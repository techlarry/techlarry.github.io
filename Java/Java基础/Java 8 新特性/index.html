


<!doctype html>
<html lang="zh" class="no-js">

 <!-- 百度统计代码 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b6f62cca1f01c8c6a28628994476d789";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
      
        <title>Java 8 新特性</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-lambda" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="">
    <a href="../../.." title="Zhenhua's Wiki" class="md-header-nav__button md-logo" aria-label="Zhenhua's Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Zhenhua's Wiki
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Java 8 新特性
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/techlarry/note/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Algorithm/" class="md-tabs__link">
          Algorithm
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" class="md-tabs__link md-tabs__link--active">
          Java
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Leetcode/" class="md-tabs__link">
          Leetcode
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Miscellaneous/" class="md-tabs__link">
          Miscellaneous
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Data%20Science/" class="md-tabs__link">
          Data Science
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../OS/" class="md-tabs__link">
          OS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Zhenhua's Wiki" class="md-nav__button md-logo" aria-label="Zhenhua's Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    Zhenhua's Wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/techlarry/note/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Algorithm
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Algorithm" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2">
    
    <label class="md-nav__link" for="nav-1-2">
      Princeton
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Princeton" data-md-level="2">
      <label class="md-nav__title" for="nav-1-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Princeton
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%201%20-%20Union%20Find/" title="Topic 1 - Union Find" class="md-nav__link">
      Topic 1 - Union Find
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%202%20-%20Stacks%20and%20Queues/" title="Topic 2 - Stacks and Queues" class="md-nav__link">
      Topic 2 - Stacks and Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%203%20-%20Sorting/" title="Topic 3 - Sorting" class="md-nav__link">
      Topic 3 - Sorting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%204%20-%20Priority%20Queues/" title="Topic 4 - Priority Queues" class="md-nav__link">
      Topic 4 - Priority Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%205%20-%20Symbol%20Tables/" title="Topic 5 - Symbol Tables" class="md-nav__link">
      Topic 5 - Symbol Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%206%20-%20Balanced%20Search%20Trees/" title="Topic 6 - Balanced Search Trees" class="md-nav__link">
      Topic 6 - Balanced Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%207%20-%20Hash%20Table/" title="Topic 7 - Hash Table" class="md-nav__link">
      Topic 7 - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%208%20-%20Graph/" title="Topic 8 - Graph" class="md-nav__link">
      Topic 8 - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%209%20-%20Minimum%20Spanning%20Tree%20and%20Shortest%20Path/" title="Topic 9 - Minimum Spanning Tree and Shortest Path" class="md-nav__link">
      Topic 9 - Minimum Spanning Tree and Shortest Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%2011%20-%20String%20Sort/" title="Topic 11 - String Sort" class="md-nav__link">
      Topic 11 - String Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic%2012%20-%20Tries/" title="Topic 12 - Tries" class="md-nav__link">
      Topic 12 - Tries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3">
    
    <label class="md-nav__link" for="nav-1-3">
      Stanford
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Stanford" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Stanford
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic%20-%20Dynamic%20Programming/" title="Topic - Dynamic Programming" class="md-nav__link">
      Topic - Dynamic Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic%20-%20Graph/" title="Topic - Graph" class="md-nav__link">
      Topic - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic%20-%20Greedy%20Algorithm/" title="Topic - Greedy Algorithm" class="md-nav__link">
      Topic - Greedy Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic%20-%20Hash%20Table/" title="Topic - Hash Table" class="md-nav__link">
      Topic - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic%20-%20Heap/" title="Topic - Heap" class="md-nav__link">
      Topic - Heap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-4" type="checkbox" id="nav-1-4">
    
    <label class="md-nav__link" for="nav-1-4">
      其他
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="其他" data-md-level="2">
      <label class="md-nav__title" for="nav-1-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        其他
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/Bloom%20Filter/" title="Bloom Filter" class="md-nav__link">
      Bloom Filter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/Bucket%20Sort/" title="Bucket Sort" class="md-nav__link">
      Bucket Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/Divide%20and%20Conquer/" title="Divide and Conquer" class="md-nav__link">
      Divide and Conquer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/Exhaustive%20Search%20and%20Backtracking/" title="Exhaustive Search and Backtracking" class="md-nav__link">
      Exhaustive Search and Backtracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%85%B6%E4%BB%96/%E6%B0%B4%E5%A1%98%E6%8A%BD%E6%A0%B7/" title="水塘抽样" class="md-nav__link">
      水塘抽样
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-5" type="checkbox" id="nav-1-5">
    
    <label class="md-nav__link" for="nav-1-5">
      剑指Offer
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="剑指Offer" data-md-level="2">
      <label class="md-nav__title" for="nav-1-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        剑指Offer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/solution/" title="solution" class="md-nav__link">
      solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/2%20%E2%BE%AF%E8%AF%95%E9%9C%80%E8%A6%81%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="2 ⾯试需要的基础知识" class="md-nav__link">
      2 ⾯试需要的基础知识
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/3%20%E9%AB%98%E8%B4%A8%E9%87%8F%E7%9A%84%E4%BB%A3%E7%A0%81/" title="3 高质量的代码" class="md-nav__link">
      3 高质量的代码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/4%20%E8%A7%A3%E5%86%B3%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9A%84%E6%80%9D%E8%B7%AF/" title="4 解决面试题的思路" class="md-nav__link">
      4 解决面试题的思路
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/5%20%E4%BC%98%E5%8C%96%E6%97%B6%E9%97%B4%E5%92%8C%E7%A9%BA%E9%97%B4%E6%95%88%E7%8E%87/" title="5 优化时间和空间效率" class="md-nav__link">
      5 优化时间和空间效率
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/6%20%E9%9D%A2%E8%AF%95%E4%B8%AD%E7%9A%84%E5%90%84%E9%A1%B9%E8%83%BD%E5%8A%9B/" title="6 面试中的各项能力" class="md-nav__link">
      6 面试中的各项能力
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%89%91%E6%8C%87Offer/7%20%E4%B8%A4%E4%B8%AA%E9%9D%A2%E8%AF%95%E6%A1%88%E4%BE%8B/" title="7 两个面试案例" class="md-nav__link">
      7 两个面试案例
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-6" type="checkbox" id="nav-1-6">
    
    <label class="md-nav__link" for="nav-1-6">
      大数据算法
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="大数据算法" data-md-level="2">
      <label class="md-nav__title" for="nav-1-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        大数据算法
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%AE%97%E6%B3%95/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%AE%97%E6%B3%95/1.%20%E5%85%B1%E5%90%8CURL/" title="1. 共同URL" class="md-nav__link">
      1. 共同URL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-7" type="checkbox" id="nav-1-7">
    
    <label class="md-nav__link" for="nav-1-7">
      CS61B
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="CS61B" data-md-level="2">
      <label class="md-nav__title" for="nav-1-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        CS61B
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab1/" title="Lab1" class="md-nav__link">
      Lab1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab2/" title="Lab2" class="md-nav__link">
      Lab2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab3/" title="Lab3" class="md-nav__link">
      Lab3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Java
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Java" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Head First Java
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Head First Java" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Head First Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/1%20Dive%20in%20A%20Quick%20Dip/" title="1 Dive in A Quick Dip" class="md-nav__link">
      1 Dive in A Quick Dip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/2%20Classes%20and%20Objects/" title="2 Classes and Objects" class="md-nav__link">
      2 Classes and Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/3%20Primitives%20and%20references/" title="3 Primitives and references" class="md-nav__link">
      3 Primitives and references
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/4%20Methods%20use%20instance%20variables/" title="4 Methods use instance variables" class="md-nav__link">
      4 Methods use instance variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/5%20Writing%20a%20Program/" title="5 Writing a Program" class="md-nav__link">
      5 Writing a Program
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/6%20Get%20to%20know%20the%20Java%20API/" title="6 Get to know the Java API" class="md-nav__link">
      6 Get to know the Java API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/7%20Inheritance%20and%20polymorphism/" title="7 Inheritance and polymorphism" class="md-nav__link">
      7 Inheritance and polymorphism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/8%20Interfaces%20and%20Abstract%20Classes/" title="8 Interfaces and Abstract Classes" class="md-nav__link">
      8 Interfaces and Abstract Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/9%20Constructors%20and%20Garbage%20Collection/" title="9 Constructors and Garbage Collection" class="md-nav__link">
      9 Constructors and Garbage Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/10%20Numbers%20and%20Statics/" title="10 Numbers and Statics" class="md-nav__link">
      10 Numbers and Statics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/11%20Exception%20Handling/" title="11 Exception Handling" class="md-nav__link">
      11 Exception Handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/12%20Getting%20GUI/" title="12 Getting GUI" class="md-nav__link">
      12 Getting GUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/13%20Using%20Swing/" title="13 Using Swing" class="md-nav__link">
      13 Using Swing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/14%20Serialization%20and%20File%20IO/" title="14 Serialization and File IO" class="md-nav__link">
      14 Serialization and File IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/15%20Networking%20and%20Threads/" title="15 Networking and Threads" class="md-nav__link">
      15 Networking and Threads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/16%20Collections%20and%20Generics/" title="16 Collections and Generics" class="md-nav__link">
      16 Collections and Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/17%20Packages%2C%20Jars%20and%20Deployment/" title="17 Packages, Jars and Deployment" class="md-nav__link">
      17 Packages, Jars and Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/18%20Remote%20deploy%20with%20RMI/" title="18 Remote deploy with RMI" class="md-nav__link">
      18 Remote deploy with RMI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%20Java/19%20Appendix/" title="19 Appendix" class="md-nav__link">
      19 Appendix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Head First设计模式
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Head First设计模式" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Head First设计模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/1%20Strategy%20Pattern/" title="1 Strategy Pattern" class="md-nav__link">
      1 Strategy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/2%20Observer%20Pattern/" title="2 Observer Pattern" class="md-nav__link">
      2 Observer Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/3%20Decorator%20Pattern/" title="3 Decorator Pattern" class="md-nav__link">
      3 Decorator Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/4%20Factory%20Pattern/" title="4 Factory Pattern" class="md-nav__link">
      4 Factory Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/5%20Singleton%20Pattern/" title="5 Singleton Pattern" class="md-nav__link">
      5 Singleton Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/6%20Command%20Pattern/" title="6 Command Pattern" class="md-nav__link">
      6 Command Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/7%20Adapter%20and%20Facade%20Pattern/" title="7 Adapter and Facade Pattern" class="md-nav__link">
      7 Adapter and Facade Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/8%20Template%20Method%20Pattern/" title="8 Template Method Pattern" class="md-nav__link">
      8 Template Method Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/9%20Iterator%20and%20Composite%20Pattern/" title="9 Iterator and Composite Pattern" class="md-nav__link">
      9 Iterator and Composite Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/10%20State%20Pattern/" title="10 State Pattern" class="md-nav__link">
      10 State Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/11%20Proxy%20Pattern/" title="11 Proxy Pattern" class="md-nav__link">
      11 Proxy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/12%20Compound%20Patterns/" title="12 Compound Patterns" class="md-nav__link">
      12 Compound Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/13%20Better%20Living%20with%20Patterns/" title="13 Better Living with Patterns" class="md-nav__link">
      13 Better Living with Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/14%20Builder%20Pattern/" title="14 Builder Pattern" class="md-nav__link">
      14 Builder Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Head%20First%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/15%20Chain%20Of%20Responsibility/" title="15 Chain Of Responsibility" class="md-nav__link">
      15 Chain Of Responsibility
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Java Web
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Java Web" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Java Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Ajax/" title="Ajax" class="md-nav__link">
      Ajax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Bootstrap/" title="Bootstrap" class="md-nav__link">
      Bootstrap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/CSS/" title="CSS" class="md-nav__link">
      CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/HTML/" title="HTML" class="md-nav__link">
      HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Head%20First%20Servlets%20and%20JSP/" title="Head First Servlets and JSP" class="md-nav__link">
      Head First Servlets and JSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/JDBC/" title="JDBC" class="md-nav__link">
      JDBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/JSON/" title="JSON" class="md-nav__link">
      JSON
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/JSP%E4%BB%A5%E5%8F%8AJSTL%E5%92%8CEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="JSP以及JSTL和EL表达式" class="md-nav__link">
      JSP以及JSTL和EL表达式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Java%20Web/" title="Java Web" class="md-nav__link">
      Java Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/JavaScript/" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/MyBatis/" title="MyBatis" class="md-nav__link">
      MyBatis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/RESTful/" title="RESTful" class="md-nav__link">
      RESTful
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Spring/" title="Spring" class="md-nav__link">
      Spring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/SpringBoot/" title="SpringBoot" class="md-nav__link">
      SpringBoot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Tomcat/" title="Tomcat" class="md-nav__link">
      Tomcat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/XML/" title="XML" class="md-nav__link">
      XML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/jQuery/" title="jQuery" class="md-nav__link">
      jQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/%E4%BA%BA%E5%91%98%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" title="人员信息管理系统" class="md-nav__link">
      人员信息管理系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java%20Web/Log4j/" title="Log4j" class="md-nav__link">
      Log4j
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" checked>
    
    <label class="md-nav__link" for="nav-2-5">
      Java基础
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Java基础" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Java基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E5%9F%BA%E7%A1%80/" title="Java基础" class="md-nav__link">
      Java基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/" title="Java编程思想" class="md-nav__link">
      Java编程思想
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%8F%8D%E5%B0%84/" title="反射" class="md-nav__link">
      反射
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/" title="多线程基础" class="md-nav__link">
      多线程基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="多线程设计模式" class="md-nav__link">
      多线程设计模式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%AE%B9%E5%99%A8/" title="容器" class="md-nav__link">
      容器
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Java 8 新特性
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Java 8 新特性" class="md-nav__link md-nav__link--active">
      Java 8 新特性
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-lambda" class="md-nav__link">
    1 Lambda表达式
  </a>
  
    <nav class="md-nav" aria-label="1 Lambda表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    函数式接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    函数描述符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    一个例子
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    常见的函数式接口
  </a>
  
    <nav class="md-nav" aria-label="常见的函数式接口">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predicate" class="md-nav__link">
    Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consumer" class="md-nav__link">
    Consumer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    类型检查推断
  </a>
  
    <nav class="md-nav" aria-label="类型检查推断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    类型检查
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    类型推断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    使用局部变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    使用方法引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    构造函数引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    lambda和方法引用实战
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda_1" class="md-nav__link">
    复合Lambda表达式
  </a>
  
    <nav class="md-nav" aria-label="复合Lambda表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    比较器复合
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    谓词复合
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    函数复合
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 流
  </a>
  
    <nav class="md-nav" aria-label="2 流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    流是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    流简介
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    流与集合
  </a>
  
    <nav class="md-nav" aria-label="流与集合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    只能遍历一次
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    内部迭代和外部迭代
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    流操作
  </a>
  
    <nav class="md-nav" aria-label="流操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    中间操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    终端操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optional" class="md-nav__link">
    3 使用Optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      其他
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="其他" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        其他
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E4%BB%96/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E4%BB%96/Java%20record/" title="Java record" class="md-nav__link">
      Java record
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E5%85%B6%E4%BB%96/%E4%BF%AE%E9%A5%B0%E8%AF%8Dnative/" title="修饰词native" class="md-nav__link">
      修饰词native
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      深入理解Java虚拟机
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="深入理解Java虚拟机" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        深入理解Java虚拟机
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/1%20%E8%B5%B0%E8%BF%9BJava/" title="1 走进Java" class="md-nav__link">
      1 走进Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/2%20Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E4%B8%8E%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E6%AD%A3%E5%B8%B8/" title="2 Java内存区域与内存溢出正常" class="md-nav__link">
      2 Java内存区域与内存溢出正常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/3%20%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/" title="3 垃圾收集器与内存分配策略" class="md-nav__link">
      3 垃圾收集器与内存分配策略
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/4%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/" title="4 虚拟机性能监控与故障处理工具" class="md-nav__link">
      4 虚拟机性能监控与故障处理工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/5%20%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98/" title="5 调优案例分析与实战" class="md-nav__link">
      5 调优案例分析与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/6%20%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="6 类文件结构" class="md-nav__link">
      6 类文件结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/7%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/" title="7 虚拟机类加载机制" class="md-nav__link">
      7 虚拟机类加载机制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/8%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/" title="8 虚拟机字节码执行引擎" class="md-nav__link">
      8 虚拟机字节码执行引擎
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/9%20%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%8F%8A%E6%89%A7%E8%A1%8C%E5%AD%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%A1%88%E4%BE%8B%E4%B8%8E%E5%AE%9E%E6%88%98/" title="9 类加载及执行子系统的案例与实战" class="md-nav__link">
      9 类加载及执行子系统的案例与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/10%20%E6%97%A9%E6%9C%9F%28%E7%BC%96%E8%AF%91%E6%9C%9F%29%E4%BC%98%E5%8C%96/" title="10 早期(编译期)优化" class="md-nav__link">
      10 早期(编译期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/11%20%E6%99%9A%E6%9C%9F%28%E8%BF%90%E8%A1%8C%E6%9C%9F%29%E4%BC%98%E5%8C%96/" title="11 晚期(运行期)优化" class="md-nav__link">
      11 晚期(运行期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/12%20Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/" title="12 Java内存模型与线程" class="md-nav__link">
      12 Java内存模型与线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/13%20%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E4%B8%8E%E9%94%81%E4%BC%98%E5%8C%96/" title="13 线程安全与锁优化" class="md-nav__link">
      13 线程安全与锁优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA/14%20AppendixC/" title="14 AppendixC" class="md-nav__link">
      14 AppendixC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Leetcode
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Leetcode" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Leetcode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/1.%20Two%20Sum/" title="1. Two Sum" class="md-nav__link">
      1. Two Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/2.%20Add%20Two%20Numbers/" title="2. Add Two Numbers" class="md-nav__link">
      2. Add Two Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/3.%20Longest%20Substring%20Without%20Repeating%20Characters/" title="3. Longest Substring Without Repeating Characters" class="md-nav__link">
      3. Longest Substring Without Repeating Characters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/4.%20Median%20of%20Two%20Sorted%20Arrays/" title="4. Median of Two Sorted Arrays" class="md-nav__link">
      4. Median of Two Sorted Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/5.%20Longest%20Palindromic%20Substring/" title="5. Longest Palindromic Substring" class="md-nav__link">
      5. Longest Palindromic Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/6.%20ZigZag%20Conversion/" title="6. ZigZag Conversion" class="md-nav__link">
      6. ZigZag Conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/7.%20Reverse%20Integer/" title="7. Reverse Integer" class="md-nav__link">
      7. Reverse Integer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/8.%20String%20to%20Integer%20%28atoi%29/" title="8. String to Integer (atoi)" class="md-nav__link">
      8. String to Integer (atoi)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/9.%20Palindrome%20Number/" title="9. Palindrome Number" class="md-nav__link">
      9. Palindrome Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/10.%20Regular%20Expression%20Matching/" title="10. Regular Expression Matching" class="md-nav__link">
      10. Regular Expression Matching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/11.%20Container%20With%20Most%20Water/" title="11. Container With Most Water" class="md-nav__link">
      11. Container With Most Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/12.%20Integer%20to%20Roman/" title="12. Integer to Roman" class="md-nav__link">
      12. Integer to Roman
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/14.%20Longest%20Common%20Prefix/" title="14. Longest Common Prefix" class="md-nav__link">
      14. Longest Common Prefix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/15.%203Sum/" title="15. 3Sum" class="md-nav__link">
      15. 3Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/16.%203Sum%20Closest/" title="16. 3Sum Closest" class="md-nav__link">
      16. 3Sum Closest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/17.%20Letter%20Combinations%20of%20a%20Phone%20Number.md/" title="17. Letter Combinations of a Phone Number" class="md-nav__link">
      17. Letter Combinations of a Phone Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/18.%204%20Sum/" title="18. 4 Sum" class="md-nav__link">
      18. 4 Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/19.%20Remove%20Nth%20Node%20From%20End%20of%20List/" title="19. Remove Nth Node From End of List" class="md-nav__link">
      19. Remove Nth Node From End of List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/20.%20Valid%20Parentheses/" title="20. Valid Parentheses" class="md-nav__link">
      20. Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/21.%20Merge%20Two%20Sorted%20Lists/" title="21. Merge Two Sorted Lists" class="md-nav__link">
      21. Merge Two Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/22.%20Generate%20Parentheses/" title="22. Generate Parentheses" class="md-nav__link">
      22. Generate Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/23.%20Merge%20k%20Sorted%20Lists/" title="23. Merge k Sorted Lists" class="md-nav__link">
      23. Merge k Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/24.%20Swap%20Nodes%20in%20Pairs/" title="24. Swap Nodes in Pairs" class="md-nav__link">
      24. Swap Nodes in Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/25.%20Reverse%20Nodes%20in%20k-Group/" title="25. Reverse Nodes in k-Group" class="md-nav__link">
      25. Reverse Nodes in k-Group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/26.%20Remove%20Duplicates%20from%20Sorted%20Array/" title="26. Remove Duplicates from Sorted Array" class="md-nav__link">
      26. Remove Duplicates from Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/27.%20Remove%20Element/" title="27. Remove Element" class="md-nav__link">
      27. Remove Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/28.%20Implement%20strStr%28%29/" title="28. Implement strStr()" class="md-nav__link">
      28. Implement strStr()
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/29.%20Divide%20Two%20Integers/" title="29. Divide Two Integers" class="md-nav__link">
      29. Divide Two Integers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/30.%20Substring%20with%20Concatenation%20of%20All%20Words/" title="30. Substring with Concatenation of All Words" class="md-nav__link">
      30. Substring with Concatenation of All Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/31.%20Next%20Permutation/" title="31. Next Permutation" class="md-nav__link">
      31. Next Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/32.%20Longest%20Valid%20Parentheses/" title="32. Longest Valid Parentheses" class="md-nav__link">
      32. Longest Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/33.%20Search%20in%20Rotated%20Sorted%20Array/" title="33. Search in Rotated Sorted Array" class="md-nav__link">
      33. Search in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/34.%20Find%20First%20and%20Last%20Position%20of%20Element%20in%20Sorted%20Array/" title="34. Find First and Last Position of Element in Sorted Array" class="md-nav__link">
      34. Find First and Last Position of Element in Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/35.%20Search%20Insert%20Position/" title="35. Search Insert Position" class="md-nav__link">
      35. Search Insert Position
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/36.%20Valid%20Sudoku/" title="36. Valid Sudoku" class="md-nav__link">
      36. Valid Sudoku
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/37.%20Sudoku%20Solver/" title="37. Sudoku Solver" class="md-nav__link">
      37. Sudoku Solver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/38.%20Count%20and%20Say/" title="38. Count and Say" class="md-nav__link">
      38. Count and Say
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/39.%20Combination%20Sum/" title="39. Combination Sum" class="md-nav__link">
      39. Combination Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/40.%20Combination%20Sum%20II/" title="40. Combination Sum II" class="md-nav__link">
      40. Combination Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/42.%20Trapping%20Rain%20Water/" title="42. Trapping Rain Water" class="md-nav__link">
      42. Trapping Rain Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/43.%20Multiply%20Strings/" title="43. Multiply Strings" class="md-nav__link">
      43. Multiply Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/46.%20Permutations/" title="46. Permutations" class="md-nav__link">
      46. Permutations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/47.%20Permutations%20II/" title="47. Permutations II" class="md-nav__link">
      47. Permutations II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/49.%20Group%20Anagrams/" title="49. Group Anagrams" class="md-nav__link">
      49. Group Anagrams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/50.%20Pow%28x%2C%20n%29/" title="50. Pow(x, n)" class="md-nav__link">
      50. Pow(x, n)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/51.%20N-Queens/" title="51. N-Queens" class="md-nav__link">
      51. N-Queens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/52.%20N-Queens%20II/" title="52. N-Queens II" class="md-nav__link">
      52. N-Queens II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/53.%20Maximum%20Subarray/" title="53. Maximum Subarray" class="md-nav__link">
      53. Maximum Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/56.%20Merge%20Intervals/" title="56. Merge Intervals" class="md-nav__link">
      56. Merge Intervals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/57.%20Insert%20Interval/" title="57. Insert Interval" class="md-nav__link">
      57. Insert Interval
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/58.%20Length%20of%20Last%20Word/" title="58. Length of Last Word" class="md-nav__link">
      58. Length of Last Word
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/60.%20Permutation%20Sequence/" title="60. Permutation Sequence" class="md-nav__link">
      60. Permutation Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/61.%20Rotate%20List/" title="61. Rotate List" class="md-nav__link">
      61. Rotate List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/62.%20Unique%20Paths/" title="62. Unique Paths" class="md-nav__link">
      62. Unique Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/63.%20Unique%20Paths%20II/" title="63. Unique Paths II" class="md-nav__link">
      63. Unique Paths II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/64.%20Minimum%20Path%20Sum/" title="64. Minimum Path Sum" class="md-nav__link">
      64. Minimum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/66.%20Plus%20One/" title="66. Plus One" class="md-nav__link">
      66. Plus One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/67.%20Add%20Binary/" title="67. Add Binary" class="md-nav__link">
      67. Add Binary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/69.%20Sqrt%28x%29/" title="69. Sqrt(x)" class="md-nav__link">
      69. Sqrt(x)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/70.%20Climbing%20Stairs/" title="70. Climbing Stairs" class="md-nav__link">
      70. Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/71.%20Simplify%20Path/" title="71. Simplify Path" class="md-nav__link">
      71. Simplify Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/74.%20Search%20a%202D%20Matrix/" title="74. Search a 2D Matrix" class="md-nav__link">
      74. Search a 2D Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/75.%20Sort%20Colors/" title="75. Sort Colors" class="md-nav__link">
      75. Sort Colors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/76.%20Minimum%20Window%20Substring/" title="76. Minimum Window Substring" class="md-nav__link">
      76. Minimum Window Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/77.%20Combinations/" title="77. Combinations" class="md-nav__link">
      77. Combinations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/78.%20Subsets/" title="78. Subsets" class="md-nav__link">
      78. Subsets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/79.%20Word%20Search/" title="79. Word Search" class="md-nav__link">
      79. Word Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/81.%20Search%20in%20Rotated%20Sorted%20Array%20II/" title="81. Search in Rotated Sorted Array II" class="md-nav__link">
      81. Search in Rotated Sorted Array II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/82.%20Remove%20Duplicates%20from%20Sorted%20List%20II/" title="82. Remove Duplicates from Sorted List II" class="md-nav__link">
      82. Remove Duplicates from Sorted List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/83.%20Remove%20Duplicates%20from%20Sorted%20List/" title="83. Remove Duplicates from Sorted List" class="md-nav__link">
      83. Remove Duplicates from Sorted List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/84.%20Largest%20Rectangle%20in%20Histogram/" title="84. Largest Rectangle in Histogram" class="md-nav__link">
      84. Largest Rectangle in Histogram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/85.%20Maximal%20Rectangle/" title="85. Maximal Rectangle" class="md-nav__link">
      85. Maximal Rectangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/86.%20Partition%20List/" title="86. Partition List" class="md-nav__link">
      86. Partition List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/88.%20Merge%20Sorted%20Array/" title="88. Merge Sorted Array" class="md-nav__link">
      88. Merge Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/89.%20Gray%20Code/" title="89. Gray Code" class="md-nav__link">
      89. Gray Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/90.%20Subsets%20II/" title="90. Subsets II" class="md-nav__link">
      90. Subsets II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/91.%20Decode%20Ways/" title="91. Decode Ways" class="md-nav__link">
      91. Decode Ways
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/92.%20Reverse%20Linked%20List%20II/" title="92. Reverse Linked List II" class="md-nav__link">
      92. Reverse Linked List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/93.%20Restore%20IP%20Addresses/" title="93. Restore IP Addresses" class="md-nav__link">
      93. Restore IP Addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/93.%20Restore%20IP%20Adress/" title="93. Restore IP Adress" class="md-nav__link">
      93. Restore IP Adress
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/94.%20Binary%20Tree%20Inorder%20Traversal/" title="94. Binary Tree Inorder Traversal" class="md-nav__link">
      94. Binary Tree Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/95.%20Unique%20Binary%20Search%20Trees%20II/" title="95. Unique Binary Search Trees II" class="md-nav__link">
      95. Unique Binary Search Trees II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/96.%20Unique%20Binary%20Search%20Trees/" title="96. Unique Binary Search Trees" class="md-nav__link">
      96. Unique Binary Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/98.%20Validate%20Binary%20Search%20Tree/" title="98. Validate Binary Search Tree" class="md-nav__link">
      98. Validate Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/99.%20Recover%20Binary%20Search%20Tree/" title="99. Recover Binary Search Tree" class="md-nav__link">
      99. Recover Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/100.%20Same%20Tree/" title="100. Same Tree" class="md-nav__link">
      100. Same Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/101.%20Symmetric%20Tree/" title="101. Symmetric Tree" class="md-nav__link">
      101. Symmetric Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/102.%20Binary%20Tree%20Level%20Order%20Traversal/" title="102. Binary Tree Level Order Traversal" class="md-nav__link">
      102. Binary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/103.%20Binary%20Tree%20Zigzag%20Level%20Order%20Traversal/" title="103. Binary Tree Zigzag Level Order Traversal" class="md-nav__link">
      103. Binary Tree Zigzag Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/104.%20Maximum%20Depth%20of%20Binary%20Tree/" title="104. Maximum Depth of Binary Tree" class="md-nav__link">
      104. Maximum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/105.%20Construct%20Binary%20Tree%20from%20Preorder%20and%20Inorder%20Traversal/" title="105. Construct Binary Tree from Preorder and Inorder Traversal" class="md-nav__link">
      105. Construct Binary Tree from Preorder and Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/107.%20Binary%20Tree%20Level%20Order%20Traversal%20II/" title="107. Binary Tree Level Order Traversal II" class="md-nav__link">
      107. Binary Tree Level Order Traversal II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/108.%20Convert%20Sorted%20Array%20to%20Binary%20Search%20Tree/" title="108. Convert Sorted Array to Binary Search Tree" class="md-nav__link">
      108. Convert Sorted Array to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/109.%20Convert%20Sorted%20List%20to%20Binary%20Search%20Tree/" title="109. Convert Sorted List to Binary Search Tree" class="md-nav__link">
      109. Convert Sorted List to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/110.%20Balanced%20Binary%20Tree/" title="110. Balanced Binary Tree" class="md-nav__link">
      110. Balanced Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/111.%20Minimum%20Depth%20of%20Binary%20Tree/" title="111. Minimum Depth of Binary Tree" class="md-nav__link">
      111. Minimum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/112.%20Path%20Sum/" title="112. Path Sum" class="md-nav__link">
      112. Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/113.%20Path%20Sum%20II/" title="113. Path Sum II" class="md-nav__link">
      113. Path Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/114.%20Flatten%20Binary%20Tree%20to%20Linked%20List/" title="114. Flatten Binary Tree to Linked List" class="md-nav__link">
      114. Flatten Binary Tree to Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/116.%20Populating%20Next%20Right%20Pointers%20in%20Each%20Node/" title="116. Populating Next Right Pointers in Each Node" class="md-nav__link">
      116. Populating Next Right Pointers in Each Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/117.%20Populating%20Next%20Right%20Pointers%20in%20Each%20Node%20II/" title="117. Populating Next Right Pointers in Each Node II" class="md-nav__link">
      117. Populating Next Right Pointers in Each Node II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/118.%20Pascals%20Triangle/" title="118. Pascals Triangle" class="md-nav__link">
      118. Pascals Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/119.%20Pascals%20Triangle%20II/" title="119. Pascals Triangle II" class="md-nav__link">
      119. Pascals Triangle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/120.%20Triangle/" title="120. Triangle" class="md-nav__link">
      120. Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/121.%20Best%20Time%20to%20Buy%20and%20Sell%20Stock/" title="121. Best Time to Buy and Sell Stock" class="md-nav__link">
      121. Best Time to Buy and Sell Stock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/122.%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20II/" title="122. Best Time to Buy and Sell Stock II" class="md-nav__link">
      122. Best Time to Buy and Sell Stock II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/123.%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20III/" title="123. Best Time to Buy and Sell Stock III" class="md-nav__link">
      123. Best Time to Buy and Sell Stock III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/124.%20Binary%20Tree%20Maximum%20Path%20Sum/" title="124. Binary Tree Maximum Path Sum" class="md-nav__link">
      124. Binary Tree Maximum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/125.%20Valid%20Palindrome/" title="125. Valid Palindrome" class="md-nav__link">
      125. Valid Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/127.%20Word%20Ladder/" title="127. Word Ladder" class="md-nav__link">
      127. Word Ladder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/128.%20Longest%20Consecutive%20Sequence/" title="128. Longest Consecutive Sequence" class="md-nav__link">
      128. Longest Consecutive Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/129.%20Sum%20Root%20to%20Leaf%20Numbers/" title="129. Sum Root to Leaf Numbers" class="md-nav__link">
      129. Sum Root to Leaf Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/130.%20Surrounded%20Regions/" title="130. Surrounded Regions" class="md-nav__link">
      130. Surrounded Regions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/131.%20Palindrome%20Partitioning/" title="131. Palindrome Partitioning" class="md-nav__link">
      131. Palindrome Partitioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/132.%20Palindrome%20Partitioning%20II/" title="132. Palindrome Partitioning II" class="md-nav__link">
      132. Palindrome Partitioning II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/133.%20Clone%20Graph/" title="133. Clone Graph" class="md-nav__link">
      133. Clone Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/136%20Single%20Number/" title="136 Single Number" class="md-nav__link">
      136 Single Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/137%20Single%20Number%20II/" title="137 Single Number II" class="md-nav__link">
      137 Single Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/138.%20Copy%20List%20with%20Random%20Pointer/" title="138. Copy List with Random Pointer" class="md-nav__link">
      138. Copy List with Random Pointer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/139.%20Word%20Break/" title="139. Word Break" class="md-nav__link">
      139. Word Break
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/141.%20Linked%20List%20Cycle/" title="141. Linked List Cycle" class="md-nav__link">
      141. Linked List Cycle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/142.%20Linked%20List%20Cycle%20II/" title="142. Linked List Cycle II" class="md-nav__link">
      142. Linked List Cycle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/143.%20Reorder%20List/" title="143. Reorder List" class="md-nav__link">
      143. Reorder List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/144.%20Binary%20Tree%20Preorder%20Traversal/" title="144. Binary Tree Preorder Traversal" class="md-nav__link">
      144. Binary Tree Preorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/145.%20Binary%20Tree%20Postorder%20Traversal/" title="145. Binary Tree Postorder Traversal" class="md-nav__link">
      145. Binary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/146.%20LRU%20Cache/" title="146. LRU Cache" class="md-nav__link">
      146. LRU Cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/147.%20Insertion%20Sort%20List/" title="147. Insertion Sort List" class="md-nav__link">
      147. Insertion Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/148.%20Sort%20List/" title="148. Sort List" class="md-nav__link">
      148. Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/149.%20Max%20Points%20on%20a%20Line/" title="149. Max Points on a Line" class="md-nav__link">
      149. Max Points on a Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/150.%20Evaluate%20Reverse%20Polish%20Notation/" title="150. Evaluate Reverse Polish Notation" class="md-nav__link">
      150. Evaluate Reverse Polish Notation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/151.%20Reverse%20Words%20in%20a%20String/" title="151. Reverse Words in a String" class="md-nav__link">
      151. Reverse Words in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/152.%20Maximum%20Product%20Subarray/" title="152. Maximum Product Subarray" class="md-nav__link">
      152. Maximum Product Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/153.%20Find%20Minimum%20in%20Rotated%20Sorted%20Array/" title="153. Find Minimum in Rotated Sorted Array" class="md-nav__link">
      153. Find Minimum in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/155.%20Min%20Stack/" title="155. Min Stack" class="md-nav__link">
      155. Min Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/160.%20Intersection%20of%20Two%20Linked%20Lists/" title="160. Intersection of Two Linked Lists" class="md-nav__link">
      160. Intersection of Two Linked Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/164.%20Maximum%20Gap/" title="164. Maximum Gap" class="md-nav__link">
      164. Maximum Gap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/166.%20Fraction%20to%20Recurring%20Decimal/" title="166. Fraction to Recurring Decimal" class="md-nav__link">
      166. Fraction to Recurring Decimal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/167.%20Two%20Sum%20II%20-%20Input%20array%20is%20sorted/" title="167. Two Sum II - Input array is sorted" class="md-nav__link">
      167. Two Sum II - Input array is sorted
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/168.%20Excel%20Sheet%20Column%20Title/" title="168. Excel Sheet Column Title" class="md-nav__link">
      168. Excel Sheet Column Title
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/169.%20Majority%20Element/" title="169. Majority Element" class="md-nav__link">
      169. Majority Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/170.%20TwoSum%20III/" title="170. TwoSum III" class="md-nav__link">
      170. TwoSum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/171.%20Excel%20Sheet%20Column%20Number/" title="171. Excel Sheet Column Number" class="md-nav__link">
      171. Excel Sheet Column Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/172.%20Factorial%20Trailing%20Zeroes/" title="172. Factorial Trailing Zeroes" class="md-nav__link">
      172. Factorial Trailing Zeroes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/173.%20Binary%20Search%20Tree%20Iterator/" title="173. Binary Search Tree Iterator" class="md-nav__link">
      173. Binary Search Tree Iterator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/174.%20Dungeon%20Game/" title="174. Dungeon Game" class="md-nav__link">
      174. Dungeon Game
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/179.%20Largest%20Number/" title="179. Largest Number" class="md-nav__link">
      179. Largest Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/187.%20Repeated%20DNA%20Sequences/" title="187. Repeated DNA Sequences" class="md-nav__link">
      187. Repeated DNA Sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/190.%20Reverse%20Bits/" title="190. Reverse Bits" class="md-nav__link">
      190. Reverse Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/191.%20Number%20of%201%20Bits/" title="191. Number of 1 Bits" class="md-nav__link">
      191. Number of 1 Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/198.%20House%20Robber/" title="198. House Robber" class="md-nav__link">
      198. House Robber
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/199.%20Binary%20Tree%20Right%20Side%20View/" title="199. Binary Tree Right Side View" class="md-nav__link">
      199. Binary Tree Right Side View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/200.%20Number%20of%20Islands/" title="200. Number of Islands" class="md-nav__link">
      200. Number of Islands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/202.%20Happy%20Number/" title="202. Happy Number" class="md-nav__link">
      202. Happy Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/203.%20Remove%20Linked%20List%20Elements/" title="203. Remove Linked List Elements" class="md-nav__link">
      203. Remove Linked List Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/204.%20Count%20Primes/" title="204. Count Primes" class="md-nav__link">
      204. Count Primes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/205.%20Isomorphic%20Strings/" title="205. Isomorphic Strings" class="md-nav__link">
      205. Isomorphic Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/206.%20Reverse%20Linked%20List/" title="206. Reverse Linked List" class="md-nav__link">
      206. Reverse Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/207.%20Course%20Schedule/" title="207. Course Schedule" class="md-nav__link">
      207. Course Schedule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/209.%20Minimum%20Size%20Subarray%20Sum/" title="209. Minimum Size Subarray Sum" class="md-nav__link">
      209. Minimum Size Subarray Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/210.%20Course%20Schedule%20II/" title="210. Course Schedule II" class="md-nav__link">
      210. Course Schedule II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/213.%20House%20Robber%20II/" title="213. House Robber II" class="md-nav__link">
      213. House Robber II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/215.%20Kth%20Largest%20Element%20in%20an%20Array/" title="215. Kth Largest Element in an Array" class="md-nav__link">
      215. Kth Largest Element in an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/216.%20Combination%20Sum%20III/" title="216. Combination Sum III" class="md-nav__link">
      216. Combination Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/221.%20Maximal%20Square/" title="221. Maximal Square" class="md-nav__link">
      221. Maximal Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/222.%20Count%20Complete%20Tree%20Nodes/" title="222. Count Complete Tree Nodes" class="md-nav__link">
      222. Count Complete Tree Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/224.%20Basic%20Calculator/" title="224. Basic Calculator" class="md-nav__link">
      224. Basic Calculator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/225.%20Implement%20Stack%20using%20Queues/" title="225. Implement Stack using Queues" class="md-nav__link">
      225. Implement Stack using Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/226.%20Invert%20Binary%20Tree/" title="226. Invert Binary Tree" class="md-nav__link">
      226. Invert Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/229.%20Majority%20Element%20II/" title="229. Majority Element II" class="md-nav__link">
      229. Majority Element II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/230.%20Kth%20Smallest%20Element%20in%20a%20BST/" title="230. Kth Smallest Element in a BST" class="md-nav__link">
      230. Kth Smallest Element in a BST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/231.%20Power%20of%20Two/" title="231. Power of Two" class="md-nav__link">
      231. Power of Two
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/232.%20Implement%20Queue%20using%20Stacks/" title="232. Implement Queue using Stacks" class="md-nav__link">
      232. Implement Queue using Stacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/233.%20Number%20of%20Digit%20One/" title="233. Number of Digit One" class="md-nav__link">
      233. Number of Digit One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/234.%20Palindrome%20Linked%20List/" title="234. Palindrome Linked List" class="md-nav__link">
      234. Palindrome Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/235.%20Lowest%20Common%20Ancestor%20of%20a%20Binary%20Search%20Tree/" title="235. Lowest Common Ancestor of a Binary Search Tree" class="md-nav__link">
      235. Lowest Common Ancestor of a Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/236.%20Lowest%20Common%20Ancestor%20of%20a%20Binary%20Tree/" title="236. Lowest Common Ancestor of a Binary Tree" class="md-nav__link">
      236. Lowest Common Ancestor of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/237.%20Delete%20Node%20in%20a%20Linked%20List/" title="237. Delete Node in a Linked List" class="md-nav__link">
      237. Delete Node in a Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/240.%20Search%20a%202D%20Matrix%20II/" title="240. Search a 2D Matrix II" class="md-nav__link">
      240. Search a 2D Matrix II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/241.%20Different%20Ways%20to%20Add%20Parentheses/" title="241. Different Ways to Add Parentheses" class="md-nav__link">
      241. Different Ways to Add Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/242.%20Valid%20Anagram/" title="242. Valid Anagram" class="md-nav__link">
      242. Valid Anagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/252.%20Meeting%20Rooms/" title="252. Meeting Rooms" class="md-nav__link">
      252. Meeting Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/253.%20Meeting%20Rooms%20II/" title="253. Meeting Rooms II" class="md-nav__link">
      253. Meeting Rooms II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/256.%20Paint%20House/" title="256. Paint House" class="md-nav__link">
      256. Paint House
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/257.%20Binary%20Tree%20Paths/" title="257. Binary Tree Paths" class="md-nav__link">
      257. Binary Tree Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/258.%20Add%20Digits/" title="258. Add Digits" class="md-nav__link">
      258. Add Digits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/260.%20Single%20Number%20III/" title="260. Single Number III" class="md-nav__link">
      260. Single Number III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/261.%20Graph%20Valid%20Tree/" title="261. Graph Valid Tree" class="md-nav__link">
      261. Graph Valid Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/263.%20Ugly%20Number/" title="263. Ugly Number" class="md-nav__link">
      263. Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/264.%20Ugly%20Number%20II/" title="264. Ugly Number II" class="md-nav__link">
      264. Ugly Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/265.%20Paint%20House%20II/" title="265. Paint House II" class="md-nav__link">
      265. Paint House II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/268.%20Missing%20Number/" title="268. Missing Number" class="md-nav__link">
      268. Missing Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/270.%20Closest%20Binary%20Search%20Tree%20Value/" title="270. Closest Binary Search Tree Value" class="md-nav__link">
      270. Closest Binary Search Tree Value
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/276.%20Paint%20Fence/" title="276. Paint Fence" class="md-nav__link">
      276. Paint Fence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/278.%20First%20Bad%20Version/" title="278. First Bad Version" class="md-nav__link">
      278. First Bad Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/279.%20Perfect%20Squares/" title="279. Perfect Squares" class="md-nav__link">
      279. Perfect Squares
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/280.%20Wiggle%20Sort/" title="280. Wiggle Sort" class="md-nav__link">
      280. Wiggle Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/287.%20Find%20the%20Duplicate%20Number/" title="287. Find the Duplicate Number" class="md-nav__link">
      287. Find the Duplicate Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/290.%20Word%20Pattern/" title="290. Word Pattern" class="md-nav__link">
      290. Word Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/295.%20Find%20Median%20from%20Data%20Stream/" title="295. Find Median from Data Stream" class="md-nav__link">
      295. Find Median from Data Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/297.%20Serialize%20and%20Deserialize%20Binary%20Tree/" title="297. Serialize and Deserialize Binary Tree" class="md-nav__link">
      297. Serialize and Deserialize Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/300.%20Longest%20Increasing%20Subsequence/" title="300. Longest Increasing Subsequence" class="md-nav__link">
      300. Longest Increasing Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/303.%20Range%20Sum%20Query%20-%20Immutable/" title="303. Range Sum Query - Immutable" class="md-nav__link">
      303. Range Sum Query - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/304.%20Range%20Sum%20Query%202D%20-%20Immutable/" title="304. Range Sum Query 2D - Immutable" class="md-nav__link">
      304. Range Sum Query 2D - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/309.%20Best%20Time%20to%20Buy%20and%20Sell%20Stock%20with%20Cooldown/" title="309. Best Time to Buy and Sell Stock with Cooldown" class="md-nav__link">
      309. Best Time to Buy and Sell Stock with Cooldown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/310.%20Minimum%20Height%20Trees/" title="310. Minimum Height Trees" class="md-nav__link">
      310. Minimum Height Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/313.%20Super%20Ugly%20Number/" title="313. Super Ugly Number" class="md-nav__link">
      313. Super Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/322.%20Coin%20Change/" title="322. Coin Change" class="md-nav__link">
      322. Coin Change
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/324.%20Wiggle%20Sort%20II/" title="324. Wiggle Sort II" class="md-nav__link">
      324. Wiggle Sort II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/326.%20Power%20of%20Three/" title="326. Power of Three" class="md-nav__link">
      326. Power of Three
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/328.%20Odd%20Even%20Linked%20List/" title="328. Odd Even Linked List" class="md-nav__link">
      328. Odd Even Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/331.%20Verify%20Preorder%20Serialization%20of%20a%20Binary%20Tree/" title="331. Verify Preorder Serialization of a Binary Tree" class="md-nav__link">
      331. Verify Preorder Serialization of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/332.%20Reconstruct%20Itinerary/" title="332. Reconstruct Itinerary" class="md-nav__link">
      332. Reconstruct Itinerary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/337.%20House%20Robber%20III/" title="337. House Robber III" class="md-nav__link">
      337. House Robber III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/338.%20Counting%20Bits/" title="338. Counting Bits" class="md-nav__link">
      338. Counting Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/342.%20Power%20of%20Four/" title="342. Power of Four" class="md-nav__link">
      342. Power of Four
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/344.%20Reverse%20String/" title="344. Reverse String" class="md-nav__link">
      344. Reverse String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/345.%20Reverse%20Vowels%20of%20a%20String/" title="345. Reverse Vowels of a String" class="md-nav__link">
      345. Reverse Vowels of a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/347.%20Top%20K%20Frequent%20Elements/" title="347. Top K Frequent Elements" class="md-nav__link">
      347. Top K Frequent Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/349.%20Intersection%20of%20Two%20Arrays/" title="349. Intersection of Two Arrays" class="md-nav__link">
      349. Intersection of Two Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/350.%20Intersection%20of%20Two%20Arrays%20II/" title="350. Intersection of Two Arrays II" class="md-nav__link">
      350. Intersection of Two Arrays II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/359.%20Logger%20Rate%20Limiter/" title="359. Logger Rate Limiter" class="md-nav__link">
      359. Logger Rate Limiter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/366.%20Find%20Leaves%20of%20Binary%20Tree/" title="366. Find Leaves of Binary Tree" class="md-nav__link">
      366. Find Leaves of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/367.%20Valid%20Perfect%20Square/" title="367. Valid Perfect Square" class="md-nav__link">
      367. Valid Perfect Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/370.%20Range%20Addition/" title="370. Range Addition" class="md-nav__link">
      370. Range Addition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/372.%20Super%20Pow/" title="372. Super Pow" class="md-nav__link">
      372. Super Pow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/373.%20Find%20K%20Pairs%20with%20Smallest%20Sums/" title="373. Find K Pairs with Smallest Sums" class="md-nav__link">
      373. Find K Pairs with Smallest Sums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/378.%20Kth%20Smallest%20Element%20in%20a%20Sorted%20Matrix/" title="378. Kth Smallest Element in a Sorted Matrix" class="md-nav__link">
      378. Kth Smallest Element in a Sorted Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/382.%20Linked%20List%20Random%20Node/" title="382. Linked List Random Node" class="md-nav__link">
      382. Linked List Random Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/384.%20Shuffle%20an%20Array/" title="384. Shuffle an Array" class="md-nav__link">
      384. Shuffle an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/387.%20First%20Unique%20Character%20in%20a%20String/" title="387. First Unique Character in a String" class="md-nav__link">
      387. First Unique Character in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/399.%20Evaluate%20Division/" title="399. Evaluate Division" class="md-nav__link">
      399. Evaluate Division
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/401.%20Binary%20Watch/" title="401. Binary Watch" class="md-nav__link">
      401. Binary Watch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/404.%20Sum%20of%20Left%20Leaves/" title="404. Sum of Left Leaves" class="md-nav__link">
      404. Sum of Left Leaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/409.%20Longest%20Palindrome/" title="409. Longest Palindrome" class="md-nav__link">
      409. Longest Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/415.%20Add%20Strings/" title="415. Add Strings" class="md-nav__link">
      415. Add Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/426.%20Convert%20Binary%20Search%20Tree%20to%20Sorted%20Doubly%20Linked%20List/" title="426. Convert Binary Search Tree to Sorted Doubly Linked List" class="md-nav__link">
      426. Convert Binary Search Tree to Sorted Doubly Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/429.%20N-ary%20Tree%20Level%20Order%20Traversal/" title="429. N-ary Tree Level Order Traversal" class="md-nav__link">
      429. N-ary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/437.%20Path%20Sum%20III/" title="437. Path Sum III" class="md-nav__link">
      437. Path Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/438.%20Find%20All%20Anagrams%20in%20a%20String/" title="438. Find All Anagrams in a String" class="md-nav__link">
      438. Find All Anagrams in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/451.%20Sort%20Characters%20By%20Frequency/" title="451. Sort Characters By Frequency" class="md-nav__link">
      451. Sort Characters By Frequency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/463.%20Island%20Perimeter/" title="463. Island Perimeter" class="md-nav__link">
      463. Island Perimeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/493.%20Reverse%20Pairs/" title="493. Reverse Pairs" class="md-nav__link">
      493. Reverse Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/500.%20Keyboard%20Row/" title="500. Keyboard Row" class="md-nav__link">
      500. Keyboard Row
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/507.%20Perfect%20Number/" title="507. Perfect Number" class="md-nav__link">
      507. Perfect Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/518.%20Coin%20Change%202/" title="518. Coin Change 2" class="md-nav__link">
      518. Coin Change 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/538.%20Convert%20BST%20to%20Greater%20Tree/" title="538. Convert BST to Greater Tree" class="md-nav__link">
      538. Convert BST to Greater Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/559.%20Maximum%20Depth%20of%20N-ary%20Tree/" title="559. Maximum Depth of N-ary Tree" class="md-nav__link">
      559. Maximum Depth of N-ary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/590.%20N-ary%20Tree%20Postorder%20Traversal/" title="590. N-ary Tree Postorder Traversal" class="md-nav__link">
      590. N-ary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/599.%20Minimum%20Index%20Sum%20of%20Two%20Lists/" title="599. Minimum Index Sum of Two Lists" class="md-nav__link">
      599. Minimum Index Sum of Two Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/606.%20Construct%20String%20from%20Binary%20Tree/" title="606. Construct String from Binary Tree" class="md-nav__link">
      606. Construct String from Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/633.%20Sum%20of%20Square%20Numbers/" title="633. Sum of Square Numbers" class="md-nav__link">
      633. Sum of Square Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/637.%20Average%20of%20Levels%20in%20Binary%20Tree/" title="637. Average of Levels in Binary Tree" class="md-nav__link">
      637. Average of Levels in Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/671.%20Second%20Minimum%20Node%20In%20a%20Binary%20Tree/" title="671. Second Minimum Node In a Binary Tree" class="md-nav__link">
      671. Second Minimum Node In a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/684.%20Redundant%20Connection/" title="684. Redundant Connection" class="md-nav__link">
      684. Redundant Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/685.%20Redundant%20Connection%20II/" title="685. Redundant Connection II" class="md-nav__link">
      685. Redundant Connection II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/687.%20Longest%20Univalue%20Path/" title="687. Longest Univalue Path" class="md-nav__link">
      687. Longest Univalue Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/692.%20Top%20K%20Frequent%20Words/" title="692. Top K Frequent Words" class="md-nav__link">
      692. Top K Frequent Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/697.%20Degree%20of%20an%20Array/" title="697. Degree of an Array" class="md-nav__link">
      697. Degree of an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/703.%20Kth%20Largest%20Element%20in%20a%20Stream/" title="703. Kth Largest Element in a Stream" class="md-nav__link">
      703. Kth Largest Element in a Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/704.%20Binary%20Search/" title="704. Binary Search" class="md-nav__link">
      704. Binary Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/716.%20Max%20Stack/" title="716. Max Stack" class="md-nav__link">
      716. Max Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/728.%20Self%20Dividing%20Numbers/" title="728. Self Dividing Numbers" class="md-nav__link">
      728. Self Dividing Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/741.%20Cherry%20Pickup/" title="741. Cherry Pickup" class="md-nav__link">
      741. Cherry Pickup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/743.%20Network%20Delay%20Time/" title="743. Network Delay Time" class="md-nav__link">
      743. Network Delay Time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/746.%20Min%20Cost%20Climbing%20Stairs/" title="746. Min Cost Climbing Stairs" class="md-nav__link">
      746. Min Cost Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/760.%20Find%20Anagram%20Mappings/" title="760. Find Anagram Mappings" class="md-nav__link">
      760. Find Anagram Mappings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/783.%20Minimum%20Distance%20Between%20BST%20Nodes/" title="783. Minimum Distance Between BST Nodes" class="md-nav__link">
      783. Minimum Distance Between BST Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/784.%20Letter%20Case%20Permutation/" title="784. Letter Case Permutation" class="md-nav__link">
      784. Letter Case Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/785.%20Is%20Graph%20Bipartite%3F/" title="785. Is Graph Bipartite?" class="md-nav__link">
      785. Is Graph Bipartite?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/841.%20Keys%20and%20Rooms/" title="841. Keys and Rooms" class="md-nav__link">
      841. Keys and Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/867.%20Transpose%20Matrix/" title="867. Transpose Matrix" class="md-nav__link">
      867. Transpose Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/873.%20Length%20of%20Longest%20Fibonacci%20Subsequence/" title="873. Length of Longest Fibonacci Subsequence" class="md-nav__link">
      873. Length of Longest Fibonacci Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/876.%20Middle%20of%20the%20Linked%20List/" title="876. Middle of the Linked List" class="md-nav__link">
      876. Middle of the Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/941.%20Valid%20Mountain%20Array/" title="941. Valid Mountain Array" class="md-nav__link">
      941. Valid Mountain Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/1020.%20Number%20of%20Enclaves/" title="1020. Number of Enclaves" class="md-nav__link">
      1020. Number of Enclaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-277" type="checkbox" id="nav-3-277">
    
    <label class="md-nav__link" for="nav-3-277">
      LintCode
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="LintCode" data-md-level="2">
      <label class="md-nav__title" for="nav-3-277">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        LintCode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/77.%20Longest%20Common%20Subsequence/" title="77. Longest Common Subsequence" class="md-nav__link">
      77. Longest Common Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/464.%20Sort%20Integers%20II/" title="464. Sort Integers II" class="md-nav__link">
      464. Sort Integers II
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Miscellaneous
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Miscellaneous" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Clion/" title="Clion" class="md-nav__link">
      Clion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/GCC/" title="GCC" class="md-nav__link">
      GCC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Intellij%20IDEA/" title="Intellij IDEA" class="md-nav__link">
      Intellij IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/LLDB%E4%BD%BF%E7%94%A8/" title="LLDB使用" class="md-nav__link">
      LLDB使用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Maven/" title="Maven" class="md-nav__link">
      Maven
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/VIM%E6%8A%80%E5%B7%A7/" title="VIM技巧" class="md-nav__link">
      VIM技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/" title="建站日志" class="md-nav__link">
      建站日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-11" type="checkbox" id="nav-4-11">
    
    <label class="md-nav__link" for="nav-4-11">
      Cpp
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Cpp" data-md-level="2">
      <label class="md-nav__title" for="nav-4-11">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Cpp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/EOF/" title="EOF" class="md-nav__link">
      EOF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/STL%E4%B8%AD%E7%9A%84vector%20string%E6%80%BB%E7%BB%93/" title="STL中的vector string总结" class="md-nav__link">
      STL中的vector string总结
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/STL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/" title="STL源码剖析" class="md-nav__link">
      STL源码剖析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/static%E7%94%A8%E6%B3%95/" title="static用法" class="md-nav__link">
      static用法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C%2B%2B%20Primer%20%286%29%20-%20%E5%87%BD%E6%95%B0/" title="C++ Primer (6) - 函数" class="md-nav__link">
      C++ Primer (6) - 函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C%2B%2B%20Primer%20%2812%29%20-%20%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/" title="C++ Primer (12) - 动态内存" class="md-nav__link">
      C++ Primer (12) - 动态内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C%2B%2B%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%85%B8100%E9%A2%98/" title="C++面试经典100题" class="md-nav__link">
      C++面试经典100题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      awesome Install
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="awesome Install" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        awesome Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/CentOS%E6%97%A5%E5%BF%97/" title="CentOS日志" class="md-nav__link">
      CentOS日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Intel%20Parallel%20Studio%20XE/" title="Intel Parallel Studio XE" class="md-nav__link">
      Intel Parallel Studio XE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Jupyter%20Notebook/" title="Jupyter Notebook" class="md-nav__link">
      Jupyter Notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Nasm/" title="Nasm" class="md-nav__link">
      Nasm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Octave/" title="Octave" class="md-nav__link">
      Octave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Proxy/" title="Proxy" class="md-nav__link">
      Proxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/Ubuntu%E6%97%A5%E5%BF%97/" title="Ubuntu日志" class="md-nav__link">
      Ubuntu日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/git/" title="git" class="md-nav__link">
      git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/vagrant%E6%90%AD%E5%BB%BAubuntu/" title="vagrant搭建ubuntu" class="md-nav__link">
      vagrant搭建ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/%E4%B8%8B%E8%BD%BD/" title="下载" class="md-nav__link">
      下载
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome%20Install/%E9%BB%91%E8%8B%B9%E6%9E%9C%E6%97%A5%E5%BF%97/" title="黑苹果日志" class="md-nav__link">
      黑苹果日志
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-13" type="checkbox" id="nav-4-13">
    
    <label class="md-nav__link" for="nav-4-13">
      面试
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="面试" data-md-level="2">
      <label class="md-nav__title" for="nav-4-13">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        面试
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/%E9%9D%A2%E8%AF%95/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/%E9%9D%A2%E8%AF%95/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95/" title="Java多线程面试" class="md-nav__link">
      Java多线程面试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/%E9%9D%A2%E8%AF%95/%E7%BD%91%E7%BB%9C%E9%9D%A2%E8%AF%95/" title="网络面试" class="md-nav__link">
      网络面试
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Data Science
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Data Science" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Big%20Data/" title="Big Data" class="md-nav__link">
      Big Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/%E6%B5%81%E5%BC%8F%E7%B3%BB%E7%BB%9F/" title="流式系统" class="md-nav__link">
      流式系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      Database
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Database" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Database
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/Database%20Systems/" title="Database Systems" class="md-nav__link">
      Database Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/MySQL/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/Redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/" title="SQL必知必会" class="md-nav__link">
      SQL必知必会
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Database/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/" title="数据仓库" class="md-nav__link">
      数据仓库
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5">
    
    <label class="md-nav__link" for="nav-5-5">
      Practical Data Science
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Practical Data Science" data-md-level="2">
      <label class="md-nav__title" for="nav-5-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Practical Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/Free%20text%20and%20natural%20language%20processing/" title="Free text and natural language processing" class="md-nav__link">
      Free text and natural language processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/Intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/Jupyter%20notebook/" title="Jupyter notebook" class="md-nav__link">
      Jupyter notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/Relational%20Data/" title="Relational Data" class="md-nav__link">
      Relational Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Practical%20Data%20Science/The%20data%20collection%20process/" title="The data collection process" class="md-nav__link">
      The data collection process
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6">
    
    <label class="md-nav__link" for="nav-5-6">
      Python
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Python" data-md-level="2">
      <label class="md-nav__title" for="nav-5-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/Python%E5%BC%95%E5%8F%B7/" title="Python引号" class="md-nav__link">
      Python引号
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/Python%E9%85%8D%E7%BD%AE/" title="Python配置" class="md-nav__link">
      Python配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/Records/" title="Records" class="md-nav__link">
      Records
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/%E5%8D%8F%E7%A8%8B/" title="协程" class="md-nav__link">
      协程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/%E7%94%9F%E6%88%90%E5%99%A8%E4%B8%8E%E8%BF%AD%E4%BB%A3%E5%99%A8/" title="生成器与迭代器" class="md-nav__link">
      生成器与迭代器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/%E8%B0%88%E8%B0%88Python%E4%B8%AD%E7%9A%84%E6%8B%B7%E8%B4%9D/" title="谈谈Python中的拷贝" class="md-nav__link">
      谈谈Python中的拷贝
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Python/%E9%97%AD%E5%8C%85%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8/" title="闭包和装饰器" class="md-nav__link">
      闭包和装饰器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-7" type="checkbox" id="nav-5-7">
    
    <label class="md-nav__link" for="nav-5-7">
      Scala
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Scala" data-md-level="2">
      <label class="md-nav__title" for="nav-5-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Scala
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/Cheat%20Sheet/" title="Cheat Sheet" class="md-nav__link">
      Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/Sbt/" title="Sbt" class="md-nav__link">
      Sbt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/Scala%E7%BC%96%E7%A8%8B/" title="Scala编程" class="md-nav__link">
      Scala编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/functional%20programming%20in%20scala/" title="functional programming in scala" class="md-nav__link">
      functional programming in scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/scala/" title="scala" class="md-nav__link">
      scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/%E6%85%95%E8%AF%BE%E7%BD%91Scala%E5%85%A5%E9%97%A8/" title="慕课网Scala入门" class="md-nav__link">
      慕课网Scala入门
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/%E7%AC%AC3%E7%AB%A0%20%E4%BB%8EJava%E5%88%B0Scala/" title="第3章 从Java到Scala" class="md-nav__link">
      第3章 从Java到Scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Scala/%E7%AC%AC4%E7%AB%A0%20%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1/" title="第4章 处理对象" class="md-nav__link">
      第4章 处理对象
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-8" type="checkbox" id="nav-5-8">
    
    <label class="md-nav__link" for="nav-5-8">
      机器学习
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="机器学习" data-md-level="2">
      <label class="md-nav__title" for="nav-5-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        机器学习
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Hands%20On%20Machine%20Learning/" title="Hands On Machine Learning" class="md-nav__link">
      Hands On Machine Learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/Machine%20Learning%20Coursera/" title="Machine Learning Coursera" class="md-nav__link">
      Machine Learning Coursera
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%9D%A2%E5%90%91%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%8C%87%E5%8D%97/" title="面向程序员的数据挖掘指南" class="md-nav__link">
      面向程序员的数据挖掘指南
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-9" type="checkbox" id="nav-5-9">
    
    <label class="md-nav__link" for="nav-5-9">
      Hadoop
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Hadoop" data-md-level="2">
      <label class="md-nav__title" for="nav-5-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Hadoop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Avro/" title="Avro" class="md-nav__link">
      Avro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Flink/" title="Flink" class="md-nav__link">
      Flink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Flume/" title="Flume" class="md-nav__link">
      Flume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/HBase/" title="HBase" class="md-nav__link">
      HBase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Hadoop%E5%9F%BA%E7%A1%80/" title="Hadoop基础" class="md-nav__link">
      Hadoop基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Hive/" title="Hive" class="md-nav__link">
      Hive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Sqoop/" title="Sqoop" class="md-nav__link">
      Sqoop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/YARN/" title="YARN" class="md-nav__link">
      YARN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/ZooKeeper/" title="ZooKeeper" class="md-nav__link">
      ZooKeeper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/%E5%85%B3%E4%BA%8EMapReduce/" title="关于MapReduce" class="md-nav__link">
      关于MapReduce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="文件格式" class="md-nav__link">
      文件格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-9-14" type="checkbox" id="nav-5-9-14">
    
    <label class="md-nav__link" for="nav-5-9-14">
      Spark
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Spark" data-md-level="3">
      <label class="md-nav__title" for="nav-5-9-14">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Spark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/%E9%99%84%E5%BD%95/" title="附录" class="md-nav__link">
      附录
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/1%20%E7%AE%80%E4%BB%8B/" title="1 简介" class="md-nav__link">
      1 简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/2%20Structured%20API/" title="2 Structured API" class="md-nav__link">
      2 Structured API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/3%20Low-level%20APIs/" title="3 Low-level APIs" class="md-nav__link">
      3 Low-level APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/4%20Spark%E6%98%AF%E5%A6%82%E4%BD%95%E5%9C%A8%E9%9B%86%E7%BE%A4%E4%B8%8A%E8%BF%90%E8%A1%8C%E7%9A%84/" title="4 Spark是如何在集群上运行的" class="md-nav__link">
      4 Spark是如何在集群上运行的
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/5%20Spark%20Streaming/" title="5 Spark Streaming" class="md-nav__link">
      5 Spark Streaming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/6%20MLlib/" title="6 MLlib" class="md-nav__link">
      6 MLlib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Data%20Science/Hadoop/Spark/7%20%E8%B0%83%E4%BC%98/" title="7 调优" class="md-nav__link">
      7 调优
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      OS
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="OS" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        OS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90Mac%20OS%20X/" title="深入解析Mac OS X" class="md-nav__link">
      深入解析Mac OS X
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E8%A6%81%E7%B4%A0/" title="计算机系统要素" class="md-nav__link">
      计算机系统要素
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E8%AE%BE%E8%AE%A1/" title="计算机组成与设计" class="md-nav__link">
      计算机组成与设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      Unix
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Unix" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Unix
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Unix/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Unix/Linux%E7%AE%A1%E7%90%86%EF%BC%8C%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC/" title="Linux管理，命令行与shell脚本" class="md-nav__link">
      Linux管理，命令行与shell脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Unix/Unix%E7%8E%AF%E5%A2%83%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/" title="Unix环境高级编程" class="md-nav__link">
      Unix环境高级编程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7">
    
    <label class="md-nav__link" for="nav-6-7">
      操作系统概念
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="操作系统概念" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        操作系统概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/1%20Introduction/" title="1 Introduction" class="md-nav__link">
      1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/2%20Operating%20System%20structures/" title="2 Operating System structures" class="md-nav__link">
      2 Operating System structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/3%20Processes/" title="3 Processes" class="md-nav__link">
      3 Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/4%20Threads%20and%20Concurrency/" title="4 Threads and Concurrency" class="md-nav__link">
      4 Threads and Concurrency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/5%20CPU%20Scheduling/" title="5 CPU Scheduling" class="md-nav__link">
      5 CPU Scheduling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/6%20Synchronization%20Tools/" title="6 Synchronization Tools" class="md-nav__link">
      6 Synchronization Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/7%20Synchronization%20Examples/" title="7 Synchronization Examples" class="md-nav__link">
      7 Synchronization Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/8%20DeadLocks/" title="8 DeadLocks" class="md-nav__link">
      8 DeadLocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/9%20Main%20Memory/" title="9 Main Memory" class="md-nav__link">
      9 Main Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/10%20Virtual%20Memory/" title="10 Virtual Memory" class="md-nav__link">
      10 Virtual Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/11%20Mass-Storage%20Structure/" title="11 Mass-Storage Structure" class="md-nav__link">
      11 Mass-Storage Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/12%20IO%20Systems/" title="12 IO Systems" class="md-nav__link">
      12 IO Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/13%20File%20System%20Interface/" title="13 File System Interface" class="md-nav__link">
      13 File System Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/14%20File%20System%20Implementation/" title="14 File System Implementation" class="md-nav__link">
      14 File System Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/15%20File%20System%20Internals/" title="15 File System Internals" class="md-nav__link">
      15 File System Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/17%20Protection/" title="17 Protection" class="md-nav__link">
      17 Protection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/18%20Virtual%20Machines/" title="18 Virtual Machines" class="md-nav__link">
      18 Virtual Machines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-8" type="checkbox" id="nav-6-8">
    
    <label class="md-nav__link" for="nav-6-8">
      计算机网络
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="计算机网络" data-md-level="2">
      <label class="md-nav__title" for="nav-6-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        计算机网络
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/Socket%20Programming/" title="Socket Programming" class="md-nav__link">
      Socket Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/WireShark%20Lab/" title="WireShark Lab" class="md-nav__link">
      WireShark Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/" title="1 计算机网络和因特网" class="md-nav__link">
      1 计算机网络和因特网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/2%20%E5%BA%94%E7%94%A8%E5%B1%82/" title="2 应用层" class="md-nav__link">
      2 应用层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/3%20%E8%BF%90%E8%BE%93%E5%B1%82/" title="3 运输层" class="md-nav__link">
      3 运输层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/4%20%E7%BD%91%E7%BB%9C%E5%B1%82/" title="4 网络层" class="md-nav__link">
      4 网络层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/5%20%E9%93%BE%E8%B7%AF%E5%B1%82/" title="5 链路层" class="md-nav__link">
      5 链路层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/6%20%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="6 网络安全" class="md-nav__link">
      6 网络安全
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      深入理解计算机系统
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="深入理解计算机系统" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        深入理解计算机系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%BC%AB%E6%B8%B8/" title="1 计算机系统漫游" class="md-nav__link">
      1 计算机系统漫游
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/2%20%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%92%8C%E5%A4%84%E7%90%86/" title="2 信息的表示和处理" class="md-nav__link">
      2 信息的表示和处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/3%20%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/" title="3 程序的机器级表示" class="md-nav__link">
      3 程序的机器级表示
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/4%20%E5%A4%84%E7%90%86%E5%99%A8%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" title="4 处理器体系结构" class="md-nav__link">
      4 处理器体系结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/5%20%E4%BC%98%E5%8C%96%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD/" title="5 优化程序性能" class="md-nav__link">
      5 优化程序性能
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/6%20%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84/" title="6 存储器层次结构" class="md-nav__link">
      6 存储器层次结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/7%20%E9%93%BE%E6%8E%A5/" title="7 链接" class="md-nav__link">
      7 链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/8%20%E5%BC%82%E5%B8%B8%E6%8E%A7%E5%88%B6%E6%B5%81/" title="8 异常控制流" class="md-nav__link">
      8 异常控制流
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/9%20%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/" title="9 虚拟内存" class="md-nav__link">
      9 虚拟内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/10%20%E7%B3%BB%E7%BB%9F%E7%BA%A7IO/" title="10 系统级IO" class="md-nav__link">
      10 系统级IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/11%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="11 网络编程" class="md-nav__link">
      11 网络编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-9-13" type="checkbox" id="nav-6-9-13">
    
    <label class="md-nav__link" for="nav-6-9-13">
      Labs
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Labs" data-md-level="3">
      <label class="md-nav__title" for="nav-6-9-13">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Labs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/Lab1%20Data%20Lab/" title="Lab1 Data Lab" class="md-nav__link">
      Lab1 Data Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/Lab3%20Attack%20Lab/" title="Lab3 Attack Lab" class="md-nav__link">
      Lab3 Attack Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/Lab4%20Cache%20Lab/" title="Lab4 Cache Lab" class="md-nav__link">
      Lab4 Cache Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/Lab5%20Shell%20Lab/" title="Lab5 Shell Lab" class="md-nav__link">
      Lab5 Shell Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/Labs/Lab6%20Malloc%20Lab/" title="Lab6 Malloc Lab" class="md-nav__link">
      Lab6 Malloc Lab
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-lambda" class="md-nav__link">
    1 Lambda表达式
  </a>
  
    <nav class="md-nav" aria-label="1 Lambda表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    函数式接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    函数描述符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    一个例子
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    常见的函数式接口
  </a>
  
    <nav class="md-nav" aria-label="常见的函数式接口">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predicate" class="md-nav__link">
    Predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consumer" class="md-nav__link">
    Consumer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    类型检查推断
  </a>
  
    <nav class="md-nav" aria-label="类型检查推断">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    类型检查
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    类型推断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    使用局部变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    使用方法引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    构造函数引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    lambda和方法引用实战
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambda_1" class="md-nav__link">
    复合Lambda表达式
  </a>
  
    <nav class="md-nav" aria-label="复合Lambda表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    比较器复合
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    谓词复合
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    函数复合
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 流
  </a>
  
    <nav class="md-nav" aria-label="2 流">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    流是什么
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    流简介
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    流与集合
  </a>
  
    <nav class="md-nav" aria-label="流与集合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    只能遍历一次
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    内部迭代和外部迭代
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    流操作
  </a>
  
    <nav class="md-nav" aria-label="流操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    中间操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    终端操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-optional" class="md-nav__link">
    3 使用Optional
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/techlarry/note/edit/master/wiki/docs/Java/Java基础/Java 8 新特性.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                  <h1>Java 8 新特性</h1>
                
<!--添加tag标签 -->


                <h3 id="1-lambda">1 Lambda表达式<a class="headerlink" href="#1-lambda" title="Permanent link">&para;</a></h3>
<p>Lambda表达式由参数、箭头和函数主体组成。可以把Lambda表达式理解为简洁地表示可传递的匿名函数的一种方式：它没有名称，但它有参数列表、函数主体、返回类型，可能还有一个可以抛出的异常列表。</p>
<p><img alt="" src="../figures/lambda.jpg" /></p>
<ul>
<li><code>(Apple a1, Apple a2)</code>: 参数列表 — 这里它采用了Comparator中compare方法的参数，两个Apple。</li>
<li><code>-&gt;</code>: 箭头， 把参数列表与Lambda主体分开。</li>
<li><code>Lambda主体</code>: 比较两个Apple的重量。表达式就是Lambda的返回值了。</li>
</ul>
<p>Lambda的基本语法是</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="n">parameters</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">expression</span>
<span class="o">(</span><span class="n">parameters</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span><span class="n">statements</span><span class="o">;}</span> <span class="c1">// 注意花括号和分号</span>
</code></pre></div>

<h4 id="_1">函数式接口<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>函数式接口(funtional interface)就是定义且只定义了⼀个抽象⽅法的接口。函数式接口的抽象⽅法的签名称为函数描述符。函数式接口可以带 有<code>@FunctionalInterface</code>的注解，但不是必须的。常见的函数式接口有<code>Comparable</code>, <code>Runnable</code>, <code>Callable</code>。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Runnable.java</span>
<span class="nd">@FunctionalInterface</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Runnable</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>

<p>⽤函数式接口可以⼲什么呢？Lambda表达式允许你直接以内联的形式为函数式接口的抽象⽅法提供实现，并把整个表达式作为函数式接口的实例 （具体说来，是函数式接口⼀个具体实现的实例):</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 使用lambda</span>
<span class="n">Runnable</span> <span class="n">r1</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;hello world!&quot;</span><span class="o">);</span>
<span class="c1">// 使用匿名类</span>
<span class="n">Runnable</span> <span class="n">r2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Hello world!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span><span class="err">；</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">Runnable</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">r</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
<span class="o">}</span>
<span class="c1">// 利用直接传递的Lambda</span>
<span class="n">process</span><span class="o">(()-&gt;</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;hello world!&quot;</span><span class="o">));</span>
</code></pre></div>

<h4 id="_2">函数描述符<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>函数式接口的抽象⽅法就是函数描述符。例如，<code>Runnable</code>接口可以看作⼀个什么也不接受什么也不返回(void)的函数的签名，因为它只有⼀个叫作<code>run()</code>的抽象⽅法，这个⽅法什么也不接受，什么也不返回(void)。可以写成<code>()-&gt;void</code>来描述函数式接口的签名。</p>
<h4 id="_3">一个例子<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>资源处理(例如处理⽂件或数据库)是⼀个常见的模式：打开⼀个资源，做⼀些处理，然后关闭资源。这个设置和清理阶段总是很类似，并且会围绕着执⾏处理的那些重要代码。这就是所谓的环绕执⾏(execute around)模式，下图很好的展示了环绕执行模式的特点：</p>
<p><img alt="" src="../figures/15849303472747.png" /></p>
<p>带资源的try语句块，会在结束后释放资源。而核心代码只有 <strong>br.readLine()</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">processFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span> 
    <span class="k">try</span> <span class="o">(</span><span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="s">&quot;data.txt&quot;</span><span class="o">)))</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span> 
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>假如我们下次需要读取文件前两行呢？我们可能需要复制一下上面的方法。如下：</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">processFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span> 
    <span class="k">try</span> <span class="o">(</span><span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="s">&quot;data.txt&quot;</span><span class="o">)))</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span> 
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>如果现在需要读取三行，最后一行呢？会造成太多代码冗余了！但是java8后你可以这样：</p>
<p>1.定义一个函数式接口</p>
<div class="highlight"><pre><span></span><code><span class="nd">@FunctionalInterface</span> 
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BufferedReaderProcessor</span> <span class="o">{</span> 
    <span class="n">String</span> <span class="nf">process</span><span class="o">(</span><span class="n">BufferedReader</span> <span class="n">b</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

<p>2.定义读取文件的方法</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">processFile</span><span class="o">(</span><span class="n">BufferedReaderProcessor</span> <span class="n">p</span><span class="o">)</span> 
                                    <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span> 
 <span class="k">try</span> <span class="o">(</span><span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="s">&quot;data.txt&quot;</span><span class="o">)))</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">br</span><span class="o">);</span>
 <span class="o">}}</span>
</code></pre></div>

<p>3.行为参数化-传递lamdba行为表达式</p>
<div class="highlight"><pre><span></span><code><span class="c1">//处理一行：</span>
<span class="n">String</span> <span class="n">oneLine</span> <span class="o">=</span> <span class="n">processFile</span><span class="o">((</span><span class="n">BufferedReader</span> <span class="n">br</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">());</span> 
<span class="c1">//处理两行：</span>
<span class="n">String</span> <span class="n">twoLines</span> <span class="o">=</span> <span class="n">processFile</span><span class="o">((</span><span class="n">BufferedReader</span> <span class="n">br</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">()</span> 
            <span class="o">+</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">());</span>
</code></pre></div>

<h4 id="_4">常见的函数式接口<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>Java 8在<code>java.util.function</code>包中引入了几个新的函数式接口。</p>
<p><img alt="common_functional_interface" src="../figures/common_functional_interface.png" /></p>
<h5 id="predicate">Predicate<a class="headerlink" href="#predicate" title="Permanent link">&para;</a></h5>
<p><code>Predicate&lt;T&gt;</code>接口定义了一个名叫test的抽象方法，它接受泛型T对象，并返回一个boolean。</p>
<p>以下是源码的一部分：
<div class="highlight"><pre><span></span><code><span class="nd">@FunctionalInterface</span> 
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Predicate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span> 
    <span class="kt">boolean</span> <span class="nf">test</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span> 
<span class="o">}</span> 

<span class="c1">// filter源码部分</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">filter</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
    <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="n">s</span><span class="o">:</span> <span class="n">list</span><span class="o">){</span> 
        <span class="k">if</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">test</span><span class="o">(</span><span class="n">s</span><span class="o">)){</span> 
            <span class="n">results</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 
 <span class="k">return</span> <span class="n">results</span><span class="o">;</span> 
<span class="o">}</span> 

<span class="c1">// 实际使用场景-1</span>
<span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nonEmptyStringPredicate</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">s</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span> 
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nonEmpty</span> <span class="o">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">listOfStrings</span><span class="o">,</span> <span class="n">nonEmptyStringPredicate</span><span class="o">);</span>
<span class="c1">// 实际使用场景-2</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nonEmpty</span> <span class="o">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">listOfStrings</span><span class="o">,</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">s</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
</code></pre></div></p>
<h5 id="consumer">Consumer<a class="headerlink" href="#consumer" title="Permanent link">&para;</a></h5>
<p><code>Consumer&lt;T&gt;</code>定义了一个名叫accept的抽象方法，它接受泛型T的对象，没有返回（void）。你如果需要访问类型T的对象，并对其执行某些操作，就可以使用这个接口.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@FunctionalInterface</span> 
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Consumer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span> 
  <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span> 
<span class="o">}</span> 

<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">forEach</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Consumer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">){</span> 
     <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="n">i</span><span class="o">:</span> <span class="n">list</span><span class="o">){</span> 
         <span class="n">c</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> 
    <span class="o">}</span>
<span class="o">}</span> 

<span class="c1">// 实际使用--lambda表达式即为Consumer函数式接口参数</span>
<span class="n">forEach</span><span class="o">(</span>
    <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">),</span> 
    <span class="o">(</span><span class="n">Integer</span> <span class="n">i</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> 
 <span class="o">);</span>
</code></pre></div>

<h5 id="function">Function<a class="headerlink" href="#function" title="Permanent link">&para;</a></h5>
<p><code>Function&lt;T, R&gt;</code>接口定义了一个叫作apply的方法，它接受一个泛型T的对象，并返回一个泛型R的对象</p>
<div class="highlight"><pre><span></span><code><span class="nd">@FunctionalInterface</span> 
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Function</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">R</span><span class="o">&gt;{</span> 
    <span class="n">R</span> <span class="nf">apply</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span> 
<span class="o">}</span> 
<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">R</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">R</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">List</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
    <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="n">s</span><span class="o">:</span> <span class="n">list</span><span class="o">){</span> 
        <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">));</span> 
    <span class="o">}</span> 
 <span class="k">return</span> <span class="n">result</span><span class="o">;</span> 
<span class="o">}</span> 

<span class="c1">// 这里 (String s)相当于T-String  s.length()相当于 R --int</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">map</span><span class="o">(</span>
        <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&quot;lambdas&quot;</span><span class="o">,</span><span class="s">&quot;in&quot;</span><span class="o">,</span><span class="s">&quot;action&quot;</span><span class="o">),</span> 
        <span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> 
 <span class="o">);</span>
</code></pre></div>

<p><strong>原始类型特化</strong></p>
<p>我们介绍了三个泛型函数式接口：<code>Predicate&lt;T&gt;</code>、<code>Consumer&lt;T&gt;</code>和<code>Function&lt;T,R&gt;</code>。还有些函数式接口专为某些类型而设计。</p>
<blockquote>
<p>如果基础类型也使用这些函数式接口，比如<code>Predicate&lt;Integer&gt;</code>通过自动拆箱装箱是可以实现的，但这在性能方面是要̶出代价的。装箱的本质就是把原来的原始类型包装起来，并保存在堆里。因此，装箱后值需要更多的内存，并需要额外的内存搜索来获取被包装的原始值。</p>
</blockquote>
<p>Java 8为我们前面所说的函数式接口带来了一个专门的版本，以便在输入和输出都是原始类型时避免自动装箱的操作。</p>
<h4 id="_5">类型检查推断<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<blockquote>
<p>当我们第一次提到Lambda表达式时，说它可以为函数式接口生成一个实例。然而，Lambda表达式本身并不包含它在实现哪个函数式接口的信息。</p>
</blockquote>
<h5 id="_6">类型检查<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>Lambda的类型是从使用Lambda的上下文推断出来的。上下文（比如，接受它传递的方法的参数，或接受它的值的局部变量）中Lambda表达式需要的类型称为目标类型。让我们通过一个例子，看看当你使用Lambda表达式时背后发生了什么。</p>
<p><img alt="" src="../figures/15849306464554.png" /></p>
<p>请注意，如果Lambda表达式抛出一个异常，那么抽象方法所声明的throws语句也必须与之匹配</p>
<blockquote>
<p><strong>特殊的void匹配规则</strong></p>
<p>如果一个Lambda的主体是一个表达式，就和一个返回void的函数式接口兼容。（当然参数列表必须兼容）</p>
<p>例如，以下两行都是合法的，尽管List的add方法返回了一个boolean，而不是函数Consumer上下文（T -&gt; void）所要求的void：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1">//Predicate返回了一个boolean </span>
<span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span> 
<span class="c1">//Consumer返回了一个void </span>
<span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
</code></pre></div>

<h5 id="_7">类型推断<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<p>Java编译器会像下面这样推断Lambda的参数类型：
<div class="highlight"><pre><span></span><code><span class="c1">// 参数a没有显示说明类型</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">greenApples</span> <span class="o">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">inventory</span><span class="o">,</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="s">&quot;green&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">getColor</span><span class="o">()));</span>
</code></pre></div>
Lambda表达式有多个参数，代码可读性的好处就更为明显。例如，你可以这样来创建一个Comparator对象：
<div class="highlight"><pre><span></span><code><span class="c1">// 没有类型推断</span>
<span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="n">Apple</span> <span class="n">a1</span><span class="o">,</span> <span class="n">Apple</span> <span class="n">a2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">());</span>
<span class="c1">// 有类型推断</span>
<span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="n">a2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">());</span>
</code></pre></div>
有时候显式写出类型更易读，有时候去掉它们更易读。没有什么法则说哪种更好；对于如何让代码更易读，程序员必须做出自己的选择。</p>
<h5 id="_8">使用局部变量<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<p>我们迄今为止所介绍的所有Lambda表达式都只用到了其主体里面的参数。但Lambda表达式也允许使用自由变量（不是参数，而是在外层作用域中定义的变量），就像匿名类一样。 它们被称作捕获Lambda</p>
<p>下面的Lambda捕获了portNumber变量：
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">portNumber</span> <span class="o">=</span> <span class="mi">1337</span><span class="o">;</span> 
<span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">portNumber</span><span class="o">);</span>
</code></pre></div></p>
<p>尽管如此，还有一点点小麻烦：关于能对这些局部变量做什么有一些限制。Lambda可以没有限制地捕获（也就是在其主体中引用）实例变量和静态变量。但是局部变量必须显式声明为final，或事实上是final。换句话说，Lambda表达式只能捕获局部变量一次。（注：捕获实例变量可以被看作捕获最终局部变量this。） 例如，下面的代码无法编译，因为portNumber变量被赋值两次：</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">portNumber</span> <span class="o">=</span> <span class="mi">1337</span><span class="o">;</span> 
<span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">portNumber</span><span class="o">);</span>
<span class="n">portNumber</span> <span class="o">=</span> <span class="mi">31337</span><span class="o">;</span>
<span class="c1">// 错误的，因为portNumber被赋值两次，lambda捕获的局部变量必须是显示final或事实上就是final（即只被赋值一次的）</span>
</code></pre></div>

<blockquote>
<p><strong>为什么这样限制</strong></p>
<p>实例变量不需要是final，而局部变量需要是final。最主要的原因是因为：实例变量是存储在堆上的，而局部变量是存储在方法栈上的。而当lambda函数访问局部变量时，该变量可能已经被回收，因此只会捕获一次即只会复制一次局部变量的副本，访问时即访问副本。因此该变量必须保证是final，副本才有效。</p>
</blockquote>
<h5 id="_9">使用方法引用<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<p>方法引用其实就是为了使代码可读性更高，例如：</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 直接使用lambda</span>
<span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">((</span><span class="n">Apple</span> <span class="n">a1</span><span class="o">,</span> <span class="n">Apple</span> <span class="n">a2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()));</span>
<span class="c1">// 使用方法引用</span>
<span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">comparing</span><span class="o">(</span><span class="n">Apple</span><span class="o">::</span><span class="n">getWeight</span><span class="o">));</span>
</code></pre></div>

<p>方法引用可以被看作仅仅调用特定方法的Lambda的一种快捷写法。它的基本思想是，如果一个Lambda代表的只是“直接调用这个方法”，比如<code>(Apple a) -&gt; a.getWeight()</code>，那最好还是方法引用来调用它：<code>Apple::getWeight</code></p>
<p>当你需要使用方法引用时，目标引用放在分隔符::前，方法的名称放在后面。<code>Apple::getWight</code> 即Apple是目标引用</p>
<div class="highlight"><pre><span></span><code><span class="o">()</span> <span class="o">-&gt;</span> <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">dumpStack</span><span class="o">()</span>  <span class="o">==&gt;</span>    <span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">()::</span><span class="n">dumpStack</span>
<span class="o">(</span><span class="n">str</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">str</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">)</span>              <span class="o">==&gt;</span>    <span class="n">String</span><span class="o">::</span><span class="n">substring</span>
</code></pre></div>

<p><strong>如何构建方法引用</strong></p>
<ul>
<li>
<p>指向静态方法的方法引用
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="n">agrs</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">ClassName</span><span class="o">.</span><span class="na">staticMethod</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>    <span class="o">==&gt;</span>    <span class="n">ClassName</span><span class="o">::</span><span class="n">staticMethod</span>
</code></pre></div></p>
</li>
<li>
<p>指向任意类型实例方法的引用
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="n">exp</span><span class="o">,</span><span class="n">args</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">exp</span><span class="o">.</span><span class="na">instanceMethod</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>    <span class="o">==&gt;</span>    <span class="n">ExpClassName</span><span class="o">::</span><span class="n">instanceMethod</span>
</code></pre></div></p>
</li>
<li>
<p>指向现有对象的实例方法的方法引用
<div class="highlight"><pre><span></span><code><span class="c1">// exp是已有变量</span>
<span class="o">(</span><span class="n">args</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">exp</span><span class="o">.</span><span class="na">instanceMethod</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>        <span class="o">==&gt;</span>    <span class="n">exp</span><span class="o">::</span><span class="n">insatanceMethod</span>
</code></pre></div></p>
</li>
</ul>
<blockquote>
<p>编译器会进行一种与Lambda表达式类似的类型检查过程，来确定对于给定的函数式接口，这个<strong>方法引用</strong>是否有效：<strong>方法引用的签名必须和上下文类型匹配</strong>。</p>
</blockquote>
<h5 id="_10">构造函数引用<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>无参构造函数引用 即 () -&gt; T
<div class="highlight"><pre><span></span><code><span class="n">Supplier</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Apple</span><span class="o">:</span><span class="k">new</span>
</code></pre></div></p>
</li>
<li>
<p>一个参数构造函数引用 即 (P) -&gt; T
<div class="highlight"><pre><span></span><code><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Apple</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Apple</span><span class="o">::</span><span class="k">new</span>
</code></pre></div></p>
</li>
<li>
<p>两个参数的构造函数引用 即 (P1, P2) -&gt; T
<div class="highlight"><pre><span></span><code><span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">,</span> <span class="n">Apple</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Apple</span><span class="o">::</span><span class="k">new</span>
</code></pre></div></p>
</li>
<li>
<p>多个构造函数的引用也一样，只是需要自定义函数式接口。接口上下文符合 (P1,P2,P3...) -&gt; T 即可</p>
</li>
</ul>
<p>一个栗子：
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span> 
<span class="c1">// 调用map方法获得一组apple实例的集合</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">apples</span> <span class="o">=</span> <span class="n">map</span><span class="o">(</span><span class="n">weights</span><span class="o">,</span> <span class="n">Apple</span><span class="o">::</span><span class="k">new</span><span class="o">);</span> 
<span class="c1">// 将构造函数引用传递给map方法</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Apple</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">){</span> 
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
    <span class="k">for</span><span class="o">(</span><span class="n">Integer</span> <span class="n">e</span><span class="o">:</span> <span class="n">list</span><span class="o">){</span>
        <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">e</span><span class="o">));</span> 
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div></p>
<p>不将构造函数实例化却能够引用它，这个功能有一些有趣的应用。比如下面的giveMeFruit方法可以获得各种各样不同重量的水果实例：
<div class="highlight"><pre><span></span><code><span class="c1">// 创建一个Map 字符串映射相应的构造函数引用</span>
<span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Fruit</span><span class="o">&gt;&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span> 
<span class="kd">static</span> <span class="o">{</span>
    <span class="c1">// apple 匹配Apple的构造函数引用</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;apple&quot;</span><span class="o">,</span> <span class="n">Apple</span><span class="o">::</span><span class="k">new</span><span class="o">);</span> 
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;orange&quot;</span><span class="o">,</span> <span class="n">Orange</span><span class="o">::</span><span class="k">new</span><span class="o">);</span> 
    <span class="c1">// etc... </span>
<span class="o">}</span> 
<span class="c1">// 这个方法可以通过输入的 fruit名字 以及构造函数需要的参数，获得相应的实例。</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">Fruit</span> <span class="nf">giveMeFruit</span><span class="o">(</span><span class="n">String</span> <span class="n">fruit</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">weight</span><span class="o">){</span> 
    <span class="k">return</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">fruit</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">())</span> 
              <span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">weight</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div></p>
<h5 id="lambda">lambda和方法引用实战<a class="headerlink" href="#lambda" title="Permanent link">&para;</a></h5>
<p>用不同的排序策略给一个Apple列表排序，并需要展示如何把一个原始粗暴的解决方法一步步优化。</p>
<p>Java 8的API已经为你提供了一个List可用的<code>sort</code>方法，你不用自己去实现它。那么最困难的部分已经搞定了。但是，如何把排序策略传递给<code>sort</code>方法呢？你看，<code>sort</code>方法的签名是这样的：<code>void sort(Comparator&lt;? super E&gt; c)</code>。而<code>Comparator</code>是函数式接口，可以传递方法。因此我们可以认为<code>sort</code>的行为被参数化了。传递给它的排序策略不同，其行为也会不同。</p>
<ul>
<li>
<p>首先我们的第一个解决办法可能是：
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;()</span> <span class="o">{</span> 
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Apple</span> <span class="n">a1</span><span class="o">,</span> <span class="n">Apple</span> <span class="n">a2</span><span class="o">){</span> 
        <span class="k">return</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">());</span> 
    <span class="o">}</span> 
<span class="o">});</span>
</code></pre></div></p>
<blockquote>
<p>匿名内部类的方法依旧很啰嗦，因为当我们需要一种新的排序策略时，我们可能需要把上面的代码拷贝一份，但是却只需要改动 <code>return a1.getWeight().compareTo(a2.getWeight());</code> 这部分核心代码。策略一多便啰嗦极了。</p>
</blockquote>
</li>
<li>
<p>ֵ用 Lambda 表达式</p>
</li>
</ul>
<blockquote>
<p>上面的例子可以看成是一个接收签名为 (T1,T2) -&gt; int 的方法。</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">((</span><span class="n">Apple</span> <span class="n">a1</span><span class="o">,</span> <span class="n">Apple</span> <span class="n">a2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()));</span>
</code></pre></div>

<p>看起来好多了，因为lambda的类型推断，我们甚至可以1简化成下面这样：
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">((</span><span class="n">a1</span><span class="o">,</span> <span class="n">a2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a1</span><span class="o">.</span><span class="na">getWeight</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">a2</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()));</span>
</code></pre></div></p>
<blockquote>
<p>代码还能更简洁吗？Comparator具有一个叫作comparing的静态辅助方法，
  它可以接受一个Function来提取Comparable键值，并生成一个Comparator对象（我们会在第
  后面解释为什么接口可以有静态方法）。</p>
</blockquote>
<p>comparing的静态辅助方法源码如下：
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">U</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">U</span><span class="o">&gt;&gt;</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">comparing</span><span class="o">(</span>
            <span class="n">Function</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">,</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">U</span><span class="o">&gt;</span> <span class="n">keyExtractor</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">keyExtractor</span><span class="o">);</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">Comparator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">Serializable</span><span class="o">)</span>
        <span class="o">(</span><span class="n">c1</span><span class="o">,</span> <span class="n">c2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">keyExtractor</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">c1</span><span class="o">).</span><span class="na">compareTo</span><span class="o">(</span><span class="n">keyExtractor</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></p>
<p>它可以像下面这样用：</p>
<div class="highlight"><pre><span></span><code><span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Comparator</span><span class="o">.</span><span class="na">comparing</span><span class="o">((</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getWeight</span><span class="o">());</span>
</code></pre></div>

<p>现在你可以把代码再改得紧凑一点了：
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">Comparator</span><span class="o">.</span><span class="na">comparing</span><span class="o">((</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getWeight</span><span class="o">());</span>
</code></pre></div></p>
<ul>
<li>方法引用</li>
</ul>
<blockquote>
<p>前面解释过，方法引用就是替代那些转发参数的Lambda表达式的语法糖。你可以用方法引
  用让你的代码更简洁</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">Comparator</span><span class="o">.</span><span class="na">comparing</span><span class="o">(</span><span class="n">Apple</span><span class="o">::</span><span class="n">getWeight</span><span class="o">);</span>
</code></pre></div>

<p>这就是你的最终解决方案！这比Java 8之前的代码好在哪儿呢？它比较短；它的意
思也很明显，并且代码读起来和问题描述差不多：“对库存进行排序，比较苹果的重量。”</p>
<blockquote>
<p><strong>注意：</strong> 
- 这个例子中lambda表达式<code>Apple::getWeight</code> 的返回值是int 因此可以采用 comparingInt方法提高内存利用率。
- lambda表达式的返回值必须实现了Comparable接口，为可比较的元素，才能进行集合排序操作。</p>
</blockquote>
<h4 id="lambda_1">复合Lambda表达式<a class="headerlink" href="#lambda_1" title="Permanent link">&para;</a></h4>
<p>Java 8的好几个函数式接口都有为方便而设计的方法。具体而言，许多函数式接口，比如用于传递Lambda表达式的<code>Comparator</code>、<code>Function</code>和<code>Predicate</code>都提供了允许你进行复合的方法。</p>
<p>这意味着你可以把多个简单的Lambda复合成复杂的表达式。比如，你可以让两个谓词之间做一个or操作，组合成一个更大的谓词。而且，你还可以让一个函数的结果成为另一个函数的输入。</p>
<p>你可能会想，函数式接口中怎么可能有更多的方法呢？（毕竟，这可是违背了函数式接口的定义啊！）窍门在于，提供的允许进行复合操作的方法都是默认方法，也就是说它们不是抽象方法。</p>
<h5 id="_11">比较器复合<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<p>我们前面看到，你可以使用静态方法<code>Comparator.comparing</code>，如下所示：<code>Comparator&lt;Apple&gt; c = Comparator.comparing(Apple::getWeight);</code></p>
<ul>
<li>
<p>逆序</p>
<blockquote>
<p>如果我们需要对之前的排序策略进行逆序怎么办？用不着去建立另一个Comparator的实例。接口有一个默认方法reversed可以使给定的比较器逆序
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">comparing</span><span class="o">(</span><span class="n">Apple</span><span class="o">::</span><span class="n">getWeight</span><span class="o">).</span><span class="na">reversed</span><span class="o">());</span>
</code></pre></div></p>
</blockquote>
</li>
<li>
<p>比较器链</p>
<blockquote>
<p>前面都很好，但如果发现有两个苹果一样重怎么办？哪个苹果应该排在前面呢？你可能
需要再提供一个Comparator来进一步定义这个比较。比如，在按重量比较两个苹果之后，你可
能想要按原产国排序。thenComparing方法就是做这个用的。</p>
</blockquote>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">inventory</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">comparing</span><span class="o">(</span><span class="n">Apple</span><span class="o">::</span><span class="n">getWeight</span><span class="o">)</span> 
         <span class="o">.</span><span class="na">reversed</span><span class="o">()</span> 
         <span class="o">.</span><span class="na">thenComparing</span><span class="o">(</span><span class="n">Apple</span><span class="o">::</span><span class="n">getCountry</span><span class="o">));</span>
</code></pre></div>

<h5 id="_12">谓词复合<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h5>
<blockquote>
<p>谓词接口包括三个方法：negate、and和or，你可以重用已有的Predicate来创建更复
  杂的谓词。比如，你可以使用negate方法来返回一个Predicate的非，比如苹果不是红的：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">redApple</span> <span class="o">=</span> <span class="o">(</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getColor</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;red&quot;</span><span class="o">);</span>
<span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">notRedApple</span> <span class="o">=</span> <span class="n">redApple</span><span class="o">.</span><span class="na">negate</span><span class="o">();</span>
</code></pre></div>

<blockquote>
<p>你可能想要把两个Lambda用and方法组合起来，比如一个苹果既是红色的又比较重的：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">redAndHeavy</span> <span class="o">=</span> <span class="n">redApple</span><span class="o">.</span><span class="na">and</span><span class="o">((</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="o">);</span>
</code></pre></div>

<blockquote>
<p>你可以进一步组合谓词，表达要么是重（150克以上）的红苹果，要么是绿苹果：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">redAndHeavyOrGreen</span> <span class="o">=</span> <span class="n">redApple</span><span class="o">.</span><span class="na">and</span><span class="o">((</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getWeight</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="o">)</span>
                                              <span class="o">.</span><span class="na">or</span><span class="o">((</span><span class="n">a</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="na">getColor</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">&quot;green&quot;</span><span class="o">));</span>
</code></pre></div>

<p>请注意，and和or方法是按照在表达式链中的位置，从左向右确定优
先级的。因此，a.or(b).and&copy;可以看作(a || b) &amp;&amp; c。</p>
<h5 id="_13">函数复合<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h5>
<p>最后，你还可以把Function接口所代表的Lambda表达式复合起来。Function接口为此配
了andThen和compose两个默认方法</p>
<blockquote>
<p>andThen方法会返回一个函数，它先对输入应用一个给定函数，再对输出应用另一个函数。
  比如，假设有一个函数f给数字加1 (x -&gt; x + 1)，另一个函数g给数字˱2，你可以将它们组
  合成一个函数h，先给数字加1，再给结果乘2：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1">// g(f(x)) 即：((x+1)*2)</span>
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> 
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">;</span> 
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">andThen</span><span class="o">(</span><span class="n">g</span><span class="o">);</span> 
<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// 返回 4</span>
</code></pre></div>

<blockquote>
<p>使用compose方法，先把给定的函数用作compose的参数里面给的那个函
  数，然后再把函数本身用于结果。比如在上一个例子里用compose的话，它将意味着f(g(x))， 而andThen则意味着g(f(x))：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1">// 数学上会写作f(g(x)) 即 ((x*2)+1)  compose组成/构成</span>
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> 
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">;</span> 
<span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">compose</span><span class="o">(</span><span class="n">g</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// 返回3</span>
</code></pre></div>

<blockquote>
<p>那么在实际中这有什么用呢？比方说你有一系列工具方法，对用String表示的一份信做文本转换：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Letter</span><span class="o">{</span> 
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">addHeader</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">){</span> 
        <span class="k">return</span> <span class="s">&quot;From caotinging: &quot;</span> <span class="o">+</span> <span class="n">text</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">addFooter</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">){</span> 
        <span class="k">return</span> <span class="n">text</span> <span class="o">+</span> <span class="s">&quot; Kind regards&quot;</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">checkSpelling</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">){</span> 
        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&quot;labda&quot;</span><span class="o">,</span> <span class="s">&quot;lambda&quot;</span><span class="o">);</span> 
    <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>

<blockquote>
<p>现在你可以通过复合这些工具方法来创建各种转型流水线了，比如创建一个流水线：先加上
  抬头，然后进行拼写检查，最后加上一个落款：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">addHeader</span> <span class="o">=</span> <span class="n">Letter</span><span class="o">::</span><span class="n">addHeader</span><span class="o">;</span> 
<span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">transformationPipeline</span> 
      <span class="o">=</span> <span class="n">addHeader</span><span class="o">.</span><span class="na">andThen</span><span class="o">(</span><span class="n">Letter</span><span class="o">::</span><span class="n">checkSpelling</span><span class="o">)</span> 
                 <span class="o">.</span><span class="na">andThen</span><span class="o">(</span><span class="n">Letter</span><span class="o">::</span><span class="n">addFooter</span><span class="o">);</span>
</code></pre></div>

<h3 id="2">2 流<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<h4 id="_14">流是什么<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>流是允许以声明性方式处理数据集合，并可以透明的并行处理，而无需写任何多线程代码。</p>
<p>下面两段代码都是用来返回低热量的菜肴名称的，
并按照卡路里排序，一个是用Java 7写的，另一个是用Java 8的流写的。比较一下。</p>
<p>java7
<div class="highlight"><pre><span></span><code><span class="c1">// 迭代器筛选卡路里低于400的食物</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">lowCaloricDishes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="k">for</span><span class="o">(</span><span class="n">Dish</span> <span class="n">d</span><span class="o">:</span> <span class="n">menu</span><span class="o">){</span> 
    <span class="k">if</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="o">){</span> 
        <span class="n">lowCaloricDishes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">d</span><span class="o">);</span> 
    <span class="o">}</span> 
<span class="o">}</span> 
<span class="c1">// 进行排序</span>
<span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">lowCaloricDishes</span><span class="o">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Dish</span> <span class="n">d1</span><span class="o">,</span> <span class="n">Dish</span> <span class="n">d2</span><span class="o">){</span> 
        <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">d1</span><span class="o">.</span><span class="na">getCalories</span><span class="o">(),</span> <span class="n">d2</span><span class="o">.</span><span class="na">getCalories</span><span class="o">());</span> 
    <span class="o">}</span> 
<span class="o">});</span> 
<span class="c1">// 获取排序后低热量菜肴的名称</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lowCaloricDishesName</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="k">for</span><span class="o">(</span><span class="n">Dish</span> <span class="n">d</span><span class="o">:</span> <span class="n">lowCaloricDishes</span><span class="o">){</span> 
    <span class="n">lowCaloricDishesName</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> 
<span class="o">}</span>
</code></pre></div></p>
<blockquote>
<p>在这段代码中，你用了一个“垃圾变量”lowCaloricDishes。它唯一的作用就是作为一次
 性的中间容器。在Java 8中，实现的细节被放在它本该归属的库里了。</p>
</blockquote>
<p>java8
<div class="highlight"><pre><span></span><code><span class="kn">import static</span> <span class="nn">java.util.Comparator.comparing</span><span class="o">;</span> 
<span class="kn">import static</span> <span class="nn">java.util.stream.Collectors.toList</span><span class="o">;</span> 

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lowCaloricDishesName</span> <span class="o">=</span> 
            <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">sorted</span><span class="o">(</span><span class="n">comparing</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">))</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div></p>
<blockquote>
<p>为了利用多核架构并行执行这段代码，你只需要把stream()换成parallelStream()：</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lowCaloricDishesName</span> <span class="o">=</span> 
                <span class="n">menu</span><span class="o">.</span><span class="na">parallelStream</span><span class="o">()</span> 
                    <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="o">)</span> 
                    <span class="o">.</span><span class="na">sorted</span><span class="o">(</span><span class="n">comparing</span><span class="o">(</span><span class="n">Dishes</span><span class="o">::</span><span class="n">getCalories</span><span class="o">))</span> 
                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> 
                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

<p>你可能会想，在调用parallelStream方法的时候到底发生了什么。用了多少个线程？对性
能有多大提升？后面会详细讨论这些问题。现在，你可以看出，从软件工程师的角度来看，新
的方法有几个显而易见的好处。</p>
<ul>
<li>代码是以声明式的方式写的：说明想要完成什么，而不是说明如何实现一个操作（利用循环和if条件等控制流语句）。</li>
<li>轻松应对变化的需求：你很容易再创建一个代码版本，利用
  Lambda表达式来筛选高卡路里的菜肴，而用不着去复制粘贴代码。</li>
<li>你可以把几个基础操作链接起来，来表达复杂的数据处理流水线（在filter后面接上
  sorted、map和collect操作），同时保持代码清晰可读。filter的结果
  被传给了sorted方法，再传给map方法，最后传给collect方法。</li>
</ul>
<p><strong>别浪费太多时间了。一起来拥抱接下来介绍的强大的流吧！</strong></p>
<p>总结一下，Java 8中的Stream API可以让你写出这样的代码：
- 声明式——更简洁，更易读
- 可复合——更灵活
- 可并行——性能更好</p>
<p>我们会使用这样一个例子：一个menu，它只是一张菜单：
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">menu</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;pork&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="mi">800</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">MEAT</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;beef&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="mi">700</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">MEAT</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;chicken&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="mi">400</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">MEAT</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;french fries&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="mi">530</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">OTHER</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;rice&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="mi">350</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">OTHER</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;season fruit&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="mi">120</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">OTHER</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;pizza&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="mi">550</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">OTHER</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;prawns&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="mi">300</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">FISH</span><span class="o">),</span> 
 <span class="k">new</span> <span class="n">Dish</span><span class="o">(</span><span class="s">&quot;salmon&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="mi">450</span><span class="o">,</span> <span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">.</span><span class="na">FISH</span><span class="o">)</span> <span class="o">);</span>
</code></pre></div>
Dish类的定义是：
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dish</span> <span class="o">{</span> 
     <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> 
     <span class="kd">private</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">vegetarian</span><span class="o">;</span> <span class="c1">// 素</span>
     <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">calories</span><span class="o">;</span> 
     <span class="kd">private</span> <span class="kd">final</span> <span class="n">Type</span> <span class="n">type</span><span class="o">;</span> 

     <span class="kd">public</span> <span class="nf">Dish</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">vegetarian</span><span class="o">,</span> <span class="kt">int</span> <span class="n">calories</span><span class="o">,</span> <span class="n">Type</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span> 
         <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> 
         <span class="k">this</span><span class="o">.</span><span class="na">vegetarian</span> <span class="o">=</span> <span class="n">vegetarian</span><span class="o">;</span> 
         <span class="k">this</span><span class="o">.</span><span class="na">calories</span> <span class="o">=</span> <span class="n">calories</span><span class="o">;</span> 
         <span class="k">this</span><span class="o">.</span><span class="na">type</span> <span class="o">=</span> <span class="n">type</span><span class="o">;</span> 
     <span class="o">}</span> 
     <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span> 
     <span class="o">}</span> 
     <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isVegetarian</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">vegetarian</span><span class="o">;</span> 
     <span class="o">}</span> 
     <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCalories</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">calories</span><span class="o">;</span> 
     <span class="o">}</span> 
     <span class="kd">public</span> <span class="n">Type</span> <span class="nf">getType</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">type</span><span class="o">;</span> 
     <span class="o">}</span> 
     <span class="nd">@Override</span> 
     <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span> 
     <span class="o">}</span>
     <span class="kd">public</span> <span class="kd">enum</span> <span class="n">Type</span> <span class="o">{</span> <span class="n">MEAT</span><span class="o">,</span> <span class="n">FISH</span><span class="o">,</span> <span class="n">OTHER</span> <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div></p>
<h4 id="_15">流简介<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<blockquote>
<p>简短的定义就是“从支持数据处理操作的源生成的元素序列”。让
  我们一步步分析这个定义。</p>
</blockquote>
<ul>
<li><strong>元素序列</strong>——就像集合一样，流也提供了一个接口，可以访问特定元素类型的一组有序
  值。因为集合是数据结构，所以它的主要目的是以特定的时间/空间复杂度存储和访问元
  素（如ArrayList 与 LinkedList）。但流的目的在于表达计算，比如你前面见到的
  filter、sorted和map。集合讲的是数据，流讲的是计算。我们会在后面详细解
  释这个思想。</li>
<li><strong>源</strong>——流会使用一个提供数据的源，如集合、数组或输入/输出资源。 请注意，从有序集
  合生成流时会保留原有的顺序。由列表生成的流，其元素顺序与列表一致。</li>
<li><strong>数据处理操作</strong>——流的数据处理功能支持类似于数据库的操作，以及函数式编程语言中
  的常用操作，如filter、map、reduce、find、match、sort等。流操作可以顺序执
  行，也可并行执行。</li>
</ul>
<p>此外，流操作有两个重要的特点。
- <strong>流水线</strong>——很多流操作本身会返回一个流，这样多个操作就可以链接起来，形成一个大
  的流水线。这让一些优化成为可能，如延迟和短路。流水线的操作可以
  看作对数据源进行数据库式查询。
- <strong>内部迭代</strong>——与使用迭代器显式迭代的集合不同，流的迭代操作是在背后进行的。</p>
<p>让我们来看一段能够体现所有这些概念的代码：
<div class="highlight"><pre><span></span><code><span class="kn">import static</span> <span class="nn">java.util.stream.Collectors.toList</span><span class="o">;</span> 
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">threeHighCaloricDishNames</span> <span class="o">=</span> 
                    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>  <span class="c1">// 从菜单集合中获取流-建立流水线</span>
                        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="o">)</span> <span class="c1">// 首先筛选卡路里高于300的食物</span>
                        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> <span class="c1">// 获取菜名</span>
                        <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="c1">// 截取前三个</span>
                        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span> <span class="c1">// 组合成新的列表</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">threeHighCaloricDishNames</span><span class="o">);</span>
</code></pre></div></p>
<blockquote>
<p>在本例中，我们先是对menu调用stream方法，由菜单得到一个流。数据源是菜单列表，
它给流提供一个元素序列。接下来，对流应用一系列数据处理操作：filter、map、limit
 和collect。除了collect之外，所有这些操作都会返回另一个流，这样它们就可以接成一条流水线，于是就可以看作对源的一个查询。最后，collect操作开始处理流水线，并返回结果（它
 和别的操作不一样，因为它返回的不是流，在这里是一个List）。在调用collect之前，没有任
 何结果产生，实际上根本就没有从menu里选择元素。你可以这么理解：链中的方法调用都在排
 队等待，直到调用collect。</p>
</blockquote>
<p>过程如下所示：</p>
<p><img alt="" src="http://clevercoder.cn/github/image/20190918182851.png" /></p>
<h4 id="_16">流与集合<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<blockquote>
<p>我们先来打个直观的比方吧。比如说存在DVD里的电影，这就是一个集合（也许是字节，也
  许是帧，这个无所谓），因为它包含了整个数据结构。</p>
<p>现在再来想想在互联网上通过视频流看同
  样的电影。现在这是一个流（字节流或帧流）。流媒体播放器只要提前下载用户观看位置的
  那几帧就可以了，这样不用等到流中大部分值计算出来，你就可以显示流的开始部分了（想想观
  看直播足球赛）。</p>
<p>特别要注意，视频播放器可能没有将整个流作为集合，保存所需要的内存缓冲
  区——而且要是非得等到最后一帧出现才能开始看，那等待的时间就太长了。</p>
<p>简单地说，集合与流之间的差异就在于什么时候进行计算。集合是一个内存中的数据结构，
它包含数据结构中目前所有的值——集合中的每个元素都得先算出来才能添加到集合中。（你可
以往集合里加东西或者删减东西，但是不管什么时候，集合中的每个元素都是放在内存里的，元素
都得先算出来才能成为集合的一部分。）</p>
</blockquote>
<p>相比之下，流则是在概念上固定的数据结构（你不能添加或删除元素），其元素则是按需计
算的。 这对编程有很大的好处。在后面，我们将展示利用流构建一个质数流（2, 3, 5, 7, 11, …）有
多简单，尽管质数有无穷多个。这个思想就是用户仅仅从流中提取需要的值，而这些值——在用
户看不见的地方——只会按需生成。从另一个角度来说，流就
像是一个延迟创建的集合：只有在消费者要求的时候才会计算值（用管理学的话说这就是需求驱
动，甚至是实时制造)。</p>
<p>与此相反，集合则是急切创建的（供应商驱动：先把̱库装满，再开始卖，就像那些昙花一现
的圣诞新玩意儿一样）。以质数为例，要是想创建一个包含所有质数的集合，那这个程序算起
来就没完没了了，因为总有新的质数要算，然后把它加到集合里面。当然这个集合是永远也创建
不完的，消费者这辈子都见不着了。</p>
<h5 id="_17">只能遍历一次<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h5>
<blockquote>
<p>请注意，和迭代器类似，流只能遍历一次。遍历完之后，我们就说这个流已经被消费掉了。
你可以从原始数据源那里再获得一个新的流来重新遍历一遍，就像迭代器一样（这里假设它是集
合之类的可重复的源，如果是I/O通道就没戏了）。</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">title</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&quot;Java8&quot;</span><span class="o">,</span> <span class="s">&quot;In&quot;</span><span class="o">,</span> <span class="s">&quot;Action&quot;</span><span class="o">);</span> 
<span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="na">stream</span><span class="o">();</span> 
<span class="n">s</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="c1">// 下面这句代码会抛出异常 java.lang.IllegalStateException：提示流已被消费 </span>
<span class="n">s</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

<p>所以要记得，流只能被消费一次！</p>
<h5 id="_18">内部迭代和外部迭代<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<blockquote>
<p>使用Collection接口需要用户去做迭代（比如用for-each），这称为外部迭代。 相反，
Streams库使用内部迭代——它帮你把迭代做了，还把得到的流值存在了某个地方，你只要给出
一个函数说要干什么就可以了</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c1">// 集合：使用for-each循环外部迭代</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="k">for</span><span class="o">(</span><span class="n">Dish</span> <span class="n">d</span><span class="o">:</span> <span class="n">menu</span><span class="o">){</span> 
    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> 
<span class="o">}</span>
</code></pre></div>

<p>请注意，for-each还隐藏了迭代中的一些复杂性。for-each结构是一个语法糖，它背后的
东西用Iterator对象表达出来更要丑陋得多。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 集合：用背后的迭代器做外部迭代</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span> 
<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> 
<span class="k">while</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span> 
    <span class="n">Dish</span> <span class="n">d</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span> 
    <span class="n">names</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> 
<span class="o">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">// 流：内部迭代，将得到的操作流根据提供的函数进行操作</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span>
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

<p>举个例子说明：比如你希望你两岁的女儿把地上的玩具收起来</p>
<p>外部迭代：</p>
<div class="highlight"><pre><span></span><code>你：“我们把玩具收进盒子里，地上还有玩具吗？”
小孩：“有，球。”
你：“好，把球放进盒子里，还有吗？”
小孩：“有，娃娃。”
你：“好，把娃娃放进盒子里，还有吗？”
小孩：“有，水枪。”
你：“好，把水枪放进盒子里，还有吗？”
小孩：“没有了”
你：“好。我们收好了”
</code></pre></div>

<p>内部迭代：</p>
<div class="highlight"><pre><span></span><code>// 你只需要告诉小孩，把地上的玩具放进盒子里
你：”我们把地上的玩具都收进盒子里“
小孩：“好”

// 小孩可以选择一只手拿球，一只手拿娃娃，一起放进盒子里，也可以先把近一点的水枪放进盒子里，效率更高
</code></pre></div>

<blockquote>
<p>总结就是：内部迭代时，项目可以透明地并行处理，或者用更优化的顺
  序进行处理。要是用Java过去的那种外部迭代方法，这些优化都是很困难的。
  并且一旦通过写for-each而选择了外部迭代，那你基
  本上就要自己管理所有的并行问题了（自己管理实际上意味着“某个良辰吉日我们会把它并行化”
  或“开始了关于任务和synchronized的漫长而艰苦的斗争”）</p>
</blockquote>
<h4 id="_19">流操作<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<p>stream定义了很多操作，分为两类：
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="o">)</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div></p>
<p>你可以看到两类操作：
1.filter、map和limit可以连成一条流水线；
2.collect触发流水线执行并关闭它；</p>
<p>可以连接起来的流操作称为中间操作，关闭流的操作称为终端操作。</p>
<p><img alt="" src="http://clevercoder.cn/github/image/20190924155029.png" /></p>
<h5 id="_20">中间操作<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h5>
<blockquote>
<p>诸如filter或sorted等中间操作会返回另一个流。这让多个操作可以连接起来形成一个查
 询。重要的是，除非流水线上触发一个终端操作，否则中间操作不会执行任何处理——它们很懒。
 这是因为中间操作一般都可以合并起来，在终端操作时一次性全部处理。</p>
</blockquote>
<p>为了搞清楚流水线中到底发生了什么，我们把代码改一改，让每个Lambda都打印出当前处
理的菜肴（就像很多演示和调试技巧一样，这种编程风格要是放在生产代码里那就吓死人了，但
是学习的时候却可以直接看清楚求值的顺序）：</p>
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="o">{</span> 
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;filtering&quot;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> 
            <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="o">;</span> 
        <span class="o">})</span> 
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="o">{</span> 
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;mapping&quot;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> 
            <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span> 
        <span class="o">})</span> 
        <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> 
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span> 

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
</code></pre></div>

<p>此时打印的结果如下：
<div class="highlight"><pre><span></span><code><span class="n">filtering</span> <span class="n">pork</span> 
<span class="n">mapping</span> <span class="n">pork</span> 
<span class="n">filtering</span> <span class="n">beef</span> 
<span class="n">mapping</span> <span class="n">beef</span> 
<span class="n">filtering</span> <span class="n">chicken</span> 
<span class="n">mapping</span> <span class="n">chicken</span> 
<span class="o">[</span><span class="n">pork</span><span class="o">,</span> <span class="n">beef</span><span class="o">,</span> <span class="n">chicken</span><span class="o">]</span>
</code></pre></div></p>
<p>可以很清楚的看出来，程序并不是顺序执行的，filter、map是并行处理的。这种技术称之为循环合并。
有好几种优化利用了流的延迟性质。第一，尽管很多菜肴热量都高于300卡路里，
但只选出了前三个！这是因为limit操作以及一种称为短路的技巧。（后面会介绍）</p>
<h5 id="_21">终端操作<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h5>
<blockquote>
<p>终端操作会从流的流水线生成结果。其结果是任何不是流的值，比如List、Integer，甚
  至void</p>
</blockquote>
<p>例如，在下面的流水线中，forEach是一个返回void的终端操作，它会对源中的每道
菜应用一个Lambda。把System.out.println传递给forEach，并要求它打印出由menu生成的
流中的每一个Dish：</p>
<div class="highlight"><pre><span></span><code><span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

<p>总而言之，流的使用一般包括三件事：</p>
<ol>
<li>一个数据源（如集合）来执行一个查询；</li>
<li>一个中间操作链，形成一条流的流水线；</li>
<li>一个中间操作，执行流水线，并能生成结果。</li>
</ol>
<p>下面列出了已经遇到的流操作，不涵盖全部</p>
<p><img alt="" src="http://clevercoder.cn/github/image/20190924180659.png" /></p>
<blockquote>
<p>以上都是书中所述，本人抱着实践出真知的态度亲自试了一下stream和for循环的性能比较，就在源码中的chap4中的<a href="https://github.com/caotinging/Java8Action/blob/master/src/main/java/com/caotinging/java8action/chap4/StreamBasic.java">streamBasic</a>、结果大跌眼镜。在难以置信的情况下
查阅了相关资料，发现了这个：<a href="https://jaxenter.com/follow-up-how-fast-are-the-java-8-streams-122522.html">Follow-up: How fast are the Java 8 Streams?</a>
这个：<a href="https://segmentfault.com/a/1190000004171551">Java 8 Stream的性能到底如何？</a> 这个：<a href="https://jaxenter.com/java-performance-tutorial-how-fast-are-the-java-8-streams-118830.html">Java performance tutorial – How fast are the Java 8 streams?</a>
但是，很多关于集合线程安全性方面的考虑，Stream已经帮我们做了，如果在多线程场景下，java7的写法再加上一堆的同步锁等操作。结果究竟如何也不得而知。</p>
</blockquote>
<h4 id="3-optional">3 使用<code>Optional</code><a class="headerlink" href="#3-optional" title="Permanent link">&para;</a></h4>
<p>如果对象不存在，那么调用对象的方法便会抛出<code>NullPointerException</code>异常。为了避免<code>NullPointerException</code>异常，通常需要在必要的地方添加null的检查。</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">String</span> <span class="nf">getCarInsuranceName</span><span class="o">(</span><span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">person</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Car</span> <span class="n">car</span> <span class="o">=</span> <span class="n">pserson</span><span class="o">.</span><span class="na">getCar</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">car</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Insurance</span> <span class="n">insurance</span> <span class="o">=</span> <span class="n">car</span><span class="o">.</span><span class="na">getInsurance</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">insurance</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">insurance</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
            <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>但很显然，这种嵌套的if语句块增加了代码缩进的层数，不具备扩展性，也牺牲了代码的可读性。总结来说，使用null会带来种种问题；</p>
<p><a href="../../../Data%20Science/Scala/Scala%E7%BC%96%E7%A8%8B/">Scala语言</a>中的<code>Option[T]</code>既可以包含类型为<code>T</code>的变量，也可以不包含该变量。但要使用它，必须显示地调用<code>Option</code>类型的<code>available</code>操作，检查该变量是否有值，而这其实也是一种变相的<code>null</code>检查。</p>
<p>Java 8中引入了新的类<code>java.util.Optional&lt;T&gt;</code>，用来封装T类型的值的类。</p>
<ul>
<li>通过静态工厂方法<code>Optional.empty</code>声明一个空的<code>Optional</code><ul>
<li><code>Optional&lt;Car&gt; optCar = Optional.empty();</code></li>
</ul>
</li>
<li>通过静态工厂方法<code>Optional.of</code>创建一个<code>Optional</code>对象<ul>
<li><code>Optional&lt;Car&gt; optCar = Optional.of(car);</code></li>
</ul>
</li>
<li>可接收null的<code>Optional</code><ul>
<li><code>Optional&lt;Car&gt; optCar = Optional.ofNullable(car);</code></li>
</ul>
</li>
</ul>
<p><img alt="" src="../figures/optional_demo.jpg" /></p>
<!--
### 使用流
#### 筛选和切片
##### 用谓词筛选

Streams接口支持filter方法（你现在应该很熟悉了）。该操作会接受一个谓词（一个返回
boolean的函数）作为参数，并返回一个包括所有符合谓词的元素的流。

<div class="highlight"><pre><span></span><code><span class="c1">// 筛选所有素菜</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">vegetarianMenu</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

##### 筛选各异的元素

流还支持一个叫作distinct的方法，它会返回一个元素各异（即无重复的，根据流所生成元素的
hashCode和equals方法实现）的流。例如，以下代码会筛选出列表中所有的偶数，并确保没有
重复。

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span> 
<span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
       <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
       <span class="o">.</span><span class="na">distinct</span><span class="o">()</span> 
       <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

##### 截短流

流支持limit(n)方法，该方法会返回一个不超过给定长度的流。所需的长度作为参数传递
给limit。如果流是有序的，则最多会返回前n个元素。比如，你可以建立一个List，选出能量
超过300卡路里的头三道菜：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishes</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="o">)</span> 
                        <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> 
                        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

##### 跳过流

流还支持skip(n)方法，返回一个扔掉了前n个元素的流。如果流中元素不足n个，则返回一
个空流。请注意，limit(n)和skip(n)是互补的！例如，下面的代码将跳过超过300卡路里的头
两道菜，并返回剩下的。

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishes</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="o">)</span> 
                        <span class="o">.</span><span class="na">skip</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> 
                        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>


#### 映射

> 一个非常常见的数据处理套路就是从某些对象中选择信息。比如在SQL里，你可以从表中选
  择一列。Stream API也通过map和flatMap方法提供了类似的工具

##### 对流中每一个元素应用函数

流支持map方法，这个方法接收一个函数作为参数，这个函数会被应用到流中的每个元素，并将其映
成一个新的元素，（创建新版本而不是修改原始流）例如，下面的代码把方法引用Dish::getName传给了map方法，
来提取流中菜肴的名称：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">dishNames</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                             <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> 
                             <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

> 因为getName方法返回一个String，所以map方法输出的流的类型就是Stream<String>。

让我们看一个稍微不同的例子来加深一下对map的理解。给定一个单词列表，你想要返回另
一个列表，显示每个单词中有几个字母。怎么做呢？

你需要对列表中的每个元素应用一个函数。应用的函数应该接受一个单词，并返回其长度。你可以像下面
这样，给map传递一个方法引用String::length来解决这个问题：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&quot;Java 8&quot;</span><span class="o">,</span> <span class="s">&quot;Lambdas&quot;</span><span class="o">,</span> <span class="s">&quot;In&quot;</span><span class="o">,</span> <span class="s">&quot;Action&quot;</span><span class="o">);</span> 
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">wordLengths</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                                 <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">String</span><span class="o">::</span><span class="n">length</span><span class="o">)</span> 
                                 <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

现在让我们回到提取菜名的例子。如果你要找出每道菜的名称有多长，怎么做？你可以像下
面这样，再链接上一个map：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">dishNameLengths</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">)</span> 
                                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">String</span><span class="o">::</span><span class="n">length</span><span class="o">)</span> 
                                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

##### 流的扁平化

你已经看到如何使用map方法返回列表中每个单词的长度了。让我们扩展一下：对于一张单
词表，如何返回一张列表，列出里面各不相同的字符呢？例如，给定单词列表
["Hello","World"]，你想要返回列表["H","e","l", "o","W","r","d"]

你可能会认为这很容易，你可以把每个单词映射成一张字符表，然后调用distinct来过滤
重复的字符。第一个版本可能是这样的：

<div class="highlight"><pre><span></span><code><span class="n">words</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
 <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">word</span> <span class="o">-&gt;</span> <span class="n">word</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> 
 <span class="o">.</span><span class="na">distinct</span><span class="o">()</span> 
 <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>

但是你会发现这根本不起作用，这个方法的问题在于，传递给map方法的Lambda（word -> word.split("")）为每个单词返回了一个String[]（String
列表）。因此，map返回的流实际上是Stream<String[]>类型的。你真正想要的是用
Stream<String>来表示一个字符流。

- 尝试使ֵ用map和Arrays.stream()

首先，你需要一个字符流，而不是数组流。有一个叫作Arrays.stream()的方法可以接受
一个数组并产生一个流，例如:
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="o">[]</span> <span class="n">arrayOfWords</span> <span class="o">=</span> <span class="o">{</span><span class="s">&quot;Goodbye&quot;</span><span class="o">,</span> <span class="s">&quot;World&quot;</span><span class="o">};</span> 
<span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">streamOfwords</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">arrayOfWords</span><span class="o">);</span>
</code></pre></div>

把它用在前面的那个流水线里，看看会发生什么：
<div class="highlight"><pre><span></span><code><span class="n">words</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
 <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">word</span> <span class="o">-&gt;</span> <span class="n">word</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> 
 <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Arrays</span><span class="o">::</span><span class="n">stream</span><span class="o">)</span>
 <span class="o">.</span><span class="na">distinct</span><span class="o">()</span> 
 <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>
当前的解决方案仍然搞不定！这是因为，你现在得到的是一个流的列表（更准确地说是
Stream<String>类型的List）！的确，你先是把每个单词转换成一个字母数组，然后把每个数组变成了一
个独立的流。

- 用flatMap

使用flatMap方法的效果是，各个数组并不是分别映射成一个流，而映射成流的内容。所
有使用map(Arrays::stream)时生成的单个流都被合并起来，即扁平化为一个流。

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">uniqueCharacters</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                                    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">w</span> <span class="o">-&gt;</span> <span class="n">w</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">))</span> 
                                    <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">Arrays</span><span class="o">::</span><span class="n">stream</span><span class="o">)</span> 
                                    <span class="o">.</span><span class="na">distinct</span><span class="o">()</span> 
                                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
</code></pre></div>

> flatmap方法让你把一个流中的每个值都换成另一个流，然后把所有的流连接
  起来成为一个流。



#### 查找和匹配

> 另一个常见的数据处理操作是看看数据集中的某些元素是否匹配一个给定的属性，
Stream API通过allMatch、anyMatch、noneMatch、findFirst和findAny方法提供了这样的工具。

##### 检查谓词是否至少匹配一个元素

> 标题中的谓词指的是函数式接口：Predicate<T>  T  boolean

anyMatch方法可以解决 “流中是否有一个元素能匹配给定的谓词”。比如，你可以用它来看看菜单里面是否有素食可选择：

<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="o">(</span><span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">)){</span> 
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;The menu is (somewhat) vegetarian friendly!!&quot;</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

anyMatch方法返回一个boolean，因此是一个终端操作

##### 检查谓词是否匹配所有元素

**allMatch**

allMatch方法会检查流中的元素是否都能匹配给定的谓词。比如，你可以用它来看看菜单是否有利健康（即所有菜品的热量都低于1000卡路里）：

<div class="highlight"><pre><span></span><code><span class="kt">boolean</span> <span class="n">isHealthy</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
    <span class="o">.</span><span class="na">allMatch</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">);</span>
</code></pre></div>

**noneMatch**

noneMatch它可以确保流中没有任何元素与给定的谓词匹配。比如，你可以用noneMatch重写前面的例子：

<div class="highlight"><pre><span></span><code><span class="kt">boolean</span> <span class="n">isHealthy</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
        <span class="o">.</span><span class="na">noneMatch</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">d</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="o">);</span>
</code></pre></div>

> anyMatch、allMatch和noneMatch这三个操作都用到了我们所谓的短路，这就是大家熟悉
  的Java中&&和||运算符短路在流中的版本

##### 查找元素

findAny方法将返回当前流中的任意元素。它可以与其他流操作结合使用。比如，你可能想
找到一道素食菜肴。你可以结合使用filter和findAny方法来实现这个查询：

<div class="highlight"><pre><span></span><code><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dish</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">)</span> 
            <span class="o">.</span><span class="na">findAny</span><span class="o">();</span>
</code></pre></div>

慢着，代码里面的Optional是个什么玩意儿？

**Optional简介**

Optional<T>类（java.util.Optional）是一个容器类，代表一个值存在或不存在。在
上面的代码中，findAny可能什么元素都没找到。Java 8的库设计人员引入了Optional<T>，这
样就不用返回众所周知容易出问题的null了。

- isPresent()将在Optional包含值的时候返回true, 否则返回false。
- ifPresent(Consumer<T> block)会在值存在的时候执行给定的代码块。我们在前面
  介绍了Consumer函数式接口；它让你传递一个接收T类型参数，并返回void的Lambda
  表达式。
- T get()会在值存在时返回值，否则会抛出一个NoSuchElement异常。
- T orElse(T other)会在值存在时返回值，否则返回一个默认值。

例如，在前面的代码中你需要显式地检查Optional对象中是否存在一道素菜可以访问其名称：

<div class="highlight"><pre><span></span><code><span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
    <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">findAny</span><span class="o">()</span> 
    <span class="o">.</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">d</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span> <span class="c1">// 如果包含值就返回菜名 否则什么都不做</span>
</code></pre></div>

##### 查找第一个元素

有些流有一个出现顺序（encounter order）来指定流中项目出现的逻辑顺序（比如由List或
排序好的数据列生成的流）。对于这种流，你可能想要找到第一个元素。为此有一个findFirst
方法，它的工作方式类似于findany。

例如，给定一个数字列表，下面的代码能找出第一个平方能被3整除的数：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">someNumbers</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span> 
<span class="n">Optional</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">firstSquareDivisibleByThree</span> <span class="o">=</span> <span class="n">someNumbers</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span> 
                            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
                            <span class="o">.</span><span class="na">findFirst</span><span class="o">();</span> <span class="c1">// 9</span>
</code></pre></div>

**何时用findFirst和findAny**

你可能会想，为什么会有findFirst和findAny呢？答案是并行。找到第一个元素
在并行上限制更多。如果你不关心返回的元素是哪个，请使用findAny，因为它在使用并行流
时限制更少。



#### 归约

把一个流中的元素组合起来，使用reduce操作来表达更复杂的查
询，比如“计算菜单中的总卡路里”或“菜单中卡路里最高的菜是哪一个”。

此类查询需要将流中所有元素反复结合起来，得到一个值，比如一个Integer。
用函数式编程语言的术语来说，这称为折叠（fold），因为你可以将这个操
作看成把一张长长的纸（你的流）反复折叠成一个小方块，而这就是归约操作的结果。

##### 元素求和

在我们研究如何使用reduce方法之前，先来看看如何使用for-each循环来对数字列表中的
元素求和：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span> <span class="o">:</span> <span class="n">numbers</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">sum</span> <span class="o">+=</span> <span class="n">x</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

这段代码中有两个参数：
- 总和变量的初始值，在这里是0；
- 将列表中所有元素结合在一起的操作，在这里是+。

要是还能把所有的数字相乘，而不必去复制粘贴这段代码，ࡧ不是很好？这正是reduce操
作的用武之地，它对这种重复应用的模式做了抽象。你可以像下面这样对流中所有的元素求和：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">);</span>
</code></pre></div>

reduce接受两个参数：
- 一个初始值，这里是0；
- 一个BinaryOperator<T>来将两个元素结合起来产生一个新值，这里我们用的是
  lambda (a, b) -> a + b。

你也很容易把所有的元素相乘，只需要将另一个Lambda：(a, b) -> a * b传递给reduce
操作就可以了：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">product</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="o">);</span>
</code></pre></div>

你可以使用方法引用让这段代码更简洁。在Java 8中，Integer类现在有了一个静态的sum
方法来对两个数求和，这恰好是我们想要的，用不着反复用Lambda写同一段代码了：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">Integer</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span>
</code></pre></div>

**无初始值**

reduce还有一个重载的变体，它不接受初始值，但是会返回一个Optional对象：
<div class="highlight"><pre><span></span><code><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">));</span>
</code></pre></div>

> 为什么它返回一个Optional<Integer>呢？考虑流中没有任何元素的情况。reduce操作无
  法返回其和，因为它没有初始值。这就是为什么结果被包裹在一个Optional对象里，以表明和
  可能不存在。

##### 最大值和最小值

Integer类有了一个静态比较大小较大值（max）和较小值（min）的方法

- 最大值
<div class="highlight"><pre><span></span><code><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">max</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">(</span><span class="n">Integer</span><span class="o">::</span><span class="n">max</span><span class="o">);</span>
</code></pre></div>

- 最小值
<div class="highlight"><pre><span></span><code><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">min</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">(</span><span class="n">Integer</span><span class="o">::</span><span class="n">min</span><span class="o">);</span>
</code></pre></div>

> 你当然也可以写成Lambda (x, y) -> x < y ? x : y而不是Integer::min，不过后者
  比较易读。

> map和reduce的连接通常称为map-reduce模式，因Google用它来进行网络搜索而出名，
  因为它很容易并行化。在源码chap5/StreamReduce.class/ 中有实践例子

##### 中间操作和终端操作表
![](http://clevercoder.cn/github/image/20191029100726.png)



#### 付诸实践

将迄今学到的关于流的知识付诸实践。我们来看一个不同的领域：执行交易
的交易员。你的经理让你为八个查询找到答案。我在[源代码](https://github.com/caotinging/Java8Action/blob/master/src/main/java/com/caotinging/java8action/chap5/ExerciseTraders.java)给出了答案，但你应
该自己先解答一下作为练习。

(1) 找出2011年发生的所有交易，并按交易额排序（从低到高）。

(2) 交易员都在哪些不同的ۡ市工作过？

(3) 查找所有来自于剑桥的交易员，并按姓名排序。

(4) 返回所有交易员的姓名字符串，按字母顺序排序。

(5) 有没有交易员是在米兰工作的？

(6) 打印生活在剑桥的交易员的所有交易额。

(7) 所有交易中，最高的交易额是多少？

(8) 找到交易额最小的交易。

以下是你要处理的领域，一个Traders和Transactions的列表：

<div class="highlight"><pre><span></span><code><span class="n">Trader</span> <span class="n">raoul</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Trader</span><span class="o">(</span><span class="s">&quot;Raoul&quot;</span><span class="o">,</span> <span class="s">&quot;Cambridge&quot;</span><span class="o">);</span> 
<span class="n">Trader</span> <span class="n">mario</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Trader</span><span class="o">(</span><span class="s">&quot;Mario&quot;</span><span class="o">,</span><span class="s">&quot;Milan&quot;</span><span class="o">);</span> 
<span class="n">Trader</span> <span class="n">alan</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Trader</span><span class="o">(</span><span class="s">&quot;Alan&quot;</span><span class="o">,</span><span class="s">&quot;Cambridge&quot;</span><span class="o">);</span> 
<span class="n">Trader</span> <span class="n">brian</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Trader</span><span class="o">(</span><span class="s">&quot;Brian&quot;</span><span class="o">,</span><span class="s">&quot;Cambridge&quot;</span><span class="o">);</span> 

<span class="n">List</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span> <span class="n">transactions</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">brian</span><span class="o">,</span> <span class="mi">2011</span><span class="o">,</span> <span class="mi">300</span><span class="o">),</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">raoul</span><span class="o">,</span> <span class="mi">2012</span><span class="o">,</span> <span class="mi">1000</span><span class="o">),</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">raoul</span><span class="o">,</span> <span class="mi">2011</span><span class="o">,</span> <span class="mi">400</span><span class="o">),</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">mario</span><span class="o">,</span> <span class="mi">2012</span><span class="o">,</span> <span class="mi">710</span><span class="o">),</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">mario</span><span class="o">,</span> <span class="mi">2012</span><span class="o">,</span> <span class="mi">700</span><span class="o">),</span> 
     <span class="k">new</span> <span class="n">Transaction</span><span class="o">(</span><span class="n">alan</span><span class="o">,</span> <span class="mi">2012</span><span class="o">,</span> <span class="mi">950</span><span class="o">)</span> 
<span class="o">);</span>
</code></pre></div>

Trader和Transaction类的定义如下：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Trader</span><span class="o">{</span> 
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> 
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">city</span><span class="o">;</span> 
    <span class="kd">public</span> <span class="nf">Trader</span><span class="o">(</span><span class="n">String</span> <span class="n">n</span><span class="o">,</span> <span class="n">String</span> <span class="n">c</span><span class="o">){</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">city</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCity</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">city</span><span class="o">;</span> 
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="s">&quot;Trader:&quot;</span><span class="o">+</span><span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">+</span> <span class="s">&quot; in &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">city</span><span class="o">;</span> 
    <span class="o">}</span> 
<span class="o">}</span> 

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Transaction</span><span class="o">{</span> 
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Trader</span> <span class="n">trader</span><span class="o">;</span> 
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">year</span><span class="o">;</span> 
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">value</span><span class="o">;</span> 
    <span class="kd">public</span> <span class="nf">Transaction</span><span class="o">(</span><span class="n">Trader</span> <span class="n">trader</span><span class="o">,</span> <span class="kt">int</span> <span class="n">year</span><span class="o">,</span> <span class="kt">int</span> <span class="n">value</span><span class="o">){</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">trader</span> <span class="o">=</span> <span class="n">trader</span><span class="o">;</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">year</span> <span class="o">=</span> <span class="n">year</span><span class="o">;</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="n">Trader</span> <span class="nf">getTrader</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">trader</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getYear</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">year</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getValue</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span> 
        <span class="k">return</span> <span class="s">&quot;{&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">trader</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> 
        <span class="s">&quot;year: &quot;</span><span class="o">+</span><span class="k">this</span><span class="o">.</span><span class="na">year</span><span class="o">+</span><span class="s">&quot;, &quot;</span> <span class="o">+</span> 
        <span class="s">&quot;value:&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">+</span><span class="s">&quot;}&quot;</span><span class="o">;</span> 
    <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>



#### 数值流

我们在前面看到了可以使用reduce方法计算流中元素的总和。例如，你可以像下面这样计
算菜单的热量：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">calories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">Integer</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span>
</code></pre></div>

这段代码的问题是，它有一个暗含的装箱成本。每个Integer都必须拆箱成一个原始类型，
再进行求和。但是Stream为我们提供了更好的解决办法

##### 原始类型流特化

Java 8引入了三个原始类型特化流接口来解决这个问题：IntStream、DoubleStream和
LongStream，分别将流中的元素特化为int、long和double，从而避免了暗含的装箱成本。

**映射到数值流**

将流转换为特化版本的常用方法是mapToInt、mapToDouble和mapToLong。这些方法和前
面说的map方法的工作方式一样，只是它们返回的是一个特化流，而不是Stream<T>。

你可以像下面这样用mapToInt对menu中的卡路里求和：
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">calories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">mapToInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">sum</span><span class="o">();</span>
</code></pre></div>

> 这里，mapToInt会从每道菜中提取热量（用一个Integer表示），并返回一个IntStream
  （而不是一个Stream<Integer>）。然后你就可以调用IntStream接口中定义的sum方法，对卡
  路里求和了！请注意，如果流是空的，sum默认返回0。IntStream还支持其他的方便方法，如
  max、min、average等。

**转换回对象流**

同样，一旦有了数值流，你可能会想把它转换回非特化流。例如，IntStream上的操作只能
产生原始整数： IntStream 的 map 操作接受的 Lambda 必须接受 int 并返回 int （一个
IntUnaryOperator）。但是你可能想要生成另一类值，比如Dish。为此，你需要访问Stream
接口中定义的那些更广义的操作。要把原始流转换成一般流（每个int都会装箱成一个
Integer），可以使用boxed方法

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">intStream</span><span class="o">.</span><span class="na">boxed</span><span class="o">();</span>
</code></pre></div>
**默认值OptionalInt**

求和的那个例子很容易，因为它有一个默认值：0。但是，如果你要计算IntStream中的最
大元素，就得换个法子了，因为0是错误的结果。Optional可以用
Integer、String等参考类型来参数化。对于三种原始流特化，也分别有一个Optional原始类
型特化版本：OptionalInt、OptionalDouble和OptionalLong。

例如，要找到IntStream中的最大元素，可以调用max方法，它会返回一个OptionalInt：
<div class="highlight"><pre><span></span><code><span class="n">OptionalInt</span> <span class="n">maxCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                            <span class="o">.</span><span class="na">mapToInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)</span> 
                            <span class="o">.</span><span class="na">max</span><span class="o">();</span>
</code></pre></div>

现在，如果没有最大值的话，你就可以显式处理OptionalInt去定义一个默认值了：
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">max</span> <span class="o">=</span> <span class="n">maxCalories</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</code></pre></div>


##### 数值范围

假设你想要生成1和100之间的所有数值，
Java 8引入了两个可以用于IntStream和LongStream的静态方法，帮助生成这种范围：
range和rangeClosed。这两个方法都是第一个参数接受起始值，第二个参数接受结束值。但
range是不包含结束值的，而rangeClosed则包含结束值

<div class="highlight"><pre><span></span><code><span class="c1">// 这里的范围是[1,100] 结果为50个</span>
<span class="kt">int</span> <span class="n">evenNumbers</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">count</span><span class="o">();</span>

<span class="c1">// 这里的范围是[1,100) 不包含100 结果为49</span>
<span class="kt">int</span> <span class="n">evenNumbers2</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">count</span><span class="o">();</span>
</code></pre></div>

##### 数值流的应用勾股数

现在我们来看一个难一点儿的例子，让你回顾一下有关数值流以及到目前为止学过的所有流
操作的知识。任务就是创建一个勾股数流。

**1.勾股数**

那么什么是勾ᐦ数（毕达哥加斯三元数）呢？数学家毕达哥加斯发现了某些三元数(a, b, c)满足公式a * a + b * b = 
c * c，其中a、b、c都是整数。例如，(3, 4, 5)就是一组有效的勾股数，因为3 * 3 + 4 * 4 = 5 * 5
或9 + 16 = 25。这样的三元数有无限组。例如，(5, 12, 13)、(6, 8, 10)和(7, 24, 25)都是有效的勾股数。勾股数很有用，因为它们描述的正好是直角三角形的三条直角边长

![](http://clevercoder.cn/github/image/20191101152436.png)

**2.表示三元数**

那么，怎么入手呢？第一步是定义一个三元数。虽然更恰当的做法是定义一个新的类来表示
三元数，但这里你可以使用具有三个元素的int数组，比如new int[]{3, 4, 5}，来表示勾股数(3, 4, 5)。现在你就可以用数组索引访问每个元素了。

**3.筛选成立的组合**

假定有人为你提供了三元数中的前两个数字：a和b。怎么知道它是否能形成一组勾股数呢？
你需要测试 a * a + b * b的平方根是不是整数，也就是说它没有小数部分——在Java里可以
使用expr % 1表示。如果它不是整数，那就是说c不是整数。

<div class="highlight"><pre><span></span><code><span class="n">filter</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
</code></pre></div>
假设周围的代码给a提供了一个值，并且stream提供了b可能出现的值，filter将只选出那
些可以与a组成勾股数的b。

**4.生产三元组**

在筛选之后，你知道a和b能够组成一个正确的组合。现在需要创建一个三元组。你可以使用
map操作，像下面这样把每个元素转换成一个勾股数组：

<div class="highlight"><pre><span></span><code><span class="n">stream</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
     <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">)});</span>
</code></pre></div>

**5.生产b值**

前面已经看到，Stream.rangeClosed让你可以在给定
区间内生成一个数值流。你可以用它来给b提供数值，这里是1到100：

<div class="highlight"><pre><span></span><code><span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
    <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">boxed</span><span class="o">()</span> 
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">)});</span>
</code></pre></div>

请注意，你在filter之后调用boxed， 从rangeClosed返回的IntStream生成一个
Stream<Integer>。这是因为你的map会为流中的每个元素返回一个int数组。而不是int

你也可以像下面这样使用mapToObj改写这个方法:

<div class="highlight"><pre><span></span><code><span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> 
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
        <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">)});</span>
</code></pre></div>

**6.生成值**

这里有一个关键的假设：给出了a的值。 现在，只要已知a的值，你就有了一个可以生成勾
ᐦ数的流。如何解决这个问题呢？就像b一样，你需要为a生成数值

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">pythagoreanTriples</span> <span class="o">=</span> 
    <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
             <span class="o">.</span><span class="na">boxed</span><span class="o">()</span> 
             <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> 
                                    <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> 
                                    <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">)})</span>
             <span class="o">);</span>
</code></pre></div>

好的，flatMap又是怎么回事呢？首先，创建一个从1到100的数值范围来生成a的值。对每
个给定的a值，创建一个三元数流。要是把a的值映射到三元数流的话，就会得到一个由流构成的
流。flatMap方法在做映射的同时，还会把所有生成的三元数流扁平化成一个流。这样你就得到
了一个三元数流。

还要注意，我们把b的范围改成了a到100。没有必要再从1开始了，否则就会造
成重复的三元数，例如(3,4,5)和(4,3,5)。

**7.运行代码**

现在你可以运行解决方案，并且可以利用我们前面看到的limit命令，明确限定从生成的流
中要返回多少组勾ᐦ数了：

<div class="highlight"><pre><span></span><code><span class="n">pythagoreanTriples</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">t</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">t</span><span class="o">[</span><span class="mi">2</span><span class="o">]));</span>
</code></pre></div>

这会打印：

<div class="highlight"><pre><span></span><code>3, 4, 5 
5, 12, 13 
6, 8, 10 
7, 24, 25 
8, 15, 17
</code></pre></div>

**8.进一步优化**

目前的解决办法并不是最优的，因为你要求两次平方根。让代码更为紧凑的一种可能的方法
是，先生成所有的三元数(a*a, b*b, a*a+b*b)，然后再筛选符合条件的：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">[]&gt;</span> <span class="n">pythagoreanTriples2</span> <span class="o">=</span> 
            <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">).</span><span class="na">boxed</span><span class="o">()</span> 
                     <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span> 
                                            <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[]{</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="o">)})</span> 
                                            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
                      <span class="o">);</span>
</code></pre></div>



#### 构建流

到目前为止，你已经能够使用stream方法从集合生成流了。此外，我们还介绍了如何根据数值范围创建
数值流。但创建流的方法还有许多！本节将介绍如何从值序列、数组、文件来创建流，甚至由生
成函数来创建无限流！

##### 由值创建流

你可以使用静态方法Stream.of，通过显式值创建一个流。它可以接受任意数量的参数。例
如，以下代码直接使用Stream.of创建了一个字符串流。然后，你可以将字符串转换为大写，再
一个个打印出来：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;Java 8 &quot;</span><span class="o">,</span> <span class="s">&quot;Lambdas &quot;</span><span class="o">,</span> <span class="s">&quot;In &quot;</span><span class="o">,</span> <span class="s">&quot;Action&quot;</span><span class="o">);</span> 
<span class="n">stream</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">String</span><span class="o">::</span><span class="n">toUpperCase</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

你可以使用empty得到一个空流，如下所示：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">emptyStream</span> <span class="o">=</span> <span class="n">Stream</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</code></pre></div>

##### 由数组创建流

你可以使用静态方法Arrays.stream从数组创建一个流。它接受一个数组作为参数。例如，
你可以将一个原始类型int的数组转换成一个IntStream，如下所示：

<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="o">[]</span> <span class="n">numbers</span> <span class="o">=</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">13</span><span class="o">};</span> 
<span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">numbers</span><span class="o">).</span><span class="na">sum</span><span class="o">();</span>
</code></pre></div>

##### 由文件生成流

Java中用于处理文件等I/O操作的NIO API（非阻塞I/O）已更新，以便利用Stream API。
java.nio.file.Files中的很多静态方法都会返回一个流。

> 例如，一个很有用的方法是Files.lines，它会返回一个由指定文件中的各行构成的字符串流。使用你迄今所学的内容，
你可以用这个方法看看一个文件中有多少各不相同的词：

<div class="highlight"><pre><span></span><code><span class="kt">long</span> <span class="n">uniqueWords</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
<span class="k">try</span><span class="o">(</span><span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">Files</span><span class="o">.</span><span class="na">lines</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;data.txt&quot;</span><span class="o">),</span> <span class="n">Charset</span><span class="o">.</span><span class="na">defaultCharset</span><span class="o">())){</span> 
    <span class="n">uniqueWords</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">line</span> <span class="o">-&gt;</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">)))</span>
                    <span class="o">.</span><span class="na">distinct</span><span class="o">()</span> 
                    <span class="o">.</span><span class="na">count</span><span class="o">();</span> 
<span class="o">}</span> 
<span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">){</span>
<span class="o">}</span>
</code></pre></div>

##### 由函数生成无限流

Stream API提供了两个静态方法来从函数生成流：Stream.iterate和Stream.generate。
这两个操作可以创建所谓的无限流：不像从固定集合创建的流那样有固定大小的流。由iterate
和generate产生的流会用**给定的函数按需创建值**，因此可以无穷无尽地计算下去！一般来说，
应该使用limit(n)来对这种流加以限制

**1.迭代**

我们先来看一个iterate的简单例子，然后再解释：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

iterate方法接受一个初始值（在这里是0），还有一个依次应用在每个产生的新值上的
Lambda（UnaryOperator<t>类型）。这里，我们使用Lambda n -> n + 2，返回的是前一个元
素加上2

> 这种iterate操作基本上是顺序的，因为结果取决于前一次。此操作将生成一个无限流——这个流没有结尾，因为值是
  按需计算的，可以永远计算下去。这个流是无界的。

来看一个难一点儿的应用iterate的例子，如下：

> 斐波那契元组序列
>
>斐波那契序列是经典编程练习。下面这个数列就是斐波那契序列的一部分：0, 1, 1, 
 2, 3, 5, 8, 13, 21, 34, 55…数列中开始的两个数字是0和1，后面的每个数字都是前两个数字之和。
>
> 斐波那契元组序列与此类似，是数列中数字和其后面数字组成的元组构成的序列：(0, 1), 
 (1, 1), (1, 2), (2, 3), (3, 5), (5, 8), (8, 13), (13, 21) …
 你的方法是用iterate方法生成斐波那契元组序列中的前20个元素。

> 答案在[这里](https://github.com/caotinging/Java8Action/blob/master/src/main/java/com/caotinging/java8action/chap5/UnlimitedStream.java)



**2.生成**

与iterate方法类似，generate方法也可让你按需生成一个无限流。但generate不是依次
对每个新生成的值应用函数的。它接受一个Supplier<T>类型的Lambda提供新的值。我们先来
看一个简单的用法：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="n">Math</span><span class="o">::</span><span class="n">random</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

这段代码将生成一个流，其中有五个0到1之间的随机双精度数。例如，运行一次得到了下面
的结果：

<div class="highlight"><pre><span></span><code><span class="mf">0.9410810294106129</span> 
<span class="mf">0.6586270755634592</span> 
<span class="mf">0.9592859117266873</span> 
<span class="mf">0.13743396659487006</span> 
<span class="mf">0.3942776037651241</span>
</code></pre></div>

Math.Random静态方法被用作新值生成器。

我们使用的供应源（指向Math.random的方法引用）是无状态的：它不会在任何地方记录任何值，以备以后计算使用。但供应源不一定是无
  状态的。你可以创建存储状态的供应源，它可以修改状态，并在为流生成下一个值时使用。

> 举个例子，我们将展示如何利用generate创建斐波那契数列，这样你就可以和用
  iterate方法的办法比较一下。但很重要的一点是，在并行代码中使用有状态的供应源是不安全
  的。因此下面的代码仅仅是为了内容完整，应尽量避免使用！

> 我们在这个例子中会使用IntStream说明避免装኷操作的代码。IntStream的generate方
法会接受一个IntSupplier，而不是Supplier<t>。例如，可以这样来生成一个全是1的无限流：

<div class="highlight"><pre><span></span><code><span class="n">IntStream</span> <span class="n">ones</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">generate</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">);</span>
</code></pre></div>

Lambda允许你创建函数式接口的实例，只要直接内联提供方法的实现就可以。你也可以像下面这样，通过实现IntSupplier接口中定义的getAsInt方法显式传递
一个对象:

<div class="highlight"><pre><span></span><code><span class="n">IntStream</span> <span class="n">twos</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="k">new</span> <span class="n">IntSupplier</span><span class="o">(){</span> 
    <span class="k">return</span> <span class="mi">2</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div>

generate方法将使用给定的供应源，并反复调用getAsInt方法，而这个方法总是返回2。
但这里使用的匿名类和Lambda的区别在于，匿名类可以通过字段定义属性（状态），而属性（状态）又可以用
getAsInt方法来修改。这是一个副作用的例子。你迄今见过的所有Lambda都是没有副作用的；它们没有改变任何状态。

回到斐波那契数列的任务上，你现在需要做的是建立一个IntSupplier，它要把前一项的
值保存在属性（状态）中，以便getAsInt用它来计算下一项。此外，在下一次调用它的时候，还要更新
IntSupplier的属性值。

<div class="highlight"><pre><span></span><code><span class="n">IntSupplier</span> <span class="n">fib</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntSupplier</span><span class="o">(){</span> 
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">previous</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAsInt</span><span class="o">(){</span> 
        <span class="kt">int</span> <span class="n">oldPrevious</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">previous</span><span class="o">;</span> 
        <span class="kt">int</span> <span class="n">nextValue</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">previous</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">current</span><span class="o">;</span>

        <span class="k">this</span><span class="o">.</span><span class="na">previous</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">current</span><span class="o">;</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">current</span> <span class="o">=</span> <span class="n">nextValue</span><span class="o">;</span> 

        <span class="k">return</span> <span class="n">oldPrevious</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">};</span> 
<span class="n">IntStream</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="n">fib</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>

前面的代码创建了一个IntSupplier的实例。此对象有可变的状态：它在两个实例变量中
记录了前一个斐波那契项和当前的斐波那契项。getAsInt在调用时会改变对象的状态，由此在
每次调用时产生新的值。相比之下，使用iterate的方法则是纯粹不变的：它没有修改现有状态
但在每次迭代时会创建新的元组。

> 你应该始终采用不改变属性（状态）的方法，以便并行处理流，并保持结果正确



### 用流收集数据

下面是一些查询的例子，看看你用collect和收集器能够做什么？
- 对一个交易列表按货币分组，获得该货币的所有交易额总和（返回一个Map<Currency, Integer>）
- 将交易列表分成两组：贵的和不贵的（返回一个Map<Boolean, List<Transaction>>）
- 创建多级分组，比如按城市对交易分组，然后进一步按照贵的或不贵的分组（返回一个Map<Boolean, List<Transaction>>）。

java7中你可能很快就能实现上面的需求，如下

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Currency</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;&gt;</span> <span class="n">transactionsByCurrencies</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Transaction</span> <span class="n">transaction</span> <span class="o">:</span> <span class="n">transactions</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Currency</span> <span class="n">currency</span> <span class="o">=</span> <span class="n">transaction</span><span class="o">.</span><span class="na">getCurrency</span><span class="o">();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span> <span class="n">transactionsForCurrency</span> <span class="o">=</span> <span class="n">transactionsByCurrencies</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currency</span><span class="o">);</span> 

    <span class="k">if</span> <span class="o">(</span><span class="n">transactionsForCurrency</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> 
        <span class="n">transactionsForCurrency</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

        <span class="n">transactionsByCurrencies</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">currency</span><span class="o">,</span> <span class="n">transactionsForCurrency</span><span class="o">);</span>
        <span class="n">transactionsForCurrency</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">transaction</span><span class="o">);</span> 
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

如果你是一位经验丰富的Java程序员，写这种东西可能挺顺手的，不过你必须承认，做这么
简单的一件事就得写很多代码。更糟糕的是，读起来比写起来更费劲！代码的目的并不容易看出
来，尽管换作白话的话是很直截了当的：“把列表中的交易按货币分组。”

用Stream中collect方法的一个更通用的Collector参数，你就可以用一句话实现完全相同的结果

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Currency</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;&gt;</span> <span class="n">transactionsByCurrencies</span> <span class="o">=</span> <span class="n">transactions</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Transaction</span><span class="o">::</span><span class="n">getCurrency</span><span class="o">));</span>
</code></pre></div>

这一比差的还真多



#### 收集器简介

指令式编程的一个主要优势：你只需指出希望的结果——“做什么”，而不用操心执行的步骤——“如何做”
传递给collect方法的参数是Collector接口的一个实现，也就是给Stream中元素做汇总的方法。
toList只是说“按顺序给每个元素生成一个列表”；在本例中，groupingBy说的是“生成一个
Map，它的键(key)是（货币）桶，值(value)则是桶中那些元素的集合”

##### 收集器用作高级归约

如图所示收集器所作所做的工作和前面java7的指令式代码一样。它遍历流中的每个元素，并让Collector进行处理

![按货币对交易分组的过程图](http://clevercoder.cn/blogs/image/20191116175744.png)

> 一般来说，Collector会对元素应用一个转换函数，并将结果存储在一个数据结构中，从而产生这一过程的最终输出。例如，在前面
  所示的交易分组的例子中，转换函数提取了每笔交易的货币，随后使用货币作为键，将交易本身累积存储在生成的Map中。

**预定义收集器**

预定义收集器（即系统自带的收集器）的功能，也就是那些可以从Collectors类提供的工厂方法（例如groupingBy）创建的收集器。它们主要提供了三大功能：
- 将流元素归约和汇总为一个值
- 元素分组
- 元素分区



#### 归约和汇总

我们先来举一个简单的例子，利用counting工厂方法返回的收集器，数一数菜单里有多少种菜：
<div class="highlight"><pre><span></span><code><span class="kt">long</span> <span class="n">howManyDishes</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">counting</span><span class="o">());</span>
</code></pre></div>

这还可以写得更为直接：
<div class="highlight"><pre><span></span><code><span class="kt">long</span> <span class="n">howManyDishes</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">count</span><span class="o">();</span>
</code></pre></div>

在后面的部分，我们假定你已导入了Collectors类的所有静态工厂方法：
import static java.util.stream.Collectors.*; 
这样你就可以写counting()而用不着写Collectors.counting()之类的了。

##### 查找流中的最大值和最小值

假设你想要找出菜单中热量最高的菜。你可以使用两个收集器，Collectors.maxBy和Collectors.minBy，来计算流中的最大或最小值。
这两个收集器接收一个Comparator参数来比较流中的元素。
<div class="highlight"><pre><span></span><code><span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishCaloriesComparator</span> <span class="o">=</span> <span class="n">Comparator</span><span class="o">.</span><span class="na">comparingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">);</span> 

<span class="n">Optional</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">mostCalorieDish</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
                                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">maxBy</span><span class="o">(</span><span class="n">dishCaloriesComparator</span><span class="o">));</span>
</code></pre></div>



##### 汇总

Collectors类专门为汇总提供了一个工厂方法：Collectors.summingInt。它可接受一
个把对象映射为求和所需int的函数，并返回一个收集器；该收集器在传递给普通的collect方法后即执行我们需要的汇总操作。

举个例子来说，你可以这样求出菜单列表的总热量：
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">totalCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">summingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">));</span>
</code></pre></div>

这里的收集过程如下图所示。在遍历流时，会把每一道菜都映射为其热量，然后把这个数字累加到一个累加器里（这里的初始值0）。

![summingInt收集器的累积过程图](http://clevercoder.cn/blogs/image/20191116182122.png)

> Collectors.summingLong和Collectors.summingDouble方法的作用完全一样，可以用
于求和字段为long或double的情况

**求平均值**

汇总不仅仅是求和；还有Collectors.averagingInt，连同对应的averagingLong和
averagingDouble可以计算数值的平均数：

<div class="highlight"><pre><span></span><code><span class="c1">// 计算菜的平均热量</span>
<span class="kt">double</span> <span class="n">avgCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">averagingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">));</span>
</code></pre></div>

**一次性汇总操作**

一次操作即可获取集合中元素的个数，总和，平均数，最大值最小值等

你可以使用summarizingInt工厂方法返回的收集器。例如，通过一次summarizing操作你可以就数出菜单中元素的个数，并得
到菜单热量总和、平均值、最大值和最小值：

<div class="highlight"><pre><span></span><code><span class="n">IntSummaryStatistics</span> <span class="n">menuStatistics</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">summarizingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">));</span>
</code></pre></div>

这个收集器会把所有这些信息收集到一个叫作IntSummaryStatistics的类里，它提供了
方便的取值（getter）方法来访问结果。打印menuStatisticobject会得到以下输出：

<div class="highlight"><pre><span></span><code><span class="n">IntSummaryStatistics</span><span class="o">{</span><span class="n">count</span><span class="o">=</span><span class="mi">9</span><span class="o">,</span> <span class="n">sum</span><span class="o">=</span><span class="mi">4300</span><span class="o">,</span> <span class="n">min</span><span class="o">=</span><span class="mi">120</span><span class="o">,</span> <span class="n">average</span><span class="o">=</span><span class="mf">477.777778</span><span class="o">,</span> <span class="n">max</span><span class="o">=</span><span class="mi">800</span><span class="o">}</span>
</code></pre></div>

> 同样，相应的summarizingLong和summarizingDouble工厂方法有相关的LongSummaryStatistics和DoubleSummaryStatistics类型，适用于收集的属性是原始类型long或
  double的情况。



##### 连接字符串

joining工厂方法返回的收集器会把对流中每一个对象应用toString方法得到的所有字符
串连接成一个字符串。这意味着你把菜单中所有菜单的名称连接起来，如下所示：

<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">shortMenu</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">joining</span><span class="o">());</span>
</code></pre></div>

oining在内部使用了StringBuilder来把生成的字符串逐个追加起来。此外，如果Dish类的toString方法返回菜单的名称，那你无需用提取每一道菜的名称的
函数来对原流做映射就能够得到相同的结果：

<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">shortMenu</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">joining</span><span class="o">());</span>
</code></pre></div>

两者均可产生字符串: porkbeefchickenfrench friesriceseason fruitpizzaprawnssalmon

该字符串的可读性并不好。joining工厂方法有一个重载版本可以接受元素之间的
分界符，这样你就可以得到一个带有逗号分隔的菜肴名称列表：

<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">shortMenu</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getName</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">joining</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">));</span>
</code></pre></div>
它会生成：pork, beef, chicken, french fries, rice, season fruit, pizza, prawns, salmon



##### 广义的归约汇总

事实上，我们已经讨论的所有收集器，都可以用reducing工厂方法Collectors.reducing工厂方法实现。
可以说，前面讨论的只是提高代码可读性。

例如，可以用reducing方法创建的收集器来计算菜单的总热量，如下所示：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">totalCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">reducing</span><span class="o">(</span> <span class="mi">0</span><span class="o">,</span> <span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">,</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="o">));</span>
</code></pre></div>

它需要三个参数:
- 第一个参数是归约操作的起始值，也是流中没有元素时的返回值.
- 第二个参数就是收集操作中的转换函数。
- 第三个参数是一个BinaryOperator，将上一次操作返回的值和当前元素收集成一个同类型的值

同样，你可以使用下面这样单参数形式的reducing来找到热量最高的菜，如下所示：

<div class="highlight"><pre><span></span><code><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">mostCalorieDish</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
          <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">reducing</span><span class="o">((</span><span class="n">d1</span><span class="o">,</span> <span class="n">d2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">d1</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">d2</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">?</span> <span class="n">d1</span> <span class="o">:</span> <span class="n">d2</span><span class="o">));</span>
</code></pre></div>

**reduce和collect的区别**

reduce和collect方法通常可以获得同样的结果，例如，你可以用如下的方式用reduce方法来实现toListCollector所做的工作：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">).</span><span class="na">stream</span><span class="o">();</span> 
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="na">reduce</span><span class="o">(</span> 
        <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(),(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">l</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">e</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                                                        <span class="n">l</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">e</span><span class="o">);</span> 
                                                        <span class="k">return</span> <span class="n">l</span><span class="o">;</span> 
                                   <span class="o">},</span>
                <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">l1</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">l2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                                            <span class="n">l1</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">l2</span><span class="o">);</span> 
                                            <span class="k">return</span> <span class="n">l1</span><span class="o">;</span> 
        <span class="o">});</span>
</code></pre></div>

这个解决方法有两个问题：
- reduce方法旨在把两个值结合起来生成一个新值，它是一个不可变的归约。
- collect方法的设计就是要改变容器，累积出要的结果。

这意味着，上面的代码是在滥用reduce方法，因为它在原地改变了作为容器的List。

错误的使用reduce方法还会造成一个实际问题：这个归约过程不能并行工作，因为由多个线程并发
修改同一个数据结构可能会破坏List本身。在这种情况下，想要线程安全，就必须要每次分配一个新的List，而对象分配又会影响性能。
这就是collect方法更适合表达可变容器上的归约的原因，它更适合并行操作。

1. 收集器的灵活性：以不同的方法执行同样的操作

你还可以进一步简化前面使用reducing收集器的求和例子——引用Integer类的sum方法

<div class="highlight"><pre><span></span><code><span class="c1">// reducing(初始值,转换函数,累积函数)</span>
<span class="kt">int</span> <span class="n">totalCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">reducing</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">,</span><span class="n">Integer</span><span class="o">::</span><span class="n">sum</span><span class="o">));</span>
</code></pre></div>

![](http://clevercoder.cn/blogs/image/2019-11-18_22-25-41.png)

counting收集器也是类似地利用三参数reducing工厂方法实现的。它把流中的每个元素都转换成一个值为1的Long型对象，然后再把它们相加：
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Collector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="o">?,</span> <span class="n">Long</span><span class="o">&gt;</span> <span class="nf">counting</span><span class="o">()</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">reducing</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="mi">1L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

**使用泛型 ？通配符**

在刚刚提到的代码片段中，？通配符它用作counting工厂方法返回的收集器签名中的第二个泛型类型。在这里，
它仅仅意味着收集器的累加器类型未知，即，累加器本身可以是任何类型。

还有另一种方法不使用收集器也能执行相同操作

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">totalCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">).</span><span class="na">reduce</span><span class="o">(</span><span class="n">Integer</span><span class="o">::</span><span class="n">sum</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
</code></pre></div>

更简洁的方法是把流映射到一个IntStream，然后调用sum方法：

<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">totalCalories</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">mapToInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">).</span><span class="na">sum</span><span class="o">();</span>
</code></pre></div>

2. 根据情况选择最佳解决方案

函数式编程通常提供了多种方法来执行同一个操作.
收集器在某种程度上比Stream接口上直接提供的方法用起来更复杂，但好处在于它们能提供更高水平的抽象和概
括，也更容易重用和自定义。

> 尽可能为问题探索不同的解决方案，但在通用的方案里面，始终选择最专门化的一个。无论是从可读性还是性能上看，
这一般都是最好的决定。例如，要计算菜单的总热量，我们更倾向于最后一个解决方案（使用IntStream），因为它最简明，也很可能最易读。
同时，它也是性能最好的一个，因为IntStream可以让我们避免自动装箱操作。



#### 分组

假设你要把菜单中的菜肴按照类型进行分类，有鱼的放一组，有肉的放一组，其他的都放另一组。用Collectors.groupingBy工厂方法返回
的收集器就可以轻松地完成这项任务：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;</span> <span class="n">dishesByType</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">));</span>
</code></pre></div>

其结果是下面的map：

<div class="highlight"><pre><span></span><code><span class="o">{</span>
    <span class="n">FISH</span><span class="o">=[</span><span class="n">prawns</span><span class="o">,</span> <span class="n">salmon</span><span class="o">],</span> 
    <span class="n">OTHER</span><span class="o">=[</span><span class="n">french</span> <span class="n">fries</span><span class="o">,</span> <span class="n">rice</span><span class="o">,</span> <span class="n">season</span> <span class="n">fruit</span><span class="o">,</span> <span class="n">pizza</span><span class="o">],</span> 
    <span class="n">MEAT</span><span class="o">=[</span><span class="n">pork</span><span class="o">,</span> <span class="n">beef</span><span class="o">,</span> <span class="n">chicken</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div>

这里，你给groupingBy方法传递了一个Function（以方法引用的形式），它提取了流中每
一道Dish的Dish.Type。这个Function叫作分类函数，用来把流中的元素分成不同的组。

> 你想用以分类的条件可能比简单的属性访
  问器要复杂。例如，你可能想把热量不到400卡路里的分为“低བ量”（diet），400到700
  卡路里的分为“普通”（normal），高于700卡路里的为“高热量”（fat）。由于Dish类的作者
  没有把这个操作写成一个方法，你无法使用方法引用，但你可以把这个逻辑写成Lambda表达式：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="n">CaloricLevel</span> <span class="o">{</span> <span class="n">DIET</span><span class="o">,</span> <span class="n">NORMAL</span><span class="o">,</span> <span class="n">FAT</span> <span class="o">}</span> 

<span class="n">Map</span><span class="o">&lt;</span><span class="n">CaloricLevel</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;</span> <span class="n">dishesByCaloricLevel</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span> 
            <span class="n">groupingBy</span><span class="o">(</span><span class="n">dish</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">DIET</span><span class="o">;</span> 
                <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">700</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">NORMAL</span><span class="o">;</span> 
                <span class="k">else</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">FAT</span><span class="o">;</span> 
            <span class="o">})</span>
 <span class="o">);</span>
</code></pre></div>

你已经看到了如何对菜单按照类型和热量进行分组，但要是想同时按照这两
个标准分类怎么办呢？分组的强大之处就在于它可以有效地组合



##### 多级分组

要实现多级分组，我们可以使用一个由双参数版本的Collectors.groupingBy工厂方法创
建的收集器，它除了普通的分类函数之外，还可以接受collector类型的第二个参数。那么要进
行二级分组的话，我们可以把一个内层groupingBy传递给外层groupingBy，并定义一个为流
中项目分类的二级标准

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">CaloricLevel</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;&gt;</span> <span class="n">dishesByTypeCaloricLevel</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span> 
        <span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> 
                        <span class="n">groupingBy</span><span class="o">(</span><span class="n">dish</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                                    <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">DIET</span><span class="o">;</span> 
                                    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">700</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">NORMAL</span><span class="o">;</span>
                                    <span class="k">else</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">FAT</span><span class="o">;</span> 
                                 <span class="o">}</span> <span class="o">)</span> 
                 <span class="o">)</span> 
<span class="o">);</span>
</code></pre></div>

这个二级分组的结果就是像下面这样的两级Map：

<div class="highlight"><pre><span></span><code><span class="o">{</span>
    <span class="n">MEAT</span><span class="o">={</span><span class="n">DIET</span><span class="o">=[</span><span class="n">chicken</span><span class="o">],</span> <span class="n">NORMAL</span><span class="o">=[</span><span class="n">beef</span><span class="o">],</span> <span class="n">FAT</span><span class="o">=[</span><span class="n">pork</span><span class="o">]},</span> 
    <span class="n">FISH</span><span class="o">={</span><span class="n">DIET</span><span class="o">=[</span><span class="n">prawns</span><span class="o">],</span> <span class="n">NORMAL</span><span class="o">=[</span><span class="n">salmon</span><span class="o">]},</span> 
    <span class="n">OTHER</span><span class="o">={</span><span class="n">DIET</span><span class="o">=[</span><span class="n">rice</span><span class="o">,</span> <span class="n">seasonal</span> <span class="n">fruit</span><span class="o">],</span> <span class="n">NORMAL</span><span class="o">=[</span><span class="n">french</span> <span class="n">fries</span><span class="o">,</span> <span class="n">pizza</span><span class="o">]}</span>
<span class="o">}</span>
</code></pre></div>

这里的外层Map的键就是第一级分类函数生成的值：“fish, meat, other”，而这个Map的值又是
一个Map，键是二级分类函数生成的值：“normal, diet, fat”。

最后，第二级map的值是流中元素构成的List，是分别应用第一级和第二级分类函数所得到的对应第一级和第二级键的值：“salmon、
pizza…”这种多级分组操作可以扩展至任意层级，n级分组就会得到一个代表n级树形结构的n级Map。

![](http://clevercoder.cn/github/image/2019-12-12_11-12-31.png)



##### 按子组收集数据

传递给第一个groupingBy的第二个收集器可以是任何类型，要数一数菜单中每类菜有多少个，可以传递counting收集器作为
groupingBy收集器的第二个参数：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Long</span><span class="o">&gt;</span> <span class="n">typesCount</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> <span class="n">counting</span><span class="o">()));</span>
</code></pre></div>

其结果是下面的Map：

<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="n">MEAT</span><span class="o">=</span><span class="mi">3</span><span class="o">,</span> <span class="n">FISH</span><span class="o">=</span><span class="mi">2</span><span class="o">,</span> <span class="n">OTHER</span><span class="o">=</span><span class="mi">4</span><span class="o">}</span>
</code></pre></div>

还要注意，普通的单参数groupingBy(f)（其中f是分类函数）实际上是groupingBy(f, toList())的简便写法

例如：
按照菜的类型分类获取每个类型下最高热量的菜：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;</span> <span class="n">mostCaloricByType</span> <span class="o">=</span> 
     <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> <span class="n">maxBy</span><span class="o">(</span><span class="n">comparingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">))));</span>
</code></pre></div>

结果如下：
<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="n">FISH</span><span class="o">=</span><span class="n">Optional</span><span class="o">[</span><span class="n">salmon</span><span class="o">],</span> <span class="n">OTHER</span><span class="o">=</span><span class="n">Optional</span><span class="o">[</span><span class="n">pizza</span><span class="o">],</span> <span class="n">MEAT</span><span class="o">=</span><span class="n">Optional</span><span class="o">[</span><span class="n">pork</span><span class="o">]}</span>
</code></pre></div>

> 注意：
> 这个Map中的值是Optional，因为这是maxBy工厂方法生成的收集器的类型，但实际上，
  如果菜单中没有某一类型的Dish，这个类型就不会对应一个Optional.empty()值，
  而且根本不会出现在Map的键中。groupingBy收集器只有在应用分组条件后后，第一次在
  流中找到某个键对应的元素时才会把该键加入分组Map中。这意味着Optional包装器在这
  里不是很有用。

**1.把收集器的结果转换为另一种类型**

因为分组操作的Map结果中的每个值上包装的Optional没什么用，所以你可能想要把它们
去掉，简言之就是把收集器返回的结果转换为另一种类型，你可以使用
Collectors.collectingAndThen工厂方法返回的收集器，如下所示。

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Dish</span><span class="o">&gt;</span> <span class="n">mostCaloricByType</span> <span class="o">=</span> 
        <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span> 
            <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> 
                         <span class="n">collectingAndThen</span><span class="o">(</span>
                                 <span class="n">maxBy</span><span class="o">(</span><span class="n">comparingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)),</span> 
                                 <span class="n">Optional</span><span class="o">::</span><span class="n">get</span><span class="o">)));</span>
</code></pre></div>

这个工厂方法接受两个参数——要转换的收集器以及转换函数，并返回另一个收集器。这个
收集器相当于旧收集器的一个包装，collect操作的最后一步就是将返回值用转换函数做一个映射。
在这里，被包起来的收集器就是用maxBy建立的那个，而转换函数Optional::get则把返回的Optional中的值提取出来

结果如下:

<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="n">FISH</span><span class="o">=</span><span class="n">salmon</span><span class="o">,</span> <span class="n">OTHER</span><span class="o">=</span><span class="n">pizza</span><span class="o">,</span> <span class="n">MEAT</span><span class="o">=</span><span class="n">pork</span><span class="o">}</span>
</code></pre></div>

**2.与groupingBy联合ֵ用的其他收集器的例子**

例如，还可以联合使用对所有同类型的菜肴热量求和的收集器：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">totalCaloriesByType</span> <span class="o">=</span> 
                        <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> 
                                                        <span class="n">summingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)));</span>
</code></pre></div>

常常和groupingBy联合使用的另一个收集器是mapping方法.

这个方法接受两个参数：一个函数对流中的元素做变换，另一个则将变换的结果对象收集起来

我们来看一个使用这个收集器的实际例子。比方说你想要知道，对于每种类型的Dish，
菜单中都有哪些CaloricLevel。我们可以把groupingBy和mapping收集器结合起来，如下所示：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">CaloricLevel</span><span class="o">&gt;&gt;</span> <span class="n">caloricLevelsByType</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span> 
            <span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> <span class="n">mapping</span><span class="o">(</span> 
                                <span class="n">dish</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                                    <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">DIET</span><span class="o">;</span> 
                                        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">700</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">NORMAL</span><span class="o">;</span> 
                                            <span class="k">else</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">FAT</span><span class="o">;</span> <span class="o">},</span> 
                                    <span class="n">toSet</span><span class="o">())));</span>
</code></pre></div>

这里，就像我们前面见到过的，传递给映射方法的转换函数将Dish映射成了它的
CaloricLevel：生成的CaloricLevel流传递给一个toSet收集器，以便仅保留各不相同的值。得到这样的Map结果：

<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="n">OTHER</span><span class="o">=[</span><span class="n">DIET</span><span class="o">,</span> <span class="n">NORMAL</span><span class="o">],</span> <span class="n">MEAT</span><span class="o">=[</span><span class="n">DIET</span><span class="o">,</span> <span class="n">NORMAL</span><span class="o">,</span> <span class="n">FAT</span><span class="o">],</span> <span class="n">FISH</span><span class="o">=[</span><span class="n">DIET</span><span class="o">,</span> <span class="n">NORMAL</span><span class="o">]}</span>
</code></pre></div>

> 请注意在上
  一个示例中，对于返回的Set是什么类型并没有任何保证。但通过使用toCollection，你就可
  以有更多的控制。例如，你可以给它传递一个构造函数引用来要求HashSet：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">CaloricLevel</span><span class="o">&gt;&gt;</span> <span class="n">caloricLevelsByType</span> <span class="o">=</span> 
  <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span> 
    <span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">,</span> <span class="n">mapping</span><span class="o">(</span> 
                 <span class="n">dish</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">DIET</span><span class="o">;</span> 
                            <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">dish</span><span class="o">.</span><span class="na">getCalories</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">700</span><span class="o">)</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">NORMAL</span><span class="o">;</span> 
                                <span class="k">else</span> <span class="k">return</span> <span class="n">CaloricLevel</span><span class="o">.</span><span class="na">FAT</span><span class="o">;</span> <span class="o">},</span> 
                        <span class="n">toCollection</span><span class="o">(</span><span class="n">HashSet</span><span class="o">::</span><span class="k">new</span><span class="o">)</span> <span class="o">)));</span>
</code></pre></div>



#### 分区

分区是分组的特殊情况：由一个谓词（返回一个布尔值的函数）作为分类函数，它称分区函
数。分区函数返回一个布尔值，这意味着得到的分组Map的键类型是Boolean，于是它最多可以
分为两组——true是一组，false是一组。例如，你想将菜单中素食和非素食分开：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;</span> <span class="n">partitionedMenu</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="n">partitioningBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">));</span>
</code></pre></div>

这会返回下面的Map：

<div class="highlight"><pre><span></span><code><span class="o">{</span>
    <span class="kc">false</span><span class="o">=[</span><span class="n">pork</span><span class="o">,</span> <span class="n">beef</span><span class="o">,</span> <span class="n">chicken</span><span class="o">,</span> <span class="n">prawns</span><span class="o">,</span> <span class="n">salmon</span><span class="o">],</span> 
    <span class="kc">true</span><span class="o">=[</span><span class="n">french</span> <span class="n">fries</span><span class="o">,</span> <span class="n">rice</span><span class="o">,</span> <span class="n">season</span> <span class="n">fruit</span><span class="o">,</span> <span class="n">pizza</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div>

那么通过Map中键为true的值，就可以找出所有的素菜了：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">vegetarianDishes</span> <span class="o">=</span> <span class="n">partitionedMenu</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</code></pre></div>

用同样的分区谓词，对菜单List创建的流作筛选，然后把结果收集到另外一个List
中也可以获得相同的结果：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">vegetarianDishes</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span>
</code></pre></div>



##### 分区的优势

分区的好处在于保留了分区函数返回true或false的两套流元素列表。在上一个例子中，当你想获得素食和非素食两个集合时。
分区函数的优势就表现出来了。

并且partitioningBy工厂方法有一个重载版本，可以像下面这样传递第二个收集器：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">.</span><span class="na">Type</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;&gt;&gt;</span> <span class="n">vegetarianDishesByType</span> <span class="o">=</span> 
        <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span> 
                        <span class="n">partitioningBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">,</span> 
                                    <span class="n">groupingBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getType</span><span class="o">)));</span>
</code></pre></div>

这将产生一个二级Map：

<div class="highlight"><pre><span></span><code><span class="o">{</span>
    <span class="kc">false</span><span class="o">={</span>
            <span class="n">FISH</span><span class="o">=[</span><span class="n">prawns</span><span class="o">,</span> <span class="n">salmon</span><span class="o">],</span> 
            <span class="n">MEAT</span><span class="o">=[</span><span class="n">pork</span><span class="o">,</span> <span class="n">beef</span><span class="o">,</span> <span class="n">chicken</span><span class="o">]</span>
            <span class="o">},</span>
    <span class="kc">true</span><span class="o">={</span>
            <span class="n">OTHER</span><span class="o">=[</span><span class="n">french</span> <span class="n">fries</span><span class="o">,</span> <span class="n">rice</span><span class="o">,</span> <span class="n">season</span> <span class="n">fruit</span><span class="o">,</span> <span class="n">pizza</span><span class="o">]</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

这里，对于分区产生的素食和非素食子流，分别按类型对类型分组，得到了一个二级Map。
再举一个例子，你可以重用前面的代码来找到素食和非素食中热量最高的菜：

<div class="highlight"><pre><span></span><code><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">Dish</span><span class="o">&gt;</span> <span class="n">mostCaloricPartitionedByVegetarian</span> <span class="o">=</span> 
    <span class="n">menu</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span> 
            <span class="n">partitioningBy</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">isVegetarian</span><span class="o">,</span> 
                <span class="n">collectingAndThen</span><span class="o">(</span> 
                    <span class="n">maxBy</span><span class="o">(</span><span class="n">comparingInt</span><span class="o">(</span><span class="n">Dish</span><span class="o">::</span><span class="n">getCalories</span><span class="o">)),</span> 
                        <span class="n">Optional</span><span class="o">::</span><span class="n">get</span><span class="o">)));</span>
</code></pre></div>

这将产生以下结果：

<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="kc">false</span><span class="o">=</span><span class="n">pork</span><span class="o">,</span> <span class="kc">true</span><span class="o">=</span><span class="n">pizza</span><span class="o">}</span>
</code></pre></div>

##### 将数字按质数和非质数区分

假设你要写一个方法，它接受参数int n，并将前n个自然数分为质数和非质数。
首先，编写能测试一个int是否为质数的谓词函数

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isPrime</span><span class="o">(</span><span class="kt">int</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//判断 从2开始到参数为止（不包括本身）的所有数是否都不能被该参数整除，如果都不能返回true--为质数</span>
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">candidate</span><span class="o">).</span><span class="na">noneMatch</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">candidate</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

简单的优化一下上述函数：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isPrime</span><span class="o">(</span><span class="kt">int</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">{</span> 
    <span class="c1">// 仅测试小于等于待测数平方根的因子：</span>
    <span class="kt">int</span> <span class="n">candidateRoot</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">((</span><span class="kt">double</span><span class="o">)</span> <span class="n">candidate</span><span class="o">);</span> 
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">candidateRoot</span><span class="o">).</span><span class="na">noneMatch</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">candidate</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

现在最主要的一部分工作已经做好了。为了把前n个数字分为质数和非质数，只要创建一
个包含这n个数的流，用已经写好的isPrime方法作为谓词，再给partitioningBy收集器收集归约就好了：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">partitionPrimes</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">n</span><span class="o">).</span><span class="na">boxed</span><span class="o">()</span> 
                                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">partitioningBy</span><span class="o">(</span><span class="n">candidate</span> <span class="o">-&gt;</span> <span class="n">isPrime</span><span class="o">(</span><span class="n">candidate</span><span class="o">)));</span> 
<span class="o">}</span>
</code></pre></div>

现在我们已经讨论过了Collectors类的静态工厂方法能够创建的所有收集器，并介绍了使
用它们的实际例子。下表将它们汇总到一起，给出了它们应用到Stream<T>上返回的类型，以
及它们用于一个叫作menuStream的Stream<Dish>上的实际例子。



##### Collectors收集器汇总表

![](http://clevercoder.cn/github/image/2019-12-13_18-17-38.png)
![](http://clevercoder.cn/github/image/2019-12-13_18-18-21.png)



#### 收集器接口

自定义Collector接口，首先需要了解源码结构：

<div class="highlight"><pre><span></span><code><span class="c1">//Collector接口</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Collector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">A</span><span class="o">,</span> <span class="n">R</span><span class="o">&gt;</span> <span class="o">{</span> 
    <span class="n">Supplier</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="nf">supplier</span><span class="o">();</span> 
    <span class="n">BiConsumer</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="nf">accumulator</span><span class="o">();</span> 
    <span class="n">Function</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span> <span class="n">R</span><span class="o">&gt;</span> <span class="nf">finisher</span><span class="o">();</span> 
    <span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="nf">combiner</span><span class="o">();</span> 
    <span class="n">Set</span><span class="o">&lt;</span><span class="n">Characteristics</span><span class="o">&gt;</span> <span class="nf">characteristics</span><span class="o">();</span> 
<span class="o">}</span>
</code></pre></div>
本列表适用以下定义。
- T是流中要收集的项目的泛型。
- A是累加器的类型，累加器是在收集过程中用于收集部分结果的对象。
- R是收集操作得到的对象（通常但并不一定是集合）的类型。

例如，你可以实现一个ToListCollector<T>类，将Stream<T>中的所有元素收集到一个List<T>里，它的签名如下：
```public class ToListCollector<T> implements Collector<T, List<T>, List<T>> ```

这里用于累积的对象也将是收集过程的最终结果。



##### 理解收集器接口的方法

**1、建立新的结果容器：supplier方法**

supplier方法必须返回一个结果为空的Supplier，也就是一个无参数函数，在调用时它会
创建一个空的累加器实例，供数据收集过程使用：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">Supplier</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">supplier</span><span class="o">()</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span> 
<span class="o">}</span>

<span class="c1">//也可以只传递一个构造函数引用：</span>
<span class="kd">public</span> <span class="n">Supplier</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">supplier</span><span class="o">()</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">ArrayList</span><span class="o">::</span><span class="k">new</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

**2、将元素添加到结果容器：accumulator方法**

accumulator方法会返回执行累加操作的函数。当遍历到流中第n个元素时，这个函数执行
时会有两个参数：保存累加结果的累加器（已收集了流中的前 n-1 个项目），还有第n个元素本身。

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">BiConsumer</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="nf">accumulator</span><span class="o">()</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">List</span><span class="o">::</span><span class="n">add</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

**3、对结果容器用最终转换：finisher方法**

在遍历完流后，finisher方法必须返回在ጌሤ过程的最后要调用的一个函数，以便将ጌ加
器对象转换为整个集合操作的最终结果：

像ToListCollector的情况一样，累加器对象刚好符合预期的最终结果，因此无需进行转换。所以finisher方法只需返回identity函数：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">finisher</span><span class="o">()</span> <span class="o">{</span> 
 <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="na">identity</span><span class="o">();</span> 
<span class="o">}</span>
</code></pre></div>

> 通常这三个方法就足以对流进行顺序归约，但是往往需要对流进行并行操作。这三个方法的归约流程大概如下：

![](http://clevercoder.cn/github/image/20191217172903.png)

**4、合并多个结果容器：combiner方法**

四个方法中的最后一个——combiner方法会返回一个供归约操作使用的函数，它定义了对
流的各个子部分进行并行处理时，各个子部分归约所得的累加器要如何合并。对于toList而言，
这个方法的实现非常简单，只要把从流的第二个部分收集到的项目列表加到遍历第一部分时得到
的列表后面就行了：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">combiner</span><span class="o">()</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="o">(</span><span class="n">list1</span><span class="o">,</span> <span class="n">list2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> 
        <span class="n">list1</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">list2</span><span class="o">);</span> 
        <span class="k">return</span> <span class="n">list1</span><span class="o">;</span> 
    <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>

- 原始流会以递归方式划分为子流，直到定义流是否需要进一步划分的一个条件为非（如
果分布式工作单位太小，并行计算往往比顺序计算要慢，而且要是生成的并行任务比处
理器内核数多很多的话就毫无意义了）。
- 现在，所有的子流都可以并行处理，即对每个子流应用顺序归约算法。
- 最后，使用收集器combiner方法返回的函数，将所有的部分结果两两合并。这时会把原
始流每次划分时得到的子流对应的归约结果合并起来。

**5、characteristics方法**

最后一个方法——characteristics会返回一个不可变的Characteristics集合，它定义
了收集器的行为——尤其是关于流是否可以并行归约，以及可以使用哪些优化的提示。
Characteristics是一个包含三个项目的枚举。

- UNORDERED——归约结果不受流中项目的遍历和累积顺序的影响。
- CONCURRENT——accumulator函数可以从多个线程同时调用，且该收集器可以并行归约流。
如果收集器没有标为UNORDERED，那它仅在用于无序数据源时才可以并行归约。
- IDENTITY_FINISH——这表明完成器方法返回的函数是一个恒等函数，可以跳过。这种
情况下，累加器对象将会直接用作归约过程的最终结果。这也意味着，将累加器A不加检查地转换为结果R是安全的。

> 我们迄今开发的ToListCollector是IDENTITY_FINISH的，因为用来累积流中元素的
  List已经是我们要的最终结果，用不着进一步转换了，但它并不是UNORDERED，因为用在有序
  流上的时候，我们还是希望顺序能够保留在得到的List中。最后，它是CONCURRENT的，但我们
  说过了，仅仅在背后的数据源无序时才会并行处理。



##### 融合完整的ToListCollector

融合前面所介绍的方法实现，足够我们开发自己的toList收集器了，代码如下：

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">java.util.function.*</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">java.util.stream.Collector</span><span class="o">;</span> 
<span class="kn">import static</span> <span class="nn">java.util.stream.Collector.Characteristics.*</span><span class="o">;</span> 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToListCollector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Collector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span> 

    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Supplier</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">supplier</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">ArrayList</span><span class="o">::</span><span class="k">new</span><span class="o">;</span> 
    <span class="o">}</span> 

    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">BiConsumer</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="nf">accumulator</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">List</span><span class="o">::</span><span class="n">add</span><span class="o">;</span> 
    <span class="o">}</span> 

    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">finisher</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="na">indentity</span><span class="o">();</span> 
    <span class="o">}</span> 

    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">combiner</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="o">(</span><span class="n">list1</span><span class="o">,</span> <span class="n">list2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> 
            <span class="n">list1</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">list2</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">list1</span><span class="o">;</span> 
        <span class="o">};</span> 
    <span class="o">}</span> 

    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Characteristics</span><span class="o">&gt;</span> <span class="nf">characteristics</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableSet</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span> 
        <span class="n">IDENTITY_FINISH</span><span class="o">,</span> <span class="n">CONCURRENT</span><span class="o">));</span>
    <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>

> 这个实现与Collectors.toList方法并不完全相同，但区别仅仅是一些小的优化。
ava API所提供的收集器在需要返回空列表时使用了Collections.emptyList()这个单例（singleton）。

<div class="highlight"><pre><span></span><code> <span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishes</span> <span class="o">=</span> <span class="n">menuStream</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="k">new</span> <span class="n">ToListCollector</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;());</span> 
</code></pre></div>
这个实现和标准的
<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishes</span> <span class="o">=</span> <span class="n">menuStream</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toList</span><span class="o">());</span> 
</code></pre></div>
构造之间的其他差异在于toList是一个工厂，而ToListCollector必须用new来实例化



##### 进行自定义收集而不实现Collector接口

对于IDENTITY_FINISH的收集操作，还有一种方法可以得到同样的结果而无需从头实现新
的Collectors接口.

Stream有一个重载的collect方法可以接受另外三个函数——supplier、
accumulator和combiner，其语义和Collector接口的相应方法返回的函数完全相同

所以比
如说，我们可以像下面这样把菜肴流中的项目收集到一个List中：

<div class="highlight"><pre><span></span><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Dish</span><span class="o">&gt;</span> <span class="n">dishes</span> <span class="o">=</span> <span class="n">menuStream</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span> 
    <span class="n">ArrayList</span><span class="o">::</span><span class="k">new</span><span class="o">,</span> <span class="c1">// 供应源</span>
    <span class="n">List</span><span class="o">::</span><span class="n">add</span><span class="o">,</span>      <span class="c1">// 累加器</span>
    <span class="n">List</span><span class="o">::</span><span class="n">addAll</span>    <span class="c1">// 并行组合器</span>
 <span class="o">);</span>
</code></pre></div>

这第二种形式虽然比前一个写法更为紧凑和简洁，却不那么易读。此外，以恰当
的类来实现自己的自定义收集器有助于重用并可避免代码重复。另外这第二个
collect方法不能传递任何Characteristics，所以它永远都是一个IDENTITY_FINISH和
CONCURRENT但并非UNORDERED的收集器。



#### 开发自定义质数收集器

讨论分区的时候，我们用Collectors类提供的一个方便的工厂方法创建了一个收集
器，它将前n个自然数划分为质数和非质数，如下所示。

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">partitionPrimes</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">n</span><span class="o">).</span><span class="na">boxed</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">partitioningBy</span><span class="o">(</span><span class="n">candidate</span> <span class="o">-&gt;</span> <span class="n">isPrime</span><span class="o">(</span><span class="n">candidate</span><span class="o">));</span> 
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isPrime</span><span class="o">(</span><span class="kt">int</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">{</span> 
    <span class="kt">int</span> <span class="n">candidateRoot</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">((</span><span class="kt">double</span><span class="o">)</span> <span class="n">candidate</span><span class="o">);</span> 
    <span class="k">return</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">candidateRoot</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">noneMatch</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">candidate</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

还有没有办法来获得更好的性能呢？当然，开发一个自定义收集器即可



##### 自定义质数收集器

一个可能的优化是仅仅看看被测试数是不是能够被质数整除。要是除数本身都不是质数就用
不着测了。所以我们可以仅仅用被测试数之前的质数来测试。完整例子如下：

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm">* T: Integer 收集的元素类型为Integer</span>
<span class="cm">* A: Map&lt;Boolean, List&lt;Integer&gt;&gt; 累加器收集结果的类型。</span>
<span class="cm">* R: Map&lt;Boolean, List&lt;Integer&gt;&gt; 收集操作最后的结果类型</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PrimeNumbersCollector</span> <span class="kd">implements</span> <span class="n">Collector</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;&gt;</span> <span class="o">{</span> 

    <span class="cm">/**</span>
<span class="cm">    * 创建用作累加器的容器Map。初始化true false两个键的空列表，分别用来收集质数和非质数</span>
<span class="cm">    * @return </span>
<span class="cm">    */</span>
    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Supplier</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;&gt;</span> <span class="nf">supplier</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;()</span> <span class="o">{{</span>
                            <span class="n">put</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;());</span> 
                            <span class="n">put</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;());</span> 
        <span class="o">}};</span> 
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * 实现累加过程：通过调用isPrime函数判断元素是否为质数，并添加到相应的键中</span>
<span class="cm">    * @return </span>
<span class="cm">    */</span>
    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">BiConsumer</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">accumulator</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">acc</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> 
                    <span class="n">acc</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="n">isPrime</span><span class="o">(</span> <span class="n">acc</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">)</span> 
                       <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">candidate</span><span class="o">);</span>
        <span class="o">};</span> 
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * 让收集器并行工作：请注意这个收集器实际上是无法并行工作的，因为isPrime的原因，该算法本身就是顺序的，意味着</span>
<span class="cm">    * 这个combiner方法永远都不会被调用，这里为了示例还是补全方法，</span>
<span class="cm">    * 实际中可以留空，也可以抛出UnsupporteOperationException异常</span>
<span class="cm">    * @return </span>
<span class="cm">    */</span>
    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">BinaryOperator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;&gt;</span> <span class="nf">combiner</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map1</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
                    <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">addAll</span><span class="o">(</span><span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span> 
                    <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">false</span><span class="o">).</span><span class="na">addAll</span><span class="o">(</span><span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">false</span><span class="o">));</span> 
                    <span class="k">return</span> <span class="n">map1</span><span class="o">;</span> 
        <span class="o">};</span> 
    <span class="o">}</span> 

    <span class="cm">/**</span>
<span class="cm">    * 因为累加结果就是最后的结果，因此这里也不需要做其他的转化操作。</span>
<span class="cm">    * @return </span>
<span class="cm">    */</span>
    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;&gt;</span> <span class="nf">finisher</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="na">identity</span><span class="o">();</span> 
    <span class="o">}</span> 

    <span class="cm">/**</span>
<span class="cm">    * 收集器特征值</span>
<span class="cm">    * @return </span>
<span class="cm">    */</span>
    <span class="nd">@Override</span> 
    <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Characteristics</span><span class="o">&gt;</span> <span class="nf">characteristics</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableSet</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">IDENTITY_FINISH</span><span class="o">));</span>
    <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>

也可以通过collect的重载版本实现这个收集器，如下：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">partitionPrimesWithCustomCollector</span> <span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">n</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;()</span> <span class="o">{{</span> 
                                <span class="n">put</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;());</span> 
                                <span class="n">put</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;());</span> 
            <span class="o">}},</span> 
            <span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="n">acc</span><span class="o">.</span><span class="na">get</span><span class="o">(</span> <span class="n">isPrime</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span> <span class="n">candidate</span><span class="o">)</span> <span class="o">)</span> 
                                        <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">candidate</span><span class="o">);</span> 
            <span class="o">},</span> 
            <span class="o">(</span><span class="n">map1</span><span class="o">,</span> <span class="n">map2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
                    <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">addAll</span><span class="o">(</span><span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span> 
                    <span class="n">map1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">false</span><span class="o">).</span><span class="na">addAll</span><span class="o">(</span><span class="n">map2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">false</span><span class="o">));</span> 
            <span class="o">}</span>
    <span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

你看，这样就可以避免为实现Collector接口创建一个全新的类；得到的代码更紧凑，虽然
可能可读性会差一点，可重用性会差一点。



### 并行处理数据与性能

在Java 7之前，并行处理数据集合非常麻烦。
- 第一，你得明确地把包含数据的数据结构分成若干子部分。
- 第二，你要给每个子部分分配一个独立的线程。
- 第三，你需要在恰当的时候对它们进行同步来避免不希望出现的竞争条件，等待所有线程完成，最后把这些部分结果合并起
来。

Java 7引入了一个叫作分支/合并的框架，让这些操作更稳定、更不易出错。

Stream接口可以让你不用太费力气就能对数据集执行并行操作。它允
许你声明性地将顺序流变为并行流。此外你还将看到
流是如何在幕后应用Java 7引入的分支/合并框架的。你还会发现，了解并行流内部是如何工作的
很重要，因为如果你如果误用这一方面，就可能因误用而得到意外的（很可能是错的）结果。

#### 并行流

在前面。我们简要地提到了Stream接口可以让你非常方便地处理它的元素：可以通过对
收集源调用parallelStream方法来把集合转换为并行流。并行流就是一个把内容分成多个数据
块，并用不同的线程分别处理每个数据块的流。这样一来，你就可以自动把给定操作的工作负荷
分配给多核处理器的所有内核，让它们都动起来。让我们用一个简单的例子来体验一下这个思想。

假设你需要写一个方法，接受数字n作为参数，并返回从1到给定参数的所有数字的和。一个
直接的方法是生成一个数字流，把它限制到给定的数目，然后用对两个
数字求和的BinaryOperator来归约这个流，如下所示：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">sequentialSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> 
             <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> 
             <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>

用更为传统的Java术语来说，这段代码与下面的迭代等价：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">iterativeSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
    <span class="k">for</span> <span class="o">(</span><span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> 
        <span class="n">result</span> <span class="o">+=</span> <span class="n">i</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

这似乎是利用并行处理的好机会，特别是n很大的时候。那怎么入手呢？你要对结果变量进
行同步吗？用多少个线程呢？谁负责生成数呢？谁来做加法呢？用并行流的话，这问题就简单多了！



##### 将顺序流转为并行流

你可以把流转换成并行流，从而让前面的函数归约过程（也就是求和）并行运行————对顺序
流调用parallel方法：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">parallelSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">parallel</span><span class="o">()</span> <span class="c1">// 将流转为并行流</span>
                <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

在上面的代码中，对流中所有数字求和的过程和以往不同
之处在于Stream在内部分成了几块。因此可以对不同的块独立并行进行归约操作，
最后，同一个归约操作会将各个子流的部分归纳结果合并起来，得到整个原始流的归纳结果。

> 请注意，在现实中，对顺序流调用parallel方法并不意味着流本身有任何实际的变化。它
在内部实际上就是设了一个boolean标志，表示你想让调用parallel之后进行的所有操作都并
行执行。类似地，你只需要对并行流调用sequential方法就可以把它变成顺序流。
> 
> 但最后一次parallel或sequential调用会影响整个流水线。也就是一整个流操作中只会被最后一次的parallel或sequential影响

**配合并行流使用的线程池**

看看流的parallel方法，你可能会想，并行流用的线程是̯哪儿来的？有多少个？怎么自定义这个过程呢？

并行流内部使用了默认的ForkJoinPool（分支/合并框架会提到），它默认的
线程数量就是你的处理器数量，这个值是由 Runtime.getRuntime().availableProcessors()得到的。

但是你可以通过系统属性 java.util.concurrent.ForkJoinPool.common.parallelism来改变线程池大小，
如下所示：
<div class="highlight"><pre><span></span><code><span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&quot;java.util.concurrent.ForkJoinPool.common.parallelism&quot;</span><span class="o">,</span><span class="s">&quot;12&quot;</span><span class="o">);</span>
</code></pre></div>

这是一个全局设置，因此它将影响代码中所有的并行流。反过来说，目前还无法专为౼个并行流指定这个值。
一般而言，最好让ForkJoinPool的大小等于处理器数量，除非你有很好的理由，否则强烈建议不要修改。

现在你有三个方法，用三种不同的方式（迭代式、顺序归纳和并行归纳）做完全相同的操作，
让我们看看谁最快吧！



##### 测量流性能

我们声称并行求和方法应该比顺序和迭代方法性能好。然而在软件工程上，靠猜绝对不是什
么好办法！特别是在优化性能时，你应该始终遵循三个黄金规则：测量，测量，再测量。

测量方法如下所示：

<div class="highlight"><pre><span></span><code><span class="c1">// 测量队前n个自然数求和的性能</span>
<span class="kd">public</span> <span class="kt">long</span> <span class="nf">measureSumPerf</span><span class="o">(</span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">,</span> <span class="n">Long</span><span class="o">&gt;</span> <span class="n">adder</span><span class="o">,</span> <span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="kt">long</span> <span class="n">fastest</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span> 
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> 

        <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">();</span> 
        <span class="kt">long</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">adder</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">n</span><span class="o">);</span> 
        <span class="kt">long</span> <span class="n">duration</span> <span class="o">=</span> <span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">()</span> <span class="o">-</span> <span class="n">start</span><span class="o">)</span> <span class="o">/</span> <span class="mi">1_000_000</span><span class="o">;</span> 

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Result: &quot;</span> <span class="o">+</span> <span class="n">sum</span><span class="o">);</span> 
        <span class="k">if</span> <span class="o">(</span><span class="n">duration</span> <span class="o">&lt;</span> <span class="n">fastest</span><span class="o">)</span> 
                <span class="n">fastest</span> <span class="o">=</span> <span class="n">duration</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="k">return</span> <span class="n">fastest</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

这个方法接受一个函数和一个long作为参数。它会对传给方法的long应用函数10次，记录
每次执行的时间（以毫秒为单位），并返回最短的一次执行时间

贴一下ParallelStreams类中三个方法的源码:
<div class="highlight"><pre><span></span><code><span class="c1">// 顺序归约版本</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">sequentialSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">// 迭代版本</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">iterativeSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
    <span class="k">for</span> <span class="o">(</span><span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span> 
        <span class="n">result</span> <span class="o">+=</span> <span class="n">i</span><span class="o">;</span> 
    <span class="o">}</span> 
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span> 
<span class="o">}</span>

<span class="c1">// 并行归约版本</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">parallelSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">Stream</span><span class="o">.</span><span class="na">iterate</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">parallel</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">// 假设方法都在ParallelStreams中</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Sequential sum done in:&quot;</span> <span class="o">+</span> 
 <span class="n">measureSumPerf</span><span class="o">(</span><span class="n">ParallelStreams</span><span class="o">::</span><span class="n">sequentialSum</span><span class="o">,</span> <span class="mi">10_000_000</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; msecs&quot;</span><span class="o">);</span>
</code></pre></div>

请注意，我们对这个结果应持保留态度。影响执行时间的因素有很多，比如你的电脑支持多
少个内核。你可以在自己的机器上ᡪ一下这些代码。我们在一台四核英特尔i7 2.3 GHz的MacBook 
Pro上运行它，输出是这样的：

<div class="highlight"><pre><span></span><code><span class="n">Sequential</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">97</span> <span class="n">msecs</span>
</code></pre></div>

用传统for循环的迭代版本执行起来应该会快很多，因为它更为底层，更重要的是不需要对
原始类型做任何装箱或拆箱操作。如果你试着测量它的性能，

<div class="highlight"><pre><span></span><code><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Iterative sum done in:&quot;</span> <span class="o">+</span> 
 <span class="n">measureSumPerf</span><span class="o">(</span><span class="n">ParallelStreams</span><span class="o">::</span><span class="n">iterativeSum</span><span class="o">,</span> <span class="mi">10_000_000</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; msecs&quot;</span><span class="o">);</span>
</code></pre></div>

将得到:
<div class="highlight"><pre><span></span><code><span class="n">Iterative</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">2</span> <span class="n">msecs</span>
</code></pre></div>

现在我们来对函数的并行版本做测试：

<div class="highlight"><pre><span></span><code><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Parallel sum done in: &quot;</span> <span class="o">+</span> 
 <span class="n">measureSumPerf</span><span class="o">(</span><span class="n">ParallelStreams</span><span class="o">::</span><span class="n">parallelSum</span><span class="o">,</span> <span class="mi">10_000_000</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; msecs&quot;</span> <span class="o">);</span>
</code></pre></div>

看看会出现什么情况:

<div class="highlight"><pre><span></span><code><span class="n">Parallel</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">164</span> <span class="n">msecs</span>
</code></pre></div>

这相当令人失望，求和方法的并行版本比顺序版本要慢很多。你如何解释这个意外的结果
呢？这里实际上有两个问题：
- iterate生成的是装箱的对象，必须拆箱成数字才能求和；
- 我们很难把iterate分成多个独立块来并行执行。

第二个问题更有意思一点，因为你必须意识到某些流操作比其他操作更容易并行化。具体来
说，iterate很难分成能够独立执行的小块，因为每次应用这个函数都要依赖前一次应用的结果，

这意味着，在这个特定情况下，整个进程不是像前面所说的那样进行的；整张数字列表在归纳过程开始时没有准备好。
因而无法有效的把流划分为小块来并行处理，把流标记成并行，反而给顺序处理增加了开销。它还要把每次求和操作分到一个不同的线程上

这就说明了并行编程可能很复杂，有时候甚至有点违反直觉。如果用得不对（比如采用了一
个不易并行化的操作，如iterate），它甚至可能让程序的整体性能更差，所以在调用那个看似
神奇的parallel操作时，了解背后到底发生了什么是很有必要的。

**使用更有针对性的办法**

那到底要怎么利用多核处理器，用流来高效地并行求和呢？

我们在前面讨论了一个叫LongStream.rangeClosed的方法。这个方法与iterate相比有两个优点。
- LongStream.rangeClosed直接产生原始类型的long数字，没有装箱拆箱的风险
- LongStream.rangeClosed会生成数字范围，很容易划分为独立的小块。。例如，范围1~20可分为1~5、6~10、11~15和16~20。

让我们先看一下它用于顺序流时的性能如何，看看装箱和拆箱到底要不要紧：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">rangedSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">LongStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

这一次的输出是：
<div class="highlight"><pre><span></span><code><span class="n">Ranged</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">17</span> <span class="n">msecs</span>
</code></pre></div>

这个数值流比前面那个用iterate工厂方法生成数字的顺序执行版本要快得多，因为数值流
避免了那些没必要的自动装箱和拆箱操作。由此可见，选择适当的数据结构往往比并
行化算法更重要。但要是对这个新版本应用并行流呢？

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">parallelRangedSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="k">return</span> <span class="n">LongStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">)</span> 
                    <span class="o">.</span><span class="na">parallel</span><span class="o">()</span> 
                    <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="n">L</span><span class="o">,</span> <span class="n">Long</span><span class="o">::</span><span class="n">sum</span><span class="o">);</span> 
<span class="o">}</span>
</code></pre></div>

你会得到：
<div class="highlight"><pre><span></span><code><span class="n">Parallel</span> <span class="n">range</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">1</span> <span class="n">msecs</span>
</code></pre></div>

终于，我们得到了一个比顺序执行更快的并行归纳，因为这一次归纳操作可以正确
执行了。这也表明，使用正确的数据结构然后使其并行工作能够保证最佳的性能。

尽管如此，请记住，并行化并不是没有代价的。并行化过程本身需要对流做递归划分，把每
个子流的归纳操作分配到不同的线程，然后把这些操作的结果合并成一个值。但在多个内核之间
移动数据的代价也可能比你想的要大，所以很重要的一点是要保证在内核中并行执行工作的时间
比在内核之间传输数据的时间长。总而言之，很多情况下不可能或不方便并行化。然而，在使用
并行Stream加速代码之前，你必须确保用得对；如果结果错了，算得快就毫无意义了。让我们
来看一个常见的陷阱。



##### 避免共享可变状态

错用并行流而产生错误的首要原因，就是使用的算法改变了某些共享状态。下面是另一种实
现对前n个自然数求和的方法，但这会改变一个共享累加器：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">sideEffectSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">Accumulator</span> <span class="n">accumulator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Accumulator</span><span class="o">();</span> 
    <span class="n">LongStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">accumulator</span><span class="o">::</span><span class="n">add</span><span class="o">);</span> 
    <span class="k">return</span> <span class="n">accumulator</span><span class="o">.</span><span class="na">total</span><span class="o">;</span> 
<span class="o">}</span> 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Accumulator</span> <span class="o">{</span> 
    <span class="kd">public</span> <span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="kt">long</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="n">total</span> <span class="o">+=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>

这种代码有什么问题呢？不幸的是，它真的无可救药，因为它在本质上就是顺序的。每
次访问total都会出现数据竞争。如果你试图用同步来修复，那就完全失去并行的意义了。为了
说明这一点，让我们试着把Stream变成并行的：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">sideEffectParallelSum</span><span class="o">(</span><span class="kt">long</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">Accumulator</span> <span class="n">accumulator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Accumulator</span><span class="o">();</span> 
    <span class="n">LongStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">).</span><span class="na">parallel</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">accumulator</span><span class="o">::</span><span class="n">add</span><span class="o">);</span> 
    <span class="k">return</span> <span class="n">accumulator</span><span class="o">.</span><span class="na">total</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

用测试框架来执行这个方法，并打印每次执行的结果：

<div class="highlight"><pre><span></span><code><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;SideEffect parallel sum done in: &quot;</span> <span class="o">+</span> 
    <span class="n">measurePerf</span><span class="o">(</span><span class="n">ParallelStreams</span><span class="o">::</span><span class="n">sideEffectParallelSum</span><span class="o">,</span> <span class="mi">10_000_000L</span><span class="o">)</span> <span class="o">+</span><span class="s">&quot; msecs&quot;</span> <span class="o">);</span>
</code></pre></div>

你可能会得到类似于下面这种输出：

<div class="highlight"><pre><span></span><code><span class="nl">Result:</span> <span class="mi">5959989000692</span> 
<span class="nl">Result:</span> <span class="mi">7425264100768</span> 
<span class="nl">Result:</span> <span class="mi">6827235020033</span> 
<span class="nl">Result:</span> <span class="mi">7192970417739</span> 
<span class="nl">Result:</span> <span class="mi">6714157975331</span> 
<span class="nl">Result:</span> <span class="mi">7497810541907</span> 
<span class="nl">Result:</span> <span class="mi">6435348440385</span> 
<span class="nl">Result:</span> <span class="mi">6999349840672</span> 
<span class="nl">Result:</span> <span class="mi">7435914379978</span>
<span class="nl">Result:</span> <span class="mi">7715125932481</span> 
<span class="n">SideEffect</span> <span class="n">parallel</span> <span class="n">sum</span> <span class="n">done</span> <span class="n">in</span><span class="o">:</span> <span class="mi">49</span> <span class="n">msecs</span>
</code></pre></div>

这回方法的性能无关紧要了，要紧的是每次执行都会返回不同的结果，都离正确值
50000005000000差很远。这是由于多个线程在同时访问累加器，执行total += value，而这
一句虽然看似简单，却不是一个原子操作。

问题的根源在于，forEach中调用的方法有副作用，它会改变多个线程共享的对象的可变状态。
要是你想用并行Stream又不想引发类似的意外，就必须避免这种情况。



##### 高效使用并行流

一般而言，想给出任何关于什么时候该用并行流的定量建议都是不可能也毫无意义的，因为
任何类似于“仅当至少有一千个（或一百万个或随便什么数字）元素的时候才用并行流）”的建
议对于某台特定机器上的某个特定操作可能是对的，但在略有差异的另一种情况下可能就是大错
特错。

尽管如此，我们至少可以提出一些定性意见，帮你决定某个特定情况下是否有必要使用并
行流。

- 如果有疑问，测量。把顺序流转成并行流轻而易举，但却不一定是好事。
并行流并不总是比顺序流快。此外，并行流有时候会和你的直觉不一致，所
以在考虑选择顺序流还是并行流时，第一个也是最重要的建议就是用适当的基准来检查
其性能。

- 留意装箱。自动装箱和拆箱操作会大大降低性能。Java 8中有原始类型流（IntStream、
  LongStream、DoubleStream）来避免这种操作，但ї有可能都应该用这些流。

- 有些操作本身在并行流上的性能就比顺序流差。特别是limit和findFirst等依赖于元
  素顺序的操作，它们在并行流上执行的代价非常大。例如，findAny会比findFirst性
  能好，因为它不一定要按顺序来执行。你总是可以调用unordered方法来把有序流变成
  无序流。那么，如果你需要流中的n个元素而不是专门要前n个的话，对无序并行流调用
  limit可能会比单个有序流（比如数据源是一个List）更高效。

- 还要考虑流的操作流水线的总计算成本。设N是要处理的元素的总数，Q是一个元素通过
  流水线的大致处理成本，则N*Q就是这个对成本的一个ዣ略的定性估计。Q值较高就意味
  着使用并行流时性能好的可能性比较大。

- 对于较小的数据量，选择并行流几乎从来都不是一个好的决定。并行处理少数几个元素
  的好处还抵不上并行化造成的额外开销。

- 要考虑流背后的数据结构是否易于分解。例如，ArrayList的拆分效率比LinkedList
  高得多，因为前者用不着遍历就可以平均拆分，而后者则必须遍历。另外，用range工厂
  方法创建的原始类型流也可以快速分解。最后，你将在7.3节中学到，你可以自己实现
  Spliterator来完全掌控分解过程。

- 流自身的特点，以及流水线中的中间操作修改流的方式，都可能会改变分解过程的性能。
  例如，一个SIZED流可以分成大小相等的两部分，这样每个部分都可以比较高效地并行处
  理，但筛选操作可能丢弃的元素个数却无法预测，导致流本身的大小未知。

- 还要考虑终端操作中合并步骤的代价是大是小（例如Collector中的combiner方法）。
  如果这一步代价很大，那么组合每个子流产生的部分结果所̶出的代价就可能会超出通
  过并行流得到的性能提升。

下表按照可分解性总结了一些流数据源适不适于并行。

|源|可分解性|
|---|---|
|ArrayList|极佳|
|LinkedList|差|
|IntStream.range|极佳|
|Stream.iterate|差|
|HashSet|好|
|TreeSet|好|

最后，还要强调一下并行流背后使用的基础架构是Java 7中引入的分支/合并框架。并行汇总
的示例证明了要想正确使用并行流，了解它的内部原理至关重要，所以我们稍后会仔细研究
分支/合并框架。



#### 分支/合并框架

分支/合并框架的目的是以递归的方式将可以并行的任务拆分成更小的任务，然后将每个子任 
务的结果合并起来生成整体结果。它是ExecutorService接口的一个实现，它把子任务分配给
线程池（称为ForkJoinPool）中的工作线程。首先来看看如何定义任务和子任务。

##### 使用RecursiveTask

要把任务提交到这个池，必须创建RecursiveTask<R>的一个子类，其中R是并行化任务（以
及所有子任务）产生的结果类型，或者如果任务不返回结果，则是RecursiveAction类型（当
然它可能会更新其他非局部机构）。要定义RecursiveTask，只需实现它唯一的抽象方法
compute：
 ```protected abstract R compute();```

这个方法同时定义了将任务划分成子任务的逻辑，以及无法再划分或不方便再划分时，生成
单个子任务结果的逻辑。正由于此，这个方法的实现类似于下面的伪代码：

<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="o">(</span><span class="n">任务足够小或不可分</span><span class="o">)</span> <span class="o">{</span> 
    <span class="n">顺序计算该任务</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span> 
    <span class="n">将任务分成两个子任务</span>
    <span class="n">递归调用本方法</span><span class="err">，</span><span class="n">拆分每个子任务</span><span class="err">，</span><span class="n">等待所有子任务完成</span>
    <span class="n">合并每个子任务的结果</span>
<span class="o">}</span>
</code></pre></div>

下面是使用分支/合并框架实现并发进行累积和计算的代码:

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ForkJoinSumCalculator</span> <span class="kd">extends</span> <span class="n">RecursiveTask</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span><span class="o">[]</span> <span class="n">numbers</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">start</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">end</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">THRESHOLD</span> <span class="o">=</span> <span class="mi">10_000</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">ForkJoinSumCalculator</span><span class="o">(</span><span class="kt">long</span><span class="o">[]</span> <span class="n">numbers</span><span class="o">,</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">numbers</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">ForkJoinSumCalculator</span><span class="o">(</span><span class="kt">long</span><span class="o">[]</span> <span class="n">numbers</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">numbers</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">numbers</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Fork 就是把一个大任务切分为若干子任务并行的执行，</span>
<span class="cm">     * Join 就是合并这些子任务的执行结果，最后得到这个大任务的结果</span>
<span class="cm">     * @Author: CaoTing</span>
<span class="cm">     * @Date: 2019/12/22</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Long</span> <span class="nf">compute</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="n">THRESHOLD</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">computeSequentially</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">ForkJoinSumCalculator</span> <span class="n">leftTask</span> <span class="o">=</span>
                <span class="k">new</span> <span class="n">ForkJoinSumCalculator</span><span class="o">(</span><span class="n">numbers</span><span class="o">,</span> <span class="n">start</span><span class="o">,</span> <span class="n">start</span> <span class="o">+</span> <span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span>

        <span class="c1">// 使用另一个ForkJoinPool线程异步执行新创建的子任务</span>
        <span class="n">leftTask</span><span class="o">.</span><span class="na">fork</span><span class="o">();</span>

        <span class="n">ForkJoinSumCalculator</span> <span class="n">rightTask</span> <span class="o">=</span>
                <span class="k">new</span> <span class="n">ForkJoinSumCalculator</span><span class="o">(</span><span class="n">numbers</span><span class="o">,</span> <span class="n">start</span> <span class="o">+</span> <span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>

        <span class="c1">// 继续在这个线程递归调用compute方法，可能会在上一步fork时再次分支</span>
        <span class="n">Long</span> <span class="n">rightResult</span> <span class="o">=</span> <span class="n">rightTask</span><span class="o">.</span><span class="na">compute</span><span class="o">();</span>

        <span class="c1">// 读取另一半子任务的结果，如果未完成会继续等待</span>
        <span class="n">Long</span> <span class="n">leftResult</span> <span class="o">=</span> <span class="n">leftTask</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">leftResult</span><span class="o">+</span><span class="n">rightResult</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * 在子任务不再分裂时调用的计算方法</span>
<span class="cm">     * @Author: CaoTing</span>
<span class="cm">     * @Date: 2019/12/22</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="n">Long</span> <span class="nf">computeSequentially</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">end</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">numbers</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>



##### 使用分支/合并框架的最好做法

虽然分支/合并框架还算简单易用，不幸的是它也很容易被误用。以下是几个有效使用它的
最佳做法。

- 对一个任务调用join方法会阻塞调用方，直到该任务做出结果。因此，有必要在两个子
  任务的计算都开始之后再调用它。否则，你得到的版本会比原始的顺序算法更慢更复杂

- 不应该在RecursiveTask内部使用ForkJoinPool的invoke方法。相反，你应该始终直
  接调用compute或fork方法，只有顺序代码才应该用invoke来启动并行计算。

- 对子任务调用fork方法可以把它排进ForkJoinPool。同时对左边和右边的子任务调用
  它似乎很自然，但这样做的效率要比直接对其中一个调用compute低。这样做你可以为
  其中一个子任务重用同一线程，从而避免在线程池中多分配一个任务造成的开销。

- 调试使用分支/合并框架的并行计算可能有点棘手。特别是你平常都在你喜欢的IDE里面
  看栈跟踪（stack trace）来找问题，但放在分支/合并计算上就不行了，因为调用compute
  的线程并不是概念上的调用方，后者是调用fork的那个。

- 和并行流一样，你不应理所当然地认为在多核处理器上使用分支/合并框架就比顺序计
  算快。

对于分支/合并拆分策略还有最后一点补充：你必须选择一个标准，来决定任务是要进一步
划分还是已小到可以顺序求值。

##### 工作窃取

在ForkJoinSumCalculator的例子中，我们决定在要求和的数组中最多包含10 000个项目
时就不再创建子任务了。这个选择是很随意的，但大多数情况下也很难找到一个好的启发式方法
来确定它，只能试几个不同的值来优化它。

但分出大量的小任务一般来说都是一个好的选择。这是因为，理想情况下，划分并行任务时，
应该让每个任务都用完全相同的时间完成，让所有的CPU内核都同样繁忙。但是实际中，每
个子任务所花的时间可能天差地别，要么是因为划分策略效率低，要么是有不可预知的原因，比如
磁盘访问慢，或是需要和外部服务协调执行。

分支/合并框架工程用一种称为工作窃取（work stealing）的技术来解决这个问题。在实际应
用中，这意味着这些任务差不多被平均分配到ForkJoinPool中的所有线程上。每个线程都为分
配给它的任务保存一个双向链式队列，每完成一个任务，就会从队列头上取出下一个任务开始执
行。

基于前面所述的原因，某个线程可能早早完成了分配给它的所有任务，也就是它的队列已经
空了，而其他的线程还很忙。这时，这个线程并没有闲下来，而是随机选了一个别的线程，从队
列的尾巴上“偷走”一个任务。这个过程一直持续下去，直到所有的任务都执行完毕，所有的队
列都清空。这就是为什么要划分成许多小任务而不是少数几个大任务，这有助于更好地在工作线程
之间平衡负载。

一般来说，这种工作窃取算法用于在池中的工作线程之间重新分配和平衡任务。



#### Spliterator

Spliterator是Java 8中加入的另一个新接口；这个名字代表“可分迭代器”（splitable 
iterator）。和Iterator一样，Spliterator也用于遍历数据源中的元素，但它是为了并行执行
而设计的。

**Spliterator接口**

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Spliterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span> 
    <span class="kt">boolean</span> <span class="nf">tryAdvance</span><span class="o">(</span><span class="n">Consumer</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">action</span><span class="o">);</span> 
    <span class="n">Spliterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">trySplit</span><span class="o">();</span> 
    <span class="kt">long</span> <span class="nf">estimateSize</span><span class="o">();</span> 
    <span class="kt">int</span> <span class="nf">characteristics</span><span class="o">();</span> 
<span class="o">}</span>
</code></pre></div>

- T是Spliterator遍历的元素的类型。
- tryAdvance方法的行为类似于普通的Iterator，因为它会按顺序一个一个使用Spliterator中的元素，并且如果还有其他元素要遍
历就返回true。
- trySplit是专为Spliterator接口设计的，因为它可以把一些元素划出去分
给第二个Spliterator（由该方法返回），让它们两个并行处理。
- estimateSize方法可以估计还剩下多少元素要遍历。

##### 拆分过程

将Stream拆分成多个部分的算法是一个递归过程。第一步是对第一个
Spliterator调用trySplit，生成第二个Spliterator。第二步对这两个Spliterator调用
trysplit，这样总共就有了四个Spliterator。这个框架不断对Spliterator调用trySplit
直到它返回null，表明它处理的数据结构不能再分Ҟ，如第三步所示。最后，这个递ॅઞ分过
程到第四步就终止了，这时所有的Spliterator在调用trySplit时都返回了null。

这个拆分过程也受Spliterator本身的特性影响，而特性是通过characteristics方法声
明的。

##### Spliterator的特性

Spliterator接口声明的最后一个抽象方法是characteristics，它将返回一个int，代
表Spliterator本身特性集的编码。下表总结了这些特性

![](http://clevercoder.cn/github/image/2019-12-26_14-16-11.png)

##### 实现你自己的Spliterator

让我们来看一个可能需要你自己实现Spliterator的实际例子。我们要开发一个简单的方
法来数数一个String中的单词数。这个方法的一个迭代版本可以写成下面的样子：

<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">int</span> <span class="nf">countWordsIteratively</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span> 

    <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> 
    <span class="kt">boolean</span> <span class="n">lastSpace</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> 

    <span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">c</span> <span class="o">:</span> <span class="n">s</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">())</span> <span class="o">{</span> 
        <span class="k">if</span> <span class="o">(</span><span class="n">Character</span><span class="o">.</span><span class="na">isWhitespace</span><span class="o">(</span><span class="n">c</span><span class="o">))</span> <span class="o">{</span> 
            <span class="n">lastSpace</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> 
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span> 
            <span class="k">if</span> <span class="o">(</span><span class="n">lastSpace</span><span class="o">)</span> <span class="n">counter</span><span class="o">++;</span>
                <span class="n">lastSpace</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> 
        <span class="o">}</span> 
    <span class="o">}</span> 
    <span class="k">return</span> <span class="n">counter</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>

现在调用它：

<div class="highlight"><pre><span></span><code><span class="kd">final</span> <span class="n">String</span> <span class="n">SENTENCE</span> <span class="o">=</span> 
    <span class="s">&quot; Nel mezzo del cammin di nostra vita &quot;</span> <span class="o">+</span> 
    <span class="s">&quot;mi ritrovai in una selva oscura&quot;</span> <span class="o">+</span> 
    <span class="s">&quot; ché la dritta via era smarrita &quot;</span><span class="o">;</span> 

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Found &quot;</span> <span class="o">+</span> <span class="n">countWordsIteratively</span><span class="o">(</span><span class="n">SENTENCE</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; words&quot;</span><span class="o">);</span>
</code></pre></div>

我在句子里添加了一些额外的随机空格，以演示这个迭代实现即使在两个词之间
存在多个空格时也能正常工作，这段代码将打印以下内容：

<div class="highlight"><pre><span></span><code><span class="n">Found</span> <span class="mi">19</span> <span class="n">words</span>
</code></pre></div>

理想情况下，你会想要用更为函数式的风格来实现它，因为就像我们前面说过的，这样你就
可以用并行Stream来并行化这个过程，而无需显式地处理线程和同步问题。

**1. 以函数式风格重写单词计数器**

首先你需要把String转换成一个流。但是原始类型的流仅限于int、long和double，
所以你只能用Stream<Character>：

<div class="highlight"><pre><span></span><code><span class="n">Stream</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">IntStream</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">SENTENCE</span><span class="o">.</span><span class="na">length</span><span class="o">())</span> 
                                <span class="o">.</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">SENTENCE</span><span class="o">::</span><span class="n">charAt</span><span class="o">);</span>
</code></pre></div>

-->

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>https://github.com/caotinging/Java8Action&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="">
        
          <a href="../%E5%AE%B9%E5%99%A8/" title="容器" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                容器
              </div>
            </div>
          </a>
        
        
          <a href="../../%E5%85%B6%E4%BB%96/" title="index" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                index
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../../../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "", "search.config.separator": "[\\uff0c\\u3002]+", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: ["tabs", "instant"],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>