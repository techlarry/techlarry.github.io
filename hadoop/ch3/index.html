<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note/hadoop/ch3/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Chapter 3: The Hadoop Distributed FileSystem - Zhenhua's Notes</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../extra_css/custom.css" rel="stylesheet">
        <link href="../../extra_css/custom.js" rel="stylesheet">
        <link href="../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../extra_css/theme.css" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Zhenhua's Notes</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OSC <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../osc/">Contents</a>
</li>
                            
<li >
    <a href="../../osc/ch1/">Chapter 1: Introduction </a>
</li>
                            
<li >
    <a href="../../osc/ch2/">Chapter 2: Operating System structures</a>
</li>
                            
<li >
    <a href="../../osc/ch3/">Chapter 3: Processes</a>
</li>
                            
<li >
    <a href="../../osc/ch4/">Chapter 4: Threads and Concurrency</a>
</li>
                            
<li >
    <a href="../../osc/ch5/">Chapter 5: CPU Scheduling</a>
</li>
                            
<li >
    <a href="../../osc/ch6/">Chapter 6: Synchronization Tools</a>
</li>
                            
<li >
    <a href="../../osc/ch7/">Chapter 7: Synchronization Examples</a>
</li>
                            
<li >
    <a href="../../osc/ch8/">Chapter 8: Deadlocks</a>
</li>
                            
<li >
    <a href="../../osc/ch9/">Chapter 9: Main Memory</a>
</li>
                            
<li >
    <a href="../../osc/ch10/">Chapter 10: Virtual Memory</a>
</li>
                            
<li >
    <a href="../../osc/ch11/">Chapter 11: Mass-Storage Structure</a>
</li>
                            
<li >
    <a href="../../osc/ch13/">Chapter 13: File-System Interfaces</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CSAPP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../csapp/">Contents</a>
</li>
                            
<li >
    <a href="../../csapp/ch1/">Chapter 1: 计算机系统漫游</a>
</li>
                            
<li >
    <a href="../../csapp/ch2/">Chapter 2: 信息的表示和处理</a>
</li>
                            
<li >
    <a href="../../csapp/ch3/">Chapter 3: 程序的机器级表示</a>
</li>
                            
<li >
    <a href="../../csapp/ch4/">Chapter 4: 处理器体系结构</a>
</li>
                            
<li >
    <a href="../../csapp/ch5/">Chapter 5: 优化程序性能</a>
</li>
                            
<li >
    <a href="../../csapp/ch6/">Chapter 6: 存储器层次结构</a>
</li>
                            
<li >
    <a href="../../csapp/ch7/">Chapter 7: 链接</a>
</li>
                            
<li >
    <a href="../../csapp/ch8/">Chapter 8: 异常控制流</a>
</li>
                            
<li >
    <a href="../../csapp/ch9/">Chapter 9: 虚拟内存</a>
</li>
                            
<li >
    <a href="../../csapp/ch10/">Chapter 10: 系统级I/O</a>
</li>
                            
<li >
    <a href="../../csapp/ch11/">Chapter 11: 网络编程</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HFJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../hfj/">Contents</a>
</li>
                            
<li >
    <a href="../../hfj/ch1/">Chapter 1: Dive in A Quick Dip</a>
</li>
                            
<li >
    <a href="../../hfj/ch2/">Chapter 2: Classes and Objects</a>
</li>
                            
<li >
    <a href="../../hfj/ch3/">Chapter 3: Primitives and References</a>
</li>
                            
<li >
    <a href="../../hfj/ch4/">Chapter 4: Methods use Instance Variables</a>
</li>
                            
<li >
    <a href="../../hfj/ch5/">Chapter 5: Writing a Program</a>
</li>
                            
<li >
    <a href="../../hfj/ch6/">Chapter 6: Get to Know the Java API</a>
</li>
                            
<li >
    <a href="../../hfj/ch7/">Chapter 7: Inheritance and Polymorphism</a>
</li>
                            
<li >
    <a href="../../hfj/ch8/">Chapter 8: Interfaces and Abstract Classes</a>
</li>
                            
<li >
    <a href="../../hfj/ch9/">Chapter 9: Constructors and Garbage Collection</a>
</li>
                            
<li >
    <a href="../../hfj/ch10/">Chapter 10: Numbers and Statics</a>
</li>
                            
<li >
    <a href="../../hfj/ch11/">Chapter 11: Exception Handling</a>
</li>
                            
<li >
    <a href="../../hfj/ch12/">Chapter 12: Getting GUI</a>
</li>
                            
<li >
    <a href="../../hfj/ch13/">Chapter 13: Using Swing</a>
</li>
                            
<li >
    <a href="../../hfj/ch14/">Chapter 14: Serialization and File I/O</a>
</li>
                            
<li >
    <a href="../../hfj/ch15/">Chapter 15: Networking and Threads</a>
</li>
                            
<li >
    <a href="../../hfj/ch16/">Chapter 16: Collections and Generics</a>
</li>
                            
<li >
    <a href="../../hfj/ch17/">Chapter 17: Packages, Jars and Deployment</a>
</li>
                            
<li >
    <a href="../../hfj/ch18/">Chapter 18: Remote deploy with RMI</a>
</li>
                            
<li >
    <a href="../../hfj/Appendix/">Appendix: The Top Ten Topics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HFDP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../hfdp/">Contents</a>
</li>
                            
<li >
    <a href="../../hfdp/ch1/">Chapter 1: Strategy Pattern </a>
</li>
                            
<li >
    <a href="../../hfdp/ch2/">Chapter 2: Observer Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch3/">Chapter 3: Decorator Pattern </a>
</li>
                            
<li >
    <a href="../../hfdp/ch4/">Chapter 4: Factory Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch5/">Chapter 5: Singleton Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch6/">Chapter 6: Command Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch7/">Chapter 7: Adapter and Facade Patterns</a>
</li>
                            
<li >
    <a href="../../hfdp/ch8/">Chapter 8: Template Method Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch9/">Chapter 9: Iterator and Composite Patterns</a>
</li>
                            
<li >
    <a href="../../hfdp/ch10/">Chapter 10: State Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch11/">Chapter 11: Proxy Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch12/">Chapter 12: Compound Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch13/">Chapter 13: Better Living with Patterns</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">TIJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tij/">Contents</a>
</li>
                            
<li >
    <a href="../../tij/ch1/">Chapter 1: Introduction</a>
</li>
                            
<li >
    <a href="../../tij/ch2/">Chapter 2: Introduction to Objects</a>
</li>
                            
<li >
    <a href="../../tij/ch3/">Chapter 3: Everything is an Object</a>
</li>
                            
<li >
    <a href="../../tij/ch4/">Chapter 4: Opertors</a>
</li>
                            
<li >
    <a href="../../tij/ch5/">Chapter 5: Controlling Execution</a>
</li>
                            
<li >
    <a href="../../tij/ch6/">Chapter 6: Initialization & Cleanup</a>
</li>
                            
<li >
    <a href="../../tij/ch7/">Chapter 7: Access Control</a>
</li>
                            
<li >
    <a href="../../tij/ch8/">Chapter 8: Reusing Clases</a>
</li>
                            
<li >
    <a href="../../tij/ch9/">Chapter 9: Polymorphism</a>
</li>
                            
<li >
    <a href="../../tij/ch10/">Chapter 10: Interfaces</a>
</li>
                            
<li >
    <a href="../../tij/ch11/">Chapter 11: Inner Classes</a>
</li>
                            
<li >
    <a href="../../tij/ch12/">Chapter 12: Holding Your Objects</a>
</li>
                            
<li >
    <a href="../../tij/ch13/">Chapter 13: Error Handling with Exceptions</a>
</li>
                            
<li >
    <a href="../../tij/ch14/">Chapter 14: Strings</a>
</li>
                            
<li >
    <a href="../../tij/ch15/">Chapter 15: Type Information</a>
</li>
                            
<li >
    <a href="../../tij/ch16/">Chapter 16: Generics</a>
</li>
                            
<li >
    <a href="../../tij/ch17/">Chapter 17: Arrays</a>
</li>
                            
<li >
    <a href="../../tij/ch18/">Chapter 18: Containers in Depth</a>
</li>
                            
<li >
    <a href="../../tij/ch19/">Chapter 19: I/O</a>
</li>
                            
<li >
    <a href="../../tij/ch20/">Chapter 20: Enumerated Types</a>
</li>
                            
<li >
    <a href="../../tij/ch21/">Chapter 21: Annotations</a>
</li>
                            
<li >
    <a href="../../tij/ch22/">Chapter 22: Concurrency</a>
</li>
                            
<li >
    <a href="../../tij/ch23/">Chapter 23: Graphical User Interfaces</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CPJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../cpj/">Contents</a>
</li>
                            
<li >
    <a href="../../cpj/ch1/">Concurrent Programming in Java 1: Threads and Locks</a>
</li>
                            
<li >
    <a href="../../cpj/ch2/">Concurrent Programming in Java 2: Critical Sections and Isolation</a>
</li>
                            
<li >
    <a href="../../cpj/ch3/">Concurrent Programming in Java 3: Actors</a>
</li>
                            
<li >
    <a href="../../cpj/ch4/">Concurrent Programming in Java 4: Concurrent Data Structures</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HADOOP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../">Contents</a>
</li>
                            
<li >
    <a href="../ch1/">Chapter 1: Meet Hadoop</a>
</li>
                            
<li >
    <a href="../ch2/">Chapter 2: MapReduce</a>
</li>
                            
<li class="active">
    <a href="./">Chapter 3: The Hadoop Distributed FileSystem</a>
</li>
                            
<li >
    <a href="../ch4/">Chapter 4: YARN</a>
</li>
                            
<li >
    <a href="../ch5/">Chapter 5: Hadoop I/O</a>
</li>
                            
<li >
    <a href="../ch6/">Chapter 6: Developing a MapReduce Application</a>
</li>
                            
<li >
    <a href="../ch7/">Chapter 7: How MapReduce Works</a>
</li>
                            
<li >
    <a href="../ch8/">Chapter 8: MapReduce Types and Formats</a>
</li>
                            
<li >
    <a href="../ch9/">Chapter 9: MapReduce Features</a>
</li>
                            
<li >
    <a href="../ch10/">Chapter 10: Setting Up a Hadoop Cluster</a>
</li>
                            
<li >
    <a href="../ch11/">Chapter 11: Adminstering Hadoop</a>
</li>
                            
<li >
    <a href="../ch12/">Chapter 12: Avro</a>
</li>
                            
<li >
    <a href="../ch13/">Chapter 13: Parquet</a>
</li>
                            
<li >
    <a href="../ch14/">Chapter 14: Flume</a>
</li>
                            
<li >
    <a href="../ch15/">Chapter 15: Sqoop</a>
</li>
                            
<li >
    <a href="../ch16/">Chapter 16: Pig</a>
</li>
                            
<li >
    <a href="../ch17/">Chapter 17: Hive</a>
</li>
                            
<li >
    <a href="../ch18/">Chapter 18: Crunch</a>
</li>
                            
<li >
    <a href="../ch19/">Chapter 19: Spark</a>
</li>
                            
<li >
    <a href="../ch20/">Chapter 20: HBase</a>
</li>
                            
<li >
    <a href="../ch21/">Chapter 21: ZooKeeper</a>
</li>
                            
<li >
    <a href="../ch22/">Chapter 22: Composable Data at Center</a>
</li>
                            
<li >
    <a href="../ch23/">Chapter 23: Biological Data Science: Saving Lives with Software</a>
</li>
                            
<li >
    <a href="../ch24/">Chapter 24: Cascading</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UJVM <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../ujvm/">Contents</a>
</li>
                            
<li >
    <a href="../../ujvm/ch1/">Chapter 1 : 走进Java</a>
</li>
                            
<li >
    <a href="../../ujvm/ch2/">Chapter 2 : Java内存区域与内存溢出正常</a>
</li>
                            
<li >
    <a href="../../ujvm/ch3/">Chapter 3 : 垃圾收集器与内存分配策略</a>
</li>
                            
<li >
    <a href="../../ujvm/ch4/">Chapter 4 : 虚拟机性能监控与故障处理工具</a>
</li>
                            
<li >
    <a href="../../ujvm/ch5/">Chapter 5 : 调优案例分析与实战</a>
</li>
                            
<li >
    <a href="../../ujvm/ch6/">Chapter 6 : 类文件结构</a>
</li>
                            
<li >
    <a href="../../ujvm/ch7/">Chapter 7 : 虚拟机类加载机制</a>
</li>
                            
<li >
    <a href="../../ujvm/ch8/">Chapter 8 : 虚拟机字节码执行引擎</a>
</li>
                            
<li >
    <a href="../../ujvm/ch9/">Chapter 9 : 类加载及执行子系统的案例与实战</a>
</li>
                            
<li >
    <a href="../../ujvm/ch10/">Chapter 10 : 早期(编译期)优化</a>
</li>
                            
<li >
    <a href="../../ujvm/ch11/">Chapter 11 : 晚期(运行期)优化</a>
</li>
                            
<li >
    <a href="../../ujvm/ch12/">Chapter 12 : Java内存模型与线程</a>
</li>
                            
<li >
    <a href="../../ujvm/ch13/">Chapter 13 : 线程安全与锁优化</a>
</li>
                            
<li >
    <a href="../../ujvm/AppendixC/">Appendix HotSpot虚拟机主要参数列表</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../books/">Books</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../ch2/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../ch4/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#hadoop-the-definitive-guide-3-the-hadoop-distributed-filesystem">Hadoop: The Definitive Guide 3 - The Hadoop Distributed FileSystem</a></li>
        <li class="main "><a href="#1-the-design-of-hdfs">1 The Design of HDFS</a></li>
        <li class="main "><a href="#2-hdfs-concepts">2 HDFS Concepts</a></li>
            <li><a href="#blocks">Blocks</a></li>
            <li><a href="#namenodes-and-datanodes">Namenodes and Datanodes</a></li>
            <li><a href="#block-caching">Block Caching</a></li>
            <li><a href="#hdfs-federation">HDFS Federation</a></li>
            <li><a href="#hdfs-high-availability">HDFS High Availability</a></li>
        <li class="main "><a href="#3-the-command-line-interface">3 The Command-Line Interface</a></li>
            <li><a href="#basic-filesystem-operations">Basic Filesystem Operations</a></li>
        <li class="main "><a href="#4-hadoop-filesystems">4 Hadoop Filesystems</a></li>
            <li><a href="#http">HTTP</a></li>
        <li class="main "><a href="#5-the-java-interface">5 The Java Interface</a></li>
            <li><a href="#reading-data-from-a-hadoop-url">Reading Data from a Hadoop URL</a></li>
            <li><a href="#reading-data-using-the-filesystem-api">Reading Data Using the FileSystem API</a></li>
        <li class="main "><a href="#6-data-flow">6 Data Flow</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="hadoop-the-definitive-guide-3-the-hadoop-distributed-filesystem"><strong>Hadoop: The Definitive Guide 3 - The Hadoop Distributed FileSystem</strong><a class="headerlink" href="#hadoop-the-definitive-guide-3-the-hadoop-distributed-filesystem" title="Permanent link">&para;</a></h3>
<p>Filesystems that manage the storage across a network of machines are called <strong><em>distributed filesystems</em></strong> . Hadoop comes with a distributed filesystem called HDFS, which stands for <strong><em>Hadoop Distributed Filesystem</em></strong> .</p>
<h3 id="1-the-design-of-hdfs">1 The Design of HDFS<a class="headerlink" href="#1-the-design-of-hdfs" title="Permanent link">&para;</a></h3>
<p>HDFS is a filesystem designed for storing very large files with streaming data access patterns, running on clusters of commodity hardware.</p>
<ul>
<li>Very large files: files that are hundreds of megabytes, gigabytes, or terabytes in size.</li>
<li>Streaming data access: HDFS is built around the idea that the most efficient data processing pattern is a <strong><em>write-once, read-many-times</em></strong> pattern.</li>
<li>Commodity hardware: It’s designed to run on clusters of commodity hardware.</li>
</ul>
<p>These are areas where HDFS is not a good fit today:</p>
<ul>
<li>Low-latency data access</li>
<li>Lots of small files</li>
<li>Multiple writers, arbitrary file modifications</li>
</ul>
<h3 id="2-hdfs-concepts">2 HDFS Concepts<a class="headerlink" href="#2-hdfs-concepts" title="Permanent link">&para;</a></h3>
<h4 id="blocks">Blocks<a class="headerlink" href="#blocks" title="Permanent link">&para;</a></h4>
<p>A disk has a block size, which is the minimum amount of data that it can read or write. Filesystems for a single disk build on this by dealing with data in blocks, which are an integral multiple of the disk block size.</p>
<p>HDFS, too, has the concept of a block, but it is a much larger unit — 128 MB by default (typically a few kilobytes for ordinary file system). Unlike a filesystem for a single disk, a file in HDFS that is smaller than a single block does not occupy a full block’s worth of underlying storage. (For example, a 1 MB file stored with a block size of 128 MB uses 1 MB of disk space, not 128 MB.)</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>WHY IS A BLOCK IN HDFS SO LARGE? To minimize the cost of seeks.</p>
</div>
<p>Having a block abstraction for a distributed filesystem brings several benefits.</p>
<ul>
<li>A file can be larger than any single disk in the network.</li>
<li>Making the unit of abstraction a block rather than a file simplifies the storage subsystem.<ul>
<li>storage management: because blocks are a fixed size, it is easy to calculate how many can be stored on a given disk </li>
<li>metadata concerns: because blocks are just chunks of data to be stored, file metadata such as permissions information does not need to be stored with the blocks</li>
</ul>
</li>
<li>Blocks fit well with replication for providing fault tolerance and availability.<ul>
<li>To insure against corrupted blocks and disk and machine failure, each block is replicated to a small number of physically separate machines (typically three).</li>
</ul>
</li>
</ul>
<h4 id="namenodes-and-datanodes">Namenodes and Datanodes<a class="headerlink" href="#namenodes-and-datanodes" title="Permanent link">&para;</a></h4>
<p>An HDFS cluster has two types of nodes operating in a master−worker pattern: a <strong><em>namenode</em></strong> (the master) and a number of <strong><em>datanodes</em></strong> (workers). </p>
<ul>
<li>The namenode manages the filesystem namespace. It maintains the filesystem tree and the metadata for all the files and directories in the tree. This information is stored persistently on the local disk in the form of two files: the namespace image and the edit log.</li>
<li>The namenode also knows the datanodes on which all the blocks for a given file are located;</li>
<li>Datanodes are the workhorses of the filesystem. They store and retrieve blocks when they are told to (by clients or the namenode), and they report back to the namenode periodically with lists of blocks that they are storing.</li>
</ul>
<p>If the machine running the namenode were obliterated, all the files on the filesystem would be lost since there would be no way of knowing how to reconstruct the files from the blocks on the datanodes. Possible solution:</p>
<ul>
<li>to back up the files that make up the persistent state of the filesystem metadata.</li>
<li>to run a secondary namenode, which keeps a copy of the merged namespace image.</li>
</ul>
<h4 id="block-caching">Block Caching<a class="headerlink" href="#block-caching" title="Permanent link">&para;</a></h4>
<p>For frequently accessed files the blocks may be explicitly cached in the datanode’s memory, in an off-heap block cache. Users or applications instruct the namenode which files to cache (and for how long) by adding a <em>cache directive</em> to a <em>cache pool</em>.</p>
<h4 id="hdfs-federation">HDFS Federation<a class="headerlink" href="#hdfs-federation" title="Permanent link">&para;</a></h4>
<p>Problem: On very large clusters with many files, memory becomes the limiting factor for scaling, since namenode keeps a reference to every file and block in the filesystem in memory.</p>
<p>Solution: HDFS federation, allows a cluster to scale by adding namenodes, each of which manages a portion of the filesystem namespace.</p>
<h4 id="hdfs-high-availability">HDFS High Availability<a class="headerlink" href="#hdfs-high-availability" title="Permanent link">&para;</a></h4>
<p>To remedy a failed namenode, a pair of namenodes in an active-standby configuration is introduced in Hadoop 2. In the event of the failure of the active namenode, the standby takes over its duties to continue servicing client requests <em>without</em> a significant interruption.</p>
<h3 id="3-the-command-line-interface">3 The Command-Line Interface<a class="headerlink" href="#3-the-command-line-interface" title="Permanent link">&para;</a></h3>
<h4 id="basic-filesystem-operations">Basic Filesystem Operations<a class="headerlink" href="#basic-filesystem-operations" title="Permanent link">&para;</a></h4>
<p>Start by copying a file from the local filesystem to HDFS:</p>
<p> <div class=codehilite><pre><span class=c1>#The local file quangle.txt is copied to the file /user/tom/quangle.txt on the HDFS instance running on localhost.</span>
$ hadoop fs -copyFromLocal input/docs/quangle.txt /user/tom/quangle.txt
</pre></div></p>
<p>Let’s copy the file back to the local filesystem:</p>
<p> <div class=codehilite><pre>$ hadoop fs -copyToLocal quangle.txt quangle.copy.txt
</pre></div></p>
<h3 id="4-hadoop-filesystems">4 Hadoop Filesystems<a class="headerlink" href="#4-hadoop-filesystems" title="Permanent link">&para;</a></h3>
<p>Hadoop has an abstract notion of filesystems, of which HDFS is just one implementation. The Java abstract class <C>org.apache.hadoop.fs.FileSystem</C> represents the client interface to a filesystem in Hadoop, and there are several concrete implementations.</p>
<table>
<thead>
<tr>
<th>Filesystem</th>
<th>URI scheme</th>
<th>Java implementation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Local</td>
<td>file</td>
<td>fs.LocalFileSystem</td>
<td>A filesystem for a locally connected disk with client-side checksums</td>
</tr>
<tr>
<td>HDFS</td>
<td>hfs</td>
<td>hdfs.DistributedFileSystem</td>
<td>Hadoop’s distributed filesystem</td>
</tr>
<tr>
<td>WebHDFS</td>
<td>webhdfs</td>
<td>hdfs.web.WebHdfsFileSystem</td>
<td>providing authenticated read/write access to HDFS over HTTP.</td>
</tr>
</tbody>
</table>
<h4 id="http">HTTP<a class="headerlink" href="#http" title="Permanent link">&para;</a></h4>
<p>The HTTP REST API exposed by the WebHDFS protocol makes it easier for other languages to interact with HDFS. Note that the HTTP interface is slower than the native Java client, so should be avoided for very large data transfers if possible.</p>
<h3 id="5-the-java-interface">5 The Java Interface<a class="headerlink" href="#5-the-java-interface" title="Permanent link">&para;</a></h3>
<h4 id="reading-data-from-a-hadoop-url">Reading Data from a Hadoop URL<a class="headerlink" href="#reading-data-from-a-hadoop-url" title="Permanent link">&para;</a></h4>
<p> <div class=codehilite><pre><span class=cm>/* Usage example: </span>
<span class=cm>    % export HADOOP_CLASSPATH=hadoop-examples.jar </span>
<span class=cm>    % hadoop URLCat hdfs://localhost/user/tom/quangle.txt</span>
<span class=cm> */</span>
<span class=kn>import</span> <span class=nn>org.apache.hadoop.fs.FsUrlStreamHandlerFactory</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>org.apache.hadoop.io.IOUtils</span><span class=o>;</span>

<span class=kn>import</span> <span class=nn>java.io.InputStream</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>java.net.URL</span><span class=o>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>URLCat</span> <span class=o>{</span>

    <span class=kd>static</span> <span class=o>{</span>
        <span class=n>URL</span><span class=o>.</span><span class=na>setURLStreamHandlerFactory</span><span class=o>(</span><span class=k>new</span> <span class=n>FsUrlStreamHandlerFactory</span><span class=o>());</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
        <span class=n>InputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
        <span class=k>try</span> <span class=o>{</span>
            <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>URL</span><span class=o>(</span><span class=n>args</span><span class=o>[</span><span class=mi>0</span><span class=o>]).</span><span class=na>openStream</span><span class=o>();</span>
            <span class=n>IOUtils</span><span class=o>.</span><span class=na>copyBytes</span><span class=o>(</span><span class=n>in</span><span class=o>,</span> <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>,</span> <span class=mi>4096</span><span class=o>,</span> <span class=kc>false</span><span class=o>);</span>
        <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
            <span class=n>IOUtils</span><span class=o>.</span><span class=na>closeStream</span><span class=o>(</span><span class=n>in</span><span class=o>);</span>
        <span class=o>}</span>

    <span class=o>}</span>

<span class=o>}</span>
</pre></div></p>
<h4 id="reading-data-using-the-filesystem-api">Reading Data Using the FileSystem API<a class="headerlink" href="#reading-data-using-the-filesystem-api" title="Permanent link">&para;</a></h4>
<p>A file in a Hadoop filesystem is represented by a Hadoop <C>Path</C> object(<C>org.apache.hadoop.fs.Path</C>, not <C>java.io.File</C>).</p>
<h3 id="6-data-flow">6 Data Flow<a class="headerlink" href="#6-data-flow" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../figures/AClientReadingDataFromHDFS.jpg" /></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script src="../../extra_javascript/tabhack.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
