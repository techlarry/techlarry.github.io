<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note/osc/ch3/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Chapter 3: Processes - Zhenhua's Notes</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../extra_css/custom.css" rel="stylesheet">
        <link href="../../extra_css/custom.js" rel="stylesheet">
        <link href="../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../extra_css/theme.css" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Zhenhua's Notes</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OSC <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../">Contents</a>
</li>
                            
<li >
    <a href="../ch1/">Chapter 1: Introduction </a>
</li>
                            
<li >
    <a href="../ch2/">Chapter 2: Operating System structures</a>
</li>
                            
<li class="active">
    <a href="./">Chapter 3: Processes</a>
</li>
                            
<li >
    <a href="../ch4/">Chapter 4: Threads and Concurrency</a>
</li>
                            
<li >
    <a href="../ch5/">Chapter 5: CPU Scheduling</a>
</li>
                            
<li >
    <a href="../ch6/">Chapter 6: Synchronization Tools</a>
</li>
                            
<li >
    <a href="../ch7/">Chapter 7: Synchronization Examples</a>
</li>
                            
<li >
    <a href="../ch8/">Chapter 8: Deadlocks</a>
</li>
                            
<li >
    <a href="../ch9/">Chapter 9: Main Memory</a>
</li>
                            
<li >
    <a href="../ch10/">Chapter 10: Virtual Memory</a>
</li>
                            
<li >
    <a href="../ch11/">Chapter 11: Mass-Storage Structure</a>
</li>
                            
<li >
    <a href="../ch13/">Chapter 13: File-System Interfaces</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CSAPP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../csapp/">Contents</a>
</li>
                            
<li >
    <a href="../../csapp/ch1/">Chapter 1: 计算机系统漫游</a>
</li>
                            
<li >
    <a href="../../csapp/ch2/">Chapter 2: 信息的表示和处理</a>
</li>
                            
<li >
    <a href="../../csapp/ch3/">Chapter 3: 程序的机器级表示</a>
</li>
                            
<li >
    <a href="../../csapp/ch4/">Chapter 4: 处理器体系结构</a>
</li>
                            
<li >
    <a href="../../csapp/ch5/">Chapter 5: 优化程序性能</a>
</li>
                            
<li >
    <a href="../../csapp/ch6/">Chapter 6: 存储器层次结构</a>
</li>
                            
<li >
    <a href="../../csapp/ch7/">Chapter 7: 链接</a>
</li>
                            
<li >
    <a href="../../csapp/ch8/">Chapter 8: 异常控制流</a>
</li>
                            
<li >
    <a href="../../csapp/ch9/">Chapter 9: 虚拟内存</a>
</li>
                            
<li >
    <a href="../../csapp/ch10/">Chapter 10: 系统级I/O</a>
</li>
                            
<li >
    <a href="../../csapp/ch11/">Chapter 11: 网络编程</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HFJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../hfj/">Contents</a>
</li>
                            
<li >
    <a href="../../hfj/ch1/">Chapter 1: Dive in A Quick Dip</a>
</li>
                            
<li >
    <a href="../../hfj/ch2/">Chapter 2: Classes and Objects</a>
</li>
                            
<li >
    <a href="../../hfj/ch3/">Chapter 3: Primitives and References</a>
</li>
                            
<li >
    <a href="../../hfj/ch4/">Chapter 4: Methods use Instance Variables</a>
</li>
                            
<li >
    <a href="../../hfj/ch5/">Chapter 5: Writing a Program</a>
</li>
                            
<li >
    <a href="../../hfj/ch6/">Chapter 6: Get to Know the Java API</a>
</li>
                            
<li >
    <a href="../../hfj/ch7/">Chapter 7: Inheritance and Polymorphism</a>
</li>
                            
<li >
    <a href="../../hfj/ch8/">Chapter 8: Interfaces and Abstract Classes</a>
</li>
                            
<li >
    <a href="../../hfj/ch9/">Chapter 9: Constructors and Garbage Collection</a>
</li>
                            
<li >
    <a href="../../hfj/ch10/">Chapter 10: Numbers and Statics</a>
</li>
                            
<li >
    <a href="../../hfj/ch11/">Chapter 11: Exception Handling</a>
</li>
                            
<li >
    <a href="../../hfj/ch12/">Chapter 12: Getting GUI</a>
</li>
                            
<li >
    <a href="../../hfj/ch13/">Chapter 13: Using Swing</a>
</li>
                            
<li >
    <a href="../../hfj/ch14/">Chapter 14: Serialization and File I/O</a>
</li>
                            
<li >
    <a href="../../hfj/ch15/">Chapter 15: Networking and Threads</a>
</li>
                            
<li >
    <a href="../../hfj/ch16/">Chapter 16: Collections and Generics</a>
</li>
                            
<li >
    <a href="../../hfj/ch17/">Chapter 17: Packages, Jars and Deployment</a>
</li>
                            
<li >
    <a href="../../hfj/ch18/">Chapter 18: Remote deploy with RMI</a>
</li>
                            
<li >
    <a href="../../hfj/Appendix/">Appendix: The Top Ten Topics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HFDP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../hfdp/">Contents</a>
</li>
                            
<li >
    <a href="../../hfdp/ch1/">Chapter 1: Strategy Pattern </a>
</li>
                            
<li >
    <a href="../../hfdp/ch2/">Chapter 2: Observer Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch3/">Chapter 3: Decorator Pattern </a>
</li>
                            
<li >
    <a href="../../hfdp/ch4/">Chapter 4: Factory Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch5/">Chapter 5: Singleton Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch6/">Chapter 6: Command Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch7/">Chapter 7: Adapter and Facade Patterns</a>
</li>
                            
<li >
    <a href="../../hfdp/ch8/">Chapter 8: Template Method Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch9/">Chapter 9: Iterator and Composite Patterns</a>
</li>
                            
<li >
    <a href="../../hfdp/ch10/">Chapter 10: State Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch11/">Chapter 11: Proxy Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch12/">Chapter 12: Compound Pattern</a>
</li>
                            
<li >
    <a href="../../hfdp/ch13/">Chapter 13: Better Living with Patterns</a>
</li>
                            
<li >
    <a href="../../hfdp/Appendix/">Appendix: Design Pattern in Java Library</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">TIJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tij/">Contents</a>
</li>
                            
<li >
    <a href="../../tij/ch1/">Chapter 1: Introduction</a>
</li>
                            
<li >
    <a href="../../tij/ch2/">Chapter 2: Introduction to Objects</a>
</li>
                            
<li >
    <a href="../../tij/ch3/">Chapter 3: Everything is an Object</a>
</li>
                            
<li >
    <a href="../../tij/ch4/">Chapter 4: Opertors</a>
</li>
                            
<li >
    <a href="../../tij/ch5/">Chapter 5: Controlling Execution</a>
</li>
                            
<li >
    <a href="../../tij/ch6/">Chapter 6: Initialization & Cleanup</a>
</li>
                            
<li >
    <a href="../../tij/ch7/">Chapter 7: Access Control</a>
</li>
                            
<li >
    <a href="../../tij/ch8/">Chapter 8: Reusing Clases</a>
</li>
                            
<li >
    <a href="../../tij/ch9/">Chapter 9: Polymorphism</a>
</li>
                            
<li >
    <a href="../../tij/ch10/">Chapter 10: Interfaces</a>
</li>
                            
<li >
    <a href="../../tij/ch11/">Chapter 11: Inner Classes</a>
</li>
                            
<li >
    <a href="../../tij/ch12/">Chapter 12: Holding Your Objects</a>
</li>
                            
<li >
    <a href="../../tij/ch13/">Chapter 13: Error Handling with Exceptions</a>
</li>
                            
<li >
    <a href="../../tij/ch14/">Chapter 14: Strings</a>
</li>
                            
<li >
    <a href="../../tij/ch15/">Chapter 15: Type Information</a>
</li>
                            
<li >
    <a href="../../tij/ch16/">Chapter 16: Generics</a>
</li>
                            
<li >
    <a href="../../tij/ch17/">Chapter 17: Arrays</a>
</li>
                            
<li >
    <a href="../../tij/ch18/">Chapter 18: Containers in Depth</a>
</li>
                            
<li >
    <a href="../../tij/ch19/">Chapter 19: I/O</a>
</li>
                            
<li >
    <a href="../../tij/ch20/">Chapter 20: Enumerated Types</a>
</li>
                            
<li >
    <a href="../../tij/ch21/">Chapter 21: Annotations</a>
</li>
                            
<li >
    <a href="../../tij/ch22/">Chapter 22: Concurrency</a>
</li>
                            
<li >
    <a href="../../tij/ch23/">Chapter 23: Graphical User Interfaces</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">CPJ <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../cpj/">Contents</a>
</li>
                            
<li >
    <a href="../../cpj/ch1/">Concurrent Programming in Java 1: Threads and Locks</a>
</li>
                            
<li >
    <a href="../../cpj/ch2/">Concurrent Programming in Java 2: Critical Sections and Isolation</a>
</li>
                            
<li >
    <a href="../../cpj/ch3/">Concurrent Programming in Java 3: Actors</a>
</li>
                            
<li >
    <a href="../../cpj/ch4/">Concurrent Programming in Java 4: Concurrent Data Structures</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HADOOP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../hadoop/">Contents</a>
</li>
                            
<li >
    <a href="../../hadoop/ch1/">Chapter 1: Meet Hadoop</a>
</li>
                            
<li >
    <a href="../../hadoop/ch2/">Chapter 2: MapReduce</a>
</li>
                            
<li >
    <a href="../../hadoop/ch3/">Chapter 3: The Hadoop Distributed FileSystem</a>
</li>
                            
<li >
    <a href="../../hadoop/ch4/">Chapter 4: YARN</a>
</li>
                            
<li >
    <a href="../../hadoop/ch5/">Chapter 5: Hadoop I/O</a>
</li>
                            
<li >
    <a href="../../hadoop/ch6/">Chapter 6: Developing a MapReduce Application</a>
</li>
                            
<li >
    <a href="../../hadoop/ch7/">Chapter 7: How MapReduce Works</a>
</li>
                            
<li >
    <a href="../../hadoop/ch8/">Chapter 8: MapReduce Types and Formats</a>
</li>
                            
<li >
    <a href="../../hadoop/ch9/">Chapter 9: MapReduce Features</a>
</li>
                            
<li >
    <a href="../../hadoop/ch10/">Chapter 10: Setting Up a Hadoop Cluster</a>
</li>
                            
<li >
    <a href="../../hadoop/ch11/">Chapter 11: Adminstering Hadoop</a>
</li>
                            
<li >
    <a href="../../hadoop/ch12/">Chapter 12: Avro</a>
</li>
                            
<li >
    <a href="../../hadoop/ch13/">Chapter 13: Parquet</a>
</li>
                            
<li >
    <a href="../../hadoop/ch14/">Chapter 14: Flume</a>
</li>
                            
<li >
    <a href="../../hadoop/ch15/">Chapter 15: Sqoop</a>
</li>
                            
<li >
    <a href="../../hadoop/ch16/">Chapter 16: Pig</a>
</li>
                            
<li >
    <a href="../../hadoop/ch17/">Chapter 17: Hive</a>
</li>
                            
<li >
    <a href="../../hadoop/ch18/">Chapter 18: Crunch</a>
</li>
                            
<li >
    <a href="../../hadoop/ch19/">Chapter 19: Spark</a>
</li>
                            
<li >
    <a href="../../hadoop/ch20/">Chapter 20: HBase</a>
</li>
                            
<li >
    <a href="../../hadoop/ch21/">Chapter 21: ZooKeeper</a>
</li>
                            
<li >
    <a href="../../hadoop/ch22/">Chapter 22: Composable Data at Center</a>
</li>
                            
<li >
    <a href="../../hadoop/ch23/">Chapter 23: Biological Data Science: Saving Lives with Software</a>
</li>
                            
<li >
    <a href="../../hadoop/ch24/">Chapter 24: Cascading</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">UJVM <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../ujvm/">Contents</a>
</li>
                            
<li >
    <a href="../../ujvm/ch1/">Chapter 1 : 走进Java</a>
</li>
                            
<li >
    <a href="../../ujvm/ch2/">Chapter 2 : Java内存区域与内存溢出正常</a>
</li>
                            
<li >
    <a href="../../ujvm/ch3/">Chapter 3 : 垃圾收集器与内存分配策略</a>
</li>
                            
<li >
    <a href="../../ujvm/ch4/">Chapter 4 : 虚拟机性能监控与故障处理工具</a>
</li>
                            
<li >
    <a href="../../ujvm/ch5/">Chapter 5 : 调优案例分析与实战</a>
</li>
                            
<li >
    <a href="../../ujvm/ch6/">Chapter 6 : 类文件结构</a>
</li>
                            
<li >
    <a href="../../ujvm/ch7/">Chapter 7 : 虚拟机类加载机制</a>
</li>
                            
<li >
    <a href="../../ujvm/ch8/">Chapter 8 : 虚拟机字节码执行引擎</a>
</li>
                            
<li >
    <a href="../../ujvm/ch9/">Chapter 9 : 类加载及执行子系统的案例与实战</a>
</li>
                            
<li >
    <a href="../../ujvm/ch10/">Chapter 10 : 早期(编译期)优化</a>
</li>
                            
<li >
    <a href="../../ujvm/ch11/">Chapter 11 : 晚期(运行期)优化</a>
</li>
                            
<li >
    <a href="../../ujvm/ch12/">Chapter 12 : Java内存模型与线程</a>
</li>
                            
<li >
    <a href="../../ujvm/ch13/">Chapter 13 : 线程安全与锁优化</a>
</li>
                            
<li >
    <a href="../../ujvm/AppendixC/">Appendix HotSpot虚拟机主要参数列表</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../books/">Books</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../ch2/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../ch4/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#operating-system-concepts-3-processes">Operating System Concepts 3 - Processes</a></li>
        <li class="main "><a href="#1-process-concept">1 Process concept</a></li>
            <li><a href="#the-process">The process</a></li>
            <li><a href="#process-state">Process state</a></li>
            <li><a href="#process-control-block">Process control block</a></li>
        <li class="main "><a href="#2-process-scheduling">2 Process scheduling</a></li>
            <li><a href="#scheduling-queues">Scheduling Queues</a></li>
            <li><a href="#context-switch">Context Switch</a></li>
        <li class="main "><a href="#3-operating-on-processes">3 Operating on Processes</a></li>
            <li><a href="#process-creation">Process creation</a></li>
            <li><a href="#process-termination">Process termination</a></li>
        <li class="main "><a href="#4-interprocess-communication">4 Interprocess communication</a></li>
        <li class="main "><a href="#5-ipc-in-shared-memory-system">5 IPC in shared-memory system</a></li>
        <li class="main "><a href="#6-ipc-in-message-passing-system">6 IPC in message-passing system</a></li>
            <li><a href="#directindirect-communication">Direct/Indirect communication</a></li>
            <li><a href="#synchronization">Synchronization</a></li>
            <li><a href="#buffering">Buffering</a></li>
        <li class="main "><a href="#7-examples-of-ipc-systems">7 Examples of IPC Systems</a></li>
            <li><a href="#posix-shared-memory">POSIX Shared Memory</a></li>
            <li><a href="#mach-message-passing">Mach Message Passing</a></li>
            <li><a href="#pipes">Pipes</a></li>
            <li><a href="#ordinary-pipes">Ordinary pipes</a></li>
            <li><a href="#named-pipes">Named pipes</a></li>
        <li class="main "><a href="#8-communication-in-client-server-system">8 Communication in Client-Server system</a></li>
            <li><a href="#sockets">Sockets</a></li>
            <li><a href="#remote-procedure-calls">Remote procedure calls</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="operating-system-concepts-3-processes"><strong>Operating System Concepts 3 - Processes</strong><a class="headerlink" href="#operating-system-concepts-3-processes" title="Permanent link">&para;</a></h3>
<h3 id="1-process-concept">1 Process concept<a class="headerlink" href="#1-process-concept" title="Permanent link">&para;</a></h3>
<h4 id="the-process">The process<a class="headerlink" href="#the-process" title="Permanent link">&para;</a></h4>
<p><strong>Process</strong> (进程) is a program in execution.</p>
<ul>
<li>Process is the unit of work in a modern computing system.</li>
</ul>
<p>The status of the <strong>current</strong> activity of a process is represented by the value of the <strong>program counter</strong> and the contents of the processor's <strong>registers</strong>.</p>
<p>A program by itself is not a process.</p>
<ul>
<li>A program is a <strong>passive</strong> entity, such as a file containing a list of instructions stored on disk.</li>
<li>A process is an <strong>active</strong> entity, with a program counter specifying the next instruction to execute.</li>
</ul>
<h4 id="process-state">Process state<a class="headerlink" href="#process-state" title="Permanent link">&para;</a></h4>
<p>A process may be in one of the following states:</p>
<ul>
<li><strong>New</strong>(新建). The process is being created. 进程正在被创建</li>
<li><strong>Running</strong>(运行). Instructions are being executed. 指令正在被执行</li>
<li><strong>Waiting</strong>(等待). The process is waiting for some event to occur(such as an I/O completion or reception of a signal). 进程等待某些事件发生</li>
<li><strong>Ready</strong>(就绪). The process is waiting to be assigned to a processor.进程等待分配处理器</li>
<li><strong>Terminated</strong>(终止). The process has finished execution. 进程执行完毕</li>
</ul>
<p>Diagram of process state:</p>
<p><img alt="Diagram of process state" src="http://or9a8nskt.bkt.clouddn.com/diagramofprocessstate.png" /></p>
<h4 id="process-control-block">Process control block<a class="headerlink" href="#process-control-block" title="Permanent link">&para;</a></h4>
<p>Each process is represented by a <strong>process control block</strong>(PCB, 进程控制块), it contains</p>
<ul>
<li><strong>Process state</strong>(进程状态)</li>
<li><strong>Program counter</strong>(程序计数器)</li>
<li><strong>CPU registers</strong>(CPU寄存器)</li>
<li><strong>CPU-scheduling information</strong>(CPU调度信息): a process priority, pointers to scheduling queues, and any other scheduling parameters.</li>
<li><strong>Memory-management information</strong>(内存管理信息)</li>
<li><strong>Accounting information</strong>(记账信息): the amount of CPU and real time used, time limits, account numbers, process numbers and so on.</li>
<li><strong>I/O status information</strong>(I/O状态信息): the list of I/O devices allocated to the process, a list of open files.</li>
</ul>
<p>Process Control Block:</p>
<p><img alt="process control block" src="http://or9a8nskt.bkt.clouddn.com/processcontrolblock.png" /></p>
<p>The process control block in Linux is represented by the C structure <code class="codehilite">task_struct</code> ('include/linux/sched.h')， <a href="https://elixir.bootlin.com/linux/latest/source/include/linux/sched.h#L592">CODE LINK</a></p>
<ul>
<li>Within the Linux kernel, all active processes are represented using a <strong>doubly linked list</strong> of task struct.</li>
</ul>
<p><code class="codehilite">Task_strut</code>:</p>
<p><img alt="task_strcut in Linux" src="http://or9a8nskt.bkt.clouddn.com/task_strcutinLinux.png" /></p>
<h3 id="2-process-scheduling">2 Process scheduling<a class="headerlink" href="#2-process-scheduling" title="Permanent link">&para;</a></h3>
<p>The <strong>process scheduler</strong>(进程调度程序) selects an available process for program execution on a core.</p>
<ul>
<li>Each CPU core can run one process at a time.</li>
<li>The number of processes currently in memory is known as the <strong>degree of multiprogramming</strong>.</li>
</ul>
<h4 id="scheduling-queues">Scheduling Queues<a class="headerlink" href="#scheduling-queues" title="Permanent link">&para;</a></h4>
<p><strong>Ready queue</strong>(就绪队列): the status of processes are ready.
* generally stored as a linked list, its header contains pointers to the first PCB in the list, each PCB includes a pointer field that points to next PCB in the ready queue.</p>
<p><strong>Wait Queue</strong>(等待队列): the status of processes are waiting.</p>
<p>Queueing-diagram representation of process scheduling: </p>
<p><img alt="Queueing-diagram representation of process scheduling" src="http://or9a8nskt.bkt.clouddn.com/Queueing-diagram_epresentation_of_process_scheduling.png" /></p>
<h4 id="context-switch">Context Switch<a class="headerlink" href="#context-switch" title="Permanent link">&para;</a></h4>
<p>Here the <strong><em>context</em></strong> of a process is represented in the PCB of the process, including the value of the CPU registers, the process state, and memory-management information.</p>
<p>An operating system performs a <strong>context switch</strong>（上下文切换) when it switches from running one process to running another.</p>
<ul>
<li>The kernel <strong>saves</strong> the context of the old process into its PCB and <strong>restore</strong> the saved context of the new process scheduled to run.</li>
<li>Context-switch time is overhead; the system does no useful work while switching. <ul>
<li>A typical speed is a several microseconds. </li>
</ul>
</li>
<li>Context-switch times are <strong>highly</strong> dependent on hardware support.</li>
</ul>
<p>Context switch from an old process to a new process:</p>
<p><img alt="context_switch" src="http://or9a8nskt.bkt.clouddn.com/context_switch.png" /></p>
<h3 id="3-operating-on-processes">3 Operating on Processes<a class="headerlink" href="#3-operating-on-processes" title="Permanent link">&para;</a></h3>
<h4 id="process-creation">Process creation<a class="headerlink" href="#process-creation" title="Permanent link">&para;</a></h4>
<p>A process may <strong>create</strong> several new processes.</p>
<ul>
<li>the creating process is called a <strong>parent process</strong>.</li>
<li>the new process is called a <strong>child process</strong> .</li>
</ul>
<p><img alt="process creating using the fork-- system cal" src="http://or9a8nskt.bkt.clouddn.com/process_creating_using_the_fork_system_call.png" /></p>
<h4 id="process-termination">Process termination<a class="headerlink" href="#process-termination" title="Permanent link">&para;</a></h4>
<p>A process <strong>terminates</strong> when it finishes executing its final statement and asks the operating system to delete it by using the <code class="codehilite">exit()</code> system call.</p>
<ul>
<li><strong>cascading termination</strong>(级联终止):  if a process terminates (either normally or abnormally), then all its children must also be terminated. </li>
<li>A process that has terminated, but whose parent has not yet called <code class="codehilite">wait()</code>, is known as a <strong>zombie process</strong>(僵尸进程).</li>
<li>if a parent did not invoke <code class="codehilite">wait()</code> and instead terminated, then leaving its child processes as <strong>orphan processes</strong>(孤儿进程).<ul>
<li>Unix system may assign the <code class="codehilite">init</code> process as the new parent to orphan processes, and the <code class="codehilite">init</code> process periodically invokes <code class="codehilite">wait()</code>.</li>
</ul>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>A problem with a single process for a web browser is that if a web application in any tab crashes, the entire process —— including all other tabs —— crashes as well. Chrome web browser uses a multiprocess architecture —— identifies three different types of processes: browser, renderers, plugins. see <a href="https://blog.chromium.org/2008/09/multi-process-architecture.html">here</a> in detail.</p>
</div>
<h3 id="4-interprocess-communication">4 Interprocess communication<a class="headerlink" href="#4-interprocess-communication" title="Permanent link">&para;</a></h3>
<p>Processes may be either <strong>independent processes</strong>(独立进程) or <strong>cooperating processes</strong>(协同进程).</p>
<ul>
<li>A process is <strong><em>independent</em></strong> if it does not share data with any other processes executing in the system.</li>
<li>A process is <strong><em>cooperating</em></strong> if it can affect or be affected by the other processes executing in the system.</li>
</ul>
<p>Advantages of  process cooperation:</p>
<ul>
<li>Information sharing </li>
<li>Computation speedup </li>
<li>Modularity </li>
</ul>
<p>Cooperating process require an <strong>interprocess communication</strong> (IPC，进程间通信) mechanism that will allow them to <strong>exchange</strong> data. There are two fundamental models of IPC:</p>
<ul>
<li><strong>shared memory</strong>(共享内存): a region of memory is shared by cooperating process. Process can exchange information by reading and writing data to the shared region.<ul>
<li>Shared memory can be <strong>faster</strong> than message passing.</li>
</ul>
</li>
<li><strong>message passing</strong>(消息传递)： communication takes place by means of messages exchanged between the cooperating processes.<ul>
<li>Message passing is useful for exchanging <strong>smaller</strong> amounts of data, because no conflicts need be avoided.</li>
<li>Message passing is easier to implement in a distributed system than shared memory.</li>
</ul>
</li>
</ul>
<p><img alt="shared_memory_and_message_passing" src="../figures/shared_memory_and_message_passing.png" /></p>
<h3 id="5-ipc-in-shared-memory-system">5 IPC in shared-memory system<a class="headerlink" href="#5-ipc-in-shared-memory-system" title="Permanent link">&para;</a></h3>
<p>Let's consider the producer-consumer problem, which is a common paradigm for cooperating processes. A <em>producer</em> process produces information that is <em>consumed</em> by a consumer process.  One solution to the producer-consumer problem uses shared memory.</p>
<p>We generally think of a server as a producer and a client as a consumer. For example, a web server produces web content such as HTML files and images, which are consumed by the client web browser requesting the resource.</p>
<p>Two types of buffers can be used.</p>
<ul>
<li><strong>unbounded buffer</strong>(无界缓冲): places no practical limit on the size of the buffer.</li>
<li><strong>bounded buffer</strong>(有界缓冲): assumes a fixed buffer size</li>
</ul>
<h3 id="6-ipc-in-message-passing-system">6 IPC in message-passing system<a class="headerlink" href="#6-ipc-in-message-passing-system" title="Permanent link">&para;</a></h3>
<p>A message-passing facility provides at least two operations:</p>
<ul>
<li>send(message)</li>
<li>receive(message)</li>
</ul>
<p>If P and Q wish to communicate, they need to</p>
<ul>
<li>establish a <strong>communication link</strong>(通信连接) between them</li>
<li>exchange messages via send/receive </li>
</ul>
<p>Here are several methods for logically implementing a <em>communication link</em> between processes:</p>
<ul>
<li>Direct or indirect communication 直接/间接通信</li>
<li>Synchronous or asynchronous communication 同步/异步同步</li>
<li>Automatic or explicit buffering 自动/显式缓冲</li>
</ul>
<h4 id="directindirect-communication">Direct/Indirect communication<a class="headerlink" href="#directindirect-communication" title="Permanent link">&para;</a></h4>
<p><font color="green"><big>Direct Communication</big></font></p>
<p>Under <strong>direct communication</strong>, each process that wants to communicate must explicitly name the recipient or sender of the communication.</p>
<ul>
<li>send(P, message) - send a message to process P.</li>
<li>receive(Q, message) - receive a message from process Q</li>
</ul>
<p>A communication link in this scheme has the following properties:</p>
<ul>
<li>A link is established <strong>automatically</strong> between every pair of processes that want to communicate.</li>
<li>A link is associated with <strong>exactly two</strong> processes.</li>
<li>Between each pair of processes, there exists exactly one link.</li>
</ul>
<p>Cons:</p>
<ul>
<li>limited modularity of the resulting process definitions. Changing the identifier of a process may necessitate examining all other process definitions.</li>
<li>any such hard-coding techniques, are less desirable.</li>
</ul>
<p><font color="green"><big>Indirect Communication</big></font></p>
<p>With <strong>indirect communication</strong>, the message are sent to and receive from <strong>mailboxes</strong>, or <strong>ports</strong>.</p>
<ul>
<li>send(A, message) - send a message to mailbox A</li>
<li>receive(A, message) - receive a message from mailbox A</li>
</ul>
<p>A mailbox can be viewed abstractly as an object into which messages can be placed by processes and from which messages can be removed.</p>
<ul>
<li>Each mailbox has an <strong>unique</strong> identification.</li>
<li>Two processes can communicate only if they have a shared mailbox.</li>
</ul>
<p>In this scheme, a communication link has the following properties:</p>
<ul>
<li>A link is established between a pair of processes only if both members of the pair have a shared mailbox.</li>
<li>A link may be associated with more than two processes.</li>
<li>Between each pair of communicating processes, a number of different links may exist, with each link corresponding to one mailbox.</li>
</ul>
<p>A mailbox may be owned either by a process or by the operating system.</p>
<p>If the mailbox is owned by a process
<em> We distinguish between the <strong>owner</strong> (which can only receive messages through his mailbox) and the <strong>user</strong> (which can only send messages to the mailbox)
</em> Each mailbox has a unique owner.
<em> When a process that owns a mailbox terminates, the mailbox disappears.
</em> The process that creates a new mailbox is that mailbox's owner by default.</p>
<h4 id="synchronization">Synchronization<a class="headerlink" href="#synchronization" title="Permanent link">&para;</a></h4>
<p>Message passing may be either <strong>blocking</strong> or <strong>nonblocking</strong> - also known as <strong>synchronous</strong> and <strong>asynchronous</strong>.</p>
<h4 id="buffering">Buffering<a class="headerlink" href="#buffering" title="Permanent link">&para;</a></h4>
<p>Messages exchanged by communicating processes reside in a temporary queue, whether communication is direct or indirect. Basically, it can be implemented in three ways:</p>
<ul>
<li>Zero capacity（零容量）-- no buffering<ul>
<li>The link cannot have any messages waiting in it.</li>
<li>The sender must block until the recipient receives the message. </li>
</ul>
</li>
<li>Bounded capacity（有界容量）-- automatic buffering<ul>
<li>The queue has finite length n, at most n message can reside in it.   </li>
<li>The sender must block until space is available in the queue if the link is full.    </li>
</ul>
</li>
<li>Unbounded capacity （无界容量） -- automatic buffering<ul>
<li>Any number of messages can wait in it.</li>
<li>The sender never blocks. </li>
</ul>
</li>
</ul>
<h3 id="7-examples-of-ipc-systems">7 Examples of IPC Systems<a class="headerlink" href="#7-examples-of-ipc-systems" title="Permanent link">&para;</a></h3>
<h4 id="posix-shared-memory">POSIX Shared Memory<a class="headerlink" href="#posix-shared-memory" title="Permanent link">&para;</a></h4>
<p>Here, we explore the POSIX API for shared memory. POSIX shared memory is organized using <strong>memory-mapped files</strong> (内存映射文件), which associate the region of shared memory with a file. A process must first create a shared-memory object using the <code class="codehilite">shm_open()</code> system call.</p>
<p> <div class=codehilite><pre><span class=n>fd</span> <span class=o>=</span> <span class=n>shm_open</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>O_CREAT</span> <span class=o>|</span> <span class=n>O_RDWR</span><span class=p>,</span> <span class=mo>0666</span><span class=p>);</span>
<span class=n>ftruncate</span><span class=p>(</span><span class=n>fd</span><span class=p>,</span> <span class=mi>4096</span><span class=p>);</span>
<span class=n>mmap</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>SIZE</span><span class=p>,</span> <span class=n>PROT_READ</span> <span class=o>|</span> <span class=n>PROT_WRITE</span><span class=p>,</span> <span class=n>MAP_SHARED</span><span class=p>,</span> <span class=n>fd</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</pre></div></p>
<ul>
<li>A successful call to <code class="codehilite">shm_open()</code> returns an integer file descriptor for the shared-memory object.</li>
<li>Once the object is established, the <code class="codehilite">ftruncate()</code> function is used to configure the size of the object in bytes.</li>
<li>Finally, the <code class="codehilite">mmap()</code> function establishes a memory-mapped file containing the shared-memory object. It returns a pointer to the shared</li>
</ul>
<p> <div class=codehilite><pre><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;sys/shm.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;sys/stat.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;sys/mman.h&gt;</span><span class=cp></span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;OS&quot;</span><span class=p>;</span>
    <span class=k>const</span> <span class=kt>int</span> <span class=n>SIZE</span> <span class=o>=</span> <span class=mi>4096</span><span class=p>;</span>

    <span class=kt>int</span> <span class=n>shm_fd</span><span class=p>;</span>
    <span class=kt>void</span> <span class=o>*</span><span class=n>ptr</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>

    <span class=cm>/* open the shared memory segment */</span>
    <span class=n>shm_fd</span> <span class=o>=</span> <span class=n>shm_open</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>O_RDONLY</span><span class=p>,</span> <span class=mo>0666</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>shm_fd</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&quot;shared memory failed</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
        <span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=cm>/* now map the shared memory segment in the address space of the process */</span>
    <span class=n>ptr</span> <span class=o>=</span> <span class=n>mmap</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>SIZE</span><span class=p>,</span> <span class=n>PROT_READ</span><span class=p>,</span> <span class=n>MAP_SHARED</span><span class=p>,</span> <span class=n>shm_fd</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>ptr</span> <span class=o>==</span> <span class=n>MAP_FAILED</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&quot;Map failed</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
        <span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=cm>/* now read from the shared memory region */</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;%s&quot;</span><span class=p>,(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>ptr</span><span class=p>);</span>

    <span class=cm>/* remove the shared memory segment */</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>shm_unlink</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>printf</span><span class=p>(</span><span class=s>&quot;Error removing %s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>name</span><span class=p>);</span>
        <span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</pre></div></p>
<h4 id="mach-message-passing">Mach Message Passing<a class="headerlink" href="#mach-message-passing" title="Permanent link">&para;</a></h4>
<p>Mach was especially designed for distributed systems. Its kernel supports the creation and destruction of multiple <strong>tasks</strong>, which are similar to processes but have multiple threads of control and fewer associated resources.  </p>
<p>Messages are sent to, and received from, mailboxes, which are called <strong>ports</strong> in Mach. </p>
<ul>
<li>Ports are <strong>finite in size</strong> and <strong>unidirectional</strong>.</li>
<li>For two-way communication, a message is sent to one port, and a response is sent to a separate <strong>reply</strong> port.</li>
<li>Associated with each port is a collection of <strong>port rights</strong>, which  identify the capabilities necessary for a task to interact with the port.</li>
</ul>
<p>Functions:</p>
<ul>
<li><code class="codehilite">mach_port_allocate()</code> creates a new port and allocates space for its queue of messages.</li>
<li><code class="codehilite">mach_msg()</code> is the standard API for both sending and receiving messages.</li>
</ul>
<p> <div class=codehilite><pre><span class=cp>#include</span> <span class=cpf>&lt;mach/mach.h&gt;</span><span class=cp></span>

<span class=k>struct</span> <span class=n>message</span> <span class=p>{</span>
    <span class=n>mach_msg_header_t</span> <span class=n>header</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>data</span><span class=p>;</span>
<span class=p>};</span>

<span class=n>mach_port_t</span> <span class=n>client</span><span class=p>;</span>
<span class=n>mach_port_t</span> <span class=n>server</span><span class=p>;</span>

<span class=cm>/* Client Code */</span>

<span class=k>struct</span> <span class=n>message</span> <span class=n>message</span><span class=p>;</span>

<span class=c1>// construct the header</span>
<span class=n>message</span><span class=p>.</span><span class=n>header</span><span class=p>.</span><span class=n>msgh_size</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>message</span><span class=p>);</span>
<span class=n>message</span><span class=p>.</span><span class=n>header</span><span class=p>.</span><span class=n>msgh_remote_port</span> <span class=o>=</span> <span class=n>server</span><span class=p>;</span>
<span class=n>message</span><span class=p>.</span><span class=n>header</span><span class=p>.</span><span class=n>msgh_local_port</span> <span class=o>=</span> <span class=n>client</span><span class=p>;</span>

<span class=c1>// send the message</span>
<span class=n>mach</span> <span class=nf>msg</span><span class=p>(</span><span class=o>&amp;</span><span class=n>message</span><span class=p>.</span><span class=n>header</span><span class=p>,</span> <span class=c1>// message header</span>
         <span class=n>MACH_SEND_MSG</span><span class=p>,</span> <span class=c1>// sending a message</span>
         <span class=k>sizeof</span><span class=p>(</span><span class=n>message</span><span class=p>),</span> <span class=c1>// size of message sent</span>
         <span class=mi>0</span><span class=p>,</span> <span class=c1>// maximum size of received message - unnecessary</span>
         <span class=n>MACH_PORT_NULL</span><span class=p>,</span> <span class=c1>// name of receive port - unnecessary</span>
         <span class=n>MACH_MSG_TIMEOUT_NONE</span><span class=p>,</span> <span class=c1>// no time outs MACH PORT NULL // no notify port</span>
<span class=p>);</span>

<span class=cm>/* Server Code */</span>

<span class=k>struct</span> <span class=n>message</span> <span class=n>message</span><span class=p>;</span>

<span class=c1>// receive the message</span>
<span class=n>mach_msg</span><span class=p>(</span><span class=o>&amp;</span><span class=n>message</span><span class=p>.</span><span class=n>header</span><span class=p>,</span> <span class=c1>// message header</span>
  <span class=n>MACH_RCV_MSG</span><span class=p>,</span> <span class=c1>// sending a message  0, // size of message sent</span>
  <span class=k>sizeof</span><span class=p>(</span><span class=n>message</span><span class=p>),</span> <span class=c1>// maximum size of received message</span>
  <span class=n>server</span><span class=p>,</span> <span class=c1>// name of receive port</span>
  <span class=n>MACH_MSG_TIMEOUT_NONE</span><span class=p>,</span> <span class=c1>// no time outs</span>
  <span class=n>MACH_PORT_NULL</span> <span class=c1>// no notify port</span>
<span class=p>);</span>
</pre></div></p>
<h4 id="pipes">Pipes<a class="headerlink" href="#pipes" title="Permanent link">&para;</a></h4>
<p>A <strong>pipe</strong> acts as a conduit allowing two processes to communicate. Pipes were one of the first IPC mechanisms in early UNIX systems. There are two common types of pipes used on both UNIX and Windows systems: <strong>ordinary pipes</strong> and <strong>named pipes</strong>.</p>
<h4 id="ordinary-pipes">Ordinary pipes<a class="headerlink" href="#ordinary-pipes" title="Permanent link">&para;</a></h4>
<p><strong>Ordinary pipes</strong> allow two processes to communicate in standard producer-consumer fashion: the producer writes to one end of the pipe (the <strong>write end</strong>) and the consumer reads from the other end (the <strong>read end</strong>).</p>
<ul>
<li>Ordinary pipes are <strong>unidirectional</strong>, allowing only one-way communication.</li>
<li>Function <code class="codehilite">pipe(int fd[])</code> constructs an ordinary pipe, where <code class="codehilite">fd</code> is a file descriptor.</li>
<li>UNIX treats a pipe as <em>a special type of file</em>. Pipes can be accessed using ordinary <code class="codehilite">read()</code> and <code class="codehilite">write()</code> system calls.</li>
<li>Ordinary pipes <strong>exit only</strong> while the processes are communicating with each other.</li>
</ul>
<p><img alt="file_descriptors_for_an_ordinary_pipes" src="../figures/file_descriptors_for_an_ordinary_pipes.png" /></p>
<blockquote>
<p><C>int pipe(int pipefd[2])</C> creates a pipe, a unidirectional data channel that can be used for interprocess communication. The array <C>pipefd</C> is used to return two file descriptors referring to the ends of the pipe. <C>pipefd[0]</C> refers to the read end of the pipe. <C>pipefd[1]</C> refers to the write end of the pipe. Data written to the write end of the pipe is buffered by the kernel until it is read from the read end of the pipe.  [<a href="https://kapeli.com/dash_share?docset_file=Linux&amp;docset_name=Linux%20Man%20Pages&amp;path=man2/pipe.2.html&amp;platform=usercontribLinux_Man_Pages&amp;repo=User%20Contributed">Man Page - PIPE</a>]</p>
</blockquote>
<p> <div class=codehilite><pre><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp></span>
<span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp></span>

<span class=cp>#define BUFFER_SIZE 25</span>
<span class=cp>#define READ_END 0</span>
<span class=cp>#define WRITE_END 1</span>

<span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
<span class=p>{</span>
        <span class=kt>char</span> <span class=n>write_msg</span><span class=p>[</span><span class=n>BUFFER_SIZE</span><span class=p>]</span> <span class=o>=</span> <span class=s>&quot;Greetings&quot;</span><span class=p>;</span>
        <span class=kt>char</span> <span class=n>read_msg</span><span class=p>[</span><span class=n>BUFFER_SIZE</span><span class=p>];</span>
        <span class=kt>int</span> <span class=n>pipefd</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
        <span class=kt>pid_t</span> <span class=n>pid</span><span class=p>;</span>

        <span class=cm>/* create the pipe */</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>pipe</span><span class=p>(</span><span class=n>pipefd</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>){</span>
                <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&quot;Pipe failed&quot;</span><span class=p>);</span>
                <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=cm>/* fork a child process */</span>
        <span class=n>pid</span> <span class=o>=</span> <span class=n>fork</span><span class=p>();</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>pid</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>){</span> <span class=cm>/* parent process */</span>
                <span class=n>close</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>READ_END</span><span class=p>]);</span><span class=cm>/* close the unused end of the pipe */</span>
                <span class=n>write</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>WRITE_END</span><span class=p>],</span> <span class=n>write_msg</span><span class=p>,</span> <span class=n>strlen</span><span class=p>(</span><span class=n>write_msg</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span> <span class=cm>/* write to the pipe */</span>
                <span class=n>close</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>WRITE_END</span><span class=p>]);</span>  <span class=cm>/* close the write end of the pipe */</span>
        <span class=p>}</span>
        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>pid</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span> <span class=cm>/* child process */</span>
                <span class=n>close</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>WRITE_END</span><span class=p>]);</span> <span class=cm>/* close the unused end of the pipe */</span>
                <span class=n>read</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>READ_END</span><span class=p>],</span> <span class=n>read_msg</span><span class=p>,</span> <span class=n>BUFFER_SIZE</span><span class=p>);</span> <span class=cm>/* read from the pipe */</span>
                <span class=n>printf</span><span class=p>(</span><span class=s>&quot;read: %s</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>read_msg</span><span class=p>);</span>
                <span class=n>close</span><span class=p>(</span><span class=n>pipefd</span><span class=p>[</span><span class=n>READ_END</span><span class=p>]);</span> <span class=cm>/* close the read end of the pipe */</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>

<span class=p>}</span>
</pre></div></p>
<h4 id="named-pipes">Named pipes<a class="headerlink" href="#named-pipes" title="Permanent link">&para;</a></h4>
<p><strong>Named pipes</strong>(命名管道) can be <strong>bidirectional</strong>, and no parent-child relationship is required.</p>
<ul>
<li>Named pipes are referred to as <strong>FIFOs</strong> in UNIX system.</li>
<li>Once created, they appear as typical files in the file system.</li>
<li>The communicating processes for named pipes must reside on the same machine.</li>
</ul>
<p>A FIFO is created with the <code class="codehilite">mkfifo()</code> system call and manipulated with the ordinary <code class="codehilite">open()</code>, <code class="codehilite">read()</code>, <code class="codehilite">write()</code>, and <code class="codehilite">close</code> system calls.：</p>
<p> <div class=codehilite><pre><span class=kt>int</span> <span class=nf>mkfifo</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>pathname</span><span class=p>,</span> <span class=kt>mode_t</span> <span class=n>mode</span><span class=p>);</span>
</pre></div></p>
<blockquote>
<p><C>mkfifo()</C> makes a FIFO special file with name <C>pathname</C>. <C>mode</C> specifies the FIFO's permissions. It is modified by the process's umask in the usual way: the permissions of the created file are (<C>mode &amp; ~umask</C>). [<a href="https://kapeli.com/dash_share?docset_file=Linux&amp;docset_name=Linux%20Man%20Pages&amp;path=man3/mkfifo.3.html&amp;platform=usercontribLinux_Man_Pages&amp;repo=User%20Contributed">Man Page - mkfifo</a>]</p>
</blockquote>
<p>The program <code class="codehilite">fifowrite.c</code> is as follows.</p>
<p> <div class=codehilite><pre><span class=cp>#include</span><span class=cpf>&lt;sys/types.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;fcntl.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;limits.h&gt;</span><span class=cp></span>
<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>fifo_name</span> <span class=o>=</span> <span class=s>&quot;/tmp/my_fifo&quot;</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>pipe_fd</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>data_fd</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=k>const</span> <span class=kt>int</span> <span class=n>open_mode</span> <span class=o>=</span> <span class=n>O_WRONLY</span><span class=p>;</span>
    <span class=kt>char</span> <span class=n>buffer</span><span class=p>[</span><span class=n>PIPE_BUF</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
    <span class=k>if</span><span class=p>(</span><span class=n>access</span><span class=p>(</span><span class=n>fifo_name</span><span class=p>,</span> <span class=n>F_OK</span><span class=p>)</span><span class=o>==-</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>res</span> <span class=o>=</span> <span class=n>mkfifo</span><span class=p>(</span><span class=n>fifo_name</span><span class=p>,</span><span class=mo>0777</span><span class=p>);</span>
        <span class=k>if</span><span class=p>(</span><span class=n>res</span><span class=o>!=</span><span class=mi>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=s>&quot;could not create fifo</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
            <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d opening fifo O_WRONLY</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>getpid</span><span class=p>());</span>
    <span class=n>pipe_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>fifo_name</span><span class=p>,</span> <span class=n>open_mode</span><span class=p>);</span>
    <span class=n>data_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=s>&quot;data.txt&quot;</span><span class=p>,</span> <span class=n>O_RDONLY</span><span class=p>);</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d result %d</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>getpid</span><span class=p>(),</span> <span class=n>pipe_fd</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>pipe_fd</span><span class=o>!=-</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=kt>int</span> <span class=n>bytes_read</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=n>bytes_read</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>data_fd</span><span class=p>,</span><span class=n>buffer</span><span class=p>,</span><span class=n>PIPE_BUF</span><span class=p>);</span>
        <span class=k>while</span> <span class=p>(</span><span class=n>bytes_read</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>write</span><span class=p>(</span><span class=n>pipe_fd</span><span class=p>,</span><span class=n>buffer</span><span class=p>,</span><span class=n>bytes_read</span><span class=p>);</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>res</span><span class=o>==-</span><span class=mi>1</span><span class=p>)</span>
            <span class=p>{</span>
                <span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=s>&quot;write error</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
                <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
            <span class=p>}</span>
            <span class=n>bytes_read</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>data_fd</span><span class=p>,</span><span class=n>buffer</span><span class=p>,</span><span class=n>PIPE_BUF</span><span class=p>);</span>
            <span class=n>buffer</span><span class=p>[</span><span class=n>bytes_read</span><span class=p>]</span><span class=o>=</span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>close</span><span class=p>(</span><span class=n>pipe_fd</span><span class=p>);</span>
        <span class=n>close</span><span class=p>(</span><span class=n>data_fd</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=k>else</span> <span class=p>{</span>
        <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d finished.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>getpid</span><span class=p>());</span>
    <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_SUCCESS</span><span class=p>);</span>
<span class=p>}</span>
</pre></div></p>
<p>the program <code class="codehilite">fiforead.c</code> is as follows.</p>
<p> <div class=codehilite><pre><span class=cp>#include</span><span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;sys/types.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;fcntl.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=cpf>&lt;limits.h&gt;</span><span class=cp></span>
<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>fifo_name</span> <span class=o>=</span> <span class=s>&quot;/tmp/my_fifo&quot;</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>pipe_fd</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>data_fd</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>open_mode</span> <span class=o>=</span> <span class=n>O_RDONLY</span><span class=p>;</span>
    <span class=kt>char</span> <span class=n>buffer</span><span class=p>[</span><span class=n>PIPE_BUF</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
    <span class=kt>int</span> <span class=n>bytes_read</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=kt>int</span> <span class=n>bytes_write</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
    <span class=n>memset</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=sc>&#39;\0&#39;</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>buffer</span><span class=p>));</span>

    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d opening FIFO O_RDONLY</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>getpid</span><span class=p>());</span>
    <span class=n>pipe_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>fifo_name</span><span class=p>,</span> <span class=n>open_mode</span><span class=p>);</span>
    <span class=n>data_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=s>&quot;dataformfifo.txt&quot;</span><span class=p>,</span> <span class=n>O_WRONLY</span><span class=o>|</span><span class=n>O_CREAT</span><span class=p>,</span><span class=mo>0644</span><span class=p>);</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d result %d</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>getpid</span><span class=p>(),</span> <span class=n>pipe_fd</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>pipe_fd</span><span class=o>!=-</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>do</span><span class=p>{</span>
            <span class=n>res</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>pipe_fd</span><span class=p>,</span> <span class=n>buffer</span><span class=p>,</span> <span class=n>PIPE_BUF</span><span class=p>);</span>
            <span class=n>bytes_write</span> <span class=o>=</span> <span class=n>write</span><span class=p>(</span><span class=n>data_fd</span><span class=p>,</span> <span class=n>buffer</span><span class=p>,</span> <span class=n>res</span><span class=p>);</span>
            <span class=n>bytes_read</span> <span class=o>+=</span><span class=n>res</span><span class=p>;</span>
        <span class=p>}</span> <span class=k>while</span><span class=p>(</span><span class=n>res</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>);</span>
        <span class=n>close</span><span class=p>(</span><span class=n>pipe_fd</span><span class=p>);</span>
        <span class=n>close</span><span class=p>(</span><span class=n>data_fd</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=k>else</span> <span class=p>{</span>
        <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&quot;process %d finished,%d bytes read</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span> <span class=n>getpid</span><span class=p>(),</span> <span class=n>bytes_read</span><span class=p>);</span>
    <span class=n>exit</span><span class=p>(</span><span class=n>EXIT_SUCCESS</span><span class=p>);</span>
<span class=p>}</span>
</pre></div></p>
<h3 id="8-communication-in-client-server-system">8 Communication in Client-Server system<a class="headerlink" href="#8-communication-in-client-server-system" title="Permanent link">&para;</a></h3>
<p>In this section, we explore two other strategies for communication in client-server system: <strong>sockets</strong> and <strong>remote procedure calls</strong>(RPCs)</p>
<h4 id="sockets">Sockets<a class="headerlink" href="#sockets" title="Permanent link">&para;</a></h4>
<p>A <strong>socket</strong>(套接字) is defined as an <em>endpoint</em> for communication. A socket is identified by an <em>IP address concatenated with a port number</em>.</p>
<p>Communication using sockets：</p>
<p><img alt="communication_using_sockets" src="../figures/communication_using_sockets.png" /></p>
<p>Servers implementing specific services (such as SSH, FTP, and HTTP) listen to well-known ports. Once a request is received, the server accepts a connection from the client socket to complete the connection.</p>
<p>Java provides three different types of sockets. Connection-oriented(TCP) sockets are implemented with the <code class="codehilite">Socket</code> class. </p>
<p>The example describes a data server that uses connection-oriented TCP sockets. </p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>java.net.*</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>java.io.*</span><span class=o>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DateClient</span>
<span class=o>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span>  <span class=o>{</span>
        <span class=k>try</span> <span class=o>{</span>
            <span class=c1>// this could be changed to an IP name or address other than the localhost.</span>
            <span class=c1>// The IP address 127.0.0.1 is a special IP address known as the loopback. </span>
            <span class=c1>// When a computer refers to IP address 127.0.0.1, it is referring to itself.</span>
            <span class=c1>// This mechanism allows a client and server on the same host to communicate using the TCP/IP protocol.</span>
            <span class=n>Socket</span> <span class=n>sock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Socket</span><span class=o>(</span><span class=s>&quot;127.0.0.1&quot;</span><span class=o>,</span><span class=mi>6013</span><span class=o>);</span>
            <span class=n>InputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>();</span>
            <span class=n>BufferedReader</span> <span class=n>bin</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BufferedReader</span><span class=o>(</span><span class=k>new</span> <span class=n>InputStreamReader</span><span class=o>(</span><span class=n>in</span><span class=o>));</span>

            <span class=n>String</span> <span class=n>line</span><span class=o>;</span>
            <span class=k>while</span><span class=o>(</span> <span class=o>(</span><span class=n>line</span> <span class=o>=</span> <span class=n>bin</span><span class=o>.</span><span class=na>readLine</span><span class=o>())</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span>
                <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>line</span><span class=o>);</span>

            <span class=n>sock</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
        <span class=o>}</span>
        <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>ioe</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>ioe</span><span class=o>);</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DateServer</span>
<span class=o>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span>  <span class=o>{</span>
        <span class=k>try</span> <span class=o>{</span>
            <span class=n>ServerSocket</span> <span class=n>sock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ServerSocket</span><span class=o>(</span><span class=mi>6013</span><span class=o>);</span>

            <span class=c1>// now listen for connections</span>
            <span class=k>while</span> <span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>Socket</span> <span class=n>client</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=na>accept</span><span class=o>();</span>
                <span class=c1>// we have a connection</span>

                <span class=n>PrintWriter</span> <span class=n>pout</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PrintWriter</span><span class=o>(</span><span class=n>client</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>(),</span> <span class=kc>true</span><span class=o>);</span>
                <span class=c1>// write the Date to the socket</span>
                <span class=n>pout</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=k>new</span> <span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Date</span><span class=o>().</span><span class=na>toString</span><span class=o>());</span>

                <span class=c1>// close the socket and resume listening for more connections</span>
                <span class=n>client</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>
        <span class=k>catch</span> <span class=o>(</span><span class=n>IOException</span> <span class=n>ioe</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>ioe</span><span class=o>);</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></p>
<p>Communication using sockets—although <em>common</em> and <em>efficient</em> —— is considered a <em>low-level</em> form of communication between distributed processes. </p>
<ul>
<li>One reason is that sockets allow only an <em>unstructured</em> stream of bytes to be exchanged between the communicating threads. It is the responsibility of the client or server application to impose a structure on the data.</li>
</ul>
<h4 id="remote-procedure-calls">Remote procedure calls<a class="headerlink" href="#remote-procedure-calls" title="Permanent link">&para;</a></h4>
<p><strong>Remote Procedure Call</strong>(远程过程调用), One of the <em>most common</em> forms of remote service, allows programs on different machines to interact using simple procedure call/return semantics, just as if the two programs were in the same computer.</p>
<p>The messages exchanged in RPC communication are well structured and are thus no longer just packets of data. Each message is addressed to an RPC daemon listening to a port on the remote system, and each contains an identifier specifying the function to execute and the parameters to pass to that function.</p>
<p>The RPC system hides the details that allow communication to take place by providing a <strong>stub</strong>(存根) on each side. Typically, a separate stub exists for each separate remote procedure. </p>
<ul>
<li>When the client invokes a remote procedure, the RPC system calls the appropriate stub, passing it the parameters provided to the remote procedure. </li>
<li>This stub locates the port on the server and <strong>marshals</strong>(编组) the parameters. The stub then transmits a message to the server using message passing.</li>
<li>A similar stub on the server side receives this message and invokes the procedure on the server.</li>
<li>If necessary, return values are passed back to the client using the same technique.</li>
</ul>
<p><img alt="" src="../figures/rpc.jpg" /></p>
<p>RPC hides all the network code into the stub procedures. This prevents the application programs, the client and the server, from having to worry about details such as sockets, network byte order, and the like.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script src="../../extra_javascript/tabhack.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
