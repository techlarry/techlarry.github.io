



<!doctype html>
<html lang="zh" class="no-js">
  <head>

 <!-- 百度统计代码 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b6f62cca1f01c8c6a28628994476d789";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="en, jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.0">
    
    
      
        <title>面向程序员的数据挖掘指南</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Zhenhua's Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Zhenhua's Wiki
            </span>
            <span class="md-header-nav__topic">
              
                面向程序员的数据挖掘指南
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/techlarry/note/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../Algorithm/CS61B/" class="md-tabs__link">
          Algorithm
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Big Data/" class="md-tabs__link md-tabs__link--active">
          Data Science
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../Java/Effective Java/" class="md-tabs__link">
          Java
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Leetcode/1. Two Sum/" class="md-tabs__link">
          Leetcode
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Miscellaneous/Clion/" class="md-tabs__link">
          Miscellaneous
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../OS/Docker/" class="md-tabs__link">
          OS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Zhenhua's Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Zhenhua's Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/techlarry/note/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-1" type="checkbox" id="nav-1-1">
    
    <label class="md-nav__link" for="nav-1-1">
      CS61B
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-1">
        CS61B
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/CS61B/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/CS61B/Lab1/" title="Lab1" class="md-nav__link">
      Lab1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/CS61B/Lab2/" title="Lab2" class="md-nav__link">
      Lab2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/CS61B/Lab3/" title="Lab3" class="md-nav__link">
      Lab3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2">
    
    <label class="md-nav__link" for="nav-1-2">
      Princeton
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-2">
        Princeton
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 1 - Union Find/" title="Topic 1 - Union Find" class="md-nav__link">
      Topic 1 - Union Find
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 2 - Stacks and Queues/" title="Topic 2 - Stacks and Queues" class="md-nav__link">
      Topic 2 - Stacks and Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 3 - Sorting/" title="Topic 3 - Sorting" class="md-nav__link">
      Topic 3 - Sorting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 4 - Priority Queues/" title="Topic 4 - Priority Queues" class="md-nav__link">
      Topic 4 - Priority Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 5 - Symbol Tables/" title="Topic 5 - Symbol Tables" class="md-nav__link">
      Topic 5 - Symbol Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 6 - Balanced Search Trees/" title="Topic 6 - Balanced Search Trees" class="md-nav__link">
      Topic 6 - Balanced Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 7 - Hash Table/" title="Topic 7 - Hash Table" class="md-nav__link">
      Topic 7 - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 8 - Graph/" title="Topic 8 - Graph" class="md-nav__link">
      Topic 8 - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 9 - Minimum Spanning Tree and Shortest Path/" title="Topic 9 - Minimum Spanning Tree and Shortest Path" class="md-nav__link">
      Topic 9 - Minimum Spanning Tree and Shortest Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 11 - String Sort/" title="Topic 11 - String Sort" class="md-nav__link">
      Topic 11 - String Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Princeton/Topic 12 - Tries/" title="Topic 12 - Tries" class="md-nav__link">
      Topic 12 - Tries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3">
    
    <label class="md-nav__link" for="nav-1-3">
      Stanford
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        Stanford
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/Topic - Dynamic Programming/" title="Topic - Dynamic Programming" class="md-nav__link">
      Topic - Dynamic Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/Topic - Graph/" title="Topic - Graph" class="md-nav__link">
      Topic - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/Topic - Greedy Algorithm/" title="Topic - Greedy Algorithm" class="md-nav__link">
      Topic - Greedy Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/Topic - Hash Table/" title="Topic - Hash Table" class="md-nav__link">
      Topic - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/Stanford/Topic - Heap/" title="Topic - Heap" class="md-nav__link">
      Topic - Heap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4" type="checkbox" id="nav-1-4">
    
    <label class="md-nav__link" for="nav-1-4">
      剑指Offer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-4">
        剑指Offer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/solution/" title="solution" class="md-nav__link">
      solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/2 ⾯试需要的基础知识/" title="2 ⾯试需要的基础知识" class="md-nav__link">
      2 ⾯试需要的基础知识
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/3 高质量的代码/" title="3 高质量的代码" class="md-nav__link">
      3 高质量的代码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/4 解决面试题的思路/" title="4 解决面试题的思路" class="md-nav__link">
      4 解决面试题的思路
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/5 优化时间和空间效率/" title="5 优化时间和空间效率" class="md-nav__link">
      5 优化时间和空间效率
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/6 面试中的各项能力/" title="6 面试中的各项能力" class="md-nav__link">
      6 面试中的各项能力
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Algorithm/剑指Offer/7 两个面试案例/" title="7 两个面试案例" class="md-nav__link">
      7 两个面试案例
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Data Science
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Big Data/" title="Big Data" class="md-nav__link">
      Big Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Database
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Database
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/MySQL基础/" title="MySQL基础" class="md-nav__link">
      MySQL基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/Redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/SQL必知必会/" title="SQL必知必会" class="md-nav__link">
      SQL必知必会
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/数据仓库/" title="数据仓库" class="md-nav__link">
      数据仓库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database/高性能MySQL/" title="高性能MySQL" class="md-nav__link">
      高性能MySQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Database System Concepts/" title="Database System Concepts" class="md-nav__link">
      Database System Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Hadoop
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Hadoop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Avro/" title="Avro" class="md-nav__link">
      Avro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Elastic Stack/" title="Elastic Stack" class="md-nav__link">
      Elastic Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Flink/" title="Flink" class="md-nav__link">
      Flink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Flume/" title="Flume" class="md-nav__link">
      Flume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/HBase/" title="HBase" class="md-nav__link">
      HBase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Hadoop基础/" title="Hadoop基础" class="md-nav__link">
      Hadoop基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Hive/" title="Hive" class="md-nav__link">
      Hive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Spark权威指南/" title="Spark权威指南" class="md-nav__link">
      Spark权威指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/Sqoop/" title="Sqoop" class="md-nav__link">
      Sqoop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/ZooKeeper/" title="ZooKeeper" class="md-nav__link">
      ZooKeeper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/关于MapReduce/" title="关于MapReduce" class="md-nav__link">
      关于MapReduce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop/文件格式/" title="文件格式" class="md-nav__link">
      文件格式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hands On Machine Learning/" title="Hands On Machine Learning" class="md-nav__link">
      Hands On Machine Learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Machine Learning Coursera/" title="Machine Learning Coursera" class="md-nav__link">
      Machine Learning Coursera
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Practical Data Science
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Practical Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/Free text and natural language processing/" title="Free text and natural language processing" class="md-nav__link">
      Free text and natural language processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/Intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/Jupyter notebook/" title="Jupyter notebook" class="md-nav__link">
      Jupyter notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/Relational Data/" title="Relational Data" class="md-nav__link">
      Relational Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Practical Data Science/The data collection process/" title="The data collection process" class="md-nav__link">
      The data collection process
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8">
    
    <label class="md-nav__link" for="nav-2-8">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/Python引号/" title="Python引号" class="md-nav__link">
      Python引号
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/Python配置/" title="Python配置" class="md-nav__link">
      Python配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/Records/" title="Records" class="md-nav__link">
      Records
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/协程/" title="协程" class="md-nav__link">
      协程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/生成器与迭代器/" title="生成器与迭代器" class="md-nav__link">
      生成器与迭代器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/谈谈Python中的拷贝/" title="谈谈Python中的拷贝" class="md-nav__link">
      谈谈Python中的拷贝
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/闭包和装饰器/" title="闭包和装饰器" class="md-nav__link">
      闭包和装饰器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python机器学习基础教程/" title="Python机器学习基础教程" class="md-nav__link">
      Python机器学习基础教程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Scala
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Scala
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/Cheat Sheet/" title="Cheat Sheet" class="md-nav__link">
      Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/Sbt/" title="Sbt" class="md-nav__link">
      Sbt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/Scala编程/" title="Scala编程" class="md-nav__link">
      Scala编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/functional programming in scala/" title="functional programming in scala" class="md-nav__link">
      functional programming in scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/scala/" title="scala" class="md-nav__link">
      scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/慕课网Scala入门/" title="慕课网Scala入门" class="md-nav__link">
      慕课网Scala入门
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/第3章 从Java到Scala/" title="第3章 从Java到Scala" class="md-nav__link">
      第3章 从Java到Scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scala/第4章 处理对象/" title="第4章 处理对象" class="md-nav__link">
      第4章 处理对象
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Storm/" title="Storm" class="md-nav__link">
      Storm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-13" type="checkbox" id="nav-2-13">
    
    <label class="md-nav__link" for="nav-2-13">
      projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-13">
        projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../projects/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../projects/SparkStreaming实时流处理项目/" title="SparkStreaming实时流处理项目" class="md-nav__link">
      SparkStreaming实时流处理项目
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../projects/中文情感分析/" title="中文情感分析" class="md-nav__link">
      中文情感分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../流式系统/" title="流式系统" class="md-nav__link">
      流式系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../爬虫/" title="爬虫" class="md-nav__link">
      爬虫
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../统计学习方法/" title="统计学习方法" class="md-nav__link">
      统计学习方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../设计数据密集型应用/" title="设计数据密集型应用" class="md-nav__link">
      设计数据密集型应用
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        面向程序员的数据挖掘指南
      </label>
    
    <a href="./" title="面向程序员的数据挖掘指南" class="md-nav__link md-nav__link--active">
      面向程序员的数据挖掘指南
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 推荐系统入门
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    曼哈顿距离
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    欧几里得距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    闵可夫斯基距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    切比雪夫距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    皮尔逊相关系数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    余弦相似度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    应该使用哪种相似度？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knn" class="md-nav__link">
    kNN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python推荐模块
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 隐式评价和基于物品的过滤算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    隐式评价
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    基于物品的过滤算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    修正的余弦相似度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    使用Python实现修正的余弦相似度算法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slope-one" class="md-nav__link">
    Slope One算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    计算差值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slope-one_1" class="md-nav__link">
    使用加权的Slope One算法进行预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pythonslope-one" class="md-nav__link">
    使用Python实现Slope One算法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-movielens" class="md-nav__link">
    Example: MovieLens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    进一步阅读
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3 分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    评分标准
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rescalingmin-max-normalization" class="md-nav__link">
    Rescaling/Min-max normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-score-normalizationstandardization" class="md-nav__link">
    z-score normalization/Standardization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modified-z-score" class="md-nav__link">
    Modified Z-Score
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    是否需要标准化？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_2" class="md-nav__link">
    Python数据格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    分类器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example:运动项目
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    数据格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_3" class="md-nav__link">
    Python代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example: 鸢尾花
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example: 每加仑燃油公里数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4 进一步探索分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#knn_1" class="md-nav__link">
    效果评估算法和kNN
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    训练集和测试集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k" class="md-nav__link">
    k折交叉验证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    留一法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    混淆矩阵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application" class="md-nav__link">
    Application: 每加仑燃油公里数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kappa" class="md-nav__link">
    Kappa指标
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knn_2" class="md-nav__link">
    kNN算法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example: 比马印第安人糖尿病
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5 朴素贝叶斯
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1 朴素贝叶斯
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    后验概率
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    贝叶斯法则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_4" class="md-nav__link">
    Example: 手环推荐
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_5" class="md-nav__link">
    Example: 美国国会投票数据
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2 数值型数据
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    区分类别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    高斯分布
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_6" class="md-nav__link">
    Example: 比马印第安人糖尿病
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    为什么要叫“朴素贝叶斯”呢？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6 朴素贝叶斯算法和非结构化文本
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    自动判别文本中的感情色彩
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    训练阶段
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    分类阶段
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-20-newsgroups" class="md-nav__link">
    Application: 20 Newsgroups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    停用词
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    常用词和停词
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_4" class="md-nav__link">
    Python代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    朴素贝叶斯与情感分析
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application_1" class="md-nav__link">
    Application电影评价
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 聚类
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Effective Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Effective Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/1 Introduction/" title="1 Introduction" class="md-nav__link">
      1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/2 Creating and Destroying Objects/" title="2 Creating and Destroying Objects" class="md-nav__link">
      2 Creating and Destroying Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/3 Methods Common to All Objects/" title="3 Methods Common to All Objects" class="md-nav__link">
      3 Methods Common to All Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/4 Classes and interfaces/" title="4 Classes and interfaces" class="md-nav__link">
      4 Classes and interfaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/5 Generics/" title="5 Generics" class="md-nav__link">
      5 Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/6 Enums and Annotations/" title="6 Enums and Annotations" class="md-nav__link">
      6 Enums and Annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/7 Lambdas and Streams/" title="7 Lambdas and Streams" class="md-nav__link">
      7 Lambdas and Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/8 Methods/" title="8 Methods" class="md-nav__link">
      8 Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/9 General Programming/" title="9 General Programming" class="md-nav__link">
      9 General Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/10 Exceptions/" title="10 Exceptions" class="md-nav__link">
      10 Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/11 Concurrency/" title="11 Concurrency" class="md-nav__link">
      11 Concurrency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Effective Java/12 Serialization/" title="12 Serialization" class="md-nav__link">
      12 Serialization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Head First Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Head First Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/1 Dive in A Quick Dip/" title="1 Dive in A Quick Dip" class="md-nav__link">
      1 Dive in A Quick Dip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/2 Classes and Objects/" title="2 Classes and Objects" class="md-nav__link">
      2 Classes and Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/3 Primitives and references/" title="3 Primitives and references" class="md-nav__link">
      3 Primitives and references
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/4 Methods use instance variables/" title="4 Methods use instance variables" class="md-nav__link">
      4 Methods use instance variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/5 Writing a Program/" title="5 Writing a Program" class="md-nav__link">
      5 Writing a Program
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/6 Get to know the Java API/" title="6 Get to know the Java API" class="md-nav__link">
      6 Get to know the Java API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/7 Inheritance and polymorphism/" title="7 Inheritance and polymorphism" class="md-nav__link">
      7 Inheritance and polymorphism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/8 Interfaces and Abstract Classes/" title="8 Interfaces and Abstract Classes" class="md-nav__link">
      8 Interfaces and Abstract Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/9 Constructors and Garbage Collection/" title="9 Constructors and Garbage Collection" class="md-nav__link">
      9 Constructors and Garbage Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/10 Numbers and Statics/" title="10 Numbers and Statics" class="md-nav__link">
      10 Numbers and Statics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/11 Exception Handling/" title="11 Exception Handling" class="md-nav__link">
      11 Exception Handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/12 Getting GUI/" title="12 Getting GUI" class="md-nav__link">
      12 Getting GUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/13 Using Swing/" title="13 Using Swing" class="md-nav__link">
      13 Using Swing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/14 Serialization and File IO/" title="14 Serialization and File IO" class="md-nav__link">
      14 Serialization and File IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/15 Networking and Threads/" title="15 Networking and Threads" class="md-nav__link">
      15 Networking and Threads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/16 Collections and Generics/" title="16 Collections and Generics" class="md-nav__link">
      16 Collections and Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/17 Packages, Jars and Deployment/" title="17 Packages, Jars and Deployment" class="md-nav__link">
      17 Packages, Jars and Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/18 Remote deploy with RMI/" title="18 Remote deploy with RMI" class="md-nav__link">
      18 Remote deploy with RMI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First Java/19 Appendix/" title="19 Appendix" class="md-nav__link">
      19 Appendix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Head First设计模式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Head First设计模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/1 Strategy Pattern/" title="1 Strategy Pattern" class="md-nav__link">
      1 Strategy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/2 Observer Pattern/" title="2 Observer Pattern" class="md-nav__link">
      2 Observer Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/3 Decorator Pattern/" title="3 Decorator Pattern" class="md-nav__link">
      3 Decorator Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/4 Factory Pattern/" title="4 Factory Pattern" class="md-nav__link">
      4 Factory Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/5 Singleton Pattern/" title="5 Singleton Pattern" class="md-nav__link">
      5 Singleton Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/6 Command Pattern/" title="6 Command Pattern" class="md-nav__link">
      6 Command Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/7 Adapter and Facade Pattern/" title="7 Adapter and Facade Pattern" class="md-nav__link">
      7 Adapter and Facade Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/8 Template Method Pattern/" title="8 Template Method Pattern" class="md-nav__link">
      8 Template Method Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/9 Iterator and Composite Pattern/" title="9 Iterator and Composite Pattern" class="md-nav__link">
      9 Iterator and Composite Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/10 State Pattern/" title="10 State Pattern" class="md-nav__link">
      10 State Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/11 Proxy Pattern/" title="11 Proxy Pattern" class="md-nav__link">
      11 Proxy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/12 Compound Patterns/" title="12 Compound Patterns" class="md-nav__link">
      12 Compound Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/13 Better Living with Patterns/" title="13 Better Living with Patterns" class="md-nav__link">
      13 Better Living with Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/14 Builder Pattern/" title="14 Builder Pattern" class="md-nav__link">
      14 Builder Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Head First设计模式/15 Chain Of Responsibility/" title="15 Chain Of Responsibility" class="md-nav__link">
      15 Chain Of Responsibility
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Java Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Java Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Ajax/" title="Ajax" class="md-nav__link">
      Ajax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Bootstrap/" title="Bootstrap" class="md-nav__link">
      Bootstrap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/CSS/" title="CSS" class="md-nav__link">
      CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/HTML/" title="HTML" class="md-nav__link">
      HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Head First Servlets and JSP/" title="Head First Servlets and JSP" class="md-nav__link">
      Head First Servlets and JSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/JDBC/" title="JDBC" class="md-nav__link">
      JDBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/JSON/" title="JSON" class="md-nav__link">
      JSON
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/JSP以及JSTL和EL表达式/" title="JSP以及JSTL和EL表达式" class="md-nav__link">
      JSP以及JSTL和EL表达式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Java Web/" title="Java Web" class="md-nav__link">
      Java Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/JavaScript/" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/MyBatis/" title="MyBatis" class="md-nav__link">
      MyBatis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/RESTful/" title="RESTful" class="md-nav__link">
      RESTful
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Spring/" title="Spring" class="md-nav__link">
      Spring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/SpringBoot/" title="SpringBoot" class="md-nav__link">
      SpringBoot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Tomcat/" title="Tomcat" class="md-nav__link">
      Tomcat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/XML/" title="XML" class="md-nav__link">
      XML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/jQuery/" title="jQuery" class="md-nav__link">
      jQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/人员信息管理系统/" title="人员信息管理系统" class="md-nav__link">
      人员信息管理系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java Web/Log4j/" title="Log4j" class="md-nav__link">
      Log4j
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/Java编程思想/" title="Java编程思想" class="md-nav__link">
      Java编程思想
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/反射/" title="反射" class="md-nav__link">
      反射
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      深入理解Java虚拟机
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        深入理解Java虚拟机
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/1 走进Java/" title="1 走进Java" class="md-nav__link">
      1 走进Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/2 Java内存区域与内存溢出正常/" title="2 Java内存区域与内存溢出正常" class="md-nav__link">
      2 Java内存区域与内存溢出正常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/3 垃圾收集器与内存分配策略/" title="3 垃圾收集器与内存分配策略" class="md-nav__link">
      3 垃圾收集器与内存分配策略
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/4 虚拟机性能监控与故障处理工具/" title="4 虚拟机性能监控与故障处理工具" class="md-nav__link">
      4 虚拟机性能监控与故障处理工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/5 调优案例分析与实战/" title="5 调优案例分析与实战" class="md-nav__link">
      5 调优案例分析与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/6 类文件结构/" title="6 类文件结构" class="md-nav__link">
      6 类文件结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/7 虚拟机类加载机制/" title="7 虚拟机类加载机制" class="md-nav__link">
      7 虚拟机类加载机制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/8 虚拟机字节码执行引擎/" title="8 虚拟机字节码执行引擎" class="md-nav__link">
      8 虚拟机字节码执行引擎
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/9 类加载及执行子系统的案例与实战/" title="9 类加载及执行子系统的案例与实战" class="md-nav__link">
      9 类加载及执行子系统的案例与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/10 早期(编译期)优化/" title="10 早期(编译期)优化" class="md-nav__link">
      10 早期(编译期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/11 晚期(运行期)优化/" title="11 晚期(运行期)优化" class="md-nav__link">
      11 晚期(运行期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/12 Java内存模型与线程/" title="12 Java内存模型与线程" class="md-nav__link">
      12 Java内存模型与线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/13 线程安全与锁优化/" title="13 线程安全与锁优化" class="md-nav__link">
      13 线程安全与锁优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/深入理解Java虚拟机/14 AppendixC/" title="14 AppendixC" class="md-nav__link">
      14 AppendixC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      高并发
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        高并发
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/高并发/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/高并发/JDK并发包/" title="JDK并发包" class="md-nav__link">
      JDK并发包
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/高并发/Java多线程设计模式/" title="Java多线程设计模式" class="md-nav__link">
      Java多线程设计模式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/高并发/事件驱动，消息驱动/" title="事件驱动，消息驱动" class="md-nav__link">
      事件驱动，消息驱动
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Java/高并发/多线程基础/" title="多线程基础" class="md-nav__link">
      多线程基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Leetcode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Leetcode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/1. Two Sum/" title="1. Two Sum" class="md-nav__link">
      1. Two Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/10. Regular Expression Matching/" title="10. Regular Expression Matching" class="md-nav__link">
      10. Regular Expression Matching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/100. Same Tree/" title="100. Same Tree" class="md-nav__link">
      100. Same Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/101. Symmetric Tree/" title="101. Symmetric Tree" class="md-nav__link">
      101. Symmetric Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/102. Binary Tree Level Order Traversal/" title="102. Binary Tree Level Order Traversal" class="md-nav__link">
      102. Binary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/1020. Number of Enclaves/" title="1020. Number of Enclaves" class="md-nav__link">
      1020. Number of Enclaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/103. Binary Tree Zigzag Level Order Traversal/" title="103. Binary Tree Zigzag Level Order Traversal" class="md-nav__link">
      103. Binary Tree Zigzag Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/104. Maximum Depth of Binary Tree/" title="104. Maximum Depth of Binary Tree" class="md-nav__link">
      104. Maximum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/105. Construct Binary Tree from Preorder and Inorder Traversal/" title="105. Construct Binary Tree from Preorder and Inorder Traversal" class="md-nav__link">
      105. Construct Binary Tree from Preorder and Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/107. Binary Tree Level Order Traversal II/" title="107. Binary Tree Level Order Traversal II" class="md-nav__link">
      107. Binary Tree Level Order Traversal II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/108. Convert Sorted Array to Binary Search Tree/" title="108. Convert Sorted Array to Binary Search Tree" class="md-nav__link">
      108. Convert Sorted Array to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/109. Convert Sorted List to Binary Search Tree/" title="109. Convert Sorted List to Binary Search Tree" class="md-nav__link">
      109. Convert Sorted List to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/11. Container With Most Water/" title="11. Container With Most Water" class="md-nav__link">
      11. Container With Most Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/110. Balanced Binary Tree/" title="110. Balanced Binary Tree" class="md-nav__link">
      110. Balanced Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/111. Minimum Depth of Binary Tree/" title="111. Minimum Depth of Binary Tree" class="md-nav__link">
      111. Minimum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/112. Path Sum/" title="112. Path Sum" class="md-nav__link">
      112. Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/113. Path Sum II/" title="113. Path Sum II" class="md-nav__link">
      113. Path Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/114. Flatten Binary Tree to Linked List/" title="114. Flatten Binary Tree to Linked List" class="md-nav__link">
      114. Flatten Binary Tree to Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/116. Populating Next Right Pointers in Each Node/" title="116. Populating Next Right Pointers in Each Node" class="md-nav__link">
      116. Populating Next Right Pointers in Each Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/117. Populating Next Right Pointers in Each Node II/" title="117. Populating Next Right Pointers in Each Node II" class="md-nav__link">
      117. Populating Next Right Pointers in Each Node II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/118. Pascals Triangle/" title="118. Pascals Triangle" class="md-nav__link">
      118. Pascals Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/119. Pascals Triangle II/" title="119. Pascals Triangle II" class="md-nav__link">
      119. Pascals Triangle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/12. Integer to Roman/" title="12. Integer to Roman" class="md-nav__link">
      12. Integer to Roman
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/120. Triangle/" title="120. Triangle" class="md-nav__link">
      120. Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/121. Best Time to Buy and Sell Stock/" title="121. Best Time to Buy and Sell Stock" class="md-nav__link">
      121. Best Time to Buy and Sell Stock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/122. Best Time to Buy and Sell Stock II/" title="122. Best Time to Buy and Sell Stock II" class="md-nav__link">
      122. Best Time to Buy and Sell Stock II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/123. Best Time to Buy and Sell Stock III/" title="123. Best Time to Buy and Sell Stock III" class="md-nav__link">
      123. Best Time to Buy and Sell Stock III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/124. Binary Tree Maximum Path Sum/" title="124. Binary Tree Maximum Path Sum" class="md-nav__link">
      124. Binary Tree Maximum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/125. Valid Palindrome/" title="125. Valid Palindrome" class="md-nav__link">
      125. Valid Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/127. Word Ladder/" title="127. Word Ladder" class="md-nav__link">
      127. Word Ladder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/128. Longest Consecutive Sequence/" title="128. Longest Consecutive Sequence" class="md-nav__link">
      128. Longest Consecutive Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/129. Sum Root to Leaf Numbers/" title="129. Sum Root to Leaf Numbers" class="md-nav__link">
      129. Sum Root to Leaf Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/130. Surrounded Regions/" title="130. Surrounded Regions" class="md-nav__link">
      130. Surrounded Regions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/131. Palindrome Partitioning/" title="131. Palindrome Partitioning" class="md-nav__link">
      131. Palindrome Partitioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/132. Palindrome Partitioning II/" title="132. Palindrome Partitioning II" class="md-nav__link">
      132. Palindrome Partitioning II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/133. Clone Graph/" title="133. Clone Graph" class="md-nav__link">
      133. Clone Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/136 Single Number/" title="136 Single Number" class="md-nav__link">
      136 Single Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/137 Single Number II/" title="137 Single Number II" class="md-nav__link">
      137 Single Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/138. Copy List with Random Pointer/" title="138. Copy List with Random Pointer" class="md-nav__link">
      138. Copy List with Random Pointer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/139. Word Break/" title="139. Word Break" class="md-nav__link">
      139. Word Break
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/14. Longest Common Prefix/" title="14. Longest Common Prefix" class="md-nav__link">
      14. Longest Common Prefix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/141. Linked List Cycle/" title="141. Linked List Cycle" class="md-nav__link">
      141. Linked List Cycle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/142. Linked List Cycle II/" title="142. Linked List Cycle II" class="md-nav__link">
      142. Linked List Cycle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/143. Reorder List/" title="143. Reorder List" class="md-nav__link">
      143. Reorder List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/144. Binary Tree Preorder Traversal/" title="144. Binary Tree Preorder Traversal" class="md-nav__link">
      144. Binary Tree Preorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/145. Binary Tree Postorder Traversal/" title="145. Binary Tree Postorder Traversal" class="md-nav__link">
      145. Binary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/146. LRU Cache/" title="146. LRU Cache" class="md-nav__link">
      146. LRU Cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/147. Insertion Sort List/" title="147. Insertion Sort List" class="md-nav__link">
      147. Insertion Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/148. Sort List/" title="148. Sort List" class="md-nav__link">
      148. Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/149. Max Points on a Line/" title="149. Max Points on a Line" class="md-nav__link">
      149. Max Points on a Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/15. 3Sum/" title="15. 3Sum" class="md-nav__link">
      15. 3Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/150. Evaluate Reverse Polish Notation/" title="150. Evaluate Reverse Polish Notation" class="md-nav__link">
      150. Evaluate Reverse Polish Notation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/151. Reverse Words in a String/" title="151. Reverse Words in a String" class="md-nav__link">
      151. Reverse Words in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/152. Maximum Product Subarray/" title="152. Maximum Product Subarray" class="md-nav__link">
      152. Maximum Product Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/153. Find Minimum in Rotated Sorted Array/" title="153. Find Minimum in Rotated Sorted Array" class="md-nav__link">
      153. Find Minimum in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/155. Min Stack/" title="155. Min Stack" class="md-nav__link">
      155. Min Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/16. 3Sum Closest/" title="16. 3Sum Closest" class="md-nav__link">
      16. 3Sum Closest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/160. Intersection of Two Linked Lists/" title="160. Intersection of Two Linked Lists" class="md-nav__link">
      160. Intersection of Two Linked Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/164. Maximum Gap/" title="164. Maximum Gap" class="md-nav__link">
      164. Maximum Gap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/166. Fraction to Recurring Decimal/" title="166. Fraction to Recurring Decimal" class="md-nav__link">
      166. Fraction to Recurring Decimal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/167. Two Sum II - Input array is sorted/" title="167. Two Sum II - Input array is sorted" class="md-nav__link">
      167. Two Sum II - Input array is sorted
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/168. Excel Sheet Column Title/" title="168. Excel Sheet Column Title" class="md-nav__link">
      168. Excel Sheet Column Title
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/169. Majority Element/" title="169. Majority Element" class="md-nav__link">
      169. Majority Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/17. Letter Combinations of a Phone Number.md/" title="17. Letter Combinations of a Phone Number" class="md-nav__link">
      17. Letter Combinations of a Phone Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/170. TwoSum III/" title="170. TwoSum III" class="md-nav__link">
      170. TwoSum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/171. Excel Sheet Column Number/" title="171. Excel Sheet Column Number" class="md-nav__link">
      171. Excel Sheet Column Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/172. Factorial Trailing Zeroes/" title="172. Factorial Trailing Zeroes" class="md-nav__link">
      172. Factorial Trailing Zeroes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/173. Binary Search Tree Iterator/" title="173. Binary Search Tree Iterator" class="md-nav__link">
      173. Binary Search Tree Iterator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/174. Dungeon Game/" title="174. Dungeon Game" class="md-nav__link">
      174. Dungeon Game
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/179. Largest Number/" title="179. Largest Number" class="md-nav__link">
      179. Largest Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/18. 4 Sum/" title="18. 4 Sum" class="md-nav__link">
      18. 4 Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/187. Repeated DNA Sequences/" title="187. Repeated DNA Sequences" class="md-nav__link">
      187. Repeated DNA Sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/19. Remove Nth Node From End of List/" title="19. Remove Nth Node From End of List" class="md-nav__link">
      19. Remove Nth Node From End of List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/190. Reverse Bits/" title="190. Reverse Bits" class="md-nav__link">
      190. Reverse Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/191. Number of 1 Bits/" title="191. Number of 1 Bits" class="md-nav__link">
      191. Number of 1 Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/198. House Robber/" title="198. House Robber" class="md-nav__link">
      198. House Robber
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/199. Binary Tree Right Side View/" title="199. Binary Tree Right Side View" class="md-nav__link">
      199. Binary Tree Right Side View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/2. Add Two Numbers/" title="2. Add Two Numbers" class="md-nav__link">
      2. Add Two Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/20. Valid Parentheses/" title="20. Valid Parentheses" class="md-nav__link">
      20. Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/200. Number of Islands/" title="200. Number of Islands" class="md-nav__link">
      200. Number of Islands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/202. Happy Number/" title="202. Happy Number" class="md-nav__link">
      202. Happy Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/203. Remove Linked List Elements/" title="203. Remove Linked List Elements" class="md-nav__link">
      203. Remove Linked List Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/204. Count Primes/" title="204. Count Primes" class="md-nav__link">
      204. Count Primes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/205. Isomorphic Strings/" title="205. Isomorphic Strings" class="md-nav__link">
      205. Isomorphic Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/206. Reverse Linked List/" title="206. Reverse Linked List" class="md-nav__link">
      206. Reverse Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/207. Course Schedule/" title="207. Course Schedule" class="md-nav__link">
      207. Course Schedule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/209. Minimum Size Subarray Sum/" title="209. Minimum Size Subarray Sum" class="md-nav__link">
      209. Minimum Size Subarray Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/21. Merge Two Sorted Lists/" title="21. Merge Two Sorted Lists" class="md-nav__link">
      21. Merge Two Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/210. Course Schedule II/" title="210. Course Schedule II" class="md-nav__link">
      210. Course Schedule II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/213. House Robber II/" title="213. House Robber II" class="md-nav__link">
      213. House Robber II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/215. Kth Largest Element in an Array/" title="215. Kth Largest Element in an Array" class="md-nav__link">
      215. Kth Largest Element in an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/216. Combination Sum III/" title="216. Combination Sum III" class="md-nav__link">
      216. Combination Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/22. Generate Parentheses/" title="22. Generate Parentheses" class="md-nav__link">
      22. Generate Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/221. Maximal Square/" title="221. Maximal Square" class="md-nav__link">
      221. Maximal Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/222. Count Complete Tree Nodes/" title="222. Count Complete Tree Nodes" class="md-nav__link">
      222. Count Complete Tree Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/224. Basic Calculator/" title="224. Basic Calculator" class="md-nav__link">
      224. Basic Calculator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/225. Implement Stack using Queues/" title="225. Implement Stack using Queues" class="md-nav__link">
      225. Implement Stack using Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/226. Invert Binary Tree/" title="226. Invert Binary Tree" class="md-nav__link">
      226. Invert Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/229. Majority Element II/" title="229. Majority Element II" class="md-nav__link">
      229. Majority Element II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/23. Merge k Sorted Lists/" title="23. Merge k Sorted Lists" class="md-nav__link">
      23. Merge k Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/230. Kth Smallest Element in a BST/" title="230. Kth Smallest Element in a BST" class="md-nav__link">
      230. Kth Smallest Element in a BST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/231. Power of Two/" title="231. Power of Two" class="md-nav__link">
      231. Power of Two
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/232. Implement Queue using Stacks/" title="232. Implement Queue using Stacks" class="md-nav__link">
      232. Implement Queue using Stacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/233. Number of Digit One/" title="233. Number of Digit One" class="md-nav__link">
      233. Number of Digit One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/234. Palindrome Linked List/" title="234. Palindrome Linked List" class="md-nav__link">
      234. Palindrome Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/235. Lowest Common Ancestor of a Binary Search Tree/" title="235. Lowest Common Ancestor of a Binary Search Tree" class="md-nav__link">
      235. Lowest Common Ancestor of a Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/236. Lowest Common Ancestor of a Binary Tree/" title="236. Lowest Common Ancestor of a Binary Tree" class="md-nav__link">
      236. Lowest Common Ancestor of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/237. Delete Node in a Linked List/" title="237. Delete Node in a Linked List" class="md-nav__link">
      237. Delete Node in a Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/24. Swap Nodes in Pairs/" title="24. Swap Nodes in Pairs" class="md-nav__link">
      24. Swap Nodes in Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/240. Search a 2D Matrix II/" title="240. Search a 2D Matrix II" class="md-nav__link">
      240. Search a 2D Matrix II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/241. Different Ways to Add Parentheses/" title="241. Different Ways to Add Parentheses" class="md-nav__link">
      241. Different Ways to Add Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/242. Valid Anagram/" title="242. Valid Anagram" class="md-nav__link">
      242. Valid Anagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/25. Reverse Nodes in k-Group/" title="25. Reverse Nodes in k-Group" class="md-nav__link">
      25. Reverse Nodes in k-Group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/252. Meeting Rooms/" title="252. Meeting Rooms" class="md-nav__link">
      252. Meeting Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/253. Meeting Rooms II/" title="253. Meeting Rooms II" class="md-nav__link">
      253. Meeting Rooms II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/256. Paint House/" title="256. Paint House" class="md-nav__link">
      256. Paint House
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/257. Binary Tree Paths/" title="257. Binary Tree Paths" class="md-nav__link">
      257. Binary Tree Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/258. Add Digits/" title="258. Add Digits" class="md-nav__link">
      258. Add Digits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/26. Remove Duplicates from Sorted Array/" title="26. Remove Duplicates from Sorted Array" class="md-nav__link">
      26. Remove Duplicates from Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/260. Single Number III/" title="260. Single Number III" class="md-nav__link">
      260. Single Number III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/261. Graph Valid Tree/" title="261. Graph Valid Tree" class="md-nav__link">
      261. Graph Valid Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/263. Ugly Number/" title="263. Ugly Number" class="md-nav__link">
      263. Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/264. Ugly Number II/" title="264. Ugly Number II" class="md-nav__link">
      264. Ugly Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/265. Paint House II/" title="265. Paint House II" class="md-nav__link">
      265. Paint House II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/268. Missing Number/" title="268. Missing Number" class="md-nav__link">
      268. Missing Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/27. Remove Element/" title="27. Remove Element" class="md-nav__link">
      27. Remove Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/270. Closest Binary Search Tree Value/" title="270. Closest Binary Search Tree Value" class="md-nav__link">
      270. Closest Binary Search Tree Value
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/276. Paint Fence/" title="276. Paint Fence" class="md-nav__link">
      276. Paint Fence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/278. First Bad Version/" title="278. First Bad Version" class="md-nav__link">
      278. First Bad Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/279. Perfect Squares/" title="279. Perfect Squares" class="md-nav__link">
      279. Perfect Squares
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/28. Implement strStr()/" title="28. Implement strStr()" class="md-nav__link">
      28. Implement strStr()
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/280. Wiggle Sort/" title="280. Wiggle Sort" class="md-nav__link">
      280. Wiggle Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/287. Find the Duplicate Number/" title="287. Find the Duplicate Number" class="md-nav__link">
      287. Find the Duplicate Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/29. Divide Two Integers/" title="29. Divide Two Integers" class="md-nav__link">
      29. Divide Two Integers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/290. Word Pattern/" title="290. Word Pattern" class="md-nav__link">
      290. Word Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/295. Find Median from Data Stream/" title="295. Find Median from Data Stream" class="md-nav__link">
      295. Find Median from Data Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/297. Serialize and Deserialize Binary Tree/" title="297. Serialize and Deserialize Binary Tree" class="md-nav__link">
      297. Serialize and Deserialize Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/3. Longest Substring Without Repeating Characters/" title="3. Longest Substring Without Repeating Characters" class="md-nav__link">
      3. Longest Substring Without Repeating Characters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/30. Substring with Concatenation of All Words/" title="30. Substring with Concatenation of All Words" class="md-nav__link">
      30. Substring with Concatenation of All Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/300. Longest Increasing Subsequence/" title="300. Longest Increasing Subsequence" class="md-nav__link">
      300. Longest Increasing Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/303. Range Sum Query - Immutable/" title="303. Range Sum Query - Immutable" class="md-nav__link">
      303. Range Sum Query - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/304. Range Sum Query 2D - Immutable/" title="304. Range Sum Query 2D - Immutable" class="md-nav__link">
      304. Range Sum Query 2D - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/309. Best Time to Buy and Sell Stock with Cooldown/" title="309. Best Time to Buy and Sell Stock with Cooldown" class="md-nav__link">
      309. Best Time to Buy and Sell Stock with Cooldown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/31. Next Permutation/" title="31. Next Permutation" class="md-nav__link">
      31. Next Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/310. Minimum Height Trees/" title="310. Minimum Height Trees" class="md-nav__link">
      310. Minimum Height Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/313. Super Ugly Number/" title="313. Super Ugly Number" class="md-nav__link">
      313. Super Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/32. Longest Valid Parentheses/" title="32. Longest Valid Parentheses" class="md-nav__link">
      32. Longest Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/322. Coin Change/" title="322. Coin Change" class="md-nav__link">
      322. Coin Change
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/324. Wiggle Sort II/" title="324. Wiggle Sort II" class="md-nav__link">
      324. Wiggle Sort II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/326. Power of Three/" title="326. Power of Three" class="md-nav__link">
      326. Power of Three
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/328. Odd Even Linked List/" title="328. Odd Even Linked List" class="md-nav__link">
      328. Odd Even Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/33. Search in Rotated Sorted Array/" title="33. Search in Rotated Sorted Array" class="md-nav__link">
      33. Search in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/331. Verify Preorder Serialization of a Binary Tree/" title="331. Verify Preorder Serialization of a Binary Tree" class="md-nav__link">
      331. Verify Preorder Serialization of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/332. Reconstruct Itinerary/" title="332. Reconstruct Itinerary" class="md-nav__link">
      332. Reconstruct Itinerary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/337. House Robber III/" title="337. House Robber III" class="md-nav__link">
      337. House Robber III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/338. Counting Bits/" title="338. Counting Bits" class="md-nav__link">
      338. Counting Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/34. Find First and Last Position of Element in Sorted Array/" title="34. Find First and Last Position of Element in Sorted Array" class="md-nav__link">
      34. Find First and Last Position of Element in Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/342. Power of Four/" title="342. Power of Four" class="md-nav__link">
      342. Power of Four
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/344. Reverse String/" title="344. Reverse String" class="md-nav__link">
      344. Reverse String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/345. Reverse Vowels of a String/" title="345. Reverse Vowels of a String" class="md-nav__link">
      345. Reverse Vowels of a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/347. Top K Frequent Elements/" title="347. Top K Frequent Elements" class="md-nav__link">
      347. Top K Frequent Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/349. Intersection of Two Arrays/" title="349. Intersection of Two Arrays" class="md-nav__link">
      349. Intersection of Two Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/35. Search Insert Position/" title="35. Search Insert Position" class="md-nav__link">
      35. Search Insert Position
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/350. Intersection of Two Arrays II/" title="350. Intersection of Two Arrays II" class="md-nav__link">
      350. Intersection of Two Arrays II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/359. Logger Rate Limiter/" title="359. Logger Rate Limiter" class="md-nav__link">
      359. Logger Rate Limiter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/36. Valid Sudoku/" title="36. Valid Sudoku" class="md-nav__link">
      36. Valid Sudoku
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/366. Find Leaves of Binary Tree/" title="366. Find Leaves of Binary Tree" class="md-nav__link">
      366. Find Leaves of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/367. Valid Perfect Square/" title="367. Valid Perfect Square" class="md-nav__link">
      367. Valid Perfect Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/37. Sudoku Solver/" title="37. Sudoku Solver" class="md-nav__link">
      37. Sudoku Solver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/370. Range Addition/" title="370. Range Addition" class="md-nav__link">
      370. Range Addition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/372. Super Pow/" title="372. Super Pow" class="md-nav__link">
      372. Super Pow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/373. Find K Pairs with Smallest Sums/" title="373. Find K Pairs with Smallest Sums" class="md-nav__link">
      373. Find K Pairs with Smallest Sums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/378. Kth Smallest Element in a Sorted Matrix/" title="378. Kth Smallest Element in a Sorted Matrix" class="md-nav__link">
      378. Kth Smallest Element in a Sorted Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/38. Count and Say/" title="38. Count and Say" class="md-nav__link">
      38. Count and Say
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/382. Linked List Random Node/" title="382. Linked List Random Node" class="md-nav__link">
      382. Linked List Random Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/384. Shuffle an Array/" title="384. Shuffle an Array" class="md-nav__link">
      384. Shuffle an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/387. First Unique Character in a String/" title="387. First Unique Character in a String" class="md-nav__link">
      387. First Unique Character in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/39. Combination Sum/" title="39. Combination Sum" class="md-nav__link">
      39. Combination Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/399. Evaluate Division/" title="399. Evaluate Division" class="md-nav__link">
      399. Evaluate Division
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/4. Median of Two Sorted Arrays/" title="4. Median of Two Sorted Arrays" class="md-nav__link">
      4. Median of Two Sorted Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/40. Combination Sum II/" title="40. Combination Sum II" class="md-nav__link">
      40. Combination Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/401. Binary Watch/" title="401. Binary Watch" class="md-nav__link">
      401. Binary Watch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/404. Sum of Left Leaves/" title="404. Sum of Left Leaves" class="md-nav__link">
      404. Sum of Left Leaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/409. Longest Palindrome/" title="409. Longest Palindrome" class="md-nav__link">
      409. Longest Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/415. Add Strings/" title="415. Add Strings" class="md-nav__link">
      415. Add Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/42. Trapping Rain Water/" title="42. Trapping Rain Water" class="md-nav__link">
      42. Trapping Rain Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/426. Convert Binary Search Tree to Sorted Doubly Linked List/" title="426. Convert Binary Search Tree to Sorted Doubly Linked List" class="md-nav__link">
      426. Convert Binary Search Tree to Sorted Doubly Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/429. N-ary Tree Level Order Traversal/" title="429. N-ary Tree Level Order Traversal" class="md-nav__link">
      429. N-ary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/43. Multiply Strings/" title="43. Multiply Strings" class="md-nav__link">
      43. Multiply Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/437. Path Sum III/" title="437. Path Sum III" class="md-nav__link">
      437. Path Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/438. Find All Anagrams in a String/" title="438. Find All Anagrams in a String" class="md-nav__link">
      438. Find All Anagrams in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/451. Sort Characters By Frequency/" title="451. Sort Characters By Frequency" class="md-nav__link">
      451. Sort Characters By Frequency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/46. Permutations/" title="46. Permutations" class="md-nav__link">
      46. Permutations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/463. Island Perimeter/" title="463. Island Perimeter" class="md-nav__link">
      463. Island Perimeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/47. Permutations II/" title="47. Permutations II" class="md-nav__link">
      47. Permutations II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/49. Group Anagrams/" title="49. Group Anagrams" class="md-nav__link">
      49. Group Anagrams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/493. Reverse Pairs/" title="493. Reverse Pairs" class="md-nav__link">
      493. Reverse Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/5. Longest Palindromic Substring/" title="5. Longest Palindromic Substring" class="md-nav__link">
      5. Longest Palindromic Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/50. Pow(x, n)/" title="50. Pow(x, n)" class="md-nav__link">
      50. Pow(x, n)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/500. Keyboard Row/" title="500. Keyboard Row" class="md-nav__link">
      500. Keyboard Row
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/507. Perfect Number/" title="507. Perfect Number" class="md-nav__link">
      507. Perfect Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/51. N-Queens/" title="51. N-Queens" class="md-nav__link">
      51. N-Queens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/518. Coin Change 2/" title="518. Coin Change 2" class="md-nav__link">
      518. Coin Change 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/52. N-Queens II/" title="52. N-Queens II" class="md-nav__link">
      52. N-Queens II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/53. Maximum Subarray/" title="53. Maximum Subarray" class="md-nav__link">
      53. Maximum Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/538. Convert BST to Greater Tree/" title="538. Convert BST to Greater Tree" class="md-nav__link">
      538. Convert BST to Greater Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/559. Maximum Depth of N-ary Tree/" title="559. Maximum Depth of N-ary Tree" class="md-nav__link">
      559. Maximum Depth of N-ary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/56. Merge Intervals/" title="56. Merge Intervals" class="md-nav__link">
      56. Merge Intervals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/57. Insert Interval/" title="57. Insert Interval" class="md-nav__link">
      57. Insert Interval
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/58. Length of Last Word/" title="58. Length of Last Word" class="md-nav__link">
      58. Length of Last Word
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/590. N-ary Tree Postorder Traversal/" title="590. N-ary Tree Postorder Traversal" class="md-nav__link">
      590. N-ary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/599. Minimum Index Sum of Two Lists/" title="599. Minimum Index Sum of Two Lists" class="md-nav__link">
      599. Minimum Index Sum of Two Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/6. ZigZag Conversion/" title="6. ZigZag Conversion" class="md-nav__link">
      6. ZigZag Conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/60. Permutation Sequence/" title="60. Permutation Sequence" class="md-nav__link">
      60. Permutation Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/606. Construct String from Binary Tree/" title="606. Construct String from Binary Tree" class="md-nav__link">
      606. Construct String from Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/61. Rotate List/" title="61. Rotate List" class="md-nav__link">
      61. Rotate List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/62. Unique Paths/" title="62. Unique Paths" class="md-nav__link">
      62. Unique Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/63. Unique Paths II/" title="63. Unique Paths II" class="md-nav__link">
      63. Unique Paths II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/633. Sum of Square Numbers/" title="633. Sum of Square Numbers" class="md-nav__link">
      633. Sum of Square Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/637. Average of Levels in Binary Tree/" title="637. Average of Levels in Binary Tree" class="md-nav__link">
      637. Average of Levels in Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/64. Minimum Path Sum/" title="64. Minimum Path Sum" class="md-nav__link">
      64. Minimum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/66. Plus One/" title="66. Plus One" class="md-nav__link">
      66. Plus One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/67. Add Binary/" title="67. Add Binary" class="md-nav__link">
      67. Add Binary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/671. Second Minimum Node In a Binary Tree/" title="671. Second Minimum Node In a Binary Tree" class="md-nav__link">
      671. Second Minimum Node In a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/684. Redundant Connection/" title="684. Redundant Connection" class="md-nav__link">
      684. Redundant Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/685. Redundant Connection II/" title="685. Redundant Connection II" class="md-nav__link">
      685. Redundant Connection II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/687. Longest Univalue Path/" title="687. Longest Univalue Path" class="md-nav__link">
      687. Longest Univalue Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/69. Sqrt(x)/" title="69. Sqrt(x)" class="md-nav__link">
      69. Sqrt(x)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/692. Top K Frequent Words/" title="692. Top K Frequent Words" class="md-nav__link">
      692. Top K Frequent Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/697. Degree of an Array/" title="697. Degree of an Array" class="md-nav__link">
      697. Degree of an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/7. Reverse Integer/" title="7. Reverse Integer" class="md-nav__link">
      7. Reverse Integer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/70. Climbing Stairs/" title="70. Climbing Stairs" class="md-nav__link">
      70. Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/703. Kth Largest Element in a Stream/" title="703. Kth Largest Element in a Stream" class="md-nav__link">
      703. Kth Largest Element in a Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/704. Binary Search/" title="704. Binary Search" class="md-nav__link">
      704. Binary Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/71. Simplify Path/" title="71. Simplify Path" class="md-nav__link">
      71. Simplify Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/716. Max Stack/" title="716. Max Stack" class="md-nav__link">
      716. Max Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/728. Self Dividing Numbers/" title="728. Self Dividing Numbers" class="md-nav__link">
      728. Self Dividing Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/74. Search a 2D Matrix/" title="74. Search a 2D Matrix" class="md-nav__link">
      74. Search a 2D Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/741. Cherry Pickup/" title="741. Cherry Pickup" class="md-nav__link">
      741. Cherry Pickup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/743. Network Delay Time/" title="743. Network Delay Time" class="md-nav__link">
      743. Network Delay Time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/746. Min Cost Climbing Stairs/" title="746. Min Cost Climbing Stairs" class="md-nav__link">
      746. Min Cost Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/75. Sort Colors/" title="75. Sort Colors" class="md-nav__link">
      75. Sort Colors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/76. Minimum Window Substring/" title="76. Minimum Window Substring" class="md-nav__link">
      76. Minimum Window Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/760. Find Anagram Mappings/" title="760. Find Anagram Mappings" class="md-nav__link">
      760. Find Anagram Mappings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/77. Combinations/" title="77. Combinations" class="md-nav__link">
      77. Combinations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/78. Subsets/" title="78. Subsets" class="md-nav__link">
      78. Subsets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/783. Minimum Distance Between BST Nodes/" title="783. Minimum Distance Between BST Nodes" class="md-nav__link">
      783. Minimum Distance Between BST Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/784. Letter Case Permutation/" title="784. Letter Case Permutation" class="md-nav__link">
      784. Letter Case Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/785. Is Graph Bipartite?/" title="785. Is Graph Bipartite?" class="md-nav__link">
      785. Is Graph Bipartite?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/79. Word Search/" title="79. Word Search" class="md-nav__link">
      79. Word Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/8. String to Integer (atoi)/" title="8. String to Integer (atoi)" class="md-nav__link">
      8. String to Integer (atoi)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/81. Search in Rotated Sorted Array II/" title="81. Search in Rotated Sorted Array II" class="md-nav__link">
      81. Search in Rotated Sorted Array II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/82. Remove Duplicates from Sorted List II/" title="82. Remove Duplicates from Sorted List II" class="md-nav__link">
      82. Remove Duplicates from Sorted List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/83. Remove Duplicates from Sorted List/" title="83. Remove Duplicates from Sorted List" class="md-nav__link">
      83. Remove Duplicates from Sorted List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/84. Largest Rectangle in Histogram/" title="84. Largest Rectangle in Histogram" class="md-nav__link">
      84. Largest Rectangle in Histogram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/841. Keys and Rooms/" title="841. Keys and Rooms" class="md-nav__link">
      841. Keys and Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/85. Maximal Rectangle/" title="85. Maximal Rectangle" class="md-nav__link">
      85. Maximal Rectangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/86. Partition List/" title="86. Partition List" class="md-nav__link">
      86. Partition List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/867. Transpose Matrix/" title="867. Transpose Matrix" class="md-nav__link">
      867. Transpose Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/873. Length of Longest Fibonacci Subsequence/" title="873. Length of Longest Fibonacci Subsequence" class="md-nav__link">
      873. Length of Longest Fibonacci Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/876. Middle of the Linked List/" title="876. Middle of the Linked List" class="md-nav__link">
      876. Middle of the Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/88. Merge Sorted Array/" title="88. Merge Sorted Array" class="md-nav__link">
      88. Merge Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/89. Gray Code/" title="89. Gray Code" class="md-nav__link">
      89. Gray Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/9. Palindrome Number/" title="9. Palindrome Number" class="md-nav__link">
      9. Palindrome Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/90. Subsets II/" title="90. Subsets II" class="md-nav__link">
      90. Subsets II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/91. Decode Ways/" title="91. Decode Ways" class="md-nav__link">
      91. Decode Ways
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/92. Reverse Linked List II/" title="92. Reverse Linked List II" class="md-nav__link">
      92. Reverse Linked List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/93. Restore IP Addresses/" title="93. Restore IP Addresses" class="md-nav__link">
      93. Restore IP Addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/93. Restore IP Adress/" title="93. Restore IP Adress" class="md-nav__link">
      93. Restore IP Adress
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/94. Binary Tree Inorder Traversal/" title="94. Binary Tree Inorder Traversal" class="md-nav__link">
      94. Binary Tree Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/941. Valid Mountain Array/" title="941. Valid Mountain Array" class="md-nav__link">
      941. Valid Mountain Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/95. Unique Binary Search Trees II/" title="95. Unique Binary Search Trees II" class="md-nav__link">
      95. Unique Binary Search Trees II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/96. Unique Binary Search Trees/" title="96. Unique Binary Search Trees" class="md-nav__link">
      96. Unique Binary Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/98. Validate Binary Search Tree/" title="98. Validate Binary Search Tree" class="md-nav__link">
      98. Validate Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/99. Recover Binary Search Tree/" title="99. Recover Binary Search Tree" class="md-nav__link">
      99. Recover Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-276" type="checkbox" id="nav-4-276">
    
    <label class="md-nav__link" for="nav-4-276">
      LintCode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-276">
        LintCode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/LintCode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/LintCode/77. Longest Common Subsequence/" title="77. Longest Common Subsequence" class="md-nav__link">
      77. Longest Common Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/LintCode/464. Sort Integers II/" title="464. Sort Integers II" class="md-nav__link">
      464. Sort Integers II
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Miscellaneous
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Clion/" title="Clion" class="md-nav__link">
      Clion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Cpp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Cpp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/EOF/" title="EOF" class="md-nav__link">
      EOF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/STL中的vector string总结/" title="STL中的vector string总结" class="md-nav__link">
      STL中的vector string总结
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/STL源码剖析/" title="STL源码剖析" class="md-nav__link">
      STL源码剖析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/static用法/" title="static用法" class="md-nav__link">
      static用法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/C++ Primer (6) - 函数/" title="C++ Primer (6) - 函数" class="md-nav__link">
      C++ Primer (6) - 函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/C++ Primer (12) - 动态内存/" title="C++ Primer (12) - 动态内存" class="md-nav__link">
      C++ Primer (12) - 动态内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Cpp/C++面试经典100题/" title="C++面试经典100题" class="md-nav__link">
      C++面试经典100题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/GCC/" title="GCC" class="md-nav__link">
      GCC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Intellij IDEA/" title="Intellij IDEA" class="md-nav__link">
      Intellij IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/LLDB使用/" title="LLDB使用" class="md-nav__link">
      LLDB使用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/Maven/" title="Maven" class="md-nav__link">
      Maven
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/VIM技巧/" title="VIM技巧" class="md-nav__link">
      VIM技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-10" type="checkbox" id="nav-5-10">
    
    <label class="md-nav__link" for="nav-5-10">
      awesome Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-10">
        awesome Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/CentOS日志/" title="CentOS日志" class="md-nav__link">
      CentOS日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Intel Parallel Studio XE/" title="Intel Parallel Studio XE" class="md-nav__link">
      Intel Parallel Studio XE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Jupyter Notebook/" title="Jupyter Notebook" class="md-nav__link">
      Jupyter Notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Nasm/" title="Nasm" class="md-nav__link">
      Nasm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Octave/" title="Octave" class="md-nav__link">
      Octave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Proxy/" title="Proxy" class="md-nav__link">
      Proxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/Youtube/" title="Youtube" class="md-nav__link">
      Youtube
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/git/" title="git" class="md-nav__link">
      git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/ubuntu日志/" title="ubuntu日志" class="md-nav__link">
      ubuntu日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/vagrant搭建ubuntu/" title="vagrant搭建ubuntu" class="md-nav__link">
      vagrant搭建ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/awesome Install/黑苹果日志/" title="黑苹果日志" class="md-nav__link">
      黑苹果日志
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/建站日志/" title="建站日志" class="md-nav__link">
      建站日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-13" type="checkbox" id="nav-5-13">
    
    <label class="md-nav__link" for="nav-5-13">
      面试
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-13">
        面试
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/面试/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/面试/Java多线程面试/" title="Java多线程面试" class="md-nav__link">
      Java多线程面试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Miscellaneous/面试/网络面试/" title="网络面试" class="md-nav__link">
      网络面试
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      OS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        OS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/Docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/Linux私房菜(Centos 7)/" title="Linux私房菜(Centos 7)" class="md-nav__link">
      Linux私房菜(Centos 7)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      分布式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        分布式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/分布式/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/分布式/Building Large Scale Internet Service/" title="Building Large Scale Internet Service" class="md-nav__link">
      Building Large Scale Internet Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/分布式/Consensus/" title="Consensus" class="md-nav__link">
      Consensus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/分布式/Google Chubby/" title="Google Chubby" class="md-nav__link">
      Google Chubby
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      操作系统概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        操作系统概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/1 Introduction/" title="1 Introduction" class="md-nav__link">
      1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/2 Operating System structures/" title="2 Operating System structures" class="md-nav__link">
      2 Operating System structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/3 Processes/" title="3 Processes" class="md-nav__link">
      3 Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/4 Threads and Concurrency/" title="4 Threads and Concurrency" class="md-nav__link">
      4 Threads and Concurrency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/5 CPU Scheduling/" title="5 CPU Scheduling" class="md-nav__link">
      5 CPU Scheduling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/6 Synchronization Tools/" title="6 Synchronization Tools" class="md-nav__link">
      6 Synchronization Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/7 Synchronization Examples/" title="7 Synchronization Examples" class="md-nav__link">
      7 Synchronization Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/8 DeadLocks/" title="8 DeadLocks" class="md-nav__link">
      8 DeadLocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/9 Main Memory/" title="9 Main Memory" class="md-nav__link">
      9 Main Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/10 Virtual Memory/" title="10 Virtual Memory" class="md-nav__link">
      10 Virtual Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/11 Mass-Storage Structure/" title="11 Mass-Storage Structure" class="md-nav__link">
      11 Mass-Storage Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/12 IO Systems/" title="12 IO Systems" class="md-nav__link">
      12 IO Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/13 File System Interface/" title="13 File System Interface" class="md-nav__link">
      13 File System Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/15 File System Internals/" title="15 File System Internals" class="md-nav__link">
      15 File System Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/17 Protection/" title="17 Protection" class="md-nav__link">
      17 Protection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/操作系统概念/18 Virtual Machines/" title="18 Virtual Machines" class="md-nav__link">
      18 Virtual Machines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      深入了解计算机系统
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        深入了解计算机系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/1 计算机系统漫游/" title="1 计算机系统漫游" class="md-nav__link">
      1 计算机系统漫游
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/10 系统级IO/" title="10 系统级IO" class="md-nav__link">
      10 系统级IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/11 网络编程/" title="11 网络编程" class="md-nav__link">
      11 网络编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/2 信息的表示和处理/" title="2 信息的表示和处理" class="md-nav__link">
      2 信息的表示和处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/3 程序的机器级表示/" title="3 程序的机器级表示" class="md-nav__link">
      3 程序的机器级表示
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/4 处理器体系结构/" title="4 处理器体系结构" class="md-nav__link">
      4 处理器体系结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/5 优化程序性能/" title="5 优化程序性能" class="md-nav__link">
      5 优化程序性能
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/6 存储器层次结构/" title="6 存储器层次结构" class="md-nav__link">
      6 存储器层次结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/7 链接/" title="7 链接" class="md-nav__link">
      7 链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/8 异常控制流/" title="8 异常控制流" class="md-nav__link">
      8 异常控制流
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/9 虚拟内存/" title="9 虚拟内存" class="md-nav__link">
      9 虚拟内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6-12" type="checkbox" id="nav-6-6-12">
    
    <label class="md-nav__link" for="nav-6-6-12">
      Labs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-6-12">
        Labs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/Lab1 Data Lab/" title="Lab1 Data Lab" class="md-nav__link">
      Lab1 Data Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/Lab3 Attack Lab/" title="Lab3 Attack Lab" class="md-nav__link">
      Lab3 Attack Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/Lab4 Cache Lab/" title="Lab4 Cache Lab" class="md-nav__link">
      Lab4 Cache Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/Lab5 Shell Lab/" title="Lab5 Shell Lab" class="md-nav__link">
      Lab5 Shell Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/Labs/Lab6 Malloc Lab/" title="Lab6 Malloc Lab" class="md-nav__link">
      Lab6 Malloc Lab
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入了解计算机系统/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/深入解析Mac OS X/" title="深入解析Mac OS X" class="md-nav__link">
      深入解析Mac OS X
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机组成与设计/" title="计算机组成与设计" class="md-nav__link">
      计算机组成与设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      计算机网络 自顶向下
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        计算机网络 自顶向下
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/Socket Programming/" title="Socket Programming" class="md-nav__link">
      Socket Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/WireShark Lab/" title="WireShark Lab" class="md-nav__link">
      WireShark Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/1 计算机网络和因特网/" title="1 计算机网络和因特网" class="md-nav__link">
      1 计算机网络和因特网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/2 应用层/" title="2 应用层" class="md-nav__link">
      2 应用层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/3 运输层/" title="3 运输层" class="md-nav__link">
      3 运输层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/4 网络层/" title="4 网络层" class="md-nav__link">
      4 网络层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/5 链路层/" title="5 链路层" class="md-nav__link">
      5 链路层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../OS/计算机网络 自顶向下/6 网络安全/" title="6 网络安全" class="md-nav__link">
      6 网络安全
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 推荐系统入门
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    曼哈顿距离
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    欧几里得距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    闵可夫斯基距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    切比雪夫距离
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    皮尔逊相关系数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    余弦相似度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    应该使用哪种相似度？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knn" class="md-nav__link">
    kNN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python推荐模块
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2 隐式评价和基于物品的过滤算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    隐式评价
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    基于物品的过滤算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    修正的余弦相似度
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    使用Python实现修正的余弦相似度算法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slope-one" class="md-nav__link">
    Slope One算法
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    计算差值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slope-one_1" class="md-nav__link">
    使用加权的Slope One算法进行预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pythonslope-one" class="md-nav__link">
    使用Python实现Slope One算法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-movielens" class="md-nav__link">
    Example: MovieLens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    进一步阅读
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3 分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    评分标准
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rescalingmin-max-normalization" class="md-nav__link">
    Rescaling/Min-max normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-score-normalizationstandardization" class="md-nav__link">
    z-score normalization/Standardization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modified-z-score" class="md-nav__link">
    Modified Z-Score
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    是否需要标准化？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_2" class="md-nav__link">
    Python数据格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    分类器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example:运动项目
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    数据格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_3" class="md-nav__link">
    Python代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example: 鸢尾花
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example: 每加仑燃油公里数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4 进一步探索分类
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#knn_1" class="md-nav__link">
    效果评估算法和kNN
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    训练集和测试集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k" class="md-nav__link">
    k折交叉验证
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    留一法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    混淆矩阵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application" class="md-nav__link">
    Application: 每加仑燃油公里数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kappa" class="md-nav__link">
    Kappa指标
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knn_2" class="md-nav__link">
    kNN算法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example: 比马印第安人糖尿病
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5 朴素贝叶斯
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    1 朴素贝叶斯
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    后验概率
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    贝叶斯法则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_4" class="md-nav__link">
    Example: 手环推荐
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_5" class="md-nav__link">
    Example: 美国国会投票数据
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    2 数值型数据
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    区分类别
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    高斯分布
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_6" class="md-nav__link">
    Example: 比马印第安人糖尿病
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    为什么要叫“朴素贝叶斯”呢？
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6 朴素贝叶斯算法和非结构化文本
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    自动判别文本中的感情色彩
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    训练阶段
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    分类阶段
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-20-newsgroups" class="md-nav__link">
    Application: 20 Newsgroups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    停用词
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    常用词和停词
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_4" class="md-nav__link">
    Python代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    朴素贝叶斯与情感分析
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#application_1" class="md-nav__link">
    Application电影评价
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 聚类
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/techlarry/note/edit/master/wiki/docs/Data Science/面向程序员的数据挖掘指南.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>面向程序员的数据挖掘指南</h1>
                

<!--添加tag标签 -->



                <p><img alt="" src="../figures/cover.png" /></p>
<h3 id="1">1 推荐系统入门<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>本章将介绍协同过滤，基本的距离算法，最后使用Python实现一个简单的推荐算法。</p>
<p>协同过滤，顾名思义，是利用他人的喜好来进行推荐，也就是说，是大家一起产生的推荐。它的工作原理是，在网站上查找一个和你类似的用户，然后将它喜欢的书籍推荐给你。</p>
<p>如何找到相似的用户？</p>
<h4 id="_1">曼哈顿距离<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>顾名思义，在曼哈顿街区要从一个十字路口开车到另一个十字路口，实际驾驶距离就是“曼哈顿距离”。</p>
<p><img alt="" src="../figures/ManhattanDistanceDemo1.jpg" /></p>
<p>最简单的距离计算方式是曼哈顿距离。在二维模型中，每个人都可以用<span><span class="MathJax_Preview">(x, y)</span><script type="math/tex">(x, y)</script></span>的点来表示，这里用下标来表示不同的人，<span><span class="MathJax_Preview">(x_1, y_1)</span><script type="math/tex">(x_1, y_1)</script></span>表示艾米，<span><span class="MathJax_Preview">(x_2, y_2)</span><script type="math/tex">(x_2, y_2)</script></span>表示神秘的X先生，那么他们之间的曼哈顿距离就是：</p>
<div>
<div class="MathJax_Preview">|x_1-x_2|+|y_1-y_2|</div>
<script type="math/tex; mode=display">|x_1-x_2|+|y_1-y_2|</script>
</div>
<p><img alt="ManhattanDistanceDemo" src="../figures/ManhattanDistanceDemo.png" /></p>
<p>曼哈顿距离的优点之一是计算速度快，对于Facebook这样需要计算百万用户之间的相似度时就非常有利。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">manhattan</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the Manhattan distance. Both rating1 and rating2 </span>
<span class="sd">        are dictionaries of the form </span>
<span class="sd">        {&#39;The Strokes&#39;: 3.0, &#39;Slightly Stoopid&#39;: 2.5}&quot;&quot;&quot;</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span> 
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
            <span class="n">distance</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">commonRatings</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">distance</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#Indicates no ratings in common</span>
</pre></div>

<h5 id="_2">欧几里得距离<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<p>欧几里得距离就是两点之间的直线距离。 下面的斜线就是欧几里得距离，公式是：</p>
<div>
<div class="MathJax_Preview">\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}</div>
<script type="math/tex; mode=display">\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}</script>
</div>
<p><img alt="Euclidean Distance Demo" src="../figures/EuclidDistanceDemo.png" /></p>
<p>曼哈顿距离和欧几里得距离在数据完整的情况下效果最好。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">euclidean</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Euclidean Distance</span>
<span class="sd">    :param rating1: rating</span>
<span class="sd">    :param rating2: rating</span>
<span class="sd">    :return: distance if common ratings exists, or -1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
            <span class="n">distance</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">commonRatings</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">distance</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicates no ratings in common</span>
</pre></div>

<h5 id="_3">闵可夫斯基距离<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p>我们可以将曼哈顿距离和欧几里得距离归纳成一个公式，这个公式称为闵可夫斯基距离(Minkowski Distance)：</p>
<div>
<div class="MathJax_Preview">d(x,y) = (\sum_{k=1}^{n}|x_k-y_k|^r)^{\frac{1}{r}}</div>
<script type="math/tex; mode=display">d(x,y) = (\sum_{k=1}^{n}|x_k-y_k|^r)^{\frac{1}{r}}</script>
</div>
<p>其中：</p>
<ul>
<li><span><span class="MathJax_Preview">r = 1</span><script type="math/tex">r = 1</script></span>, 该公式即曼哈顿距离</li>
<li><span><span class="MathJax_Preview">r = 2</span><script type="math/tex">r = 2</script></span>, 该公式即欧几里得距离</li>
<li><span><span class="MathJax_Preview">r = \infty</span><script type="math/tex">r = \infty</script></span>, 切比雪夫距离</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span>值越大，单个维度的差值大小会对整体距离有更大的影响。</p>
</div>
<h5 id="_4">切比雪夫距离<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<p>切比雪夫距离(Chebyshev Distance)是定义为其各坐标数值差的最大值。</p>
<div>
<div class="MathJax_Preview">D_{\rm Chebyshev}(x,y) = \max_i(|x_i - y_i|)=\lim_{k \to \infty} \bigg( \sum_{i=1}^n \left| x_i - y_i \right|^k \bigg)^{1/k}</div>
<script type="math/tex; mode=display">D_{\rm Chebyshev}(x,y) = \max_i(|x_i - y_i|)=\lim_{k \to \infty} \bigg( \sum_{i=1}^n \left| x_i - y_i \right|^k \bigg)^{1/k}</script>
</div>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">chebyshev</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Chebyshev Distance</span>
<span class="sd">    :param rating1: rating</span>
<span class="sd">    :param rating2: rating</span>
<span class="sd">    :return: distance if common ratings exists, or -1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
            <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">commonRatings</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">distance</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicates no ratings in common</span>
</pre></div>

<h5 id="_5">皮尔逊相关系数<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h5>
<p>让我们仔细看看用户对乐队的评分，可以发现每个用户的打分标准非常不同：</p>
<ul>
<li>Bill没有打出极端的分数，都在2至4分之间； </li>
<li>Jordyn似乎喜欢所有的乐队，打分都在4至5之间； </li>
<li>Hailey是一个有趣的人，他的分数不是1就是4。</li>
</ul>
<p>那么，如何比较这些用户呢？比如Hailey的4分相当于Jordan的4分还是5分呢？我觉得更接近5分。这样一来就会影响到推荐系统的准确性了。Clara最低给了4分——她所有的打分都在4至5分之间，这种现象在数据挖掘领域称为<strong>分数膨胀</strong>。</p>
<p><img alt="pearsonCoefficient" src="../figures/pearsonCoefficient.png" /></p>
<p>解决方法之一是使用皮尔逊相关系数, 用于度量两个变量X和Y之间的相关(线性相关)，其值介于-1与1之间, 1表示完全吻合，-1表示完全相悖。下面是常见的几组<span><span class="MathJax_Preview">(x, y)</span><script type="math/tex">(x, y)</script></span>点集的皮尔逊相关系数。</p>
<p><img alt="commonperasonCoefficient" src="../figures/commonperasonCoefficient.png" /></p>
<p>两个变量之间的皮尔逊相关系数定义为两个变量之间的协方差(<span><span class="MathJax_Preview">\text{cov}(X,Y)</span><script type="math/tex">\text{cov}(X,Y)</script></span>)和标准差(<span><span class="MathJax_Preview">\sigma_X</span><script type="math/tex">\sigma_X</script></span>)的商：</p>
<div>
<div class="MathJax_Preview">\rho_{X,Y}={\mathrm{cov}(X,Y) \over \sigma_X \sigma_Y} ={E[(X-\mu_X)(Y-\mu_Y)] \over \sigma_X\sigma_Y}</div>
<script type="math/tex; mode=display">\rho_{X,Y}={\mathrm{cov}(X,Y) \over \sigma_X \sigma_Y} ={E[(X-\mu_X)(Y-\mu_Y)] \over \sigma_X\sigma_Y}</script>
</div>
<p>对于样本皮尔逊相关系数:</p>
<div>
<div class="MathJax_Preview">r_{xy}=\frac{\sum x_iy_i-n \bar{x} \bar{y}}{(n-1) s_x s_y}=\frac{n\sum x_iy_i-\sum x_i\sum y_i}{\sqrt{n\sum x_i^2-(\sum x_i)^2}~\sqrt{n\sum y_i^2-(\sum y_i)^2}}.</div>
<script type="math/tex; mode=display">r_{xy}=\frac{\sum x_iy_i-n \bar{x} \bar{y}}{(n-1) s_x s_y}=\frac{n\sum x_iy_i-\sum x_i\sum y_i}{\sqrt{n\sum x_i^2-(\sum x_i)^2}~\sqrt{n\sum y_i^2-(\sum y_i)^2}}.</script>
</div>
<p>以上方程给出了计算样本皮尔逊相关系数简单的单流程算法，但是其依赖于涉及到的数据，有时它可能是数值不稳定的。但它最大的优点是，用代码实现的时候可以只遍历一次数据。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pearson</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute pearson coefficient</span>
<span class="sd">    :param rating1: a dictionary</span>
<span class="sd">    :param rating2: a dictionary</span>
<span class="sd">    :return: pearson coefficient</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sum_xy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sum_x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sum_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sum_x2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sum_y2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">sum_xy</span> <span class="o">+=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">sum_x</span> <span class="o">+=</span> <span class="n">x</span>
            <span class="n">sum_y</span> <span class="o">+=</span> <span class="n">y</span>
            <span class="n">sum_x2</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">sum_y2</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">commonRatings</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="c1"># now compute denominator</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum_x2</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">sum_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> 
                <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum_y2</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">sum_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">denominator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sum_xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">sum_x</span> <span class="o">*</span> <span class="n">sum_y</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">denominator</span>
</pre></div>

<h5 id="_6">余弦相似度<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>当我们用1500万首歌曲来比较两个用户时，很有可能他们之间没有任何交集，这样一来就无从计算他们之间的距离了。类似的情况是在计算两篇文章的相似度时。余弦相似度的计算中会略过这些非零值。它的计算公式是：</p>
<div>
<div class="MathJax_Preview">\cos(x,y) = \frac{x\cdot y}{||x||\times||y||}</div>
<script type="math/tex; mode=display">\cos(x,y) = \frac{x\cdot y}{||x||\times||y||}</script>
</div>
<p>其中，<span><span class="MathJax_Preview">\cdot</span><script type="math/tex">\cdot</script></span> 号表示数量积。<span><span class="MathJax_Preview">||x||</span><script type="math/tex">||x||</script></span>表示向量<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>的模。</p>
<p>余弦相似度在文本挖掘中应用得较多，在协同过滤中也会使用到。</p>
<h5 id="_7">应该使用哪种相似度？<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<ul>
<li>如果数据存在“分数膨胀”问题，就使用皮尔逊相关系数。 </li>
<li>如果数据比较“密集”，变量之间基本都存在公有值，且这些距离数据是非常重要的，那就使用欧几里得或曼哈顿距离。</li>
<li>如果数据是稀疏的，则使用余弦相似度。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>在数据标准化(<span><span class="MathJax_Preview">\mu=0,\sigma=1</span><script type="math/tex">\mu=0,\sigma=1</script></span>）后，Pearson相关性系数、余弦相似度、欧式距离的平方可认为是等价的[<a href="https://www.zhihu.com/question/19734616">1</a>]。</p>
</div>
<h4 id="knn">kNN<a class="headerlink" href="#knn" title="Permanent link">&para;</a></h4>
<p>上面的做法中，我们只依靠最相似的一个用户来做推荐，如果这个用户有些特殊的偏好，就会直接反映在推荐内容里。解决方法之一是找寻多个相似的用户，这里就要用到K最邻近算法了。</p>
<p>在协同过滤中可以使用K最邻近算法来找出K个最相似的用户，以此作为推荐的基础。不同的 应用有不同的K值，需要做一些实验来得出。以下给到读者一个基本的思路。 假设我要为Ann做推荐，并令K=3。使用皮尔逊相关系数得到的结果是：</p>
<table>
<thead>
<tr>
<th>Person</th>
<th>Pearson</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sally</td>
<td>0.8</td>
</tr>
<tr>
<td>Eric</td>
<td>0.7</td>
</tr>
<tr>
<td>Amanda</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<p>这三个人都会对推荐结果有所贡献，问题在于我们如何确定他们的比重呢？ 我们直接用相关系数的比重来描述，Sally的比重是0.8/2=40%，Eric是0.7/2=35%，Amanda 则是25%：</p>
<p>假设他们三人对Grey Wardens的评分以及加权后的结果如下：</p>
<table>
<thead>
<tr>
<th>Person</th>
<th>Grey Wardens Rating</th>
<th>Influence</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sally</td>
<td>4.5</td>
<td>25%</td>
</tr>
<tr>
<td>Eric</td>
<td>5</td>
<td>35%</td>
</tr>
<tr>
<td>Amanda</td>
<td>3.5</td>
<td>40%</td>
</tr>
</tbody>
</table>
<p>最后计算得到的分数为为加权和 <span><span class="MathJax_Preview">4.5\times 25\% + 5\times 35\% + 3.5 \times 40\%</span><script type="math/tex">4.5\times 25\% + 5\times 35\% + 3.5 \times 40\%</script></span>。</p>
<h4 id="python">Python推荐模块<a class="headerlink" href="#python" title="Permanent link">&para;</a></h4>
<p>Cai-Nicolas Zeigler从图书漂流站收集了超过100万条评价数据——278,858位用户为271,379本书打了分。数据可以从这个<a href="http://www2.informatik.uni-freiburg.de/~cziegler/BX/">地址</a>获得。</p>
<p>CSV文件包含了三张表：</p>
<ul>
<li>用户表，包括用户ID、位置、年龄等信息。其中用户的姓名已经隐去； </li>
<li>书籍表，包括ISBN号、标题、作者、出版日期、出版社等；</li>
<li>评分表，包括用户ID、书籍ISBN号、以及评分（0-10分）。</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Recommender</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Recommender</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">books</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">user_ratings</span><span class="p">,</span> <span class="n">book_ratings</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize basic data</span>
<span class="sd">        :param books: a dictionary of books, whose key is book id</span>
<span class="sd">        :param users: a dictionary of users, whose key is user id</span>
<span class="sd">        :param book_ratings: a dictionary of book ratings, whose key is book id</span>
<span class="sd">        :param user_ratings: a dictionary of user ratings, whose key is user id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">books</span> <span class="o">=</span> <span class="n">books</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="n">users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span> <span class="o">=</span> <span class="n">book_ratings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span> <span class="o">=</span> <span class="n">user_ratings</span>

    <span class="k">def</span> <span class="nf">recommend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_to_recommend_int</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recommend user books</span>
<span class="sd">        :param user_to_recommend_int: int, user id</span>
<span class="sd">        :param k : int, for nearest k neighbors</span>
<span class="sd">        :return: a list of books</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_to_recommend</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_to_recommend_int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_to_recommend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;user does not exist!!&quot;</span><span class="p">)</span>

        <span class="c1"># find the user having min distances from user_to_recommend</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">find_user</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">user_to_recommend</span> <span class="o">==</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># extract user ratings based on user ids, </span>
            <span class="c1"># and compute the distance between them</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="n">Distance</span><span class="o">.</span><span class="n">pearson</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_to_recommend</span><span class="p">],</span> 
                 <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">distance</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="n">distance</span><span class="p">])</span>
                <span class="n">find_user</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">find_user</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># sort user based on their distances</span>
        <span class="c1"># pearson 系数越大，距离越近，所以用reverse</span>
        <span class="n">distances</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># compute weight based on distances</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]</span>
        <span class="n">sum_distance</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">distance</span> <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distances</span><span class="p">)):</span>
            <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sum_distance</span>

        <span class="c1"># recommend books</span>
        <span class="n">books_to_recommend</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">book_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_id</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">book_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_to_recommend</span><span class="p">]:</span>  <span class="c1"># the user haven&#39;t seen</span>
                        <span class="k">if</span> <span class="n">book_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">books_to_recommend</span><span class="p">:</span>  <span class="c1"># haven&#39;t recommend</span>
                            <span class="n">books_to_recommend</span><span class="p">[</span><span class="n">book_id</span><span class="p">]</span> <span class="o">=</span> 
                                 <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_id</span><span class="p">][</span><span class="n">book_id</span><span class="p">]</span><span class="o">*</span><span class="n">weight</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">books_to_recommend</span><span class="p">[</span><span class="n">book_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">books_to_recommend</span><span class="p">[</span><span class="n">book_id</span><span class="p">]</span> \
                                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_id</span><span class="p">][</span><span class="n">book_id</span><span class="p">]</span><span class="o">*</span><span class="n">weight</span>

        <span class="c1"># transform to a  list of tuple</span>
        <span class="n">books_to_recommend</span> <span class="o">=</span> <span class="p">[(</span><span class="n">book_id</span><span class="p">,</span> <span class="n">project_rating</span><span class="p">)</span> 
              <span class="k">for</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">project_rating</span> <span class="ow">in</span> <span class="n">books_to_recommend</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

        <span class="c1"># sort based on project_rating</span>
        <span class="n">books_to_recommend</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># extract book title</span>
        <span class="n">books_to_recommend</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="n">book_id</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
               <span class="k">for</span> <span class="n">book_id</span><span class="p">,</span> <span class="n">project_rating</span> <span class="ow">in</span> <span class="n">books_to_recommend</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">books_to_recommend</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ratings</span> <span class="o">=</span> <span class="n">BooksImport</span><span class="p">()</span>
    <span class="n">books</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">user_ratings</span><span class="p">,</span> <span class="n">book_ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">recommender_import</span><span class="p">()</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">Recommender</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">user_ratings</span><span class="p">,</span> <span class="n">book_ratings</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="mi">171118</span><span class="p">))</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Distance</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>


<span class="k">class</span> <span class="nc">Distance</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute distance of two users, having different ratings.</span>

<span class="sd">    Both rating1 and rating2 are</span>
<span class="sd">    dictionaries of the form {&#39;The Strokes&#39;: 3.0, &#39;Slightly Stoopid&#39;: 2.5}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">manhattan</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Manhattan distance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">common_ratings</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
                <span class="n">distance</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">common_ratings</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">common_ratings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">distance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicates no ratings in common</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">euclidean</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Euclidean Distance</span>
<span class="sd">        :param rating1: rating</span>
<span class="sd">        :param rating2: rating</span>
<span class="sd">        :return: distance if common ratings exists, or -1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
                <span class="n">distance</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="n">commonRatings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">distance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicates no ratings in common</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">chebyshev</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Chebyshev Distance</span>
<span class="sd">        :param rating1: rating</span>
<span class="sd">        :param rating2: rating</span>
<span class="sd">        :return: distance if common ratings exists, or -1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
                <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="n">commonRatings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">distance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicates no ratings in common</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pearson</span><span class="p">(</span><span class="n">rating1</span><span class="p">,</span> <span class="n">rating2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute pearson coefficient</span>
<span class="sd">        :param rating1: a dictionary</span>
<span class="sd">        :param rating2: a dictionary</span>
<span class="sd">        :return: pearson coefficient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sum_xy</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sum_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sum_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sum_x2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sum_y2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rating2</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">rating1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">rating2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">sum_xy</span> <span class="o">+=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
                <span class="n">sum_x</span> <span class="o">+=</span> <span class="n">x</span>
                <span class="n">sum_y</span> <span class="o">+=</span> <span class="n">y</span>
                <span class="n">sum_x2</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">sum_y2</span> <span class="o">+=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">commonRatings</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">commonRatings</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># now compute denominator</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum_x2</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">sum_x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>\ 
            <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum_y2</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">sum_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">denominator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">sum_xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">sum_x</span> <span class="o">*</span> <span class="n">sum_y</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="n">denominator</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_2" />
<label for="__tab_1_2">books_import</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">BooksImport</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">books</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bx_books_import</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bx_users_import</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bx_ratings_import</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">bx_books_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        import books meta information</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">booksfile</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;BX-Dump/BX-Books.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">booksfile</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                <span class="n">isbn</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">author</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">year</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="n">isbn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">author</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">}</span>

            <span class="n">booksfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Failed to load: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bx_users_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        import user meta information</span>
<span class="sd">        user is a dictionary, whose key is user_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">users_file</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;BX-Dump/BX-Users.csv&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;utf--8&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">users_file</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                <span class="n">user_id</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">location</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">users_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Failed to load: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bx_ratings_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ratings_file</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;BX-Dump/BX-Book-Ratings.csv&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;utf--8&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ratings_file</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                <span class="n">user_id</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">book_id</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="n">rating</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">book_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span><span class="p">[</span><span class="n">book_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span><span class="p">[</span><span class="n">book_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">rating</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">[</span><span class="n">user_id</span><span class="p">][</span><span class="n">book_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">rating</span>

            <span class="n">ratings_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Failed to load: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_books</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">books</span>

    <span class="k">def</span> <span class="nf">get_users</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span>

    <span class="k">def</span> <span class="nf">get_user_ratings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span>

    <span class="k">def</span> <span class="nf">get_book_ratings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span>

    <span class="k">def</span> <span class="nf">recommender_import</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">books</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_ratings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">book_ratings</span>
</pre></div></div>
</div>
<h3 id="2">2 隐式评价和基于物品的过滤算法<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<h4 id="_8">隐式评价<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>用户的评价类型可以分为显式评价和隐式评价。<strong>显式评价</strong>指的是用户明确地给出对物品的评价。最常见的例子是YouTube上的“喜欢”和“不喜欢”按钮，以及亚马逊的星级评价系统。</p>
<p><strong>隐式评价</strong>，就是我们不让用户明确给出对物品的评价，而是通过观察他们的行为来获得偏好信息。示例之一是记录用户在纽约时报网上的点击记录，亚马逊上用户的实际购买记录。</p>
<p>我们可以收集到哪些隐式评价呢？ e.g. 网页方面：页面点击、停留时间、重复访问次数、引用率、Hulu上观看视频的次数；音乐播放器：播放的曲目、跳过的曲目、播放次数；</p>
<h4 id="_9">基于物品的过滤算法<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>目前为止我们描述的都是基于用户的协同过滤算法：将一个用户和其他<em>所有</em>用户进行对比，找到相似的人。这种算法有两个弊端：</p>
<ol>
<li><strong>扩展性</strong>：随着用户数量的增加，其计算量也会增加。这种算法在只有几千个用户的情况下能够工作得很好，但达到一百万个用户时就会出现瓶颈。</li>
<li><strong>稀疏性</strong>：大多数推荐系统中，用户仅仅对一小部分物品进行了评价，这就造成了数据的稀疏性。比如亚马逊有上百万本书，但用户只评论了很少一部分，于是就很难找到两个相似的用户了。</li>
</ol>
<h5 id="_10">修正的余弦相似度<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h5>
<p>使用余弦相似度来计算两个物品的距离。由于“分数膨胀”现象，需要从用户的评价中减去他所有评价的均值，这就是修正的余弦相似度(Adjusted Cosine Similarity)。这个公式来自于一篇影响深远的论文《<a href="http://files.grouplens.org/papers/www10_sarwar.pdf">基于物品的协同过滤算法</a>》。</p>
<div>
<div class="MathJax_Preview">s(i,j) =\frac{\sum_{u\in U}(R_{u,i}-\bar R_u)(R_{u,j}-\bar R_u)}{\sqrt{\sum_{u\in U}(R_{u,i}-\bar R_u)^2}\sqrt{\sum_{u\in U}(R_{u,j}-\bar R_u)^2}}</div>
<script type="math/tex; mode=display">s(i,j) =\frac{\sum_{u\in U}(R_{u,i}-\bar R_u)(R_{u,j}-\bar R_u)}{\sqrt{\sum_{u\in U}(R_{u,i}-\bar R_u)^2}\sqrt{\sum_{u\in U}(R_{u,j}-\bar R_u)^2}}</script>
</div>
<p><span><span class="MathJax_Preview">U</span><script type="math/tex">U</script></span>表示同时评价过物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>和<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>的用户集合， <span><span class="MathJax_Preview">\bar R_u</span><script type="math/tex">\bar R_u</script></span>表示用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对所有物品的评价均值，<span><span class="MathJax_Preview">s(i,j)</span><script type="math/tex">s(i,j)</script></span>表示物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>和<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>的相似度。</p>
<p><img alt="Relative performance of different similarity measures" src="../figures/relative_performance_of_different_similarity_measures.png" /></p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cosinesimilarity</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">,</span> <span class="n">userRatings</span><span class="p">):</span>
    <span class="n">averages</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="n">userRatings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">averages</span><span class="p">[</span><span class="n">user</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># 分子</span>
    <span class="n">dem1</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># 分母的第一部分</span>
    <span class="n">dem2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">ratings</span><span class="p">)</span> <span class="ow">in</span> <span class="n">userRatings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">ratings</span> <span class="ow">and</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">ratings</span><span class="p">:</span>
            <span class="n">avg</span> <span class="o">=</span> <span class="n">averages</span><span class="p">[</span><span class="n">user</span><span class="p">]</span>
            <span class="n">num</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span> <span class="o">-</span> <span class="n">avg</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="n">item2</span><span class="p">]</span> <span class="o">-</span> <span class="n">avg</span><span class="p">)</span>
            <span class="n">dem1</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span> <span class="o">-</span> <span class="n">avg</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">dem2</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span> <span class="o">-</span> <span class="n">avg</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">num</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dem1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dem2</span><span class="p">))</span>
</pre></div>

<h5 id="_11">预测<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<p>那下面该如何使用它来做预测呢？比如我想知道David有多喜欢Kacey Musgraves？在計算完 similarity 之後，下一步驟就是要進行某個 item 的預測，這裡有兩種方法，分別是： weighted-sum 和 regression。</p>
<p><hh>weighted-sum</hh></p>
<p><img alt="" src="../figures/predict.png" /></p>
<div>
<div class="MathJax_Preview">p(u,i) = \frac{{\sum_{N\in \text{similarTo}(i)}(S_{i,N}\times R_{u,N})}}{\sum_{N\in \text{similarTo}(i)}|S_{i,N}|}</div>
<script type="math/tex; mode=display">p(u,i) = \frac{{\sum_{N\in \text{similarTo}(i)}(S_{i,N}\times R_{u,N})}}{\sum_{N\in \text{similarTo}(i)}|S_{i,N}|}</script>
</div>
<p>其中<span><span class="MathJax_Preview">p(u,i)</span><script type="math/tex">p(u,i)</script></span>表示预测的用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>的评分，<span><span class="MathJax_Preview">S_{i,N}</span><script type="math/tex">S_{i,N}</script></span>表示物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>和<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>的相似度，<span><span class="MathJax_Preview">R_{u,N}</span><script type="math/tex">R_{u,N}</script></span>表示用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对物品<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>的评分。<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>是一个物品的集合，有如下特性：用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对集合中的物品打过分，物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>和集合中的物品有相似度数据。</p>
<h5 id="python_1">使用Python实现修正的余弦相似度算法<a class="headerlink" href="#python_1" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ItemBasedCF</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    使用修正的余弦相似度实现物品推荐</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize data</span>
<span class="sd">        :param data: a dict of (user, ratings)</span>
<span class="sd">        For instance, users2 = {&quot;Amy&quot;: {&quot;Taylor Swift&quot;: 4, &quot;PSY&quot;: 3, &quot;Whitney Houston&quot;: 4},</span>
<span class="sd">            &quot;Clara&quot;: {&quot;PSY&quot;: 3.5, &quot;Whitney Houston&quot;: 4},</span>
<span class="sd">            &quot;Daisy&quot;: {&quot;Taylor Swift&quot;: 5, &quot;Whitney Houston&quot;: 3}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>   <span class="c1"># a set of items</span>

        <span class="c1"># compute average user ratings of given data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avg_user_rating</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_user_rating</span><span class="p">[</span><span class="n">user</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">adjusted_cosine_similarity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute adjusted cosine similarity</span>
<span class="sd">        :param item1: an item</span>
<span class="sd">        :param item2: an item</span>
<span class="sd">        :return: similarity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">item1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">item2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input Item NOT FOUND!&quot;</span><span class="p">))</span>


        <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># numerator</span>
        <span class="n">den1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># denominator1</span>
        <span class="n">den2</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># denominator2</span>
        <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">ratings</span> <span class="ow">and</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">ratings</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_user_rating</span><span class="p">[</span><span class="n">user</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="n">item2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_user_rating</span><span class="p">[</span><span class="n">user</span><span class="p">]</span>
                <span class="n">num</span> <span class="o">+=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
                <span class="n">den1</span> <span class="o">+=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
                <span class="n">den2</span> <span class="o">+=</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>

        <span class="n">den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">den1</span><span class="o">*</span><span class="n">den2</span><span class="p">)</span>  <span class="c1"># denominator</span>
        <span class="k">if</span> <span class="n">den</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        predict rating of given user on given item</span>
<span class="sd">        :param user: an user</span>
<span class="sd">        :param item: an item</span>
<span class="sd">        :return: rating</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input User NOT FOUND!&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input Item NOT FOUND!&quot;</span><span class="p">))</span>

        <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># numerator</span>
        <span class="n">den</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># denominator</span>
        <span class="k">for</span> <span class="n">another_item</span><span class="p">,</span> <span class="n">rating</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="n">another_item</span><span class="p">:</span>
                <span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_cosine_similarity</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">another_item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">similarity</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">num</span> <span class="o">+=</span> <span class="n">rating</span> <span class="o">*</span> <span class="n">similarity</span>
                <span class="n">den</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">similarity</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">den</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

    <span class="k">def</span> <span class="nf">recommend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        recommend items to the user</span>
<span class="sd">        :param user: an user</span>
<span class="sd">        :return: a list of items(up to 10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">]:</span>
                <span class="n">predict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">predict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">predict</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>

        <span class="n">recommendations</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">recommendations</span><span class="p">))</span>
</pre></div>

<h4 id="slope-one">Slope One算法<a class="headerlink" href="#slope-one" title="Permanent link">&para;</a></h4>
<p>Slope One是另一种比较流行的基于物品的协同过滤算法。它最大的优势是简单，易于实现。Slope One算法是在一篇名为《<a href="https://arxiv.org/abs/cs/0702144">Slope One Predictors for Online Rating-Based Collaborative Filtering</a>》的论文中提出的，由Lemire和Machlachlan合著。这篇论文非常值得一读。</p>
<p>我们用一个简单的例子来了解这个算法。假设A给Item I打了1分，给Item J打了1.5分；B给Item I打了2分。我们可以用以下逻辑来预测B对Item J的评分：由于A给Item J打的分数要比Item I的高0.5分，所以我们预测B也会给高0.5分，即2.5分。</p>
<p><img alt="BasisofSLOPEONEscheme" src="../figures/BasisofSLOPEONEscheme.png" /></p>
<p>可以将Slope One分为两个步骤： </p>
<ul>
<li>计算出物品之间的两两差值(可以在夜间批量计算)</li>
<li>进行预测，可以使用加权的Slope One算法</li>
</ul>
<h5 id="_12">计算差值<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h5>
<p>物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>与物品<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>之间的平均差异为：</p>
<div>
<div class="MathJax_Preview">\text{dev}_{i,j}=\sum_{u\in S_{i,j}(X)}\frac{u_i-u_j}{\text{card}(S_{i,j}(X))}</div>
<script type="math/tex; mode=display">\text{dev}_{i,j}=\sum_{u\in S_{i,j}(X)}\frac{u_i-u_j}{\text{card}(S_{i,j}(X))}</script>
</div>
<p>其中<span><span class="MathJax_Preview">S_{i,j}(X)</span><script type="math/tex">S_{i,j}(X)</script></span>表示同时评价过<span><span class="MathJax_Preview">i,j</span><script type="math/tex">i,j</script></span>的用户集合，<span><span class="MathJax_Preview">\text{card}(S)</span><script type="math/tex">\text{card}(S)</script></span>表示<span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>中有多少个元素，<span><span class="MathJax_Preview">X</span><script type="math/tex">X</script></span>表示所有评分值的集合，<span><span class="MathJax_Preview">\text{card}(S_{j,i}(X))</span><script type="math/tex">\text{card}(S_{j,i}(X))</script></span>则表示同时评价过物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>和<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>的用户数，<span><span class="MathJax_Preview">u_i</span><script type="math/tex">u_i</script></span>表示用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>的评分。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>如果有一个新进的用户对10个歌手做了评价，我们是否需要重新计算20万×20万的差异数据，或是有其他更简单的方法？ 答案是你不需要计算整个数据集，这正是Slope One的美妙之处。对于两个物品，我们只需记录同时评价过这对物品的用户数就可以了。</p>
</div>
<h5 id="slope-one_1">使用加权的Slope One算法进行预测<a class="headerlink" href="#slope-one_1" title="Permanent link">&para;</a></h5>
<p>使用加权的Slope One算法(Weighted Slope One, WS1)来进行预测，用<span><span class="MathJax_Preview">P^{WS1}</span><script type="math/tex">P^{WS1}</script></span>来表示预测用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对物品<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>的评分：</p>
<div>
<div class="MathJax_Preview">P^{WS1}(u)_j=\frac{\sum_{i\in S(u) - \{j\}}(\text{dev}_{i,j}+u_i)c_{j,i}}{\sum_{i\in S(u) - \{j\}} c_{j,i}}</div>
<script type="math/tex; mode=display">P^{WS1}(u)_j=\frac{\sum_{i\in S(u) - \{j\}}(\text{dev}_{i,j}+u_i)c_{j,i}}{\sum_{i\in S(u) - \{j\}} c_{j,i}}</script>
</div>
<p>其中：<span><span class="MathJax_Preview">c_{j,i}=\text{card}(S_{j,i}(\chi))</span><script type="math/tex">c_{j,i}=\text{card}(S_{j,i}(\chi))</script></span>。式中<span><span class="MathJax_Preview">\sum_{i\in S(u) - \{j\}}</span><script type="math/tex">\sum_{i\in S(u) - \{j\}}</script></span>表示用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>评价的除<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>除外的物品，其他符号与上一节的含义相同。这个公式其实很好理解，<span><span class="MathJax_Preview">\text{dev}_{i,j}+u_i</span><script type="math/tex">\text{dev}_{i,j}+u_i</script></span>表示根据物品<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>预测得到的用户<span><span class="MathJax_Preview">u</span><script type="math/tex">u</script></span>对物品<span><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span>的评分，在此基础上进行了加权平均就得到<span><span class="MathJax_Preview">P^{WS1}</span><script type="math/tex">P^{WS1}</script></span>。</p>
<h5 id="pythonslope-one">使用Python实现Slope One算法<a class="headerlink" href="#pythonslope-one" title="Permanent link">&para;</a></h5>
<p>其实代码整体思路比较简单，把公式转化为代码就可以了，没有什么特殊的技巧。唯一需要注意的是尽可能的测试该程序，保证其正确性。由于网上有不少SlopeOne代码，我自己写完以后和他们的结果比对，发现完全一致。</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SlopeOne</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize</span>
<span class="sd">        :param data: a dictionary, whose key is an item, and value is  a rating.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c1"># frequencies, a dictionary, whose key is an item,</span>
        <span class="c1">#   and value is a dictionary of (item, frequency)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># deviations, a dictionary, whose key is an item,</span>
        <span class="c1">#   and value is a dictionary of (item, deviation)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">computeDeviations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute deviations between items</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 获取每位用户的评分数据ratings</span>
        <span class="k">for</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1"># 对于该用户的每个评分项(歌手、分数)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">item1</span><span class="p">,</span> <span class="n">rating1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span> <span class="p">{})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span> <span class="p">{})</span>
                <span class="c1"># 再次遍历该用户的每个评分项</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">item2</span><span class="p">,</span> <span class="n">rating2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">:</span>
                        <span class="c1"># 将评分的差异保存到变量中</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">item2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="p">[</span><span class="n">item1</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">item2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">rating1</span> <span class="o">-</span> <span class="n">rating2</span><span class="p">)</span>

        <span class="c1"># 计算deviations</span>
        <span class="k">for</span> <span class="n">item1</span><span class="p">,</span> <span class="n">deviations</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">deviations</span><span class="p">:</span>
                <span class="n">deviations</span><span class="p">[</span><span class="n">item2</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        predict the ratings of the user regard to the item</span>
<span class="sd">        Using Weighted Slope One (WSO)</span>
<span class="sd">        :param user: an user</span>
<span class="sd">        :param item: an item</span>
<span class="sd">        :return: a prediction, double</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">user</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span>

        <span class="c1"># predictions</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># 用户user 评价的除 item 除外的物品</span>
        <span class="k">for</span> <span class="n">diff_item</span><span class="p">,</span> <span class="n">ratings</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">diff_item</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">diff_item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">predictions</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">diff_item</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">][</span><span class="n">diff_item</span><span class="p">])</span> \
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">diff_item</span><span class="p">]</span>
            <span class="n">frequency</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">diff_item</span><span class="p">]</span>

        <span class="n">predictions</span> <span class="o">/=</span> <span class="n">frequency</span>

        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span> <span class="nf">recommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        recommend items to user</span>
<span class="sd">        :param user: an user</span>
<span class="sd">        :return: a list of items recommended</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">computeDeviations</span><span class="p">()</span>

        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># 所有的item</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviations</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># 用户未评价过的item</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">user</span><span class="p">]:</span>
                <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">)))</span>

        <span class="n">recommendations</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">recommendations</span><span class="p">))</span>
</pre></div>

<h4 id="example-movielens">Example: MovieLens<a class="headerlink" href="#example-movielens" title="Permanent link">&para;</a></h4>
<p>MovieLens数据集是由明尼苏达州大学的GroupLens研究项目收集的，是用户对电影的评分。 这个数据集可以在<a href="www.grouplens.org">www.grouplens.org</a>下载。其中100K数据集包含了943位用户对1682部电影的评价，约10万条记录。</p>
<p>使用MovieLens 100K数据集处理的过程如下：</p>
<ul>
<li>根据README中描述的文件格式，将电影、用户、评分数据导入并转化为合适的数据格式</li>
<li>利用SlopeOne进行推荐</li>
<li>将推荐结果展示</li>
</ul>
<p>代码整体非常简洁的，因为可以直接继承上面写的SlopeOne算法。</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MovieRecommendation</span><span class="p">(</span><span class="n">SlopeOne</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">movie</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MovieRecommendation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movie</span> <span class="o">=</span> <span class="n">movie</span>


    <span class="k">def</span> <span class="nf">recommend_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recommendation</span><span class="p">(</span><span class="n">user</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">movie</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">],</span> <span class="n">movies</span><span class="p">))</span>
</pre></div>

<h4 id="_13">进一步阅读<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p>http://www.diva-portal.se/smash/get/diva2:811049/FULLTEXT01.pdf
https://dzone.com/articles/slope-one-recommender
https://www.slideshare.net/irecsys/slope-one-recommender-on-hadoop-15199798?from_action=save#</p>
<h3 id="3">3 分类<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>试想一个极端的例子：一个新乐队发布了专辑，这张专辑还没有被任何用户评价或购买过，如果是用协同过滤的话，那它将永远不会出现在推荐列表中。</p>
<p>这时我们可以<strong>根据物品特征进行分类</strong>。</p>
<p>来看一下<a href="http://www.pandora.com/newpandora">潘多拉音乐盒</a>的例子。在这个站点上你可以设立各种音乐频道，只需为这个频道添加一个歌手，潘多拉就会播放和这个歌手风格相类似的歌曲。原因在于潘多拉网站的推荐系统是基于一个名为音乐基因的项目。 他们雇佣了专业的音乐家对歌曲进行分类（提取它们的“基因”）；这些专家要甄别400多种音乐特征。</p>
<p>具体方法是将每种歌曲类型拆分成单独的特征，并对此进行打分。每个特征都是1到5分的尺度，0.5分为一档。1分表示完全不符合，5分则表示很相符。</p>
<p><img alt="" src="../figures/musicFeature.jpg" /></p>
<p>下表使用一些音乐特征(使用钢琴的程度、使用美声的程度、节奏等)对歌曲进行评分：</p>
<p><img alt="" src="../figures/musicRatingBasedOnFeatures.jpg" /></p>
<p>可以将上表存成二维HashTable的形式，可以直接利用第一章中的各种距离计算公式计算歌曲之间的距离来进行推荐。按我的理解，可以这么看待问题，或许更加容易理解：把这些特征(piano, vocals, driving beat)看成是用户，各个特征上的评分可以看成是用户评分，把基于用户的协同过滤看成是基于特征的协同过滤。</p>
<h4 id="_14">评分标准<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>假如我想增加一种音乐特征——每分钟的鼓点数（bpm），用来判断这是一首快歌还是慢歌。由于bpm取值范围(100~200左右)与前面(1~5)的不一致，导致bpm基本决定了两首歌的距离。</p>
<p>评分标准不一是所有推荐系统的大敌！让数据变得可用我们可以对其进行<strong>标准化</strong>(normalization)。 </p>
<h5 id="rescalingmin-max-normalization">Rescaling/Min-max normalization<a class="headerlink" href="#rescalingmin-max-normalization" title="Permanent link">&para;</a></h5>
<p>最常用的方法是将所有数据都转化为0到1之间的值： 将每个值减去最小值，并除以范围：</p>
<div>
<div class="MathJax_Preview">\frac{x_i-\min}{\max-\min}</div>
<script type="math/tex; mode=display">\frac{x_i-\min}{\max-\min}</script>
</div>
<h5 id="z-score-normalizationstandardization">z-score normalization/Standardization<a class="headerlink" href="#z-score-normalizationstandardization" title="Permanent link">&para;</a></h5>
<p>还可以使用<strong>标准分</strong>(z-score or standard score)：分值偏离均值的程度，</p>
<div>
<div class="MathJax_Preview">\text{standard score} = \frac{x_i-\bar x}{\sigma}</div>
<script type="math/tex; mode=display">\text{standard score} = \frac{x_i-\bar x}{\sigma}</script>
</div>
<h5 id="modified-z-score">Modified Z-Score<a class="headerlink" href="#modified-z-score" title="Permanent link">&para;</a></h5>
<p>标准分的问题在于它会受异常值的影响。 比如说一家公司有100名员工，普通员工每小时赚10美元，而CEO一年能赚600万，那全公司的平均时薪为38美元。在修正的标准分(Modified Z-Score)中，将标准分公式中的均值改为中位数(median)，将标准差改为<strong>平均绝对偏差</strong>(MAD, Mean Absolute Deviation[<a href="https://en.wikipedia.org/wiki/Average_absolute_deviation">wiki</a>])。</p>
<div>
<div class="MathJax_Preview">\text{modified z-score}= \frac{x_i-\text{median}}{\text{MAD}}</div>
<script type="math/tex; mode=display">\text{modified z-score}= \frac{x_i-\text{median}}{\text{MAD}}</script>
</div>
<div>
<div class="MathJax_Preview">\text{mean absolute deviation(MAD)} = \frac{\sum_i |x_i-\text{median}|}{\text{card}(x)}</div>
<script type="math/tex; mode=display">\text{mean absolute deviation(MAD)} = \frac{\sum_i |x_i-\text{median}|}{\text{card}(x)}</script>
</div>
<h5 id="_15">是否需要标准化？<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h5>
<p>需要进行标准化的情形：</p>
<ul>
<li>我们需要通过物品特性来计算距离；</li>
<li>不同特性之间的尺度相差很大。</li>
</ul>
<h4 id="python_2">Python数据格式<a class="headerlink" href="#python_2" title="Permanent link">&para;</a></h4>
<p>上面我们用二维HashTable的形式来存储歌曲的特征数据，这样做虽然可行，但却比较繁琐，piano、vocals这样的键名需要重复很多次。我们可以将其简化为向量，即Python中的数组类型：</p>
<div class="codehilite"><pre><span></span><span class="c1"># 物品向量中的特征依次为：piano, vocals, beat, blues, guitar, backup vocals, rap</span>
<span class="n">items</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Dr Dog/Fate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="s2">&quot;Phoenix/Lisztomania&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="s2">&quot;Heartless Bastards/Out&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="s2">&quot;Black Eyed Peas/Rock That Body&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="s2">&quot;Lady Gaga/Alejandro&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

<p>那么用户“赞”和“踩”的数据用什么表示呢？由于用户并不会对所有的歌曲都做这些操作，所以用嵌套的字典来表示比较方便：</p>
<div class="codehilite"><pre><span></span><span class="n">users</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Angelica&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Dr Dog/Fate&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Phoenix/Lisztomania&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Mike Posner&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Black Eyed Peas/Rock That Body&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Lady Gaga/Alejandro&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">},</span>
<span class="s2">&quot;Bill&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Dr Dog/Fate&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Phoenix/Lisztomania&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Heartless Bastards/Out at Sea&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Black Eyed Peas/Rock That Body&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Lady Gaga/Alejandro&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">}}</span>
</pre></div>

<p>这里使用L和D两个字母来表示喜欢和不喜欢。</p>
<h4 id="_16">分类器<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<p>分类器是指通过物品特征来判断它应该属于哪个组或类别的程序。分类器程序会基于一组已经做过分类的物品进行学习，从而判断新物品的所属类别。</p>
<p>建立一个分类函数，用来预测用户对一个新物品的喜好;这个函数会先计算出与这个物品距离最近的物品，然后找到用户对这个最近物品的评价，以此作为新物品的预测值。</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">simple_classifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="n">users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">items</span>


    <span class="k">def</span> <span class="nf">computeNearestNeighbor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemName</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        按照距离排序，返回邻近物品列表</span>
<span class="sd">        :param itemName</span>
<span class="sd">        :param itemVector</span>
<span class="sd">        :param items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">otherItem</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">otherItem</span> <span class="o">!=</span> <span class="n">itemName</span><span class="p">:</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">DistanceVector</span><span class="o">.</span><span class="n">manhattan</span><span class="p">(</span><span class="n">itemVector</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="n">otherItem</span><span class="p">])</span>
                <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">distance</span><span class="p">,</span> <span class="n">otherItem</span><span class="p">))</span>
        <span class="c1"># 最近的排在前面</span>
        <span class="n">distances</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">distances</span>

    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">itemName</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">):</span>
        <span class="n">nearest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNearestNeighbor</span><span class="p">(</span><span class="n">itemName</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user</span><span class="p">][</span><span class="n">nearest</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">rating</span>
</pre></div>

<p>让我们试用一下：</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">classify</span><span class="p">(</span><span class="s1">&#39;Angelica&#39;</span><span class="p">,</span> <span class="s1">&#39;Chris Cagle/I Breathe In. I Breathe Out&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span>
<span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="s1">&#39;L&#39;</span>
</pre></div>

<p>其实我们做的是一个分类器，将歌曲分为了用户喜欢和不喜欢两个类别。</p>
<h4 id="example">Example:运动项目<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<p>先看一个较为简单的例子——根据女运动员的身高和体重来判断她们是从事什么运动项目的。训练数据和测试数据分别来自athletesTrainingSet.txt和athletesTestSet.txt。文件格式如下：</p>
<div class="codehilite"><pre><span></span><span class="k">comment</span> <span class="k">class</span>   <span class="n">num</span> <span class="n">num</span>
<span class="n">Asuka</span> <span class="n">Teramoto</span>  <span class="n">Gymnastics</span>  <span class="mi">54</span>  <span class="mi">66</span>
<span class="n">Brittainey</span> <span class="n">Raven</span>    <span class="n">Basketball</span>  <span class="mi">72</span> <span class="mi">162</span>
</pre></div>

<h5 id="_17">数据格式<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h5>
<p>在Python中应该如何合适的表示这些数据呢？由于分类器程序根本不会使用到姓名，所以用姓名作为键值的字典是不合适的。由于我们需要遍历文件的数据，所以使用list类型是合理的。如下是最合理的：</p>
<div class="codehilite"><pre><span></span><span class="p">[(</span><span class="s1">&#39;Gymnastics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">66</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Asuka Termoto&#39;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s1">&#39;Basketball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">162</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Brittainey Raven&#39;</span><span class="p">]),</span> <span class="o">...</span><span class="p">]</span>
</pre></div>

<p>它将不同类型的数据区别开来了，依次是分类、特征、备注。</p>
<h5 id="python_3">Python代码<a class="headerlink" href="#python_3" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">AthleteClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize</span>
<span class="sd">        :param format: num, comment, class</span>
<span class="sd">        :param filename: filename for training data</span>
<span class="sd">        :param header: whether header line exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">format</span>
        <span class="c1"># self.data format: class, fields, comments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># a list of median</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">medians</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># mean absolute deviation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># test result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># training data if a file is provided</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">format</span><span class="p">:</span>
            <span class="c1"># data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_processing</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
            <span class="c1"># mad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_deviation</span><span class="p">()</span>
            <span class="c1"># normalize</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">normalizeColumn</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">pre_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        read file and transform to data format</span>
<span class="sd">        :param filename: filename for training data</span>
<span class="sd">        :param header: whether header line exist</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">file</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="c1"># skip header</span>
        <span class="k">if</span> <span class="n">header</span><span class="p">:</span>
            <span class="nb">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">raise</span><span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Input File Format Error&quot;</span><span class="p">))</span>
            <span class="n">vector</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">classification</span> <span class="o">=</span> <span class="p">([],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">field</span><span class="p">,</span> <span class="n">field_format</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">field_format</span> <span class="o">==</span> <span class="s2">&quot;num&quot;</span><span class="p">:</span>
                    <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">field_format</span> <span class="o">==</span> <span class="s2">&quot;class&quot;</span><span class="p">:</span>
                    <span class="n">classification</span> <span class="o">=</span> <span class="n">field</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">field_format</span> <span class="o">==</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span>
                    <span class="n">comment</span> <span class="o">+=</span> <span class="p">(</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">classification</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">comment</span><span class="o">.</span><span class="n">strip</span><span class="p">()])</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">mean_absolute_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculate mean absolute deviation of each fields for data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])):</span>
            <span class="c1"># calculate median</span>
            <span class="n">field</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">medians</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                                    <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">medians</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">normalizeColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given a column number, normalize that column in self.data</span>
<span class="sd">        using the Modified Standard Score</span>
<span class="sd">        Modified Standard Score = score - median /(maxScore - minScore)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
                <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">medians</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mad</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">normalizeVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given a vector, having the same format as the vector in the self.data[0][1],</span>
<span class="sd">        normalize it using a modified z-score</span>
<span class="sd">        :param itemVector: a vector, size of fields in self.data</span>
<span class="sd">        :return: a vector normazalied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">itemVector</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">medians</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">itemVector</span><span class="p">))]</span>

    <span class="k">def</span> <span class="nf">nearest_neighbor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        find nearest neighbor</span>
<span class="sd">        :param itemVector: a vector</span>
<span class="sd">        :return: nearest neighbor and the distance between them</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="p">[(</span><span class="n">DistanceVector</span><span class="o">.</span><span class="n">manhattan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">itemVector</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
                     <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        预测itemVector的分类</span>
<span class="sd">        :return: the result of the classification</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nearest_neighbor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalizeVector</span><span class="p">(</span><span class="n">itemVector</span><span class="p">))[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">initialize_test_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize test result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">classes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">another_class_name</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="p">[</span><span class="n">class_name</span><span class="p">][</span><span class="n">another_class_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testfile</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        test file, return accuracy</span>
<span class="sd">        :param testfile: a file</span>
<span class="sd">        :param header: whether header line exist</span>
<span class="sd">        :return: double, accuracy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">accurate</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># check if test result is initialized</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialize_test_result</span><span class="p">()</span>

        <span class="n">test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_processing</span><span class="p">(</span><span class="n">testfile</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">:</span>
            <span class="n">classify_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">classify_result</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">classify_result</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">accurate</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1">#else:</span>
                <span class="c1">#print(item, &quot;not equals&quot;, classify_result)</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">accurate</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

<p>结果测试准确率为84%。</p>
<div class="codehilite"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">AthleteClassifier</span><span class="p">(</span><span class="n">training_file</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">,</span> <span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span> <span class="c1">#84.2</span>
</pre></div>

<h4 id="example_1">Example: 鸢尾花<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h4>
<p>鸢尾花数据集在数据挖掘领域是比较有名的。 它是20世纪30年代Ronald Fisher对三种鸢尾花的50个样本做的测量数据(萼片和花瓣)。训练集中有120条数据，测试集中有30条，两者没有交集。</p>
<p>测试结果表明使用同样的分类器有93.1的正确率。如果计算距离时，使用欧式距离，分类器有96.6%的正确率。</p>
<div class="codehilite"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">AthleteClassifier</span><span class="p">(</span><span class="n">training_file</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;class&quot;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># 93.1% correct</span>
</pre></div>

<h4 id="example_2">Example: 每加仑燃油公里数<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h4>
<p>卡内基梅隆大学统计的汽车燃油消耗和公里数数据也是一个广泛使用的数据集。大致格式如下：</p>
<p><img alt="" src="../figures/mpgformat.jpg" /></p>
<p>根据汽缸数、排气量、马力、重量、 加速度等数据预测每加仑燃油公里数(mpg)。如果不进行标准化，准确率将只有32%。标准化之后有55%准确率。</p>
<h3 id="4">4 进一步探索分类<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<h4 id="knn_1">效果评估算法和kNN<a class="headerlink" href="#knn_1" title="Permanent link">&para;</a></h4>
<p>当我们构建完一个分类器后，应该问以下问题：分类器的准确度如何？ 结果理想吗？ 如何与其它分类器做比较？</p>
<h5 id="_18">训练集和测试集<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<p>数据集可以分为两个部分，第一部分用来构造分类器，称为<strong>训练集</strong>；另一部分用来评估分类器的结果，称为<strong>测试集</strong>。</p>
<h5 id="k">k折交叉验证<a class="headerlink" href="#k" title="Permanent link">&para;</a></h5>
<p>不过，这种上面这种简单、直接的做法似乎有问题：如果分割的时候不凑巧，就会引发异常。比如，若测试集中的篮球运动员恰巧都很矮，她们就会被归为马拉松运动员。解决方法之一是将数据集按不同的方式拆分，测试多次，取结果的平均值。</p>
<p>如果将数据集分成<span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span>份，用<span><span class="MathJax_Preview">k-1</span><script type="math/tex">k-1</script></span>份来做训练集，另一份来做测试集，并迭代<span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span>次，叫做<span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span><strong>折交叉验证</strong>(<span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span>-fold cross validation)。在数据挖掘中，通常的做法是将数据集拆分成十份，称为<strong>十折交叉验证</strong>。</p>
<p>我们来看一个示例：假设有一个分类器能判断某个人是否是篮球运动员，数据集包含500个运动员和500个普通人。</p>
<ul>
<li>第一步：将数据分成10份，每份包含50个篮球运动员，50个普通人</li>
<li>第二步：重复以下步骤10次<ul>
<li>每次迭代我们保留一份，比如第一次迭代保留第1份，第二次保留第2份。</li>
<li>我们使用剩余的9份来训练分类器，比如第一次迭代使用第2至10份来训练。</li>
<li>我们用刚才保留的一份来进行测试，并记录结果，比如：35个篮球运动员分类正确， 29个普通人分类正确。</li>
</ul>
</li>
<li>第三步：合并结果</li>
</ul>
<p>我们可以用一张表格来展示结果(就是马上要提到的混淆矩阵)：</p>
<p><img alt="" src="../figures/15379530847219.jpg" /></p>
<p>通过十折交叉验证得到的评价结果肯定会比二折或者三折来得准确，因为使用了更多的训练数据。</p>
<h5 id="_19">留一法<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h5>
<p>既然十折交叉验证效果那么好，我们为何不做一个<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>折交叉验证？<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>即数据集中的数据量。在数据挖掘领域，<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>折交叉验证又称为<strong>留一法</strong>。</p>
<ul>
<li>优点：<ul>
<li>几乎所有的数据进行训练，然后用一个数据进行测试。</li>
<li>确定性。</li>
</ul>
</li>
<li>缺点：<ul>
<li>最大的缺点是计算时间很长。</li>
<li>分层问题</li>
</ul>
</li>
</ul>
<p>在留一法中，所有的测试集都只包含一个数据(分层问题)。所以说，留一法对小数据集是合适的，但大多数情况下我们会选择十折交叉验证。</p>
<h4 id="_20">混淆矩阵<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<p>混淆矩阵(confusion matrix)可以展现更为详细的评价结果。混淆矩阵可以帮助我们快速识别出分类器到底在哪些类别上发生了混淆，因此得名。表格的行表示测试用例实际所属的类别，列则表示分类器的判断结果。</p>
<p><img alt="" src="../figures/hunxiaojuzheng.jpg" /></p>
<p>在这个示例中，我们的分类器可以很好地区分体操运动员和篮球运动员，而马拉松运动员则比较容易和其他两个类别发生混淆。</p>
<h4 id="application">Application: 每加仑燃油公里数<a class="headerlink" href="#application" title="Permanent link">&para;</a></h4>
<p>卡内基梅隆大学统计的汽车燃油消耗和公里数数据也是一个广泛使用的数据集。在<a href="../ch3/#example_2">前面一章</a>中已经介绍过。</p>
<p>根据汽缸数、排气量、马力、重量、 加速度等数据预测每加仑燃油公里数(mpg)。392条数据都存放在mpgData.txt文件中，并用下面这段Python代码将这些数据按层次等分成十份：</p>
<div class="codehilite"><pre><span></span><span class="c1"># divide data into 10 buckets</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">buckets</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">class_column</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    @param filename: file name of the original data.</span>
<span class="sd">    @param bucket_name: the prefix for all the bucket names.</span>
<span class="sd">    @param separator: the character that divides the columns.</span>
<span class="sd">    @param class_column: column that indicates the class, start from 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># put the data in 10 buckets</span>


    <span class="n">number_of_buckets</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># first read in the data and divide by category</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">separator</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># first get the category</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="n">class_column</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="c1"># initialize the buckets</span>
    <span class="n">buckets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_buckets</span><span class="p">):</span>
        <span class="n">buckets</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="c1"># now for each category put the data into the buckets</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># randomize order of instances for each class</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">bNum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># divide into buckets</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">buckets</span><span class="p">[</span><span class="n">bNum</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">bNum</span> <span class="o">=</span> <span class="p">(</span><span class="n">bNum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">number_of_buckets</span>

    <span class="c1"># write to file</span>
    <span class="k">for</span> <span class="n">bNum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_buckets</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">bNum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">buckets</span><span class="p">[</span><span class="n">bNum</span><span class="p">]:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># example of how to use this code          </span>
<span class="n">buckets</span><span class="p">(</span><span class="s2">&quot;mpgTrainingSet&quot;</span><span class="p">,</span> <span class="s1">&#39;mpgData&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

<p>执行这个程序后会生成10个文件：mpgData01、mpgData02等。然后需要修改上一章的近邻算法程序，让AthleteClassifier.test()函数能够执行十折交叉验证。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ten_fold_cross_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    10-fold cross validation</span>
<span class="sd">    :param bucket_name: the prefix for all the bucket names.</span>
<span class="sd">    :param separator: the character that divides the columns.</span>
<span class="sd">    :param format: num, comment, class</span>
<span class="sd">    :param header: whether header line exist</span>
<span class="sd">    :return: accuracy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">format</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># repeat 10 times, select test bucket for test</span>
    <span class="k">for</span> <span class="n">test_bucket_number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="c1"># select remaining 9 bucket for training</span>
        <span class="n">training_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">bucket_number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">test_bucket_number</span> <span class="o">!=</span> <span class="n">bucket_number</span><span class="p">:</span>
                <span class="n">training_filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">bucket_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">training_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre_processing</span><span class="p">(</span><span class="n">training_filename</span><span class="p">,</span> <span class="n">header</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">training_data</span>

        <span class="c1"># normalize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_deviation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalizeColumn</span><span class="p">()</span>

        <span class="c1"># test</span>
        <span class="n">test_filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">test_bucket_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_filename</span><span class="p">,</span> <span class="n">header</span><span class="p">))</span>

    <span class="c1"># print output</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;    &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">actual</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">actual</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    &quot;</span><span class="p">,</span> <span class="s2">&quot;+----&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">test_results</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%3s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">actual</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;  |&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">accuracy_count</span> <span class="ow">in</span> <span class="n">test_results</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%3s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">accuracy_count</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; |&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;    &quot;</span><span class="p">,</span> <span class="s2">&quot;+----&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>

    <span class="n">avg_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;accuray is&quot;</span><span class="p">,</span>  <span class="n">avg_accuracy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">avg_accuracy</span>
</pre></div>

<h4 id="kappa">Kappa指标<a class="headerlink" href="#kappa" title="Permanent link">&para;</a></h4>
<p>Kappa指标可以用来评价分类器的效果比随机分类要好多少，公式为</p>
<div>
<div class="MathJax_Preview">\kappa = \frac{P(c)-P(r)}{1-P(r)}</div>
<script type="math/tex; mode=display">\kappa = \frac{P(c)-P(r)}{1-P(r)}</script>
</div>
<p><span><span class="MathJax_Preview">P(c)</span><script type="math/tex">P(c)</script></span>表示分类器的准确率，<span><span class="MathJax_Preview">P(r)</span><script type="math/tex">P(r)</script></span>表示随机分类器的准确率。可以参考下列经验结果：</p>
<p><img alt="" src="../figures/kappa.jpg" /></p>
<h4 id="knn_2">kNN算法<a class="headerlink" href="#knn_2" title="Permanent link">&para;</a></h4>
<p>其实kNN算法已经在<a href="../ch1#knn">第一章</a>里叙述并使用了。当时计算距离时，使用的是皮尔森相关系数。那么，如果是曼哈顿距离呢？首先，将距离取倒数，然后把所有的距离倒数除以距离倒数的和，从而得到评分的权重，最后加权平均得到评分。</p>
<p>其实把距离的倒数看成是相似度，就非常容易理解了。</p>
<h4 id="example_3">Example: 比马印第安人糖尿病<a class="headerlink" href="#example_3" title="Permanent link">&para;</a></h4>
<p>这一节分析由美国国家糖尿病、消化和肾脏疾病研究所提供的比马印第安人糖尿病数据集(<a href="https://gist.githubusercontent.com/ktisha/c21e73a1bd1700294ef790c56c8aec1f/raw/819b69b5736821ccee93d05b51de0510bea00294/pima-indians-diabetes.csv">下载</a>)。数据集中的一条记录代表一名21岁以上的比马女性，她们分类两类：五年内查出患有糖尿病，以及没有得病。数据集中包含了8个特征，如怀孕次数，舒张压等。</p>
<p>数据集前八列是特征，最后一列是分类（1-患病，0-健康）。</p>
<p><img alt="" src="../figures/pima.png" /></p>
<p>结果如下：</p>
<p><img alt="" src="../figures/pimaTestResult.jpg" /></p>
<h3 id="5">5 朴素贝叶斯<a class="headerlink" href="#5" title="Permanent link">&para;</a></h3>
<h4 id="1_1">1 朴素贝叶斯<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h4>
<p>使用近邻算法时，我们很难对分类结果的置信度进行量化。但如果使用的是基于概率的分类算法——贝叶斯算法——那就可以给出分类结果的可能性了：这名运动员有80%的几率是篮球运动员。</p>
<p>近邻算法又称为<strong>被动学习算法</strong>。这种算法只是将训练集的数据保存起来，在收到测试数据时才会进行计算。如果我们有10万首音乐，那每进行一次分类，都需要遍历这10万条记录才行。</p>
<p>贝叶斯算法则是一种<strong>主动学习算法</strong>。它会根据训练集构建起一个模型，并用这个模型来对新的记录进行分类，因此速度会快很多。</p>
<p>贝叶斯算法的两个优点即：</p>
<ul>
<li>能够给出分类结果的置信度；</li>
<li>它是一种主动学习算法。</li>
</ul>
<h5 id="_21">后验概率<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h5>
<p>我们用<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>来表示<span><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span>条件下事件<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>发生的概率。<span><span class="MathJax_Preview">P(h)</span><script type="math/tex">P(h)</script></span>表示事件<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>发生的概率，称为h的先验概率。<span><span class="MathJax_Preview">P(h|d)</span><script type="math/tex">P(h|d)</script></span>称为后验概率，表示在观察了数据集<span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>之后，<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>事件发生的概率是多少。后验概率又称为条件概率。</p>
<h5 id="_22">贝叶斯法则<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h5>
<p>贝叶斯法则描述了<span><span class="MathJax_Preview">P(h)</span><script type="math/tex">P(h)</script></span>、<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>、<span><span class="MathJax_Preview">P(D)</span><script type="math/tex">P(D)</script></span>、以及<span><span class="MathJax_Preview">P(D|h)</span><script type="math/tex">P(D|h)</script></span>这四个概率之间的关系：</p>
<div>
<div class="MathJax_Preview">P(h|D) = \frac{P(D|h)P(h)}{P(D)}</div>
<script type="math/tex; mode=display">P(h|D) = \frac{P(D|h)P(h)}{P(D)}</script>
</div>
<p>如果我们有<span><span class="MathJax_Preview">h_1, h_2,...h_n</span><script type="math/tex">h_1, h_2,...h_n</script></span>等事件。计算不同事件发生的概率，</p>
<div>
<div class="MathJax_Preview">P(h_i|D) = \frac{P(D|h_i)P(h_i)}{P(D)}</div>
<script type="math/tex; mode=display">P(h_i|D) = \frac{P(D|h_i)P(h_i)}{P(D)}</script>
</div>
<p>选取最大的概率，就能用作分类了。这种方法叫<strong>最大后验估计</strong>(Maximum A Posteriori, MAP)，记为<span><span class="MathJax_Preview">h_{MAP}</span><script type="math/tex">h_{MAP}</script></span>：</p>
<div>
<div class="MathJax_Preview">h_{MAP} = \arg \max_{h\in H} P(h|D) =  \arg \max_{h\in H} \frac{P(D|h)P(h)}{P(D)}</div>
<script type="math/tex; mode=display">h_{MAP} = \arg \max_{h\in H} P(h|D) =  \arg \max_{h\in H} \frac{P(D|h)P(h)}{P(D)}</script>
</div>
<p><span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>表示所有的事件，所以<span><span class="MathJax_Preview">h\in H</span><script type="math/tex">h\in H</script></span>表示“对于集合中的每一个事件”。整个公式的含义就是：对于集合中的每一个事件，计算出<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>的值，并取最大的结果。</p>
<p>可以发现对于所有的事件，公式中的分母都是<span><span class="MathJax_Preview">P(D)</span><script type="math/tex">P(D)</script></span>，因此即便只计算<span><span class="MathJax_Preview">P(D|h)P(h)</span><script type="math/tex">P(D|h)P(h)</script></span>，也可以判断出最大的结果。那么这个公式就可以简化为：</p>
<div>
<div class="MathJax_Preview">h_{MAP} = \arg \max_{h\in H} P(D|h)P(h)</div>
<script type="math/tex; mode=display">h_{MAP} = \arg \max_{h\in H} P(D|h)P(h)</script>
</div>
<h5 id="example_4">Example: 手环推荐<a class="headerlink" href="#example_4" title="Permanent link">&para;</a></h5>
<p>现在我们要为iHealth公司发一套推荐系统。iHealth新出产了两件商品：i100和i500。为了收集数据，让购买的用户填写调查问卷，每个问题都对应一个特征：</p>
<p><img alt="" src="../figures/iHealth.jpg" /></p>
<p>也就是说已知一位客户的运动目的、当前运动水平、对健身的热情、是否适应高科技产品，下面用朴素贝叶斯来推荐手环型号。</p>
<p>简单分析一下，这里的假设空间<span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>是表格第5列：推荐的手环型号，包括i500和i100; <span><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span>是表格前4列的值。</p>
<p>朴素贝叶斯分类器包含两个部分：训练和分类。</p>
<p><hh>训练</hh></p>
<p>训练的输出结果应该是：</p>
<ul>
<li>先验概率，如<span><span class="MathJax_Preview">P(i100) = 0.4</span><script type="math/tex">P(i100) = 0.4</script></span></li>
<li>条件概率，如<span><span class="MathJax_Preview">P(健康|i100) = 0.167</span><script type="math/tex">P(健康|i100) = 0.167</script></span></li>
</ul>
<p>我们使用如下代码表示先验概率：</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i500&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;i100&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">}</span>
</pre></div>

<p>条件概率的表示有些复杂，用嵌套的字典来实现：</p>
<div class="codehilite"><pre><span></span><span class="p">{</span><span class="s1">&#39;i500&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;appearance&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span> <span class="s1">&#39;health&#39;</span><span class="p">:</span> <span class="mf">0.4444444444444444</span><span class="p">,</span>
                <span class="s1">&#39;both&#39;</span><span class="p">:</span> <span class="mf">0.2222222222222222</span><span class="p">},</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="mf">0.4444444444444444</span><span class="p">,</span> <span class="s1">&#39;sedentary&#39;</span><span class="p">:</span> <span class="mf">0.2222222222222222</span><span class="p">,</span>
                <span class="s1">&#39;moderate&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">},</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggressive&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">},</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">}},</span>
<span class="s1">&#39;i100&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;both&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;health&#39;</span><span class="p">:</span> <span class="mf">0.16666666666666666</span><span class="p">,</span>
                <span class="s1">&#39;appearance&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">},</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span> <span class="s1">&#39;sedentary&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s1">&#39;moderate&#39;</span><span class="p">:</span> <span class="mf">0.16666666666666666</span><span class="p">},</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggressive&#39;</span><span class="p">:</span> <span class="mf">0.16666666666666666</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">:</span> <span class="mf">0.8333333333333334</span><span class="p">},</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="mf">0.6666666666666666</span><span class="p">}}}</span>
</pre></div>

<p>1、2、3、4表示第几列，所以第一行可以解释为购买i500的顾客中运动目的是外表的概率是0.333。</p>
<p>为了计算概率，要进行计数，可以用字典来统计每个型号的次数。</p>
<p>以下是训练用的Python代码：</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NavieBayes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classification Using naive bayes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">testBucketNumber</span><span class="p">,</span> 
                           <span class="n">dataFormat</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize data</span>
<span class="sd">        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class="sd">        :param testBucketNumber: 测试桶的编号</span>
<span class="sd">        :param dataFormat: 数据格式e.g. attr attr attr attr class</span>
<span class="sd">        :param separator: 文件分隔符</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 总条数</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># 先验概率计数</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># 后验概率计数</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 从文件中读取数据</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">dataFormat</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="c1"># 先验概率</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># 条件概率</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 遍历十个桶， 十折交叉验证</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
            <span class="c1"># 跳过测试桶</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">testBucketNumber</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">ignore</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">vector</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span>
                            <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;attr&#39;</span><span class="p">:</span>
                            <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span>
                            <span class="n">ignore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span>
                            <span class="n">category</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="c1"># 处理该条记录</span>
                    <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">classes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">counts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">classes</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># 处理各个属性</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">columnValue</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">:</span>
                        <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">columnValue</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">][</span><span class="n">columnValue</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># 计数结束，开始计算概率</span>

        <span class="c1"># 计算先验概率P(h)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total</span>

        <span class="c1"># 计算条件概率P(h|D)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">col_id</span><span class="p">,</span> <span class="n">valueCounts</span><span class="p">)</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col_id</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">attrValue</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">valueCounts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col_id</span><span class="p">][</span><span class="n">attrValue</span><span class="p">]</span> <span class="o">=</span> 
                               <span class="n">count</span> <span class="o">/</span> <span class="n">classes</span><span class="p">[</span><span class="n">category</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">counts</span>

    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        返回itemVector所属类别</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">prior</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">prior</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">attrValue</span> <span class="ow">in</span> <span class="n">itemVector</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attrValue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]:</span>
                    <span class="c1"># 属性不存在，返回0概率</span>
                    <span class="n">prob</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">*=</span> <span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">][</span><span class="n">attrValue</span><span class="p">]</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prob</span><span class="p">,</span> <span class="n">category</span><span class="p">))</span>
        <span class="c1"># 返回概率最高的结果</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">NavieBayes</span><span class="p">(</span><span class="s1">&#39;iHealth/i&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;attr</span><span class="se">\t</span><span class="s1">attr</span><span class="se">\t</span><span class="s1">attr</span><span class="se">\t</span><span class="s1">attr</span><span class="se">\t</span><span class="s1">class&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">classify</span><span class="p">([</span><span class="s1">&#39;health&#39;</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]))</span>
</pre></div>

<h5 id="example_5">Example: 美国国会投票数据<a class="headerlink" href="#example_5" title="Permanent link">&para;</a></h5>
<p><a href="https://archive.ics.uci.edu/ml/datasets/congressional+voting+records">美国国会投票数据</a>，其中每条记录代表一个选民，第一列是分类名称（democrat, republican），之后是16条法案，用y和n表示该人是否支持。</p>
<p>文件格式如下：</p>
<div class="codehilite"><pre><span></span><span class="n">democrat</span>
<span class="n">y</span> <span class="n">n</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span>
<span class="n">democrat</span>
<span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">n</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span> <span class="n">y</span>
<span class="n">republican</span>
<span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span> <span class="n">n</span> <span class="n">y</span> <span class="n">n</span> <span class="n">y</span> <span class="n">y</span> <span class="n">y</span> <span class="n">n</span> <span class="n">n</span>
</pre></div>

<p>在调用上一节编写的朴素贝叶斯分类器时使用以下dataFormat参数就可以了：</p>
<div class="codehilite"><pre><span></span><span class="ss">&quot;class\tattr\tattr\tattr\tattr\tattr\tattr\tattr\</span>
<span class="ss">tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr&quot;</span>
</pre></div>

<p><hh>概率值为0</hh></p>
<p>但是，上面的代码在一些特殊情况下会有一些问题。</p>
<p>使用朴素贝叶斯计算得到的概率其实是真实概率的一种估计，而真实概率是对全量数据做统计得到的。比如说，我们需要对所有人都做血液测试，才能得到健康人返回阴性结果的真实概率。显然，对全量数据做统计是不现实的，所以我们会选取一个样本，如1000人，对他们进行测试并计算概率。大部分情况下，这种估计都是接近于真实概率的。但当真实概率非常小时，这种抽样统计的做法就会有问题了。比如说，民主党对网络非法传播法案的否决率是0.03，即<span><span class="MathJax_Preview">P(S=no|民主党) = 0.03</span><script type="math/tex">P(S=no|民主党) = 0.03</script></span>。如果我们 分别选取十个民主党和共和党人，看他们对该法案的投票情况，你觉得得到的概率会是什么？答案很可能是0。</p>
<p>在朴素贝叶斯中，概率为0的影响是很大的。如果其中⼀个概率值为0，那么最后的乘积也为0。</p>
<p>为了表示方便，我们采用以下公式：</p>
<div>
<div class="MathJax_Preview">P(x|y)=\frac{n_c}{n}</div>
<script type="math/tex; mode=display">P(x|y)=\frac{n_c}{n}</script>
</div>
<p>其中,<span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>表示训练集中y类别的记录数；<span><span class="MathJax_Preview">n_c</span><script type="math/tex">n_c</script></span>表示<span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>类别中值为<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>的记录数。我们的问题是<span><span class="MathJax_Preview">n_c</span><script type="math/tex">n_c</script></span>可能为0。解决方法是将公示变为以下形式：</p>
<div>
<div class="MathJax_Preview">P(x|y)=\frac{n_c+mp}{n+m}</div>
<script type="math/tex; mode=display">P(x|y)=\frac{n_c+mp}{n+m}</script>
</div>
<p><span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>是一个常数，表示等效样本大小。决定常数<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>的方法有很多，我们这里使用值的类别数目来作为<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>，比如投票有赞成和否决两种类别，所以<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>就为2。<span><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>则是相应的先验概率，比如说赞成和否决的概率分别是0.5，那<span><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>就是0.5。</p>
<h4 id="2_1">2 数值型数据<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h4>
<p>在贝叶斯方法中，之前我们对事物进行了计数，这种计数则是可以度量的。对于数值型的数据要如何计数呢？通常有两种做法：区分类别和高斯分布。</p>
<h5 id="_23">区分类别<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h5>
<p>我们可以划定几个范围作为分类，如：</p>
<ul>
<li>年龄<ul>
<li>&lt; 18 </li>
<li>18 - 22 </li>
<li>23 - 30 </li>
<li>31 - 40 </li>
<li>40</li>
</ul>
</li>
<li>年薪<ul>
<li>$200,000</li>
<li>150,000 - 200,000 </li>
<li>100,000 - 150,000 </li>
<li>60,000 - 100,000 </li>
<li>40,000 - 60,000</li>
</ul>
</li>
</ul>
<p>划分类别后，就可以应用朴素贝叶斯方法了。</p>
<h5 id="_24">高斯分布<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h5>
<p>属于类别<span><span class="MathJax_Preview">y_i</span><script type="math/tex">y_i</script></span>的特征<span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span>的概率为</p>
<div>
<div class="MathJax_Preview">P(x_i|y_i) = \frac{1}{\sqrt{2\pi}\sigma_{ij}} e^{\LARGE -\frac{(x_i-u_{ij})^2}{2\sigma^2_{ij}}}</div>
<script type="math/tex; mode=display">P(x_i|y_i) = \frac{1}{\sqrt{2\pi}\sigma_{ij}} e^{\LARGE -\frac{(x_i-u_{ij})^2}{2\sigma^2_{ij}}}</script>
</div>
<p>为了举例，我们为上面讲述的手环的例子增加一列收入属性。假设我们要计算<span><span class="MathJax_Preview">P(100k|i500)</span><script type="math/tex">P(100k|i500)</script></span>的概率，即购买i500的用户中收入是100,000美元的概率。那么这里<span><span class="MathJax_Preview">u_{ij}, \sigma_{ij}</span><script type="math/tex">u_{ij}, \sigma_{ij}</script></span>分别对应的是购买i500的用户的平均收入和收入的标准差。</p>
<p>样本标准差的计算公式是：</p>
<div>
<div class="MathJax_Preview">\sigma = \sqrt{\frac{\sum_i(x_i-\bar x)^2}{\text{card}(x)-1}}</div>
<script type="math/tex; mode=display">\sigma = \sqrt{\frac{\sum_i(x_i-\bar x)^2}{\text{card}(x)-1}}</script>
</div>
<p>注意分母中的是<span><span class="MathJax_Preview">\text{card}(x)-1</span><script type="math/tex">\text{card}(x)-1</script></span>不是<span><span class="MathJax_Preview">\text{card}(x)</span><script type="math/tex">\text{card}(x)</script></span>。</p>
<p>在训练朴素贝叶斯分类器时，可以将所有属性的平均值和样本标准差计算出来，而分类阶段使用平均值和样本标准差计算概率密度分布：</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">ssd</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;概率密度函数，计算P(x|y)&quot;&quot;&quot;</span>
    <span class="n">ePart</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ssd</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">ssd</span><span class="p">))</span> <span class="o">*</span> <span class="n">ePart</span>
</pre></div>

<h5 id="example_6">Example: 比马印第安人糖尿病<a class="headerlink" href="#example_6" title="Permanent link">&para;</a></h5>
<p>比马印第安人糖尿病数据集在<a href="../ch4">前一章</a>已经进行了详细描述。该数据集包含了数值型特征，不能直接用上一节代码。也就是说不能直接用计数的方法来计算某个具体特征的值出现的概率，而是要用高斯分布的概率密度函数计算。</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="k">class</span> <span class="nc">NaiveBayes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classification Using naive bayes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">testBucketNumber</span><span class="p">,</span> <span class="n">dataFormat</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize data</span>
<span class="sd">        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class="sd">        :param testBucketNumber: 测试桶的编号</span>
<span class="sd">        :param dataFormat: 数据格式，形如attr attr attr attr class</span>
<span class="sd">        :param separator: 文件分隔符</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 对数值型数据进行求和</span>
        <span class="n">totals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">numericValues</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 对分类型数据进行计数</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># 先验概率计数</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># 后验概率计数</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 从文件中读取数据</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">dataFormat</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="c1"># 先验概率</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># 条件概率</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 遍历十个桶， 十折交叉验证</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
            <span class="c1"># 跳过测试桶</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">testBucketNumber</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">ignore</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">vector</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUT ERROR&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span>
                            <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;attr&#39;</span><span class="p">:</span>
                            <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span>
                            <span class="n">ignore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span>
                            <span class="n">category</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                    <span class="c1"># 处理分类型数据</span>
                    <span class="c1"># 处理该条记录</span>
                    <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">classes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">counts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">classes</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># 处理各个属性</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">columnValue</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">:</span>
                        <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">columnValue</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">][</span><span class="n">columnValue</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># 处理数值型数据</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># column number</span>
                    <span class="n">totals</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">numericValues</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="k">for</span> <span class="n">columnValue</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
                        <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">totals</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">totals</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">+=</span> <span class="n">columnValue</span>
                        <span class="n">numericValues</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">[])</span>
                        <span class="n">numericValues</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columnValue</span><span class="p">)</span>

        <span class="c1"># 计数结束，开始计算概率</span>

        <span class="c1"># 计算先验概率P(h)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total</span>

        <span class="c1"># 计算条件概率P(h|D)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">col_id</span><span class="p">,</span> <span class="n">valueCounts</span><span class="p">)</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">col_id</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">attrValue</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="n">valueCounts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col_id</span><span class="p">][</span><span class="n">attrValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">count</span> <span class="o">/</span> <span class="n">classes</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>

        <span class="c1"># 计算平均数和样本标准差</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">totals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">sums</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> 
                    <span class="n">sums</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">numericValues</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> 
                    <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">numericValues</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">])</span> <span class="o">-</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))</span><span class="o">/</span>
                    <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">numericValues</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">])</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">ssd</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;概率密度函数，计算P(x|y)&quot;&quot;&quot;</span>
        <span class="n">ePart</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ssd</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">ssd</span><span class="p">))</span> <span class="o">*</span> <span class="n">ePart</span>

    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemVector</span><span class="p">,</span> <span class="n">numVector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        根据itemVector和numVector进行分类</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">prior</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">prior</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">attrValue</span> <span class="ow">in</span> <span class="n">itemVector</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attrValue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">]:</span>
                    <span class="c1"># 属性不存在，返回0概率</span>
                    <span class="n">prob</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditional</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">][</span><span class="n">attrValue</span><span class="p">]</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">numValue</span> <span class="ow">in</span> <span class="n">numVector</span><span class="p">:</span>
                <span class="c1">#高斯概率密度分布</span>
                <span class="n">prob</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">],</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">col</span><span class="p">],</span> <span class="n">numValue</span><span class="p">)</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prob</span><span class="p">,</span> <span class="n">category</span><span class="p">))</span>
        <span class="c1"># 返回概率最高的结果</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">testBucket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        测试</span>
<span class="sd">        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class="sd">        :param i: 编号</span>
<span class="sd">        :return: 测试结果</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%02i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">ignore</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;INPUT ERROR&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span>
                    <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;attr&#39;</span><span class="p">:</span>
                    <span class="n">vector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span>
                    <span class="n">ignore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span>
                    <span class="n">category</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">test_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">nums</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">test_result</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">test_result</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">results</span>





<span class="k">def</span> <span class="nf">tenfold</span><span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">dataFormat</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">NaiveBayes</span><span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataFormat</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">testBucket</span><span class="p">(</span><span class="n">bucketPrefix</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ckey</span><span class="p">,</span> <span class="n">cvalue</span><span class="p">)</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">ckey</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">ckey</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cvalue</span>

    <span class="c1"># now print results</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">categories</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">       Classified as: &quot;</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;        &quot;</span>
    <span class="n">subheader</span> <span class="o">=</span> <span class="s2">&quot;      +&quot;</span>
    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
        <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">% 2s</span><span class="s2">   &quot;</span> <span class="o">%</span> <span class="n">category</span>
        <span class="n">subheader</span> <span class="o">+=</span> <span class="s2">&quot;-----+&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">subheader</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">    |&quot;</span> <span class="o">%</span> <span class="n">category</span>
        <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">]:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">c2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%3i</span><span class="s2"> |&quot;</span> <span class="o">%</span> <span class="n">count</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">count</span>
            <span class="k">if</span> <span class="n">c2</span> <span class="o">==</span> <span class="n">category</span><span class="p">:</span>
                <span class="n">correct</span> <span class="o">+=</span> <span class="n">count</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">subheader</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%5.3f</span><span class="s2"> percent correct&quot;</span> <span class="o">%</span> <span class="p">((</span><span class="n">correct</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">total</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;total of </span><span class="si">%i</span><span class="s2"> instances&quot;</span> <span class="o">%</span> <span class="n">total</span><span class="p">)</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">tenfold</span><span class="p">(</span><span class="s2">&quot;pimaSmall/pimaSmall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">num</span><span class="se">\t</span><span class="s2">class&quot;</span><span class="p">)</span>
</pre></div>

<p>输出结果如下：</p>
<div class="codehilite"><pre><span></span>       <span class="n">Classified</span> <span class="k">as</span><span class="p">:</span> 
         <span class="mi">0</span>    <span class="mi">1</span>   
      <span class="o">+</span><span class="c1">-----+-----+</span>
 <span class="mi">0</span>    <span class="o">|</span>  <span class="mi">46</span> <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span>
 <span class="mi">1</span>    <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span>  <span class="mi">26</span> <span class="o">|</span>
      <span class="o">+</span><span class="c1">-----+-----+</span>

<span class="mi">72</span><span class="p">.</span><span class="mi">000</span> <span class="n">percent</span> <span class="n">correct</span>
<span class="n">total</span> <span class="k">of</span> <span class="mi">100</span> <span class="n">instances</span>
</pre></div>

<p>与kNN相比，朴素贝叶斯准确率更好，而且计算更快。</p>
<h5 id="_25">为什么要叫“朴素贝叶斯”呢？<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h5>
<p>我们之所以能将多个概率进行相乘是因为这些概率都是具有独立性的。关于贝叶斯准则，可以参见<a href="https://techlarry.github.io/note-big-data/prob/ch1/">概率导论</a>。</p>
<blockquote>
<p>In simple terms, a naive Bayes classifier assumes that the presence (or absence) of a particular feature of a class is unrelated to the presence (or absence) of any other feature, given the class variable. For example, a fruit may be considered to be an apple if it is red, round, and about 4" in diameter. Even if these features depend on each other or upon the existence of the other features, a naive Bayes classifier considers all of these properties to independently contribute to the probability that this fruit is an apple. [<a href="https://stackoverflow.com/questions/10614754/what-is-naive-in-a-naive-bayes-classifier">ref</a>]</p>
</blockquote>
<p>但是在现实数据挖掘场景中，这种特征变量之间往往不相互独立。</p>
<ul>
<li>运动员例子中，身高和体重不是互相独立的，因为高的人体重也会较高。 </li>
<li>地区邮编、收入、年龄，这些特征也不完全独立，一些地区的房屋都很昂贵，一些地区则只有房车：加州帕罗奥图大多是20岁的年轻人，而亚利桑那州则多是退休人员。</li>
<li>在音乐基因工程中，很多特征也是不独立的，如果音乐中有很多变音吉他，那小提琴的 概率就降低了。 血液检验的结果中，T4和TSH这两个指标通常是呈反比的。</li>
</ul>
<p>所以，在使用贝叶斯方法时，我们需要互相独立的特征，但现实生活中很难找到这样的应用，因此我们只能假设他们是独立的了！我们完全忽略了这个问题，因此才称为“朴素的”（天真的）贝叶斯方法。不过事实证明朴素贝叶斯的效果还是很不错的。</p>
<h3 id="6">6 朴素贝叶斯算法和非结构化文本<a class="headerlink" href="#6" title="Permanent link">&para;</a></h3>
<p><strong>结构化数据</strong>是指数据集中的每条数据由多个特征进行描述。例如前面章节涉及的比马印第安人糖尿病数据集。</p>
<p><strong>非结构化数据</strong>指的是诸如电子邮件文本、推特信息、博客、新闻等。这些数据至少第一眼看起来是无法用一张表格来展现的，它们无法用多个特征进行描述。</p>
<h4 id="_26">自动判别文本中的感情色彩<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<p>自动判别文本感情色彩的系统的用处：</p>
<ul>
<li>售卖健康检测设备：人们对这款产品的反响如何。</li>
<li>投放广告：顾客是喜欢(我好想买一台)还是讨厌(看起来很糟糕)呢？</li>
</ul>
<p>假设我要从文本中区分顾客对某些食品的喜好，可能就会列出一些表达喜欢的词语，以及表达厌恶的词：</p>
<ul>
<li>表达喜欢的词：美味、好吃、不错、喜欢、可口 </li>
<li>表达厌恶的词：糟糕、难吃、不好、讨厌、恶心</li>
</ul>
<p>我们的训练集是一组文本，又称为<strong>语料库</strong>。每个文本(即每条记录)是一条推文，并被标记为喜欢和讨厌两类。</p>
<h5 id="_27">训练阶段<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h5>
<p>首先，我们统计所有文本中一共出现了多少个不同的单词，记作“|Vocabulary|”（总词汇表）。</p>
<p>对于每个单词<span><span class="MathJax_Preview">w_k</span><script type="math/tex">w_k</script></span> ，我们将计算<span><span class="MathJax_Preview">P(w_k|h_i)</span><script type="math/tex">P(w_k|h_i)</script></span>，每个<span><span class="MathJax_Preview">h_i</span><script type="math/tex">h_i</script></span>(喜欢和讨厌两种)的计算步骤如下：</p>
<ol>
<li>将该分类下的所有文章合并到一起；</li>
<li>统计每个分类中单词数量，记为<span><span class="MathJax_Preview">n_i</span><script type="math/tex">n_i</script></span>；</li>
<li>对于总词汇表中的单词<span><span class="MathJax_Preview">w_k</span><script type="math/tex">w_k</script></span>，统计他们在本类文章中出现的次数<span><span class="MathJax_Preview">n_k</span><script type="math/tex">n_k</script></span></li>
<li>最后计算概率：<span><span class="MathJax_Preview">P(w_k|h_i)=\large \frac{n_k+1}{n_i+|\text{Vocabulary}|}</span><script type="math/tex">P(w_k|h_i)=\large \frac{n_k+1}{n_i+|\text{Vocabulary}|}</script></span></li>
</ol>
<h5 id="_28">分类阶段<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h5>
<p>分类阶段比较简单，直接应用贝叶斯公式就可以了。</p>
<p>比如下面这句话，要如何判断它是正面还是负面的呢？“I am stunned by the hype over gravity.” 我们需要计算的是下面两个概率，并选取较高的结果：</p>
<div class="codehilite"><pre><span></span><span class="n">P</span><span class="p">(</span><span class="k">like</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">I</span><span class="o">|</span><span class="k">like</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">am</span><span class="o">|</span><span class="k">like</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">stunned</span><span class="o">|</span><span class="k">like</span><span class="p">)</span><span class="err">×</span><span class="p">...</span>
<span class="n">P</span><span class="p">(</span><span class="n">dislike</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">I</span><span class="o">|</span><span class="n">dislike</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">am</span><span class="o">|</span><span class="n">dislike</span><span class="p">)</span><span class="err">×</span><span class="n">P</span><span class="p">(</span><span class="n">stunned</span><span class="o">|</span><span class="n">dislike</span><span class="p">)</span><span class="err">×</span><span class="p">...</span>
</pre></div>

<h4 id="application-20-newsgroups">Application: 20 Newsgroups<a class="headerlink" href="#application-20-newsgroups" title="Permanent link">&para;</a></h4>
<p>20newsgroups数据集是用于文本分类、文本挖据和信息检索研究的国际标准数据集之一。数据集收集了大约20,000左右的新闻组文档，分为20个不同主题的新闻组集合。</p>
<p><img alt="20Newsgroups" src="../figures/20Newsgroups.png" /></p>
<p>下载下来后，文档格式如下：</p>
<p><img alt="20NewsgroupsFileFormat" src="../figures/20NewsgroupsFileFormat.png" /></p>
<h5 id="_29">停用词<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h5>
<p><strong>停用词</strong>指的是那些没有意义的、组成语法结构的单词，它们产生会很多噪音。这些单词一般并不会对分类结果产生大的影响。有专门的停用词表可供使用。</p>
<p>去除停用词的好处：</p>
<ol>
<li>能够减少需要处理的数据量；</li>
<li>这些词的存在会对分类效果产生负面影响。</li>
</ol>
<p>中文的常用停用词表可以在<a href="https://github.com/goto456/stopwords">这里</a>找到。
<a href="http://www.ranks.nl/stopwords">英文的停用词表</a></p>
<h5 id="_30">常用词和停词<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h5>
<p>虽然像the、a这种单词的确没有意义，但有些<strong>常用词</strong>如work、write、school等在某些场合下还是有作用的，如果将他们也列进停词表里可能会有问题。</p>
<h5 id="python_4">Python代码<a class="headerlink" href="#python_4" title="Permanent link">&para;</a></h5>
<p>分类器的初始化代码要完成以下工作：</p>
<ol>
<li>读取停词列表；</li>
<li>获取训练集中各目录（分类）的名称；</li>
<li>对于各个分类，调用train方法，统计单词出现的次数；</li>
<li>计算各个单词出现的概率</li>
</ol>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">BayesText</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainingdir</span><span class="p">,</span> <span class="n">stopwordlist</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :params trainingdir 训练集目录，子目录是分类，子目录中包含若干文本</span>
<span class="sd">        :params stopwordlist 停词列表（一行一个）</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopwords</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">stopwordlist</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stopwords</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">trainingdir</span><span class="p">)</span>
        <span class="c1"># filter out files that are not directories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">categories</span>
                           <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">trainingdir</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)]</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Counting ...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">category</span><span class="p">)</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">],</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">totals</span><span class="p">[</span><span class="n">category</span><span class="p">])</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">trainingdir</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>

        <span class="c1"># eliminate any word in the vocabulary</span>
        <span class="c1"># that occur less than 3 times</span>
        <span class="n">toDelete</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># mark word for deletion</span>
                <span class="c1"># can&#39;t delete now because you can&#39;t delete</span>
                <span class="c1"># from a list you are currently iterating over</span>
                <span class="n">toDelete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="c1"># now delete these words</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">toDelete</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>

        <span class="c1"># now compute probabilities</span>
        <span class="n">vocabLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Computing probabilities:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">category</span><span class="p">)</span>
            <span class="n">denominator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">totals</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+</span> <span class="n">vocabLength</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">]:</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">word</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                             <span class="o">/</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;DONE TRAINING</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainingdir</span><span class="p">,</span> <span class="n">category</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        counts word occurrences for a particular category</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">currentdir</span> <span class="o">=</span> <span class="n">trainingdir</span> <span class="o">+</span> <span class="n">category</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">currentdir</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">currentdir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;iso8859-1&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
                    <span class="c1"># get rid of punctuation and lowercase token</span>
                    <span class="n">token</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;.,?:-&#39;</span><span class="p">)</span>
                    <span class="n">token</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">token</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopwords</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">counts</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">counts</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
</pre></div>

<p>下面分类器<code class="codehilite"><span class="nb">classify</span></code>方法能够根据给定的新闻(以文件形式)，给出正确的分类。<code class="codehilite"><span class="n">test</span></code>方法会对测试集中的所有文档进行分类，并计算准确率。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    classify files</span>
<span class="sd">    :param filename: a file</span>
<span class="sd">    :return: classification result</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
        <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;iso8859-1&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="c1"># print(token)</span>
            <span class="n">token</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&quot;.,?:-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">token</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">token</span><span class="p">))</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">+=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">prob</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">token</span><span class="p">])</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="nb">tuple</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c1"># for debugging I can change this to give me the entire list</span>
    <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">testCategory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">category</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    test all files for the category in this directory</span>
<span class="sd">    :param directory: a directory containing category</span>
<span class="sd">    :param category: a categeory folder contains files </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="nb">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">category</span><span class="p">:</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testdir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test all files in the test directory--that directory is</span>
<span class="sd">    organized into subdirectories--each subdir is a classification</span>
<span class="sd">    category</span>
<span class="sd">    :param testdir: test directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">testdir</span><span class="p">)</span>
    <span class="c1"># filter out files that are not directories</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">categories</span> <span class="k">if</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">testdir</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)]</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">catCorrect</span><span class="p">,</span> <span class="n">catTotal</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testCategory</span><span class="p">(</span>
            <span class="n">testdir</span> <span class="o">+</span> <span class="n">category</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">catCorrect</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">catTotal</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Accuracy is  </span><span class="si">%f%%</span><span class="s2">  (</span><span class="si">%i</span><span class="s2"> test instances)&quot;</span> <span class="o">%</span>
          <span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">total</span><span class="p">))</span>
</pre></div>

<h4 id="_31">朴素贝叶斯与情感分析<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<p>情感分析的目的是判断作者的态度或意见。情感分析的例子之一是判断一篇评论是正面的还是反面的，我们可以用朴素贝叶斯算法来实现。</p>
<h5 id="application_1">Application电影评价<a class="headerlink" href="#application_1" title="Permanent link">&para;</a></h5>
<p>Pang&amp;Lee 2004的<a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/">电影评价数据</a>集包含1000个正面和1000个负面的评价。</p>
<p>与20 Newsgroups类似，可以把电影评价看成是新闻分类，也就是把求电影正负评价看成是新闻某一分类的概率。所以代码是完全相同的。</p>
<h3 id="7">7 聚类<a class="headerlink" href="#7" title="Permanent link">&para;</a></h3>
<p>...to be continued</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../设计数据密集型应用/" title="设计数据密集型应用" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                设计数据密集型应用
              </span>
            </div>
          </a>
        
        
          <a href="../../Java/Effective Java/" title="index" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                index
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a8b5e56f.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
          
            
              
              
            
          
          
            <script src="../../assets/javascripts/lunr/lunr.multi.js"></script>
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>