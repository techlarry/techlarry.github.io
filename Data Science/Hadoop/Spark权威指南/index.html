



<!doctype html>
<html lang="zh" class="no-js">
  <head>

 <!-- 百度统计代码 -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b6f62cca1f01c8c6a28628994476d789";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="en, jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.0">
    
    
      
        <title>Spark权威指南</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Zhenhua's Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Zhenhua's Wiki
            </span>
            <span class="md-header-nav__topic">
              
                Spark权威指南
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/techlarry/note/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Algorithm/CS61B/" class="md-tabs__link">
          Algorithm
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Big Data/" class="md-tabs__link md-tabs__link--active">
          Data Science
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Java/Effective Java/" class="md-tabs__link">
          Java
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Leetcode/1. Two Sum/" class="md-tabs__link">
          Leetcode
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Miscellaneous/Clion/" class="md-tabs__link">
          Miscellaneous
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../OS/Docker/" class="md-tabs__link">
          OS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Zhenhua's Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Zhenhua's Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/techlarry/note/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-1" type="checkbox" id="nav-1-1">
    
    <label class="md-nav__link" for="nav-1-1">
      CS61B
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-1">
        CS61B
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab1/" title="Lab1" class="md-nav__link">
      Lab1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab2/" title="Lab2" class="md-nav__link">
      Lab2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/CS61B/Lab3/" title="Lab3" class="md-nav__link">
      Lab3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2">
    
    <label class="md-nav__link" for="nav-1-2">
      Princeton
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-2">
        Princeton
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 1 - Union Find/" title="Topic 1 - Union Find" class="md-nav__link">
      Topic 1 - Union Find
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 2 - Stacks and Queues/" title="Topic 2 - Stacks and Queues" class="md-nav__link">
      Topic 2 - Stacks and Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 3 - Sorting/" title="Topic 3 - Sorting" class="md-nav__link">
      Topic 3 - Sorting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 4 - Priority Queues/" title="Topic 4 - Priority Queues" class="md-nav__link">
      Topic 4 - Priority Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 5 - Symbol Tables/" title="Topic 5 - Symbol Tables" class="md-nav__link">
      Topic 5 - Symbol Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 6 - Balanced Search Trees/" title="Topic 6 - Balanced Search Trees" class="md-nav__link">
      Topic 6 - Balanced Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 7 - Hash Table/" title="Topic 7 - Hash Table" class="md-nav__link">
      Topic 7 - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 8 - Graph/" title="Topic 8 - Graph" class="md-nav__link">
      Topic 8 - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 9 - Minimum Spanning Tree and Shortest Path/" title="Topic 9 - Minimum Spanning Tree and Shortest Path" class="md-nav__link">
      Topic 9 - Minimum Spanning Tree and Shortest Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 11 - String Sort/" title="Topic 11 - String Sort" class="md-nav__link">
      Topic 11 - String Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Princeton/Topic 12 - Tries/" title="Topic 12 - Tries" class="md-nav__link">
      Topic 12 - Tries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3">
    
    <label class="md-nav__link" for="nav-1-3">
      Stanford
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        Stanford
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic - Dynamic Programming/" title="Topic - Dynamic Programming" class="md-nav__link">
      Topic - Dynamic Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic - Graph/" title="Topic - Graph" class="md-nav__link">
      Topic - Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic - Greedy Algorithm/" title="Topic - Greedy Algorithm" class="md-nav__link">
      Topic - Greedy Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic - Hash Table/" title="Topic - Hash Table" class="md-nav__link">
      Topic - Hash Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/Stanford/Topic - Heap/" title="Topic - Heap" class="md-nav__link">
      Topic - Heap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4" type="checkbox" id="nav-1-4">
    
    <label class="md-nav__link" for="nav-1-4">
      剑指Offer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-4">
        剑指Offer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/solution/" title="solution" class="md-nav__link">
      solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/2 ⾯试需要的基础知识/" title="2 ⾯试需要的基础知识" class="md-nav__link">
      2 ⾯试需要的基础知识
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/3 高质量的代码/" title="3 高质量的代码" class="md-nav__link">
      3 高质量的代码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/4 解决面试题的思路/" title="4 解决面试题的思路" class="md-nav__link">
      4 解决面试题的思路
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/5 优化时间和空间效率/" title="5 优化时间和空间效率" class="md-nav__link">
      5 优化时间和空间效率
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/6 面试中的各项能力/" title="6 面试中的各项能力" class="md-nav__link">
      6 面试中的各项能力
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Algorithm/剑指Offer/7 两个面试案例/" title="7 两个面试案例" class="md-nav__link">
      7 两个面试案例
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Data Science
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Big Data/" title="Big Data" class="md-nav__link">
      Big Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Database
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Database
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/MySQL基础/" title="MySQL基础" class="md-nav__link">
      MySQL基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/Redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/SQL必知必会/" title="SQL必知必会" class="md-nav__link">
      SQL必知必会
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/数据仓库/" title="数据仓库" class="md-nav__link">
      数据仓库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database/高性能MySQL/" title="高性能MySQL" class="md-nav__link">
      高性能MySQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Database System Concepts/" title="Database System Concepts" class="md-nav__link">
      Database System Concepts
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" checked>
    
    <label class="md-nav__link" for="nav-2-4">
      Hadoop
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Hadoop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Avro/" title="Avro" class="md-nav__link">
      Avro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Elastic Stack/" title="Elastic Stack" class="md-nav__link">
      Elastic Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Flink/" title="Flink" class="md-nav__link">
      Flink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Flume/" title="Flume" class="md-nav__link">
      Flume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../HBase/" title="HBase" class="md-nav__link">
      HBase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hadoop基础/" title="Hadoop基础" class="md-nav__link">
      Hadoop基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Hive/" title="Hive" class="md-nav__link">
      Hive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Spark权威指南
      </label>
    
    <a href="./" title="Spark权威指南" class="md-nav__link md-nav__link--active">
      Spark权威指南
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 简介
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sparksession" class="md-nav__link">
    SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes" class="md-nav__link">
    DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions" class="md-nav__link">
    Partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformations" class="md-nav__link">
    Transformations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action" class="md-nav__link">
    Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark" class="md-nav__link">
    开发和部署Spark应用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-ui" class="md-nav__link">
    Spark UI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-structured-api" class="md-nav__link">
    2 Structured API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structured-api-execution" class="md-nav__link">
    Structured API Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_1" class="md-nav__link">
    Spark类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes_1" class="md-nav__link">
    DataFrames
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    列和表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    记录和行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    转换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-sql" class="md-nav__link">
    Spark SQL
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark-sql_1" class="md-nav__link">
    运行Spark SQL查询
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    DataSets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#encoder" class="md-nav__link">
    Encoder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets_1" class="md-nav__link">
    创建Datasets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    外部数据
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    读取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    写入
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-low-level-apis" class="md-nav__link">
    3 Low-level APIs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdd" class="md-nav__link">
    RDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    转换和动作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    持久化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpointing" class="md-nav__link">
    checkpointing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pair-rdd" class="md-nav__link">
    Pair RDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdd_1" class="md-nav__link">
    数值RDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    分区
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    基于分区的操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-shared-variables" class="md-nav__link">
    Distributed Shared Variables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    广播变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    累加器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-spark" class="md-nav__link">
    4 Spark是如何在集群上运行的
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    运行模式
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    集群模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    客户模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    本地模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    部署模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparkspark" class="md-nav__link">
    Spark应用的生命周期(Spark外部)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparkspark_1" class="md-nav__link">
    Spark应用的生命周期(Spark内部)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-sparksession" class="md-nav__link">
    The SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-dag" class="md-nav__link">
    The DAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-spark-job" class="md-nav__link">
    A Spark Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stages" class="md-nav__link">
    Stages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks" class="md-nav__link">
    Tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    执行细节
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipelining" class="md-nav__link">
    Pipelining
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shuffle-persistence" class="md-nav__link">
    Shuffle Persistence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    内存管理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tungsten" class="md-nav__link">
    Tungsten
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-spark-streaming" class="md-nav__link">
    5 Spark Streaming
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fundamentals" class="md-nav__link">
    fundamentals
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stream-processing-design-points" class="md-nav__link">
    Stream Processing Design Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparks-streaming-api" class="md-nav__link">
    Spark's Streaming API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dstream" class="md-nav__link">
    DStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    输出操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structured-streaming" class="md-nav__link">
    Structured Streaming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-time-and-stateful-processing" class="md-nav__link">
    Event-Time and Stateful Processing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-mllib" class="md-nav__link">
    6 MLlib
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#low-level-data-types" class="md-nav__link">
    Low-level data types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 调优
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    算子的合理选择
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupbykeyreducebykey" class="md-nav__link">
    groupByKey/reduceByKey
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    序列化格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    优化配置参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    数据倾斜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    附录
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark_2" class="md-nav__link">
    安装Spark集群
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sqoop/" title="Sqoop" class="md-nav__link">
      Sqoop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ZooKeeper/" title="ZooKeeper" class="md-nav__link">
      ZooKeeper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../关于MapReduce/" title="关于MapReduce" class="md-nav__link">
      关于MapReduce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../文件格式/" title="文件格式" class="md-nav__link">
      文件格式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Hands On Machine Learning/" title="Hands On Machine Learning" class="md-nav__link">
      Hands On Machine Learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Machine Learning Coursera/" title="Machine Learning Coursera" class="md-nav__link">
      Machine Learning Coursera
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Practical Data Science
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        Practical Data Science
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/Free text and natural language processing/" title="Free text and natural language processing" class="md-nav__link">
      Free text and natural language processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/Intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/Jupyter notebook/" title="Jupyter notebook" class="md-nav__link">
      Jupyter notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/Relational Data/" title="Relational Data" class="md-nav__link">
      Relational Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Practical Data Science/The data collection process/" title="The data collection process" class="md-nav__link">
      The data collection process
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8">
    
    <label class="md-nav__link" for="nav-2-8">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Python引号/" title="Python引号" class="md-nav__link">
      Python引号
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Python配置/" title="Python配置" class="md-nav__link">
      Python配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/Records/" title="Records" class="md-nav__link">
      Records
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/协程/" title="协程" class="md-nav__link">
      协程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/生成器与迭代器/" title="生成器与迭代器" class="md-nav__link">
      生成器与迭代器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/谈谈Python中的拷贝/" title="谈谈Python中的拷贝" class="md-nav__link">
      谈谈Python中的拷贝
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python/闭包和装饰器/" title="闭包和装饰器" class="md-nav__link">
      闭包和装饰器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Python机器学习基础教程/" title="Python机器学习基础教程" class="md-nav__link">
      Python机器学习基础教程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Scala
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        Scala
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/Cheat Sheet/" title="Cheat Sheet" class="md-nav__link">
      Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/Sbt/" title="Sbt" class="md-nav__link">
      Sbt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/Scala编程/" title="Scala编程" class="md-nav__link">
      Scala编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/functional programming in scala/" title="functional programming in scala" class="md-nav__link">
      functional programming in scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/scala/" title="scala" class="md-nav__link">
      scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/慕课网Scala入门/" title="慕课网Scala入门" class="md-nav__link">
      慕课网Scala入门
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/第3章 从Java到Scala/" title="第3章 从Java到Scala" class="md-nav__link">
      第3章 从Java到Scala
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Scala/第4章 处理对象/" title="第4章 处理对象" class="md-nav__link">
      第4章 处理对象
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Storm/" title="Storm" class="md-nav__link">
      Storm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-13" type="checkbox" id="nav-2-13">
    
    <label class="md-nav__link" for="nav-2-13">
      projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-13">
        projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/SparkStreaming实时流处理项目/" title="SparkStreaming实时流处理项目" class="md-nav__link">
      SparkStreaming实时流处理项目
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/中文情感分析/" title="中文情感分析" class="md-nav__link">
      中文情感分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../流式系统/" title="流式系统" class="md-nav__link">
      流式系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../爬虫/" title="爬虫" class="md-nav__link">
      爬虫
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../统计学习方法/" title="统计学习方法" class="md-nav__link">
      统计学习方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../设计数据密集型应用/" title="设计数据密集型应用" class="md-nav__link">
      设计数据密集型应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../面向程序员的数据挖掘指南/" title="面向程序员的数据挖掘指南" class="md-nav__link">
      面向程序员的数据挖掘指南
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Effective Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Effective Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/1 Introduction/" title="1 Introduction" class="md-nav__link">
      1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/2 Creating and Destroying Objects/" title="2 Creating and Destroying Objects" class="md-nav__link">
      2 Creating and Destroying Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/3 Methods Common to All Objects/" title="3 Methods Common to All Objects" class="md-nav__link">
      3 Methods Common to All Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/4 Classes and interfaces/" title="4 Classes and interfaces" class="md-nav__link">
      4 Classes and interfaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/5 Generics/" title="5 Generics" class="md-nav__link">
      5 Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/6 Enums and Annotations/" title="6 Enums and Annotations" class="md-nav__link">
      6 Enums and Annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/7 Lambdas and Streams/" title="7 Lambdas and Streams" class="md-nav__link">
      7 Lambdas and Streams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/8 Methods/" title="8 Methods" class="md-nav__link">
      8 Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/9 General Programming/" title="9 General Programming" class="md-nav__link">
      9 General Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/10 Exceptions/" title="10 Exceptions" class="md-nav__link">
      10 Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/11 Concurrency/" title="11 Concurrency" class="md-nav__link">
      11 Concurrency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Effective Java/12 Serialization/" title="12 Serialization" class="md-nav__link">
      12 Serialization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Head First Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Head First Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/1 Dive in A Quick Dip/" title="1 Dive in A Quick Dip" class="md-nav__link">
      1 Dive in A Quick Dip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/2 Classes and Objects/" title="2 Classes and Objects" class="md-nav__link">
      2 Classes and Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/3 Primitives and references/" title="3 Primitives and references" class="md-nav__link">
      3 Primitives and references
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/4 Methods use instance variables/" title="4 Methods use instance variables" class="md-nav__link">
      4 Methods use instance variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/5 Writing a Program/" title="5 Writing a Program" class="md-nav__link">
      5 Writing a Program
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/6 Get to know the Java API/" title="6 Get to know the Java API" class="md-nav__link">
      6 Get to know the Java API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/7 Inheritance and polymorphism/" title="7 Inheritance and polymorphism" class="md-nav__link">
      7 Inheritance and polymorphism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/8 Interfaces and Abstract Classes/" title="8 Interfaces and Abstract Classes" class="md-nav__link">
      8 Interfaces and Abstract Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/9 Constructors and Garbage Collection/" title="9 Constructors and Garbage Collection" class="md-nav__link">
      9 Constructors and Garbage Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/10 Numbers and Statics/" title="10 Numbers and Statics" class="md-nav__link">
      10 Numbers and Statics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/11 Exception Handling/" title="11 Exception Handling" class="md-nav__link">
      11 Exception Handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/12 Getting GUI/" title="12 Getting GUI" class="md-nav__link">
      12 Getting GUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/13 Using Swing/" title="13 Using Swing" class="md-nav__link">
      13 Using Swing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/14 Serialization and File IO/" title="14 Serialization and File IO" class="md-nav__link">
      14 Serialization and File IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/15 Networking and Threads/" title="15 Networking and Threads" class="md-nav__link">
      15 Networking and Threads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/16 Collections and Generics/" title="16 Collections and Generics" class="md-nav__link">
      16 Collections and Generics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/17 Packages, Jars and Deployment/" title="17 Packages, Jars and Deployment" class="md-nav__link">
      17 Packages, Jars and Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/18 Remote deploy with RMI/" title="18 Remote deploy with RMI" class="md-nav__link">
      18 Remote deploy with RMI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First Java/19 Appendix/" title="19 Appendix" class="md-nav__link">
      19 Appendix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Head First设计模式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Head First设计模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/1 Strategy Pattern/" title="1 Strategy Pattern" class="md-nav__link">
      1 Strategy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/2 Observer Pattern/" title="2 Observer Pattern" class="md-nav__link">
      2 Observer Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/3 Decorator Pattern/" title="3 Decorator Pattern" class="md-nav__link">
      3 Decorator Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/4 Factory Pattern/" title="4 Factory Pattern" class="md-nav__link">
      4 Factory Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/5 Singleton Pattern/" title="5 Singleton Pattern" class="md-nav__link">
      5 Singleton Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/6 Command Pattern/" title="6 Command Pattern" class="md-nav__link">
      6 Command Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/7 Adapter and Facade Pattern/" title="7 Adapter and Facade Pattern" class="md-nav__link">
      7 Adapter and Facade Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/8 Template Method Pattern/" title="8 Template Method Pattern" class="md-nav__link">
      8 Template Method Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/9 Iterator and Composite Pattern/" title="9 Iterator and Composite Pattern" class="md-nav__link">
      9 Iterator and Composite Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/10 State Pattern/" title="10 State Pattern" class="md-nav__link">
      10 State Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/11 Proxy Pattern/" title="11 Proxy Pattern" class="md-nav__link">
      11 Proxy Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/12 Compound Patterns/" title="12 Compound Patterns" class="md-nav__link">
      12 Compound Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/13 Better Living with Patterns/" title="13 Better Living with Patterns" class="md-nav__link">
      13 Better Living with Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/14 Builder Pattern/" title="14 Builder Pattern" class="md-nav__link">
      14 Builder Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Head First设计模式/15 Chain Of Responsibility/" title="15 Chain Of Responsibility" class="md-nav__link">
      15 Chain Of Responsibility
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Java Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Java Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Ajax/" title="Ajax" class="md-nav__link">
      Ajax
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Bootstrap/" title="Bootstrap" class="md-nav__link">
      Bootstrap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/CSS/" title="CSS" class="md-nav__link">
      CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/HTML/" title="HTML" class="md-nav__link">
      HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Head First Servlets and JSP/" title="Head First Servlets and JSP" class="md-nav__link">
      Head First Servlets and JSP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/JDBC/" title="JDBC" class="md-nav__link">
      JDBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/JSON/" title="JSON" class="md-nav__link">
      JSON
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/JSP以及JSTL和EL表达式/" title="JSP以及JSTL和EL表达式" class="md-nav__link">
      JSP以及JSTL和EL表达式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Java Web/" title="Java Web" class="md-nav__link">
      Java Web
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/JavaScript/" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/MyBatis/" title="MyBatis" class="md-nav__link">
      MyBatis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/RESTful/" title="RESTful" class="md-nav__link">
      RESTful
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Spring/" title="Spring" class="md-nav__link">
      Spring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/SpringBoot/" title="SpringBoot" class="md-nav__link">
      SpringBoot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Tomcat/" title="Tomcat" class="md-nav__link">
      Tomcat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/XML/" title="XML" class="md-nav__link">
      XML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/jQuery/" title="jQuery" class="md-nav__link">
      jQuery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/人员信息管理系统/" title="人员信息管理系统" class="md-nav__link">
      人员信息管理系统
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java Web/Log4j/" title="Log4j" class="md-nav__link">
      Log4j
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/Java编程思想/" title="Java编程思想" class="md-nav__link">
      Java编程思想
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/反射/" title="反射" class="md-nav__link">
      反射
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      深入理解Java虚拟机
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        深入理解Java虚拟机
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/1 走进Java/" title="1 走进Java" class="md-nav__link">
      1 走进Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/2 Java内存区域与内存溢出正常/" title="2 Java内存区域与内存溢出正常" class="md-nav__link">
      2 Java内存区域与内存溢出正常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/3 垃圾收集器与内存分配策略/" title="3 垃圾收集器与内存分配策略" class="md-nav__link">
      3 垃圾收集器与内存分配策略
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/4 虚拟机性能监控与故障处理工具/" title="4 虚拟机性能监控与故障处理工具" class="md-nav__link">
      4 虚拟机性能监控与故障处理工具
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/5 调优案例分析与实战/" title="5 调优案例分析与实战" class="md-nav__link">
      5 调优案例分析与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/6 类文件结构/" title="6 类文件结构" class="md-nav__link">
      6 类文件结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/7 虚拟机类加载机制/" title="7 虚拟机类加载机制" class="md-nav__link">
      7 虚拟机类加载机制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/8 虚拟机字节码执行引擎/" title="8 虚拟机字节码执行引擎" class="md-nav__link">
      8 虚拟机字节码执行引擎
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/9 类加载及执行子系统的案例与实战/" title="9 类加载及执行子系统的案例与实战" class="md-nav__link">
      9 类加载及执行子系统的案例与实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/10 早期(编译期)优化/" title="10 早期(编译期)优化" class="md-nav__link">
      10 早期(编译期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/11 晚期(运行期)优化/" title="11 晚期(运行期)优化" class="md-nav__link">
      11 晚期(运行期)优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/12 Java内存模型与线程/" title="12 Java内存模型与线程" class="md-nav__link">
      12 Java内存模型与线程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/13 线程安全与锁优化/" title="13 线程安全与锁优化" class="md-nav__link">
      13 线程安全与锁优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/深入理解Java虚拟机/14 AppendixC/" title="14 AppendixC" class="md-nav__link">
      14 AppendixC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      高并发
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        高并发
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/高并发/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/高并发/JDK并发包/" title="JDK并发包" class="md-nav__link">
      JDK并发包
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/高并发/Java多线程设计模式/" title="Java多线程设计模式" class="md-nav__link">
      Java多线程设计模式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/高并发/事件驱动，消息驱动/" title="事件驱动，消息驱动" class="md-nav__link">
      事件驱动，消息驱动
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Java/高并发/多线程基础/" title="多线程基础" class="md-nav__link">
      多线程基础
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Leetcode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Leetcode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/1. Two Sum/" title="1. Two Sum" class="md-nav__link">
      1. Two Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/10. Regular Expression Matching/" title="10. Regular Expression Matching" class="md-nav__link">
      10. Regular Expression Matching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/100. Same Tree/" title="100. Same Tree" class="md-nav__link">
      100. Same Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/101. Symmetric Tree/" title="101. Symmetric Tree" class="md-nav__link">
      101. Symmetric Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/102. Binary Tree Level Order Traversal/" title="102. Binary Tree Level Order Traversal" class="md-nav__link">
      102. Binary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/1020. Number of Enclaves/" title="1020. Number of Enclaves" class="md-nav__link">
      1020. Number of Enclaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/103. Binary Tree Zigzag Level Order Traversal/" title="103. Binary Tree Zigzag Level Order Traversal" class="md-nav__link">
      103. Binary Tree Zigzag Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/104. Maximum Depth of Binary Tree/" title="104. Maximum Depth of Binary Tree" class="md-nav__link">
      104. Maximum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/105. Construct Binary Tree from Preorder and Inorder Traversal/" title="105. Construct Binary Tree from Preorder and Inorder Traversal" class="md-nav__link">
      105. Construct Binary Tree from Preorder and Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/107. Binary Tree Level Order Traversal II/" title="107. Binary Tree Level Order Traversal II" class="md-nav__link">
      107. Binary Tree Level Order Traversal II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/108. Convert Sorted Array to Binary Search Tree/" title="108. Convert Sorted Array to Binary Search Tree" class="md-nav__link">
      108. Convert Sorted Array to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/109. Convert Sorted List to Binary Search Tree/" title="109. Convert Sorted List to Binary Search Tree" class="md-nav__link">
      109. Convert Sorted List to Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/11. Container With Most Water/" title="11. Container With Most Water" class="md-nav__link">
      11. Container With Most Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/110. Balanced Binary Tree/" title="110. Balanced Binary Tree" class="md-nav__link">
      110. Balanced Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/111. Minimum Depth of Binary Tree/" title="111. Minimum Depth of Binary Tree" class="md-nav__link">
      111. Minimum Depth of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/112. Path Sum/" title="112. Path Sum" class="md-nav__link">
      112. Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/113. Path Sum II/" title="113. Path Sum II" class="md-nav__link">
      113. Path Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/114. Flatten Binary Tree to Linked List/" title="114. Flatten Binary Tree to Linked List" class="md-nav__link">
      114. Flatten Binary Tree to Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/116. Populating Next Right Pointers in Each Node/" title="116. Populating Next Right Pointers in Each Node" class="md-nav__link">
      116. Populating Next Right Pointers in Each Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/117. Populating Next Right Pointers in Each Node II/" title="117. Populating Next Right Pointers in Each Node II" class="md-nav__link">
      117. Populating Next Right Pointers in Each Node II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/118. Pascals Triangle/" title="118. Pascals Triangle" class="md-nav__link">
      118. Pascals Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/119. Pascals Triangle II/" title="119. Pascals Triangle II" class="md-nav__link">
      119. Pascals Triangle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/12. Integer to Roman/" title="12. Integer to Roman" class="md-nav__link">
      12. Integer to Roman
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/120. Triangle/" title="120. Triangle" class="md-nav__link">
      120. Triangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/121. Best Time to Buy and Sell Stock/" title="121. Best Time to Buy and Sell Stock" class="md-nav__link">
      121. Best Time to Buy and Sell Stock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/122. Best Time to Buy and Sell Stock II/" title="122. Best Time to Buy and Sell Stock II" class="md-nav__link">
      122. Best Time to Buy and Sell Stock II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/123. Best Time to Buy and Sell Stock III/" title="123. Best Time to Buy and Sell Stock III" class="md-nav__link">
      123. Best Time to Buy and Sell Stock III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/124. Binary Tree Maximum Path Sum/" title="124. Binary Tree Maximum Path Sum" class="md-nav__link">
      124. Binary Tree Maximum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/125. Valid Palindrome/" title="125. Valid Palindrome" class="md-nav__link">
      125. Valid Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/127. Word Ladder/" title="127. Word Ladder" class="md-nav__link">
      127. Word Ladder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/128. Longest Consecutive Sequence/" title="128. Longest Consecutive Sequence" class="md-nav__link">
      128. Longest Consecutive Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/129. Sum Root to Leaf Numbers/" title="129. Sum Root to Leaf Numbers" class="md-nav__link">
      129. Sum Root to Leaf Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/130. Surrounded Regions/" title="130. Surrounded Regions" class="md-nav__link">
      130. Surrounded Regions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/131. Palindrome Partitioning/" title="131. Palindrome Partitioning" class="md-nav__link">
      131. Palindrome Partitioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/132. Palindrome Partitioning II/" title="132. Palindrome Partitioning II" class="md-nav__link">
      132. Palindrome Partitioning II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/133. Clone Graph/" title="133. Clone Graph" class="md-nav__link">
      133. Clone Graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/136 Single Number/" title="136 Single Number" class="md-nav__link">
      136 Single Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/137 Single Number II/" title="137 Single Number II" class="md-nav__link">
      137 Single Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/138. Copy List with Random Pointer/" title="138. Copy List with Random Pointer" class="md-nav__link">
      138. Copy List with Random Pointer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/139. Word Break/" title="139. Word Break" class="md-nav__link">
      139. Word Break
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/14. Longest Common Prefix/" title="14. Longest Common Prefix" class="md-nav__link">
      14. Longest Common Prefix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/141. Linked List Cycle/" title="141. Linked List Cycle" class="md-nav__link">
      141. Linked List Cycle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/142. Linked List Cycle II/" title="142. Linked List Cycle II" class="md-nav__link">
      142. Linked List Cycle II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/143. Reorder List/" title="143. Reorder List" class="md-nav__link">
      143. Reorder List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/144. Binary Tree Preorder Traversal/" title="144. Binary Tree Preorder Traversal" class="md-nav__link">
      144. Binary Tree Preorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/145. Binary Tree Postorder Traversal/" title="145. Binary Tree Postorder Traversal" class="md-nav__link">
      145. Binary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/146. LRU Cache/" title="146. LRU Cache" class="md-nav__link">
      146. LRU Cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/147. Insertion Sort List/" title="147. Insertion Sort List" class="md-nav__link">
      147. Insertion Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/148. Sort List/" title="148. Sort List" class="md-nav__link">
      148. Sort List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/149. Max Points on a Line/" title="149. Max Points on a Line" class="md-nav__link">
      149. Max Points on a Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/15. 3Sum/" title="15. 3Sum" class="md-nav__link">
      15. 3Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/150. Evaluate Reverse Polish Notation/" title="150. Evaluate Reverse Polish Notation" class="md-nav__link">
      150. Evaluate Reverse Polish Notation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/151. Reverse Words in a String/" title="151. Reverse Words in a String" class="md-nav__link">
      151. Reverse Words in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/152. Maximum Product Subarray/" title="152. Maximum Product Subarray" class="md-nav__link">
      152. Maximum Product Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/153. Find Minimum in Rotated Sorted Array/" title="153. Find Minimum in Rotated Sorted Array" class="md-nav__link">
      153. Find Minimum in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/155. Min Stack/" title="155. Min Stack" class="md-nav__link">
      155. Min Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/16. 3Sum Closest/" title="16. 3Sum Closest" class="md-nav__link">
      16. 3Sum Closest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/160. Intersection of Two Linked Lists/" title="160. Intersection of Two Linked Lists" class="md-nav__link">
      160. Intersection of Two Linked Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/164. Maximum Gap/" title="164. Maximum Gap" class="md-nav__link">
      164. Maximum Gap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/166. Fraction to Recurring Decimal/" title="166. Fraction to Recurring Decimal" class="md-nav__link">
      166. Fraction to Recurring Decimal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/167. Two Sum II - Input array is sorted/" title="167. Two Sum II - Input array is sorted" class="md-nav__link">
      167. Two Sum II - Input array is sorted
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/168. Excel Sheet Column Title/" title="168. Excel Sheet Column Title" class="md-nav__link">
      168. Excel Sheet Column Title
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/169. Majority Element/" title="169. Majority Element" class="md-nav__link">
      169. Majority Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/17. Letter Combinations of a Phone Number.md/" title="17. Letter Combinations of a Phone Number" class="md-nav__link">
      17. Letter Combinations of a Phone Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/170. TwoSum III/" title="170. TwoSum III" class="md-nav__link">
      170. TwoSum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/171. Excel Sheet Column Number/" title="171. Excel Sheet Column Number" class="md-nav__link">
      171. Excel Sheet Column Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/172. Factorial Trailing Zeroes/" title="172. Factorial Trailing Zeroes" class="md-nav__link">
      172. Factorial Trailing Zeroes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/173. Binary Search Tree Iterator/" title="173. Binary Search Tree Iterator" class="md-nav__link">
      173. Binary Search Tree Iterator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/174. Dungeon Game/" title="174. Dungeon Game" class="md-nav__link">
      174. Dungeon Game
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/179. Largest Number/" title="179. Largest Number" class="md-nav__link">
      179. Largest Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/18. 4 Sum/" title="18. 4 Sum" class="md-nav__link">
      18. 4 Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/187. Repeated DNA Sequences/" title="187. Repeated DNA Sequences" class="md-nav__link">
      187. Repeated DNA Sequences
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/19. Remove Nth Node From End of List/" title="19. Remove Nth Node From End of List" class="md-nav__link">
      19. Remove Nth Node From End of List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/190. Reverse Bits/" title="190. Reverse Bits" class="md-nav__link">
      190. Reverse Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/191. Number of 1 Bits/" title="191. Number of 1 Bits" class="md-nav__link">
      191. Number of 1 Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/198. House Robber/" title="198. House Robber" class="md-nav__link">
      198. House Robber
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/199. Binary Tree Right Side View/" title="199. Binary Tree Right Side View" class="md-nav__link">
      199. Binary Tree Right Side View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/2. Add Two Numbers/" title="2. Add Two Numbers" class="md-nav__link">
      2. Add Two Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/20. Valid Parentheses/" title="20. Valid Parentheses" class="md-nav__link">
      20. Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/200. Number of Islands/" title="200. Number of Islands" class="md-nav__link">
      200. Number of Islands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/202. Happy Number/" title="202. Happy Number" class="md-nav__link">
      202. Happy Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/203. Remove Linked List Elements/" title="203. Remove Linked List Elements" class="md-nav__link">
      203. Remove Linked List Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/204. Count Primes/" title="204. Count Primes" class="md-nav__link">
      204. Count Primes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/205. Isomorphic Strings/" title="205. Isomorphic Strings" class="md-nav__link">
      205. Isomorphic Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/206. Reverse Linked List/" title="206. Reverse Linked List" class="md-nav__link">
      206. Reverse Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/207. Course Schedule/" title="207. Course Schedule" class="md-nav__link">
      207. Course Schedule
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/209. Minimum Size Subarray Sum/" title="209. Minimum Size Subarray Sum" class="md-nav__link">
      209. Minimum Size Subarray Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/21. Merge Two Sorted Lists/" title="21. Merge Two Sorted Lists" class="md-nav__link">
      21. Merge Two Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/210. Course Schedule II/" title="210. Course Schedule II" class="md-nav__link">
      210. Course Schedule II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/213. House Robber II/" title="213. House Robber II" class="md-nav__link">
      213. House Robber II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/215. Kth Largest Element in an Array/" title="215. Kth Largest Element in an Array" class="md-nav__link">
      215. Kth Largest Element in an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/216. Combination Sum III/" title="216. Combination Sum III" class="md-nav__link">
      216. Combination Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/22. Generate Parentheses/" title="22. Generate Parentheses" class="md-nav__link">
      22. Generate Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/221. Maximal Square/" title="221. Maximal Square" class="md-nav__link">
      221. Maximal Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/222. Count Complete Tree Nodes/" title="222. Count Complete Tree Nodes" class="md-nav__link">
      222. Count Complete Tree Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/224. Basic Calculator/" title="224. Basic Calculator" class="md-nav__link">
      224. Basic Calculator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/225. Implement Stack using Queues/" title="225. Implement Stack using Queues" class="md-nav__link">
      225. Implement Stack using Queues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/226. Invert Binary Tree/" title="226. Invert Binary Tree" class="md-nav__link">
      226. Invert Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/229. Majority Element II/" title="229. Majority Element II" class="md-nav__link">
      229. Majority Element II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/23. Merge k Sorted Lists/" title="23. Merge k Sorted Lists" class="md-nav__link">
      23. Merge k Sorted Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/230. Kth Smallest Element in a BST/" title="230. Kth Smallest Element in a BST" class="md-nav__link">
      230. Kth Smallest Element in a BST
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/231. Power of Two/" title="231. Power of Two" class="md-nav__link">
      231. Power of Two
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/232. Implement Queue using Stacks/" title="232. Implement Queue using Stacks" class="md-nav__link">
      232. Implement Queue using Stacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/233. Number of Digit One/" title="233. Number of Digit One" class="md-nav__link">
      233. Number of Digit One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/234. Palindrome Linked List/" title="234. Palindrome Linked List" class="md-nav__link">
      234. Palindrome Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/235. Lowest Common Ancestor of a Binary Search Tree/" title="235. Lowest Common Ancestor of a Binary Search Tree" class="md-nav__link">
      235. Lowest Common Ancestor of a Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/236. Lowest Common Ancestor of a Binary Tree/" title="236. Lowest Common Ancestor of a Binary Tree" class="md-nav__link">
      236. Lowest Common Ancestor of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/237. Delete Node in a Linked List/" title="237. Delete Node in a Linked List" class="md-nav__link">
      237. Delete Node in a Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/24. Swap Nodes in Pairs/" title="24. Swap Nodes in Pairs" class="md-nav__link">
      24. Swap Nodes in Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/240. Search a 2D Matrix II/" title="240. Search a 2D Matrix II" class="md-nav__link">
      240. Search a 2D Matrix II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/241. Different Ways to Add Parentheses/" title="241. Different Ways to Add Parentheses" class="md-nav__link">
      241. Different Ways to Add Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/242. Valid Anagram/" title="242. Valid Anagram" class="md-nav__link">
      242. Valid Anagram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/25. Reverse Nodes in k-Group/" title="25. Reverse Nodes in k-Group" class="md-nav__link">
      25. Reverse Nodes in k-Group
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/252. Meeting Rooms/" title="252. Meeting Rooms" class="md-nav__link">
      252. Meeting Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/253. Meeting Rooms II/" title="253. Meeting Rooms II" class="md-nav__link">
      253. Meeting Rooms II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/256. Paint House/" title="256. Paint House" class="md-nav__link">
      256. Paint House
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/257. Binary Tree Paths/" title="257. Binary Tree Paths" class="md-nav__link">
      257. Binary Tree Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/258. Add Digits/" title="258. Add Digits" class="md-nav__link">
      258. Add Digits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/26. Remove Duplicates from Sorted Array/" title="26. Remove Duplicates from Sorted Array" class="md-nav__link">
      26. Remove Duplicates from Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/260. Single Number III/" title="260. Single Number III" class="md-nav__link">
      260. Single Number III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/261. Graph Valid Tree/" title="261. Graph Valid Tree" class="md-nav__link">
      261. Graph Valid Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/263. Ugly Number/" title="263. Ugly Number" class="md-nav__link">
      263. Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/264. Ugly Number II/" title="264. Ugly Number II" class="md-nav__link">
      264. Ugly Number II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/265. Paint House II/" title="265. Paint House II" class="md-nav__link">
      265. Paint House II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/268. Missing Number/" title="268. Missing Number" class="md-nav__link">
      268. Missing Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/27. Remove Element/" title="27. Remove Element" class="md-nav__link">
      27. Remove Element
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/270. Closest Binary Search Tree Value/" title="270. Closest Binary Search Tree Value" class="md-nav__link">
      270. Closest Binary Search Tree Value
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/276. Paint Fence/" title="276. Paint Fence" class="md-nav__link">
      276. Paint Fence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/278. First Bad Version/" title="278. First Bad Version" class="md-nav__link">
      278. First Bad Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/279. Perfect Squares/" title="279. Perfect Squares" class="md-nav__link">
      279. Perfect Squares
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/28. Implement strStr()/" title="28. Implement strStr()" class="md-nav__link">
      28. Implement strStr()
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/280. Wiggle Sort/" title="280. Wiggle Sort" class="md-nav__link">
      280. Wiggle Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/287. Find the Duplicate Number/" title="287. Find the Duplicate Number" class="md-nav__link">
      287. Find the Duplicate Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/29. Divide Two Integers/" title="29. Divide Two Integers" class="md-nav__link">
      29. Divide Two Integers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/290. Word Pattern/" title="290. Word Pattern" class="md-nav__link">
      290. Word Pattern
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/295. Find Median from Data Stream/" title="295. Find Median from Data Stream" class="md-nav__link">
      295. Find Median from Data Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/297. Serialize and Deserialize Binary Tree/" title="297. Serialize and Deserialize Binary Tree" class="md-nav__link">
      297. Serialize and Deserialize Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/3. Longest Substring Without Repeating Characters/" title="3. Longest Substring Without Repeating Characters" class="md-nav__link">
      3. Longest Substring Without Repeating Characters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/30. Substring with Concatenation of All Words/" title="30. Substring with Concatenation of All Words" class="md-nav__link">
      30. Substring with Concatenation of All Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/300. Longest Increasing Subsequence/" title="300. Longest Increasing Subsequence" class="md-nav__link">
      300. Longest Increasing Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/303. Range Sum Query - Immutable/" title="303. Range Sum Query - Immutable" class="md-nav__link">
      303. Range Sum Query - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/304. Range Sum Query 2D - Immutable/" title="304. Range Sum Query 2D - Immutable" class="md-nav__link">
      304. Range Sum Query 2D - Immutable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/309. Best Time to Buy and Sell Stock with Cooldown/" title="309. Best Time to Buy and Sell Stock with Cooldown" class="md-nav__link">
      309. Best Time to Buy and Sell Stock with Cooldown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/31. Next Permutation/" title="31. Next Permutation" class="md-nav__link">
      31. Next Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/310. Minimum Height Trees/" title="310. Minimum Height Trees" class="md-nav__link">
      310. Minimum Height Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/313. Super Ugly Number/" title="313. Super Ugly Number" class="md-nav__link">
      313. Super Ugly Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/32. Longest Valid Parentheses/" title="32. Longest Valid Parentheses" class="md-nav__link">
      32. Longest Valid Parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/322. Coin Change/" title="322. Coin Change" class="md-nav__link">
      322. Coin Change
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/324. Wiggle Sort II/" title="324. Wiggle Sort II" class="md-nav__link">
      324. Wiggle Sort II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/326. Power of Three/" title="326. Power of Three" class="md-nav__link">
      326. Power of Three
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/328. Odd Even Linked List/" title="328. Odd Even Linked List" class="md-nav__link">
      328. Odd Even Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/33. Search in Rotated Sorted Array/" title="33. Search in Rotated Sorted Array" class="md-nav__link">
      33. Search in Rotated Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/331. Verify Preorder Serialization of a Binary Tree/" title="331. Verify Preorder Serialization of a Binary Tree" class="md-nav__link">
      331. Verify Preorder Serialization of a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/332. Reconstruct Itinerary/" title="332. Reconstruct Itinerary" class="md-nav__link">
      332. Reconstruct Itinerary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/337. House Robber III/" title="337. House Robber III" class="md-nav__link">
      337. House Robber III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/338. Counting Bits/" title="338. Counting Bits" class="md-nav__link">
      338. Counting Bits
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/34. Find First and Last Position of Element in Sorted Array/" title="34. Find First and Last Position of Element in Sorted Array" class="md-nav__link">
      34. Find First and Last Position of Element in Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/342. Power of Four/" title="342. Power of Four" class="md-nav__link">
      342. Power of Four
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/344. Reverse String/" title="344. Reverse String" class="md-nav__link">
      344. Reverse String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/345. Reverse Vowels of a String/" title="345. Reverse Vowels of a String" class="md-nav__link">
      345. Reverse Vowels of a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/347. Top K Frequent Elements/" title="347. Top K Frequent Elements" class="md-nav__link">
      347. Top K Frequent Elements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/349. Intersection of Two Arrays/" title="349. Intersection of Two Arrays" class="md-nav__link">
      349. Intersection of Two Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/35. Search Insert Position/" title="35. Search Insert Position" class="md-nav__link">
      35. Search Insert Position
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/350. Intersection of Two Arrays II/" title="350. Intersection of Two Arrays II" class="md-nav__link">
      350. Intersection of Two Arrays II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/359. Logger Rate Limiter/" title="359. Logger Rate Limiter" class="md-nav__link">
      359. Logger Rate Limiter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/36. Valid Sudoku/" title="36. Valid Sudoku" class="md-nav__link">
      36. Valid Sudoku
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/366. Find Leaves of Binary Tree/" title="366. Find Leaves of Binary Tree" class="md-nav__link">
      366. Find Leaves of Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/367. Valid Perfect Square/" title="367. Valid Perfect Square" class="md-nav__link">
      367. Valid Perfect Square
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/37. Sudoku Solver/" title="37. Sudoku Solver" class="md-nav__link">
      37. Sudoku Solver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/370. Range Addition/" title="370. Range Addition" class="md-nav__link">
      370. Range Addition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/372. Super Pow/" title="372. Super Pow" class="md-nav__link">
      372. Super Pow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/373. Find K Pairs with Smallest Sums/" title="373. Find K Pairs with Smallest Sums" class="md-nav__link">
      373. Find K Pairs with Smallest Sums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/378. Kth Smallest Element in a Sorted Matrix/" title="378. Kth Smallest Element in a Sorted Matrix" class="md-nav__link">
      378. Kth Smallest Element in a Sorted Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/38. Count and Say/" title="38. Count and Say" class="md-nav__link">
      38. Count and Say
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/382. Linked List Random Node/" title="382. Linked List Random Node" class="md-nav__link">
      382. Linked List Random Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/384. Shuffle an Array/" title="384. Shuffle an Array" class="md-nav__link">
      384. Shuffle an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/387. First Unique Character in a String/" title="387. First Unique Character in a String" class="md-nav__link">
      387. First Unique Character in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/39. Combination Sum/" title="39. Combination Sum" class="md-nav__link">
      39. Combination Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/399. Evaluate Division/" title="399. Evaluate Division" class="md-nav__link">
      399. Evaluate Division
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/4. Median of Two Sorted Arrays/" title="4. Median of Two Sorted Arrays" class="md-nav__link">
      4. Median of Two Sorted Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/40. Combination Sum II/" title="40. Combination Sum II" class="md-nav__link">
      40. Combination Sum II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/401. Binary Watch/" title="401. Binary Watch" class="md-nav__link">
      401. Binary Watch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/404. Sum of Left Leaves/" title="404. Sum of Left Leaves" class="md-nav__link">
      404. Sum of Left Leaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/409. Longest Palindrome/" title="409. Longest Palindrome" class="md-nav__link">
      409. Longest Palindrome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/415. Add Strings/" title="415. Add Strings" class="md-nav__link">
      415. Add Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/42. Trapping Rain Water/" title="42. Trapping Rain Water" class="md-nav__link">
      42. Trapping Rain Water
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/426. Convert Binary Search Tree to Sorted Doubly Linked List/" title="426. Convert Binary Search Tree to Sorted Doubly Linked List" class="md-nav__link">
      426. Convert Binary Search Tree to Sorted Doubly Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/429. N-ary Tree Level Order Traversal/" title="429. N-ary Tree Level Order Traversal" class="md-nav__link">
      429. N-ary Tree Level Order Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/43. Multiply Strings/" title="43. Multiply Strings" class="md-nav__link">
      43. Multiply Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/437. Path Sum III/" title="437. Path Sum III" class="md-nav__link">
      437. Path Sum III
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/438. Find All Anagrams in a String/" title="438. Find All Anagrams in a String" class="md-nav__link">
      438. Find All Anagrams in a String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/451. Sort Characters By Frequency/" title="451. Sort Characters By Frequency" class="md-nav__link">
      451. Sort Characters By Frequency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/46. Permutations/" title="46. Permutations" class="md-nav__link">
      46. Permutations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/463. Island Perimeter/" title="463. Island Perimeter" class="md-nav__link">
      463. Island Perimeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/47. Permutations II/" title="47. Permutations II" class="md-nav__link">
      47. Permutations II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/49. Group Anagrams/" title="49. Group Anagrams" class="md-nav__link">
      49. Group Anagrams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/493. Reverse Pairs/" title="493. Reverse Pairs" class="md-nav__link">
      493. Reverse Pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/5. Longest Palindromic Substring/" title="5. Longest Palindromic Substring" class="md-nav__link">
      5. Longest Palindromic Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/50. Pow(x, n)/" title="50. Pow(x, n)" class="md-nav__link">
      50. Pow(x, n)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/500. Keyboard Row/" title="500. Keyboard Row" class="md-nav__link">
      500. Keyboard Row
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/507. Perfect Number/" title="507. Perfect Number" class="md-nav__link">
      507. Perfect Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/51. N-Queens/" title="51. N-Queens" class="md-nav__link">
      51. N-Queens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/518. Coin Change 2/" title="518. Coin Change 2" class="md-nav__link">
      518. Coin Change 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/52. N-Queens II/" title="52. N-Queens II" class="md-nav__link">
      52. N-Queens II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/53. Maximum Subarray/" title="53. Maximum Subarray" class="md-nav__link">
      53. Maximum Subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/538. Convert BST to Greater Tree/" title="538. Convert BST to Greater Tree" class="md-nav__link">
      538. Convert BST to Greater Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/559. Maximum Depth of N-ary Tree/" title="559. Maximum Depth of N-ary Tree" class="md-nav__link">
      559. Maximum Depth of N-ary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/56. Merge Intervals/" title="56. Merge Intervals" class="md-nav__link">
      56. Merge Intervals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/57. Insert Interval/" title="57. Insert Interval" class="md-nav__link">
      57. Insert Interval
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/58. Length of Last Word/" title="58. Length of Last Word" class="md-nav__link">
      58. Length of Last Word
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/590. N-ary Tree Postorder Traversal/" title="590. N-ary Tree Postorder Traversal" class="md-nav__link">
      590. N-ary Tree Postorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/599. Minimum Index Sum of Two Lists/" title="599. Minimum Index Sum of Two Lists" class="md-nav__link">
      599. Minimum Index Sum of Two Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/6. ZigZag Conversion/" title="6. ZigZag Conversion" class="md-nav__link">
      6. ZigZag Conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/60. Permutation Sequence/" title="60. Permutation Sequence" class="md-nav__link">
      60. Permutation Sequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/606. Construct String from Binary Tree/" title="606. Construct String from Binary Tree" class="md-nav__link">
      606. Construct String from Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/61. Rotate List/" title="61. Rotate List" class="md-nav__link">
      61. Rotate List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/62. Unique Paths/" title="62. Unique Paths" class="md-nav__link">
      62. Unique Paths
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/63. Unique Paths II/" title="63. Unique Paths II" class="md-nav__link">
      63. Unique Paths II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/633. Sum of Square Numbers/" title="633. Sum of Square Numbers" class="md-nav__link">
      633. Sum of Square Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/637. Average of Levels in Binary Tree/" title="637. Average of Levels in Binary Tree" class="md-nav__link">
      637. Average of Levels in Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/64. Minimum Path Sum/" title="64. Minimum Path Sum" class="md-nav__link">
      64. Minimum Path Sum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/66. Plus One/" title="66. Plus One" class="md-nav__link">
      66. Plus One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/67. Add Binary/" title="67. Add Binary" class="md-nav__link">
      67. Add Binary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/671. Second Minimum Node In a Binary Tree/" title="671. Second Minimum Node In a Binary Tree" class="md-nav__link">
      671. Second Minimum Node In a Binary Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/684. Redundant Connection/" title="684. Redundant Connection" class="md-nav__link">
      684. Redundant Connection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/685. Redundant Connection II/" title="685. Redundant Connection II" class="md-nav__link">
      685. Redundant Connection II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/687. Longest Univalue Path/" title="687. Longest Univalue Path" class="md-nav__link">
      687. Longest Univalue Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/69. Sqrt(x)/" title="69. Sqrt(x)" class="md-nav__link">
      69. Sqrt(x)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/692. Top K Frequent Words/" title="692. Top K Frequent Words" class="md-nav__link">
      692. Top K Frequent Words
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/697. Degree of an Array/" title="697. Degree of an Array" class="md-nav__link">
      697. Degree of an Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/7. Reverse Integer/" title="7. Reverse Integer" class="md-nav__link">
      7. Reverse Integer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/70. Climbing Stairs/" title="70. Climbing Stairs" class="md-nav__link">
      70. Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/703. Kth Largest Element in a Stream/" title="703. Kth Largest Element in a Stream" class="md-nav__link">
      703. Kth Largest Element in a Stream
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/704. Binary Search/" title="704. Binary Search" class="md-nav__link">
      704. Binary Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/71. Simplify Path/" title="71. Simplify Path" class="md-nav__link">
      71. Simplify Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/716. Max Stack/" title="716. Max Stack" class="md-nav__link">
      716. Max Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/728. Self Dividing Numbers/" title="728. Self Dividing Numbers" class="md-nav__link">
      728. Self Dividing Numbers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/74. Search a 2D Matrix/" title="74. Search a 2D Matrix" class="md-nav__link">
      74. Search a 2D Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/741. Cherry Pickup/" title="741. Cherry Pickup" class="md-nav__link">
      741. Cherry Pickup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/743. Network Delay Time/" title="743. Network Delay Time" class="md-nav__link">
      743. Network Delay Time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/746. Min Cost Climbing Stairs/" title="746. Min Cost Climbing Stairs" class="md-nav__link">
      746. Min Cost Climbing Stairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/75. Sort Colors/" title="75. Sort Colors" class="md-nav__link">
      75. Sort Colors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/76. Minimum Window Substring/" title="76. Minimum Window Substring" class="md-nav__link">
      76. Minimum Window Substring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/760. Find Anagram Mappings/" title="760. Find Anagram Mappings" class="md-nav__link">
      760. Find Anagram Mappings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/77. Combinations/" title="77. Combinations" class="md-nav__link">
      77. Combinations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/78. Subsets/" title="78. Subsets" class="md-nav__link">
      78. Subsets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/783. Minimum Distance Between BST Nodes/" title="783. Minimum Distance Between BST Nodes" class="md-nav__link">
      783. Minimum Distance Between BST Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/784. Letter Case Permutation/" title="784. Letter Case Permutation" class="md-nav__link">
      784. Letter Case Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/785. Is Graph Bipartite?/" title="785. Is Graph Bipartite?" class="md-nav__link">
      785. Is Graph Bipartite?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/79. Word Search/" title="79. Word Search" class="md-nav__link">
      79. Word Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/8. String to Integer (atoi)/" title="8. String to Integer (atoi)" class="md-nav__link">
      8. String to Integer (atoi)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/81. Search in Rotated Sorted Array II/" title="81. Search in Rotated Sorted Array II" class="md-nav__link">
      81. Search in Rotated Sorted Array II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/82. Remove Duplicates from Sorted List II/" title="82. Remove Duplicates from Sorted List II" class="md-nav__link">
      82. Remove Duplicates from Sorted List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/83. Remove Duplicates from Sorted List/" title="83. Remove Duplicates from Sorted List" class="md-nav__link">
      83. Remove Duplicates from Sorted List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/84. Largest Rectangle in Histogram/" title="84. Largest Rectangle in Histogram" class="md-nav__link">
      84. Largest Rectangle in Histogram
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/841. Keys and Rooms/" title="841. Keys and Rooms" class="md-nav__link">
      841. Keys and Rooms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/85. Maximal Rectangle/" title="85. Maximal Rectangle" class="md-nav__link">
      85. Maximal Rectangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/86. Partition List/" title="86. Partition List" class="md-nav__link">
      86. Partition List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/867. Transpose Matrix/" title="867. Transpose Matrix" class="md-nav__link">
      867. Transpose Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/873. Length of Longest Fibonacci Subsequence/" title="873. Length of Longest Fibonacci Subsequence" class="md-nav__link">
      873. Length of Longest Fibonacci Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/876. Middle of the Linked List/" title="876. Middle of the Linked List" class="md-nav__link">
      876. Middle of the Linked List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/88. Merge Sorted Array/" title="88. Merge Sorted Array" class="md-nav__link">
      88. Merge Sorted Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/89. Gray Code/" title="89. Gray Code" class="md-nav__link">
      89. Gray Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/9. Palindrome Number/" title="9. Palindrome Number" class="md-nav__link">
      9. Palindrome Number
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/90. Subsets II/" title="90. Subsets II" class="md-nav__link">
      90. Subsets II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/91. Decode Ways/" title="91. Decode Ways" class="md-nav__link">
      91. Decode Ways
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/92. Reverse Linked List II/" title="92. Reverse Linked List II" class="md-nav__link">
      92. Reverse Linked List II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/93. Restore IP Addresses/" title="93. Restore IP Addresses" class="md-nav__link">
      93. Restore IP Addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/93. Restore IP Adress/" title="93. Restore IP Adress" class="md-nav__link">
      93. Restore IP Adress
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/94. Binary Tree Inorder Traversal/" title="94. Binary Tree Inorder Traversal" class="md-nav__link">
      94. Binary Tree Inorder Traversal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/941. Valid Mountain Array/" title="941. Valid Mountain Array" class="md-nav__link">
      941. Valid Mountain Array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/95. Unique Binary Search Trees II/" title="95. Unique Binary Search Trees II" class="md-nav__link">
      95. Unique Binary Search Trees II
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/96. Unique Binary Search Trees/" title="96. Unique Binary Search Trees" class="md-nav__link">
      96. Unique Binary Search Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/98. Validate Binary Search Tree/" title="98. Validate Binary Search Tree" class="md-nav__link">
      98. Validate Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/99. Recover Binary Search Tree/" title="99. Recover Binary Search Tree" class="md-nav__link">
      99. Recover Binary Search Tree
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-276" type="checkbox" id="nav-4-276">
    
    <label class="md-nav__link" for="nav-4-276">
      LintCode
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-276">
        LintCode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/77. Longest Common Subsequence/" title="77. Longest Common Subsequence" class="md-nav__link">
      77. Longest Common Subsequence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/LintCode/464. Sort Integers II/" title="464. Sort Integers II" class="md-nav__link">
      464. Sort Integers II
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Leetcode/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Miscellaneous
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Clion/" title="Clion" class="md-nav__link">
      Clion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Cpp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Cpp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/EOF/" title="EOF" class="md-nav__link">
      EOF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/STL中的vector string总结/" title="STL中的vector string总结" class="md-nav__link">
      STL中的vector string总结
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/STL源码剖析/" title="STL源码剖析" class="md-nav__link">
      STL源码剖析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/static用法/" title="static用法" class="md-nav__link">
      static用法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C++ Primer (6) - 函数/" title="C++ Primer (6) - 函数" class="md-nav__link">
      C++ Primer (6) - 函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C++ Primer (12) - 动态内存/" title="C++ Primer (12) - 动态内存" class="md-nav__link">
      C++ Primer (12) - 动态内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Cpp/C++面试经典100题/" title="C++面试经典100题" class="md-nav__link">
      C++面试经典100题
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/GCC/" title="GCC" class="md-nav__link">
      GCC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Intellij IDEA/" title="Intellij IDEA" class="md-nav__link">
      Intellij IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/LLDB使用/" title="LLDB使用" class="md-nav__link">
      LLDB使用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/Maven/" title="Maven" class="md-nav__link">
      Maven
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/VIM技巧/" title="VIM技巧" class="md-nav__link">
      VIM技巧
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-10" type="checkbox" id="nav-5-10">
    
    <label class="md-nav__link" for="nav-5-10">
      awesome Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-10">
        awesome Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/CentOS日志/" title="CentOS日志" class="md-nav__link">
      CentOS日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Intel Parallel Studio XE/" title="Intel Parallel Studio XE" class="md-nav__link">
      Intel Parallel Studio XE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Jupyter Notebook/" title="Jupyter Notebook" class="md-nav__link">
      Jupyter Notebook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Nasm/" title="Nasm" class="md-nav__link">
      Nasm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Octave/" title="Octave" class="md-nav__link">
      Octave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Proxy/" title="Proxy" class="md-nav__link">
      Proxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/Youtube/" title="Youtube" class="md-nav__link">
      Youtube
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/git/" title="git" class="md-nav__link">
      git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/ubuntu日志/" title="ubuntu日志" class="md-nav__link">
      ubuntu日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/vagrant搭建ubuntu/" title="vagrant搭建ubuntu" class="md-nav__link">
      vagrant搭建ubuntu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/awesome Install/黑苹果日志/" title="黑苹果日志" class="md-nav__link">
      黑苹果日志
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/建站日志/" title="建站日志" class="md-nav__link">
      建站日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-13" type="checkbox" id="nav-5-13">
    
    <label class="md-nav__link" for="nav-5-13">
      面试
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-13">
        面试
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/面试/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/面试/Java多线程面试/" title="Java多线程面试" class="md-nav__link">
      Java多线程面试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Miscellaneous/面试/网络面试/" title="网络面试" class="md-nav__link">
      网络面试
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      OS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        OS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/Linux私房菜(Centos 7)/" title="Linux私房菜(Centos 7)" class="md-nav__link">
      Linux私房菜(Centos 7)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      分布式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        分布式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/分布式/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/分布式/Building Large Scale Internet Service/" title="Building Large Scale Internet Service" class="md-nav__link">
      Building Large Scale Internet Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/分布式/Consensus/" title="Consensus" class="md-nav__link">
      Consensus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/分布式/Google Chubby/" title="Google Chubby" class="md-nav__link">
      Google Chubby
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      操作系统概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        操作系统概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/1 Introduction/" title="1 Introduction" class="md-nav__link">
      1 Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/2 Operating System structures/" title="2 Operating System structures" class="md-nav__link">
      2 Operating System structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/3 Processes/" title="3 Processes" class="md-nav__link">
      3 Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/4 Threads and Concurrency/" title="4 Threads and Concurrency" class="md-nav__link">
      4 Threads and Concurrency
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/5 CPU Scheduling/" title="5 CPU Scheduling" class="md-nav__link">
      5 CPU Scheduling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/6 Synchronization Tools/" title="6 Synchronization Tools" class="md-nav__link">
      6 Synchronization Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/7 Synchronization Examples/" title="7 Synchronization Examples" class="md-nav__link">
      7 Synchronization Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/8 DeadLocks/" title="8 DeadLocks" class="md-nav__link">
      8 DeadLocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/9 Main Memory/" title="9 Main Memory" class="md-nav__link">
      9 Main Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/10 Virtual Memory/" title="10 Virtual Memory" class="md-nav__link">
      10 Virtual Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/11 Mass-Storage Structure/" title="11 Mass-Storage Structure" class="md-nav__link">
      11 Mass-Storage Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/12 IO Systems/" title="12 IO Systems" class="md-nav__link">
      12 IO Systems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/13 File System Interface/" title="13 File System Interface" class="md-nav__link">
      13 File System Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/15 File System Internals/" title="15 File System Internals" class="md-nav__link">
      15 File System Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/17 Protection/" title="17 Protection" class="md-nav__link">
      17 Protection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/操作系统概念/18 Virtual Machines/" title="18 Virtual Machines" class="md-nav__link">
      18 Virtual Machines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      深入了解计算机系统
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        深入了解计算机系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/1 计算机系统漫游/" title="1 计算机系统漫游" class="md-nav__link">
      1 计算机系统漫游
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/10 系统级IO/" title="10 系统级IO" class="md-nav__link">
      10 系统级IO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/11 网络编程/" title="11 网络编程" class="md-nav__link">
      11 网络编程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/2 信息的表示和处理/" title="2 信息的表示和处理" class="md-nav__link">
      2 信息的表示和处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/3 程序的机器级表示/" title="3 程序的机器级表示" class="md-nav__link">
      3 程序的机器级表示
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/4 处理器体系结构/" title="4 处理器体系结构" class="md-nav__link">
      4 处理器体系结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/5 优化程序性能/" title="5 优化程序性能" class="md-nav__link">
      5 优化程序性能
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/6 存储器层次结构/" title="6 存储器层次结构" class="md-nav__link">
      6 存储器层次结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/7 链接/" title="7 链接" class="md-nav__link">
      7 链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/8 异常控制流/" title="8 异常控制流" class="md-nav__link">
      8 异常控制流
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/9 虚拟内存/" title="9 虚拟内存" class="md-nav__link">
      9 虚拟内存
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6-12" type="checkbox" id="nav-6-6-12">
    
    <label class="md-nav__link" for="nav-6-6-12">
      Labs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-6-12">
        Labs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/Lab1 Data Lab/" title="Lab1 Data Lab" class="md-nav__link">
      Lab1 Data Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/Lab3 Attack Lab/" title="Lab3 Attack Lab" class="md-nav__link">
      Lab3 Attack Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/Lab4 Cache Lab/" title="Lab4 Cache Lab" class="md-nav__link">
      Lab4 Cache Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/Lab5 Shell Lab/" title="Lab5 Shell Lab" class="md-nav__link">
      Lab5 Shell Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/Labs/Lab6 Malloc Lab/" title="Lab6 Malloc Lab" class="md-nav__link">
      Lab6 Malloc Lab
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入了解计算机系统/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/深入解析Mac OS X/" title="深入解析Mac OS X" class="md-nav__link">
      深入解析Mac OS X
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机组成与设计/" title="计算机组成与设计" class="md-nav__link">
      计算机组成与设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-9" type="checkbox" id="nav-6-9">
    
    <label class="md-nav__link" for="nav-6-9">
      计算机网络 自顶向下
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-9">
        计算机网络 自顶向下
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/" title="index" class="md-nav__link">
      index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/Socket Programming/" title="Socket Programming" class="md-nav__link">
      Socket Programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/WireShark Lab/" title="WireShark Lab" class="md-nav__link">
      WireShark Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/1 计算机网络和因特网/" title="1 计算机网络和因特网" class="md-nav__link">
      1 计算机网络和因特网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/2 应用层/" title="2 应用层" class="md-nav__link">
      2 应用层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/3 运输层/" title="3 运输层" class="md-nav__link">
      3 运输层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/4 网络层/" title="4 网络层" class="md-nav__link">
      4 网络层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/5 链路层/" title="5 链路层" class="md-nav__link">
      5 链路层
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../OS/计算机网络 自顶向下/6 网络安全/" title="6 网络安全" class="md-nav__link">
      6 网络安全
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1 简介
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sparksession" class="md-nav__link">
    SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes" class="md-nav__link">
    DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions" class="md-nav__link">
    Partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformations" class="md-nav__link">
    Transformations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action" class="md-nav__link">
    Action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark" class="md-nav__link">
    开发和部署Spark应用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-ui" class="md-nav__link">
    Spark UI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-structured-api" class="md-nav__link">
    2 Structured API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structured-api-execution" class="md-nav__link">
    Structured API Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_1" class="md-nav__link">
    Spark类型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes_1" class="md-nav__link">
    DataFrames
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    Schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    列和表达式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    记录和行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    转换
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-sql" class="md-nav__link">
    Spark SQL
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark-sql_1" class="md-nav__link">
    运行Spark SQL查询
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets" class="md-nav__link">
    DataSets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#encoder" class="md-nav__link">
    Encoder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets_1" class="md-nav__link">
    创建Datasets
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    外部数据
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    读取
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    写入
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-low-level-apis" class="md-nav__link">
    3 Low-level APIs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdd" class="md-nav__link">
    RDD
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    转换和动作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    持久化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpointing" class="md-nav__link">
    checkpointing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pair-rdd" class="md-nav__link">
    Pair RDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdd_1" class="md-nav__link">
    数值RDD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    分区
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    基于分区的操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-shared-variables" class="md-nav__link">
    Distributed Shared Variables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    广播变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    累加器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-spark" class="md-nav__link">
    4 Spark是如何在集群上运行的
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    运行模式
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    集群模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    客户模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    本地模式
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    部署模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparkspark" class="md-nav__link">
    Spark应用的生命周期(Spark外部)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparkspark_1" class="md-nav__link">
    Spark应用的生命周期(Spark内部)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-sparksession" class="md-nav__link">
    The SparkSession
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-dag" class="md-nav__link">
    The DAG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-spark-job" class="md-nav__link">
    A Spark Job
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stages" class="md-nav__link">
    Stages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks" class="md-nav__link">
    Tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    执行细节
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipelining" class="md-nav__link">
    Pipelining
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shuffle-persistence" class="md-nav__link">
    Shuffle Persistence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    内存管理
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tungsten" class="md-nav__link">
    Tungsten
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-spark-streaming" class="md-nav__link">
    5 Spark Streaming
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fundamentals" class="md-nav__link">
    fundamentals
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stream-processing-design-points" class="md-nav__link">
    Stream Processing Design Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sparks-streaming-api" class="md-nav__link">
    Spark's Streaming API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dstream" class="md-nav__link">
    DStream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    输出操作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structured-streaming" class="md-nav__link">
    Structured Streaming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-time-and-stateful-processing" class="md-nav__link">
    Event-Time and Stateful Processing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-mllib" class="md-nav__link">
    6 MLlib
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#low-level-data-types" class="md-nav__link">
    Low-level data types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 调优
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    算子的合理选择
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupbykeyreducebykey" class="md-nav__link">
    groupByKey/reduceByKey
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    序列化格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    优化配置参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    数据倾斜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    附录
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark_2" class="md-nav__link">
    安装Spark集群
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/techlarry/note/edit/master/wiki/docs/Data Science/Hadoop/Spark权威指南.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Spark权威指南</h1>
                

<!--添加tag标签 -->



                <p><a href="https://spark.apache.org/">Apache Spark</a><!--是用于大数据处理的集群计算框架。它-->包括一个统一的计算引擎和多个在集群中进行数据并行处理的库。<!--它并没有以MapReduce作为执行引擎，而是使用了自己的分布式运行环境在集群上执行。-->Spark最突出的表现在于它能够将作业和作业之间的大规模的工作数据集存储在内存中，因此迭代算法和交互式分析可以从Spark中获益最大。 </p>
<p><img alt="" src="../figures/components_and_libraries_of_spark.jpg" /></p>
<ul>
<li>统一：Spark支持各种数据分析任务，从数据加载、查询到流处理都可以用相同的计算引擎和一致的API。</li>
<li>计算引擎：不同于Hadoop包括一个文件系统(HDFS)和计算引擎(MapReduce)，Spark仅包含计算引擎，但是支持很多外部存储(包括HDFS)，使得数据访问更加方便。</li>
<li>库：Spark支持标准库(Spark SQL, MLlib, Spark Streaming, GraphX)和第三方库(<a href="http://spark-packages.org">列表</a>)。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Hadoop v.s. Spark</p>
<p>对于容错(fault-tolerance)，Hadoop在map和reduce步骤之间，为了可以从可能的失败中恢复，混洗了数据并把中间结果写入到硬盘中。而Spark使用函数式编程实现了容错：不可变数据和保存在内存中。所有的数据操作都是函数式转换。</p>
</div>
<h3 id="1">1 简介<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>Spark应用包含一个<strong>driver</strong>进程和多个<strong>executor</strong>进程。driver进程运行<code class="codehilite"><span class="n">main</span><span class="p">()</span></code>函数，负责三件事情：</p>
<ul>
<li>维持Spark应用程序的相关信息</li>
<li>对用户程序或者输入进行响应</li>
<li>分析(analyze)、分布(distribute)、调度(schedule)executors之间的任务(work)</li>
</ul>
<p>executor负责实际上实施driver分配的任务，并向driver报告任务执行状态和结果。</p>
<p>集群管理器(<strong>cluster manager</strong>)负责维护运行Spark应用的集群。Spark现在支持多种集群管理器：内置的standalone cluster manager，Apache Mesos, Hadoop YARN, Kubernetes。</p>
<p><img alt="" src="../figures/the_architecture_of_a_spark_application.jpg" /></p>
<p>Spark<em>作业</em>(job)是由任意的多阶段(stages)有向无环图(DAG)构成。这些阶段(stages)又被分解为多个<em>任务</em>(task)，任务运行在分布于集群中分区上。</p>
<h4 id="sparksession">SparkSession<a class="headerlink" href="#sparksession" title="Permanent link">&para;</a></h4>
<p><code class="codehilite"><span class="n">SparkSession</span></code>是一个driver进程。<code class="codehilite"><span class="n">SparkSession</span></code>实例是Spark执行用户自定义操作的方式，和Spark应用一一对应。在Scala和Python中，<code class="codehilite"><span class="n">SparkSession</span></code>实例就是<code class="codehilite"><span class="n">spark</span></code>变量。</p>
<div class="codehilite"><pre><span></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">spark</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.SparkSession</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="nc">SparkSession</span><span class="k">@</span><span class="mi">2</span><span class="n">eb91767</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">myRange</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="mi">1000</span><span class="o">).</span><span class="n">toDF</span><span class="o">(</span><span class="s">&quot;number&quot;</span><span class="o">)</span>
<span class="n">myRange</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.DataFrame</span> <span class="o">=</span> <span class="o">[</span><span class="kt">number:</span> <span class="kt">bigint</span><span class="o">]</span>
</pre></div>

<h4 id="dataframes">DataFrames<a class="headerlink" href="#dataframes" title="Permanent link">&para;</a></h4>
<p>DataFrame是最常见的结构化API，代表一个表格的数据。定义表格列以及列的类型的list称为schema。不同于spreadsheet, Spark DataFrame分布在多个节点上。</p>
<p><img alt="Distributed versus single machine analysis" src="../figures/distributed_versus_single_machine_analysis.jpg" /></p>
<h4 id="partitions">Partitions<a class="headerlink" href="#partitions" title="Permanent link">&para;</a></h4>
<p>为了允许每一个executor并行处理任务，Spark把数据分块称为<strong>partitions</strong>(分区)。一个分区是集群中一台主机上的多行数据。DataFrame的分区代表了执行期间数据在集群中的物理分布。</p>
<h4 id="transformations">Transformations<a class="headerlink" href="#transformations" title="Permanent link">&para;</a></h4>
<p>在Spark中，数据结构是不可变的，所以创建以后就不能修改。为了改变一个DataFrame，需要采取<strong>转换</strong>(transformations)操作。</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">divisBy2</span> <span class="k">=</span> <span class="n">myRange</span><span class="o">.</span><span class="n">where</span><span class="o">(</span><span class="s">&quot;number % 2 = 0&quot;</span><span class="o">)</span>
</pre></div>

<p>一共有两种类型的转换：</p>
<ul>
<li>narrow transformations: 输入分区导致一个输出分区</li>
<li>wide transformations: 输入分区导致多个输出分区，也叫做shuffle</li>
</ul>
<p><img alt="narrow_and_wide_transformations" src="../figures/narrow_and_wide_transformations.png" /></p>
<p>对于narrow transformations, Spark会自动采取pipelining(例如如果在DataFrame上使用多个过滤器，它们都会被在内存中操作)。但是对于shuffle, Spark会把结果写入到硬盘。</p>
<p>转换是惰性求值的，在对RDD执行一个动作之前，不会实际调用任何转换。</p>
<h4 id="action">Action<a class="headerlink" href="#action" title="Permanent link">&para;</a></h4>
<p><strong>动作</strong>(Action)指示Spark从一系列转换中计算结果。动作有三种：</p>
<ul>
<li>观察数据</li>
<li>收集数据</li>
<li>写数据</li>
</ul>
<h4 id="spark">开发和部署Spark应用<a class="headerlink" href="#spark" title="Permanent link">&para;</a></h4>
<p>运行Spark应用的最简单方法是使用<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="n">submit</span></code>提交</p>
<div class="codehilite"><pre><span></span>./bin/spark-submit <span class="se">\</span>
  --class &lt;main-class&gt; <span class="se">\</span>
  --master &lt;master-url&gt; <span class="se">\</span>
  --deploy-mode &lt;deploy-mode&gt; <span class="se">\</span>
  --conf &lt;key&gt;<span class="o">=</span>&lt;value&gt; <span class="se">\</span>
  ... <span class="c1"># other options</span>
  &lt;application-jar&gt; <span class="se">\</span>
  <span class="o">[</span>application-arguments<span class="o">]</span>
</pre></div>

<h4 id="spark-ui">Spark UI<a class="headerlink" href="#spark-ui" title="Permanent link">&para;</a></h4>
<p>通过Spark Web UI可以监视作业(job)。本地模式的地址为<a href="http://localhost:4040">http://localhost:4040</a>。</p>
<h3 id="2-structured-api">2 Structured API<a class="headerlink" href="#2-structured-api" title="Permanent link">&para;</a></h3>
<p>Spark Structured API包括三种核心类型：Datasets, DataFrames, SQL。</p>
<p>数据可以是结构化(structured)、半结构化(semi-structured)和非结构化(unstructured)的。</p>
<p><img alt="structured-unstructured_data" src="../figures/structured-unstructured_data.png" /></p>
<p>对于常规的RDDs，Spark不知道其数据的schema，也就是说不知道这些类型的结构。并且由于不知其具体结构，因此无法很好的优化。</p>
<p><img alt="spark-un:structured_data_view 2" src="../figures/spark-un:structured_data_view.png" /></p>
<div class="admonition note">
<p class="admonition-title">"DataFrames v.s. Datasets</p>
<p>DataFrames和DataSets是分布式的、像表一样有行列的数据集。它们的区别是</p>
<ul>
<li><strong><em>untyped</em></strong> DataFrames: only checks whether types line up to those specified in the schema at <em>runtime</em></li>
<li><strong><em>typed</em></strong> DataSets: check whether types conform to the specification at <em>compile time</em></li>
</ul>
<p><span><span class="MathJax_Preview">\rightarrow</span><script type="math/tex">\rightarrow</script></span> <strong>Datasets: Type-Safe Structured APIs</strong></p>
<p>对于Spark in Scala来说，DataFrames是<code class="codehilite"><span class="k">Row</span></code>类型的DataSets。</p>
<div class="codehilite"><pre><span></span><span class="k">type</span> <span class="kt">DataFrame</span> <span class="o">=</span> <span class="nc">Dataset</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span>
</pre></div>

<p>可以认为DataSets是RDDs和DataFrames之间的妥协。</p>
</div>
<h4 id="structured-api-execution">Structured API Execution<a class="headerlink" href="#structured-api-execution" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../figures/spark_sql_architecture.jpg" /></p>
<p>简单来说，Spark对代码中Structured API的执行主要有以下几个步骤：</p>
<ul>
<li>编写DataFrame/Dataset/SQL代码</li>
<li>如果代码没有错误，Spark会将这些代码转换成逻辑计划(Logical Plan)</li>
<li>Spark将生成的逻辑计划记过一系列优化(Catalyst Optimizer)，转换为物理计划(Physical Plan)</li>
<li>Spark在集群上执行物理计划(RDD操作)。</li>
</ul>
<p><img alt="" src="../figures/the_catalyst_optimizer.jpg" /></p>
<p>转化为logical plan的第一步是转化为unresolved logical plan: 虽然代码有效，但是它指代的表格或者列可能不存在。随后Spark使用<em>Catalog</em>(存储着所有表格和DataFrame信息)去解析表格和列。如果需要的表格和列不存在，会拒绝unresolved logical plan。如果通过的话，就使用Catalyst Optimizer优化logical plan。</p>
<p><img alt="" src="../figures/the_structured_api_logical_planning_process.jpg" /></p>
<p>优化逻辑计划(Optimized logical plan)根据不同的物理执行策略(physical execution strategies)产生多个physical plans，通过cost model的比较，选择最优physical plan，最后在集群上执行。</p>
<p><img alt="" src="../figures/the_physical_planning_process.jpg" /></p>
<p>除此之外，Spark在运行期间会进一步优化，产生能够移除执行期间的任务和阶段的原生Java字节码。</p>
<div class="admonition examples">
<p class="admonition-title">显示逻辑/物理执行计划</p>
<p>在Spark-shell中使用<code class="codehilite"><span class="k">explain</span> <span class="n">extended</span></code>命令可以打印出从逻辑计划到物理计划的整个过程。例如</p>
<p><div class="codehilite"><pre><span></span><span class="k">create</span> <span class="k">table</span> <span class="n">t</span><span class="p">(</span><span class="k">key</span> <span class="n">string</span><span class="p">,</span> <span class="n">value</span> <span class="n">string</span><span class="p">);</span>
<span class="k">explain</span> <span class="n">extended</span> <span class="k">select</span> <span class="n">a</span><span class="p">.</span><span class="k">key</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="n">b</span><span class="p">.</span><span class="n">value</span> <span class="k">from</span>  <span class="n">t</span> <span class="n">a</span> <span class="k">join</span> <span class="n">t</span> <span class="n">b</span> <span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="k">key</span> <span class="k">and</span> <span class="n">a</span><span class="p">.</span><span class="k">key</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">;</span>
</pre></div>
上述执行结果显示为</p>
<div class="codehilite"><pre><span></span><span class="o">==</span> <span class="n">Parsed</span> <span class="n">Logical</span> <span class="n">Plan</span> <span class="o">==</span>
<span class="s1">&#39;Project [unresolvedalias((&#39;</span><span class="n">a</span><span class="p">.</span><span class="k">key</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)),</span> <span class="k">None</span><span class="p">),</span> <span class="s1">&#39;b.value]</span>
<span class="s1">+- &#39;</span><span class="k">Join</span> <span class="k">Inner</span><span class="p">,</span> <span class="p">((</span><span class="s1">&#39;a.key = &#39;</span><span class="n">b</span><span class="p">.</span><span class="k">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;a.key &gt; 3))</span>
<span class="s1">   :- &#39;</span><span class="n">UnresolvedRelation</span> <span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span> <span class="n">a</span>
   <span class="o">+-</span> <span class="err">&#39;</span><span class="n">UnresolvedRelation</span> <span class="o">`</span><span class="n">t</span><span class="o">`</span><span class="p">,</span> <span class="n">b</span>

<span class="o">==</span> <span class="n">Analyzed</span> <span class="n">Logical</span> <span class="n">Plan</span> <span class="o">==</span>
<span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">key</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="o">*</span> <span class="k">CAST</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">)):</span> <span class="n">double</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">string</span>
<span class="n">Project</span> <span class="p">[(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">*</span> <span class="k">cast</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">as</span> <span class="n">double</span><span class="p">))</span> <span class="k">AS</span> <span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">key</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="o">*</span> <span class="k">CAST</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">))</span><span class="o">#</span><span class="mi">325</span><span class="p">,</span> <span class="n">value</span><span class="o">#</span><span class="mi">324</span><span class="p">]</span>
<span class="o">+-</span> <span class="k">Join</span> <span class="k">Inner</span><span class="p">,</span> <span class="p">((</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="o">=</span> <span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">&gt;</span> <span class="k">cast</span><span class="p">(</span><span class="mi">3</span> <span class="k">as</span> <span class="n">double</span><span class="p">)))</span>
   <span class="p">:</span><span class="o">-</span> <span class="n">SubqueryAlias</span> <span class="n">a</span>
   <span class="p">:</span>  <span class="o">+-</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>
   <span class="o">+-</span> <span class="n">SubqueryAlias</span> <span class="n">b</span>
      <span class="o">+-</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>

<span class="o">==</span> <span class="n">Optimized</span> <span class="n">Logical</span> <span class="n">Plan</span> <span class="o">==</span>
<span class="n">Project</span> <span class="p">[(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">key</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="o">*</span> <span class="k">CAST</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">))</span><span class="o">#</span><span class="mi">325</span><span class="p">,</span> <span class="n">value</span><span class="o">#</span><span class="mi">324</span><span class="p">]</span>
<span class="o">+-</span> <span class="k">Join</span> <span class="k">Inner</span><span class="p">,</span> <span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="o">=</span> <span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">)</span>
   <span class="p">:</span><span class="o">-</span> <span class="n">Project</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">]</span>
   <span class="p">:</span>  <span class="o">+-</span> <span class="n">Filter</span> <span class="p">(</span><span class="n">isnotnull</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span>
   <span class="p">:</span>     <span class="o">+-</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>
   <span class="o">+-</span> <span class="n">Filter</span> <span class="p">(</span><span class="n">isnotnull</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span>
      <span class="o">+-</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>

<span class="o">==</span> <span class="n">Physical</span> <span class="n">Plan</span> <span class="o">==</span>
<span class="o">*</span><span class="n">Project</span> <span class="p">[(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">key</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="o">*</span> <span class="k">CAST</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DOUBLE</span><span class="p">))</span><span class="o">#</span><span class="mi">325</span><span class="p">,</span> <span class="n">value</span><span class="o">#</span><span class="mi">324</span><span class="p">]</span>
<span class="o">+-</span> <span class="o">*</span><span class="n">SortMergeJoin</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">],</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">],</span> <span class="k">Inner</span>
   <span class="p">:</span><span class="o">-</span> <span class="o">*</span><span class="n">Sort</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">ASC</span> <span class="n">NULLS</span> <span class="k">FIRST</span><span class="p">],</span> <span class="k">false</span><span class="p">,</span> <span class="mi">0</span>
   <span class="p">:</span>  <span class="o">+-</span> <span class="n">Exchange</span> <span class="n">hashpartitioning</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
   <span class="p">:</span>     <span class="o">+-</span> <span class="o">*</span><span class="n">Filter</span> <span class="p">(</span><span class="n">isnotnull</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span>
   <span class="p">:</span>        <span class="o">+-</span> <span class="n">HiveTableScan</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">321</span><span class="p">],</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>
   <span class="o">+-</span> <span class="o">*</span><span class="n">Sort</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span> <span class="k">ASC</span> <span class="n">NULLS</span> <span class="k">FIRST</span><span class="p">],</span> <span class="k">false</span><span class="p">,</span> <span class="mi">0</span>
      <span class="o">+-</span> <span class="n">Exchange</span> <span class="n">hashpartitioning</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
         <span class="o">+-</span> <span class="o">*</span><span class="n">Filter</span> <span class="p">(</span><span class="n">isnotnull</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">cast</span><span class="p">(</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span>
            <span class="o">+-</span> <span class="n">HiveTableScan</span> <span class="p">[</span><span class="k">key</span><span class="o">#</span><span class="mi">323</span><span class="p">,</span> <span class="n">value</span><span class="o">#</span><span class="mi">324</span><span class="p">],</span> <span class="n">MetastoreRelation</span> <span class="k">default</span><span class="p">,</span> <span class="n">t</span>
</pre></div>

</div>
<h4 id="spark_1">Spark类型<a class="headerlink" href="#spark_1" title="Permanent link">&para;</a></h4>
<p>Spark使用Catalyst维护类型信息，Spark类型与其支持的不同语言(Scala, Python等)中的类型一一对应。当使用Spark时，Spark会将输入语言的表达式转化为对应的Spark类型的表达式，然后再操作。以Scala为例，下面是Scala类型对应的Spark类型：</p>
<p><img alt="basic_spark_data_types" src="../figures/basic_spark_data_types.png" /></p>
<p>Spark支持的复杂数据类型</p>
<p><img alt="complex_spark_data_types" src="../figures/complex_spark_data_types.png" /></p>
<h4 id="dataframes_1">DataFrames<a class="headerlink" href="#dataframes_1" title="Permanent link">&para;</a></h4>
<p>DataFrames are </p>
<ul>
<li>A <strong>relational</strong> API over Spark's RDDs: because sometimes it is more convenient to use declarative relational APIs than functional APIs for analysis jobs.</li>
<li>Able to be automatically aggressively <strong>optimized</strong>: Spark SQL applies years of research on relational optimizations in the databases community to Spark.</li>
<li><strong>Untyped</strong>!: The elements within DataFrames are <code class="codehilite"><span class="k">Row</span></code>s, which are not parameterized by a type. Therefore, the Scala compiler cannot type check Spark SQL schemas in DataFrames.</li>
</ul>
<h5 id="schema">Schema<a class="headerlink" href="#schema" title="Permanent link">&para;</a></h5>
<p>Schema定义了DataFrame中列的名称和类型。Schema是<code class="codehilite"><span class="n">StructType</span></code>类型，由<code class="codehilite"><span class="n">StructField</span></code>组成。<code class="codehilite"><span class="n">StructField</span></code>包括名字，类型以及一个布尔值(列是否可以包含null)。例如：</p>
<div class="codehilite"><pre><span></span><span class="nc">StructType</span><span class="o">(</span><span class="nc">StructField</span><span class="o">(</span><span class="nc">DEST_COUNTRY_NAME</span><span class="o">,</span><span class="nc">StringType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> 
        <span class="nc">StructField</span><span class="o">(</span><span class="nc">ORIGIN_COUNTRY_NAME</span><span class="o">,</span><span class="nc">StringType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> 
        <span class="nc">StructField</span><span class="o">(</span><span class="n">count</span><span class="o">,</span><span class="nc">LongType</span><span class="o">,</span><span class="kc">true</span><span class="o">))</span>
</pre></div>

<p>可以让数据源定义schema(叫做<em>schema-on-read</em>)，也可以显示定义schema。Schema-on-read适用于临时分析数据，可能会引起一些数据精度问题(例如<code class="codehilite"><span class="n">long</span></code>设置为<code class="codehilite"><span class="nb">int</span></code>)。在ETL时，自定义schema往往更好。</p>
<div class="admonition example">
<div class="codehilite"><pre><span></span><span class="cm">/* schema on read */</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">).</span><span class="n">load</span><span class="o">(</span><span class="s">&quot;2015-summary.json&quot;</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">printSchema</span><span class="o">()</span>
<span class="n">root</span>
 <span class="o">|--</span> <span class="nc">DEST_COUNTRY_NAME</span><span class="k">:</span> <span class="kt">string</span> <span class="o">(</span><span class="kt">nullable</span> <span class="o">=</span> <span class="kt">true</span><span class="o">)</span>
 <span class="o">|--</span> <span class="nc">ORIGIN_COUNTRY_NAME</span><span class="k">:</span> <span class="kt">string</span> <span class="o">(</span><span class="kt">nullable</span> <span class="o">=</span> <span class="kt">true</span><span class="o">)</span>
 <span class="o">|--</span> <span class="n">count</span><span class="k">:</span> <span class="kt">long</span> <span class="o">(</span><span class="kt">nullable</span> <span class="o">=</span> <span class="kt">true</span><span class="o">)</span>

<span class="cm">/* 指定schema */</span>
<span class="k">val</span> <span class="n">myManualSchema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;DEST_COUNTRY_NAME&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span> 
    <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;ORIGIN_COUNTRY_NAME&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;count&quot;</span><span class="o">,</span> <span class="nc">LongType</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span>
    <span class="nc">Metadata</span><span class="o">.</span><span class="n">fromJson</span><span class="o">(</span><span class="s">&quot;{\&quot;hello\&quot;:\&quot;world\&quot;}&quot;</span><span class="o">))</span> <span class="o">))</span> 
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">).</span><span class="n">schema</span><span class="o">(</span><span class="n">myManualSchema</span><span class="o">).</span><span class="n">load</span><span class="o">(</span><span class="s">&quot;2015-summary.json&quot;</span><span class="o">)</span>
</pre></div>

</div>
<div class="admonition note">
<p class="admonition-title">RDD转成DataFrame</p>
<p>把RDD直接转换成DataFrame需要提供schema。例如：</p>
<div class="codehilite"><pre><span></span>  <span class="c1">// log schema</span>
<span class="k">val</span> <span class="n">logschema</span><span class="k">:</span> <span class="kt">StructType</span> <span class="o">=</span> <span class="nc">StructType</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">),</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;ip&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">),</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">),</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;time&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">),</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;date&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">),</span>
  <span class="nc">StructField</span><span class="o">(</span><span class="s">&quot;traffic&quot;</span><span class="o">,</span> <span class="nc">StringType</span><span class="o">,</span> <span class="n">nullable</span><span class="k">=</span><span class="kc">true</span><span class="o">)</span>
<span class="o">))</span>
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="o">(</span><span class="n">logs</span><span class="o">,</span> <span class="n">logschema</span><span class="o">)</span>
</pre></div>

</div>
<h5 id="_1">列和表达式<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h5>
<p>Spark中的列与pandas DataFrame中的列类似。你可以选择(select)，处理(manipulate)，移除(remove)列，这些操作都是表达式(<em>expressions</em>)。使用<code class="codehilite"><span class="n">col</span></code>或者<code class="codehilite"><span class="k">column</span></code>函数是最简单使用列的两种方法。另外可以使用<code class="codehilite"><span class="err">$</span></code>或者<code class="codehilite"><span class="err">&#39;</span></code>符号表示列。列不会被解析直到在catalog中比对信息。</p>
<div class="codehilite"><pre><span></span><span class="c1">// in scala</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.functions.</span><span class="o">{</span><span class="n">col</span><span class="o">,</span> <span class="n">column</span><span class="o">}</span>
<span class="n">col</span><span class="o">(</span><span class="s">&quot;myColumn&quot;</span><span class="o">)</span>    <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">&quot;age&quot;</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="o">)</span>
<span class="n">column</span><span class="o">(</span><span class="s">&quot;myColumn&quot;</span><span class="o">)</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">column</span><span class="o">(</span><span class="s">&quot;age&quot;</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="o">)</span>
<span class="n">$</span><span class="s">&quot;myColumn&quot;</span>        <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">$</span><span class="s">&quot;age&quot;</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="o">)</span>
<span class=" -Symbol">&#39;myColumn</span>          <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class=" -Symbol">&#39;age</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="o">)</span>
</pre></div>

<p>也可以在特定DataFrame上使用<code class="codehilite"><span class="n">col</span></code>方法，来指定该DataFrame的列，例如<code class="codehilite"><span class="n">df</span><span class="p">.</span><span class="n">col</span><span class="p">(</span><span class="ss">&quot;myColumn&quot;</span><span class="p">)</span></code>。注意的是列一直未解析，直到与存储在<em>catalog</em>中的列名相比较。</p>
<p>表达式(expression)是DataFrame的记录(record)中的值的一系列转换(transformation)。表达式可以通过<code class="codehilite"><span class="n">expr</span></code>函数创建，它指代的是一个DataFrame列。列属于表达式。<code class="codehilite"><span class="n">expr</span><span class="p">(</span><span class="ss">&quot;someCol&quot;</span><span class="p">)</span></code>相当于<code class="codehilite"><span class="n">col</span><span class="p">(</span><span class="ss">&quot;SomeCol&quot;</span><span class="p">)</span></code>。<code class="codehilite"><span class="n">expr</span><span class="p">(</span><span class="ss">&quot;someCol - 5&quot;</span><span class="p">)</span></code>相当于<code class="codehilite"><span class="n">col</span><span class="p">(</span><span class="ss">&quot;someCol&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span></code>。</p>
<p>复杂的表达式例如<code class="codehilite"><span class="n">expr</span><span class="p">(</span><span class="ss">&quot;(((someCol + 5) * 200) - 6) &lt; otherCol&quot;</span><span class="p">)</span></code></p>
<h5 id="_2">记录和行<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<p>DataFrame中的每一行就是一个记录(record)。Spark用类型<code class="codehilite"><span class="k">Row</span></code>的对象表示记录。Spark使用列表达式(column expressions)操作<code class="codehilite"><span class="k">Row</span></code>对象。<code class="codehilite"><span class="k">Row</span></code>对象内部表示为字节数组(arrays of bytes)。可以手动创建<code class="codehilite"><span class="k">Row</span></code>：</p>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">org.apache.spark.sql.Row</span>
<span class="k">val</span> <span class="n">myRow</span> <span class="k">=</span> <span class="nc">Row</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span>
</pre></div>

<h5 id="_3">转换<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p>DataFrame的API类似于SQL，常见的转换：</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">select</span><span class="o">(</span><span class="n">col</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">cols</span><span class="k">:</span> <span class="kt">String*</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> 
<span class="c1">// selects a set of named columns and returns a new DataFrame with these </span>
<span class="c1">// columns as a result.</span>

<span class="k">def</span> <span class="n">withColumn</span><span class="o">(</span><span class="n">colName</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">col</span><span class="k">:</span> <span class="kt">Column</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span>
<span class="c1">// Returns a new Dataset by adding a column or replacing the existing column </span>
<span class="c1">// that has the same name.</span>

<span class="k">def</span> <span class="n">agg</span><span class="o">(</span><span class="n">expr</span><span class="k">:</span> <span class="kt">Column</span><span class="o">,</span> <span class="n">exprs</span><span class="k">:</span> <span class="kt">Column*</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> 
<span class="c1">// performs aggregations on a series of columns and returns a new DataFrame </span>
<span class="c1">// with the calculated output.</span>

<span class="k">def</span> <span class="n">groupBy</span><span class="o">(</span><span class="n">col1</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">cols</span><span class="k">:</span> <span class="kt">String*</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="c1">// simplified </span>
<span class="c1">// groups the DataFrame using the specified columns. </span>
<span class="c1">// Intended to be used before an aggregation.</span>

<span class="k">def</span> <span class="n">join</span><span class="o">(</span><span class="n">right</span><span class="k">:</span> <span class="kt">DataFrame</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="c1">// simplified </span>
<span class="c1">// inner join with another DataFrame</span>
</pre></div>

<p><hh>创建DataFrame</hh></p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;json&quot;</span><span class="o">).</span><span class="n">load</span><span class="o">(</span>
</pre></div>

<h4 id="spark-sql">Spark SQL<a class="headerlink" href="#spark-sql" title="Permanent link">&para;</a></h4>
<p>Spark SQL是Spark最重要和最强大的功能之一。Spark SQL可以运行SQL语句，其SQL语句遵循ANSI SQL:2003标准。Spark SQL CLI工具(<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="k">sql</span></code>)可以很方便的使用Spark SQL。也可以使用<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">()</span></code>方法运行SQL语句，这将会返回DataFrame。</p>
<div class="codehilite"><pre><span></span><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="o">(</span><span class="s">&quot;2015-summary.json&quot;</span><span class="o">).</span><span class="n">createOrReplaceTempView</span><span class="o">(</span><span class="s">&quot;flight&quot;</span><span class="o">)</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">     | select dest_country_name, sum(count)</span>
<span class="s">     | from flight group by dest_country_name</span>
<span class="s">     | &quot;&quot;&quot;</span><span class="o">).</span><span class="n">where</span><span class="o">(</span><span class="s">&quot;dest_country_name like &#39;S%&#39;&quot;</span><span class="o">).</span>
     <span class="o">|</span> <span class="n">where</span><span class="o">(</span><span class="s">&quot;`sum(count)` &gt; 10&quot;</span><span class="o">).</span><span class="n">count</span><span class="o">()</span>
<span class="n">res</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>

<p>Spark SQL可以连接Hive metastore。<a href="../Hadoop权威指南/17 Hive.md">Hive metastore</a>维持着表的信息。若要把Spark SQL连接到一个部署好的Hive上，必须把<code class="codehilite"><span class="n">hive</span><span class="o">-</span><span class="n">site</span><span class="p">.</span><span class="n">xml</span></code>复制到Spark的配置文件目录(<code class="codehilite"><span class="err">$</span><span class="n">SPARK_HOME</span><span class="o">/</span><span class="n">conf</span></code>)中。</p>
<p>如果没有部署Hive， Spark SQL会在当前工作目录($SPARK_HOME/bin)中创建出自己的Hive元数据仓库(metastore_db文件夹)。创建的表会放在默认的文件系统中的<code class="codehilite"><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="n">hive</span><span class="o">/</span><span class="n">warehouse</span></code>目录中。</p>
<h5 id="spark-sql_1">运行Spark SQL查询<a class="headerlink" href="#spark-sql_1" title="Permanent link">&para;</a></h5>
<p>运行Spark查询有多种方式。如果要使用Hive，则先把相关配置文件(<code class="codehilite"><span class="n">hive</span><span class="o">-</span><span class="n">site</span><span class="p">.</span><span class="n">xml</span></code>, <code class="codehilite"><span class="n">core</span><span class="o">-</span><span class="n">site</span><span class="p">.</span><span class="n">xml</span></code>, <code class="codehilite"><span class="n">hdfs</span><span class="o">-</span><span class="n">site</span><span class="p">.</span><span class="n">xml</span></code>)拷贝到Hive配置目录下。除此之外，如果要使用Hive，需要在启动<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="n">shell</span></code>时加上<code class="codehilite"><span class="n">mysql</span><span class="o">-</span><span class="n">connector</span></code>依赖:</p>
<div class="codehilite"><pre><span></span>cp <span class="nv">$HIVE_HOME</span>/conf/hive-site.xml <span class="nv">$SPARK_HOME</span>/conf
spark-shell --master <span class="s2">&quot;local[*]&quot;</span>  <span class="se">\</span>
    --jars <span class="nv">$HIVE_HOME</span>/lib/mysql-connector-java-5.1.48.jar
spark-sql --master <span class="s2">&quot;local[*]&quot;</span>  <span class="se">\</span>
    --jars <span class="nv">$HIVE_HOME</span>/lib/mysql-connector-java-5.1.48.jar
</pre></div>

<p>Spark还提供了Thrift JDBC/ODBC服务。同样的，如果要使用Hive，需要添加依赖。接着就可以用<code class="codehilite"><span class="n">beeline</span></code>来连接。</p>
<div class="codehilite"><pre><span></span>start-thriftserver.sh --master <span class="s2">&quot;local[*]&quot;</span> <span class="se">\</span>
    --jars <span class="nv">$HIVE_HOME</span>/lib/mysql-connector-java-5.1.48.jar
beeline -u jdbc:hive2://localhost:10000
</pre></div>

<p>每次启动Spark-Shell、Spark-sql都是一个Spark Application，但是对于ThriftServer，不管启动多少个客户端，永远都是一个Spark Application，解决了数据共享的问题，多个客户端可以共享数据。</p>
<h4 id="datasets">DataSets<a class="headerlink" href="#datasets" title="Permanent link">&para;</a></h4>
<p>DataSets只支持基于JVM的语言(Scala和Java)，可以分别用case class和Java Bean指定DataSets的类型。使用DataSets的场景一般有：当一些操作不能使用DataFrame时、或者需要类型安全且愿意付出降低性能的代价时。</p>
<h5 id="encoder">Encoder<a class="headerlink" href="#encoder" title="Permanent link">&para;</a></h5>
<p>为了有效的支持特定域对象(domain-specific objects)，DataSets需要使用encoder将特定域类型(domain-specific type)映射为Spark内部类。例如，给定有<code class="codehilite"><span class="n">name</span></code>(string)和<code class="codehilite"><span class="n">age</span></code>(int)字段的类<code class="codehilite"><span class="n">Person</span></code>，encoder指导Spark在运行时产生代码，将<code class="codehilite"><span class="n">Person</span></code>对象序列化为二进制结构(binary structure)。当使用DataFrames时，这个二进制结构就是<code class="codehilite"><span class="k">Row</span></code>。</p>
<p>使用DataSet时，Spark会将<code class="codehilite"><span class="k">Row</span></code>转化为指定的特定域对象。在Scala中，使用<code class="codehilite"><span class="k">case</span> <span class="k">class</span></code>创建特定域对象。这种转换虽然损失了性能，但是提供了更多灵活性。</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.spark.sql.Encoders</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight</span> <span class="kd">implements</span> <span class="n">Serializable</span><span class="o">{</span> 
    <span class="n">String</span> <span class="n">DEST_COUNTRY_NAME</span><span class="o">;</span> 
    <span class="n">String</span> <span class="n">ORIGIN_COUNTRY_NAME</span><span class="o">;</span> 
    <span class="n">Long</span> <span class="n">DEST_COUNTRY_NAME</span><span class="o">;</span> 
<span class="o">}</span>
<span class="n">Dataset</span><span class="o">&lt;</span><span class="n">Flight</span><span class="o">&gt;</span> <span class="n">flights</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="na">read</span><span class="o">.</span><span class="na">parquet</span><span class="o">(</span><span class="s">&quot;2010-summary.parquet/&quot;</span><span class="o">)</span> 
    <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="n">Encoders</span><span class="o">.</span><span class="na">bean</span><span class="o">(</span><span class="n">Flight</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
</pre></div>

<h5 id="datasets_1">创建Datasets<a class="headerlink" href="#datasets_1" title="Permanent link">&para;</a></h5>
<p>在Scala中，创建Datasets之前，需要定义<code class="codehilite"><span class="k">case</span> <span class="k">class</span></code>。<code class="codehilite"><span class="k">case</span> <span class="k">class</span></code>是一个类，但它具有不可变，模式匹配、便于使用等特点。</p>
<div class="admonition example">
<p class="admonition-title">Flight</p>
<div class="codehilite"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">Flight</span><span class="o">(</span><span class="nc">DEST_COUNTRY_NAME</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="nc">ORIGIN_COUNTRY_NAME</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">count</span><span class="k">:</span> <span class="kt">BigInt</span><span class="o">)</span>
<span class="k">val</span> <span class="n">flightsDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="o">(</span><span class="s">&quot;/data/flight-data/parquet/2010-summary.parquet/&quot;</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">flights</span> <span class="k">=</span> <span class="n">flightsDF</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">Flight</span><span class="o">]</span>
</pre></div>

</div>
<p>由于DataFrame其实是Dataset[Row]，所以Dataset的动作和转换与DataFrame基本相同，不再赘述。</p>
<h4 id="_4">外部数据<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<h5 id="_5">读取<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h5>
<p>Spark支持多种文件格式，读取的基本格式为</p>
<div class="codehilite"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(...).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;key&quot;</span><span class="o">,</span> <span class="s">&quot;value&quot;</span><span class="o">).</span><span class="n">schema</span><span class="o">(...).</span><span class="n">load</span><span class="o">()</span>
<span class="cm">/* example */</span>
<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;csv&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;mode&quot;</span><span class="o">,</span> <span class="s">&quot;FAILFAST&quot;</span><span class="o">)</span> 
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">)</span> <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;path&quot;</span><span class="o">,</span> <span class="s">&quot;path/to/file(s)&quot;</span><span class="o">)</span> 
    <span class="o">.</span><span class="n">schema</span><span class="o">(</span><span class="n">someSchema</span><span class="o">)</span> <span class="o">.</span><span class="n">load</span><span class="o">()</span>
</pre></div>

<p>从外部数据读取的时候可能会遇到错误数据，read mode指定了这时Spark会采取的情况(默认<code class="codehilite"><span class="n">permissive</span></code>)：</p>
<p><img alt="read_mode" src="../figures/spark_read_mode.png" /></p>
<p>可以使用<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="k">read</span></code>后面跟文件格式(<code class="codehilite"><span class="n">json</span></code>/<code class="codehilite"><span class="n">csv</span></code>/<code class="codehilite"><span class="n">textFile</span></code>/<code class="codehilite"><span class="n">parquet</span></code>等)来读取文件。例如</p>
<div class="codehilite"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="o">(</span><span class="s">&quot;path/to/file&quot;</span><span class="o">)</span>
</pre></div>

<p>Spark支持本地文件系统，但是要求文件在集群中所有节点的相同路径路径下都可以找到，格式为<code class="codehilite"><span class="n">file</span><span class="p">:</span><span class="o">//</span></code>。默认使用HDFS，格式为<code class="codehilite"><span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">master</span><span class="p">:</span><span class="n">port</span><span class="o">/</span><span class="n">path</span></code>。</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="o">(</span><span class="s">&quot;/apps/spark/json/2015-summary.json&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="o">(</span><span class="s">&quot;file:///Users/larry/Documents/json/2015-summary.json&quot;</span><span class="o">)</span>
</pre></div>

<h5 id="_6">写入<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>Spark写入数据的基本格式为</p>
<div class="codehilite"><pre><span></span><span class="n">dataframe</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="o">(...).</span><span class="n">option</span><span class="o">(...).</span><span class="n">partitionBy</span><span class="o">(...)</span>
        <span class="o">.</span><span class="n">bucketBy</span><span class="o">(...).</span><span class="n">sortBy</span><span class="o">(...).</span><span class="n">save</span><span class="o">()</span>
<span class="cm">/* example */</span>
<span class="n">dataframe</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;csv&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;mode&quot;</span><span class="o">,</span> <span class="s">&quot;OVERWRITE&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;dateFormat&quot;</span><span class="o">,</span> <span class="s">&quot;yyyy-MM-dd&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;path&quot;</span><span class="o">,</span> <span class="s">&quot;path/to/files&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">save</span><span class="o">()</span>
</pre></div>

<p>save mode默认是<code class="codehilite"><span class="n">errorIfExists</span></code>:</p>
<p><img alt="spark_save_mode" src="../figures/spark_save_mode.png" /></p>
<div class="admonition example">
<p class="admonition-title">MySQL写入</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">SQL</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">java.sql.DriverManager</span>
<span class="k">val</span> <span class="n">connection</span> <span class="k">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="n">getConnection</span><span class="o">(</span><span class="n">url</span><span class="o">)</span>
<span class="k">val</span> <span class="n">dbDataFrame</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">&quot;jdbc&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">,</span> <span class="n">url</span>
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;dbtable&quot;</span><span class="o">,</span> <span class="n">tablename</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;driver&quot;</span><span class="o">,</span> <span class="n">driver</span><span class="o">).</span><span class="n">load</span><span class="o">()</span>
<span class="n">csvFile</span><span class="o">.</span><span class="n">wirte</span><span class="o">.</span><span class="n">mode</span><span class="o">(</span><span class="s">&quot;overwrite&quot;</span><span class="o">).</span><span class="n">jdbc</span><span class="o">(</span><span class="n">newPath</span><span class="o">,</span> <span class="n">tablename</span><span class="o">,</span> <span class="n">props</span><span class="o">)</span>
</pre></div></div>
</div>
</div>
<h3 id="3-low-level-apis">3 Low-level APIs<a class="headerlink" href="#3-low-level-apis" title="Permanent link">&para;</a></h3>
<p>在Spark中，有两类Low-level APIs：一种是操作RDD的，另一种是分布式共享变量(广播变量和累加器)。事实上，几乎所有Spark代码都会转化为这些低级操作：DataFrames和Datasets的操作会变成一系列RDD转换。SparkContext是低级API功能的入口，可以使用<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="n">sparkContext</span></code>获得SparkContext。</p>
<h4 id="rdd">RDD<a class="headerlink" href="#rdd" title="Permanent link">&para;</a></h4>
<p><strong>弹性分布式数据集</strong>(Resilient Distributed Dataset, 简称RDD)，是Spark中最核心的概念，它是在集群中跨多个机器分区存储的一个只读对象的集合。在典型的Spark程序中，首先要加载一个或多个RDD，它们作为输入通过一系列转换得到一组目标RDD，然后对这些目标RDD执行一个动作。</p>
<p>除非特别需要，不推荐使用RDD，因为RDD缺少Structured APIs中的优化。对于大多数情况，DataFrames更有效、更稳定、更易表达。RDD的最常见使用场景是对数据物理分布的精确控制(自定义数据分区)。</p>
<p>RDD的创建有多种方法：</p>
<ol>
<li>来自一个内存中的对象集合(也称为并行化一个集合)</li>
<li>使用外部存储器(例如HDFS)中的数据集</li>
<li>对现有的RDD进行转换</li>
<li>从DataFrame/DataSet转换</li>
</ol>
<div class="admonition example">
<p class="admonition-title">创建RDD</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">并行化一个集合</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">params</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span><span class="o">)</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">使用外部存储器中的数据集</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">text</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="n">inputPath</span><span class="o">)</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_2" />
<label for="__tab_2_2">对现有的RDD进行转换</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">text</span><span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="n">inputPath</span><span class="o">)</span>
<span class="k">val</span> <span class="n">lower</span><span class="k">:</span> <span class="kt">RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">text</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toLowerCase</span><span class="o">())</span>
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_3" />
<label for="__tab_2_3">从DataFrame/DataSet转换</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">// converts a Dataset[Long] to RDD[Long]</span>
<span class="k">val</span> <span class="n">h</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="mi">500</span><span class="o">).</span><span class="n">rdd</span>
</pre></div></div>
</div>
</div>
<h5 id="_7">转换和动作<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<p>RDD支持distinct, filter, map, flatMap, sortBy等转换，支持reduce, count, first, take, max, min等动作。</p>
<p>对一个数据为{1, 2, 3, 3}的RDD进行基本的RDD转化操作:</p>
<p><img alt="rdd_transformations_1" src="../figures/rdd_transformations_1.png" /></p>
<p>对一个数据为{1, 2, 3, 3}的RDD进行基本的RDD行动操作:</p>
<p><img alt="rdd_action_1" src="../figures/rdd_action_1.png" /></p>
<h5 id="_8">持久化<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<p><a href="https://spark.apache.org/docs/latest/rdd-programming-guide.html#rdd-persistence">参考官网</a></p>
<p>RDD可以使用<code class="codehilite"><span class="k">cache</span><span class="p">()</span></code>或者<code class="codehilite"><span class="n">persist</span><span class="p">()</span></code>方法进行持久化。RDD可以有不同的持久化级别(见下表)。默认情况下，<code class="codehilite"><span class="n">persist</span><span class="p">()</span></code>会把数据以序列化的形式缓存在JVM的堆空间中(默认<code class="codehilite"><span class="n">MEMORY_ONLY</span></code>)。<code class="codehilite"><span class="k">cache</span><span class="p">()</span></code>其实就是<code class="codehilite"><span class="n">persist</span><span class="p">(</span><span class="n">StorageLevel</span><span class="p">.</span><span class="n">MEMORY_ONLY</span><span class="p">)</span></code>。</p>
<div class="codehilite"><pre><span></span><span class="gh">Level                Space used  CPU time  In memory  On disk  Serialized</span>
<span class="gh">-------------------------------------------------------------------------</span>
MEMORY_ONLY          High        Low       Y          N        N
MEMORY_ONLY_SER      Low         High      Y          N        Y
MEMORY_AND_DISK      High        Medium    Some       Some     Some
MEMORY_AND_DISK_SER  Low         High      Some       Some     Y
DISK_ONLY            Low         High      N          Y        Y
</pre></div>

<h5 id="checkpointing">checkpointing<a class="headerlink" href="#checkpointing" title="Permanent link">&para;</a></h5>
<p>Checkpointing把RDD保存到磁盘，以便后续使用这个RDD时可以直接使用，而不用从头开始计算这个RDD。在迭代计算中，这非常有用。</p>
<div class="codehilite"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">setCheckpointDir</span><span class="o">(</span><span class="s">&quot;/some/path/for/checkpointing&quot;</span><span class="o">)</span>
<span class="n">words</span><span class="o">.</span><span class="n">checkpoint</span><span class="o">()</span>
</pre></div>

<h5 id="pair-rdd">Pair RDD<a class="headerlink" href="#pair-rdd" title="Permanent link">&para;</a></h5>
<p>Pair RDD是键值对的RDD(key-value RDD)。Pair RDD的转化操作如下所示：以键值对集合 {(1, 2), (3, 4), (3, 6)} 为例</p>
<p><img alt="pairRDD_transformations" src="../figures/pairRDD_transformations.png" /></p>
<p>Pair RDD的行动操作（以键值对集合 {(1, 2), (3, 4), (3, 6)}为例）</p>
<p><img alt="pairRDD_action" src="../figures/pairRDD_action.png" /></p>
<h5 id="rdd_1">数值RDD<a class="headerlink" href="#rdd_1" title="Permanent link">&para;</a></h5>
<p>Spark 对包含数值数据的RDD(Numeric RDD)提供了一些描述性的统计操作。统计数据都会在调用<code class="codehilite"><span class="n">stats</span><span class="p">()</span></code>时通过一次遍历数据计算出来, 并以 <code class="codehilite"><span class="n">StatsCounter</span></code>对象返回。</p>
<p><img alt="" src="../figures/numeric_rdd.png" /></p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="codehilite"><pre><span></span><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">distance</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1000</span><span class="o">)</span>
<span class="n">distance</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">Long</span><span class="o">]</span> <span class="k">=</span> <span class="nc">MapPartitionsRDD</span><span class="o">[</span><span class="err">26</span><span class="o">]</span>    
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">distance</span><span class="o">.</span><span class="n">sum</span><span class="o">()</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">499500.0</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">distance</span><span class="o">.</span><span class="n">mean</span><span class="o">()</span>
<span class="n">res4</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">500.0</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">distance</span><span class="o">.</span><span class="n">stats</span><span class="o">()</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">org.apache.spark.util.StatCounter</span> <span class="o">=</span> 
    <span class="o">(</span><span class="n">count</span><span class="k">:</span> <span class="err">999</span><span class="o">,</span> <span class="n">mean</span><span class="k">:</span> <span class="err">500</span><span class="kt">.</span><span class="err">000000</span><span class="o">,</span> <span class="n">stdev</span><span class="k">:</span> <span class="err">288</span><span class="kt">.</span><span class="err">386315</span><span class="o">,</span> 
    <span class="n">max</span><span class="k">:</span> <span class="err">999</span><span class="kt">.</span><span class="err">000000</span><span class="o">,</span> <span class="n">min</span><span class="k">:</span> <span class="err">1</span><span class="kt">.</span><span class="err">000000</span><span class="o">)</span>
</pre></div>

</div>
<h5 id="_9">分区<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<p>你可以控制RDD的分区方式，用来减少通信开销、避免数据倾斜。常见的RDD分区有<code class="codehilite"><span class="n">HashPartitioner</span></code>和<code class="codehilite"><span class="n">RangePartitioner</span></code>。常见的分区函数有<code class="codehilite"><span class="n">coalesce</span></code>, <code class="codehilite"><span class="n">repartition</span></code>。</p>
<ul>
<li><code class="codehilite"><span class="n">coalesce</span><span class="p">(</span><span class="n">numpartition</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="k">false</span><span class="p">)</span></code>: 合并同一个节点上的分区防止数据混洗, 减小分区数到numpartition。</li>
<li><code class="codehilite"><span class="n">repartition</span><span class="p">(</span><span class="n">numpartition</span><span class="p">)</span></code>: 对数据重新分区，其实是<code class="codehilite"><span class="n">coalesce</span><span class="p">(</span><span class="n">numpartition</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="k">true</span><span class="p">)</span></code>的封装。</li>
</ul>
<p>可以使用<code class="codehilite"><span class="n">partitionBy</span></code>来自定义分区。</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>用户所订阅的主题的列表保存在RDD[(UserID, UserInfo)]中。过去五分钟发生的事件保存在RDD[(UserID, LinkInfo)]中。两张表会周期性的进行<code class="codehilite"><span class="k">join</span><span class="p">()</span></code>操作。默认情况下，连接操作会将两个数据集中的所有键的哈希值都求出来，将该哈希值相同的记录通过网络传到同一台机器 上，然后在那台机器上对所有键相同的记录进行连接操作。因为<code class="codehilite"><span class="n">userData</span></code>表比每五分钟出现的访问日志表<code class="codehilite"><span class="n">events</span></code>要大得多，所以要浪费时间做很多额外工作：在每次调用时都对<code class="codehilite"><span class="n">userData</span></code>表进行哈希值计算和跨节点数据混洗，虽然这些数据从来都不会变化。</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="n">processNewLogs</span><span class="o">(</span><span class="n">logFileName</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">events</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">sequenceFile</span><span class="o">[</span><span class="kt">UserID</span>, <span class="kt">LinkInfo</span><span class="o">](</span><span class="n">logFileName</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">joined</span> <span class="k">=</span> <span class="n">userData</span><span class="o">.</span><span class="n">join</span><span class="o">(</span><span class="n">events</span><span class="o">)</span> <span class="c1">// RDD of (UserID, (UserInfo, LinkInfo)) pairs</span>
  <span class="k">val</span> <span class="n">offTopicVisits</span> <span class="k">=</span> <span class="n">joined</span><span class="o">.</span><span class="n">filter</span> <span class="o">{</span>
    <span class="k">case</span> <span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="o">(</span><span class="n">userInfo</span><span class="o">,</span> <span class="n">linkInfo</span><span class="o">))</span> <span class="k">=&gt;</span> <span class="c1">// Expand the tuple into its components</span>
      <span class="o">!</span><span class="n">userInfo</span><span class="o">.</span><span class="n">topics</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="n">linkInfo</span><span class="o">.</span><span class="n">topic</span><span class="o">)</span>
  <span class="o">}.</span><span class="n">count</span><span class="o">()</span>
  <span class="n">println</span><span class="o">(</span><span class="s">&quot;Number of visits to non-subscribed topics: &quot;</span> <span class="o">+</span> <span class="n">offTopicVisits</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

<p>要解决这一问题也很简单：在程序开始时， 对<code class="codehilite"><span class="n">userData</span></code>表使用<code class="codehilite"><span class="n">partitionBy</span><span class="p">()</span></code>转化操作， 将这张表转为哈希分区。可以通过向 <code class="codehilite"><span class="n">partitionBy</span></code>传递一个<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="n">HashPartitioner</span></code>对象来实现该操作。由于在构建<code class="codehilite"><span class="n">userData</span></code>时调用了<code class="codehilite"><span class="n">partitionBy</span><span class="p">()</span></code>，Spark就知道了该RDD是根据键的哈希值来分区的，这样在调用<code class="codehilite"><span class="k">join</span><span class="p">()</span></code>时，Spark就会利用到这一点。</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">userData</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">sequenceFile</span><span class="o">[</span><span class="kt">UserID</span>, <span class="kt">UserInfo</span><span class="o">](</span><span class="s">&quot;hdfs://...&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">partitionBy</span><span class="o">(</span><span class="k">new</span> <span class="nc">HashPartitioner</span><span class="o">(</span><span class="mi">100</span><span class="o">))</span> <span class="c1">// 构造100个分区 </span>
    <span class="o">.</span><span class="n">persist</span><span class="o">()</span>
</pre></div>

<p>如果没有将<code class="codehilite"><span class="n">partitionBy</span><span class="p">()</span></code>转化操作的结果持久化， 那么后面每次用到这个RDD时都会重复地对数据进行分区操作，<code class="codehilite"><span class="n">partitionBy</span><span class="p">()</span></code>带来的好处就会被抵消。</p>
</div>
<p>自定义分区一般用来避免数据倾斜(数据在集群上的不平衡分布)。</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>下面一个例子是购物日志。格式为(InvoiceNo, StockCode, Description, Quantity, InvoiceData, UnitPrice, CustomerID, Country)。</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">csv</span><span class="o">(</span><span class="s">&quot;/data/retail-data/all/&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">rdd</span> <span class="k">=</span> <span class="n">df</span><span class="o">.</span><span class="n">coalesce</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="n">rdd</span>
<span class="k">val</span> <span class="n">keyedRDD</span> <span class="k">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">keyBy</span><span class="o">(</span><span class="n">row</span> <span class="k">=&gt;</span> <span class="n">row</span><span class="o">(</span><span class="mi">6</span><span class="o">).</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">Int</span><span class="o">].</span><span class="n">toDouble</span><span class="o">)</span>

<span class="k">class</span> <span class="nc">DomainPartitioner</span> <span class="k">extends</span> <span class="nc">Partitioner</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">numPartitions</span> <span class="k">=</span> <span class="mi">3</span>
  <span class="k">def</span> <span class="n">getPartition</span><span class="o">(</span><span class="n">key</span><span class="k">:</span> <span class="kt">Any</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">customerId</span> <span class="k">=</span> <span class="n">key</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">Double</span><span class="o">].</span><span class="n">toInt</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">customerId</span> <span class="o">==</span> <span class="mf">17850.0</span> <span class="o">||</span> <span class="n">customerId</span> <span class="o">==</span> <span class="mf">12583.0</span><span class="o">)</span>
      <span class="mi">0</span>
    <span class="k">else</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="nc">Random</span><span class="o">().</span><span class="n">nextInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="n">keyedRDD</span><span class="o">.</span><span class="n">partitionBy</span><span class="o">(</span><span class="k">new</span> <span class="nc">DomainPartitioner</span><span class="o">)</span>
  <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">_1</span><span class="o">).</span><span class="n">glom</span><span class="o">().</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toSet</span><span class="o">.</span><span class="n">toSeq</span><span class="o">.</span><span class="n">length</span><span class="o">)</span>
  <span class="o">.</span><span class="n">take</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

</div>
<h5 id="_10">基于分区的操作<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h5>
<p>为了避免对每个元素进行重复的操作，可以使用基于分区的操作(<code class="codehilite"><span class="n">mapPartitions</span></code>, <code class="codehilite"><span class="n">foreachPartitions</span></code>)。</p>
<h4 id="distributed-shared-variables">Distributed Shared Variables<a class="headerlink" href="#distributed-shared-variables" title="Permanent link">&para;</a></h4>
<p>Spark有两种类型的分布式共享变量(distributed shared variables):</p>
<ul>
<li>累加器（accumulators): 把所有任务中的数据一起加到一个共享的结果中(例如调试时记录不能解析的输入记录数目)</li>
<li>广播变量(broadcast variables): 向所有节点发送一个较大的只读值，以供多个Spark动作使用而不需要重复发送</li>
</ul>
<h5 id="_11">广播变量<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<p><img alt="" src="../figures/broadcast_variables.jpg" /></p>
<p>广播变量可以让程序高效地向所有工作节点发送一个较大的只读值，以供一个或多个Spark操作使用。</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>假设Spark程序通过呼号的前缀来查询对应的国家。可以把<code class="codehilite"><span class="n">singPrefixes</span></code>设置为广播变量，在任务中通过对Broadcast对象调用value来获取该对象的值。这个值只会被发送到各节点一次。</p>
<div class="codehilite"><pre><span></span><span class="c1">// 查询RDD contactCounts中的呼号的对应位置。</span>
<span class="c1">// 将呼号前缀读取为国家代码来进行查询</span>
<span class="k">val</span> <span class="n">signPrefixes</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">broadcast</span><span class="o">(</span><span class="n">loadCallSignTable</span><span class="o">())</span> 
<span class="k">val</span> <span class="n">countryContactCounts</span> <span class="k">=</span> <span class="n">contactCounts</span><span class="o">.</span><span class="n">map</span><span class="o">{</span><span class="k">case</span> <span class="o">(</span><span class="n">sign</span><span class="o">,</span> <span class="n">count</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="k">val</span> <span class="n">country</span> <span class="k">=</span> <span class="n">lookupInArray</span><span class="o">(</span><span class="n">sign</span><span class="o">,</span> <span class="n">signPrefixes</span><span class="o">.</span><span class="n">value</span><span class="o">)</span>
    <span class="o">(</span><span class="n">country</span><span class="o">,</span> <span class="n">count</span><span class="o">)</span>
<span class="o">}.</span><span class="n">reduceByKey</span><span class="o">((</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">)</span>
<span class="n">countryContactCounts</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="o">(</span><span class="n">outputDir</span> <span class="o">+</span> <span class="s">&quot;/countries.txt&quot;</span><span class="o">)</span>
</pre></div>

</div>
<h5 id="_12">累加器<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h5>
<p><img alt="" src="../figures/accumulator_variable.jpg" /></p>
<p>累加器可以将工作节点中的值聚合到驱动器程序中，常见用途是在调试时对作业执行过程中的事件进行计数。</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>假设我们在 从文件中读取呼号列表对应的日志，同时也想知道输入文件中有多少空行（也许不希望在 有效输入中看到很多这样的行）。</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">sc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SparkContext</span><span class="o">(...)</span> 
<span class="k">val</span> <span class="n">file</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="s">&quot;file.txt&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">blankLines</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">accumulator</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">// 创建Accumulator[Int]并初始化为0</span>
<span class="k">val</span> <span class="n">callSigns</span> <span class="k">=</span> <span class="n">file</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">line</span> <span class="k">=&gt;</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="o">)</span> <span class="o">{</span> <span class="n">blankLines</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1">// 累加器加1 </span>
    <span class="o">}</span>
    <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">)</span> 
<span class="o">})</span>
<span class="n">callSigns</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="o">(</span><span class="s">&quot;output.txt&quot;</span><span class="o">)</span>
<span class="n">println</span><span class="o">(</span><span class="s">&quot;Blank lines: &quot;</span> <span class="o">+</span> <span class="n">blankLines</span><span class="o">.</span><span class="n">value</span><span class="o">)</span>
</pre></div>

</div>
<h3 id="4-spark">4 Spark是如何在集群上运行的<a class="headerlink" href="#4-spark" title="Permanent link">&para;</a></h3>
<h4 id="_13">运行模式<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p>运行模式(execution mode)包括：</p>
<ul>
<li>集群模式(cluster mode)</li>
<li>客户模式(client mode)</li>
<li>本地模式(local mode)</li>
</ul>
<p>在使用<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="n">submit</span></code>提交时，可以使用<code class="codehilite"><span class="c1">--deploy-mode &lt;deploy-mode&gt;</span></code>指定模式(<code class="codehilite"><span class="k">cluster</span></code>或者<code class="codehilite"><span class="n">client</span></code>)。</p>
<h5 id="_14">集群模式<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h5>
<p>在集群模式(Cluster mode)中，用户提交编译好的JAR、Python脚本到集群管理器。然后集群管理器在集群中的一个工作节点上运行driver进程。也就是说集群管理器(cluster manager)负责维护所有Spark应用相关的进程。</p>
<p><img alt="spark_cluster_mode" src="../figures/spark_cluster_mode.png" /></p>
<p><small>注意这里的Cluster Driver/Worker Process对应的是集群管理器(例如Yarn)</small></p>
<h5 id="_15">客户模式<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h5>
<p>客户模式(client mode)几乎与集群模式相同，除了Spark driver在提交应用的客户端机器上。也就是说 <em>客户端机器负责维持Spark driver进程，集群管理器负责维持executor进程</em> 。运行driver进程的机器是不在集群中的。</p>
<p><img alt="" src="../figures/spark_client_mode.jpg" /></p>
<h5 id="_16">本地模式<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h5>
<p>本地模式(local mode)把整个Spark应用都在一台机器上运行，通过<em>多线程</em>实现并行。一般使用该模式学习Spark，测试应用。</p>
<h4 id="_17">部署模式<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<p>Spark支持多种部署模式：Standalone, Spark on Mesos, Spark on YARN。</p>
<ul>
<li>Standalone模式：自带完整的服务，可单独部署到一个集群中，无需依赖任何其他资源管理系统。</li>
<li>Spark on YARN模式：支持yarn-cluster和yarn-client<ul>
<li>yarn-cluster使用与生产环境</li>
<li>yarn-client使用于交互、调试</li>
</ul>
</li>
<li>Spark on Mesos模式：支持粗粒度和细粒度模式<ul>
<li>粗粒度模式(Coarse-grained Mode)</li>
<li>细粒度模式(Fine-grained Mode) </li>
</ul>
</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">yarn-client</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>spark-submit <span class="se">\</span>
    --master yarn <span class="se">\</span>
    --driver-memory 1g <span class="se">\</span>
    --executor-memory 1g <span class="se">\</span>
    --executor-cores <span class="m">2</span> <span class="se">\</span>
    --class org.apache.spark.examples.SparkPi <span class="se">\</span>
    examples/jars/spark-examples_2.11-2.3.4.jar <span class="se">\</span>
    <span class="m">1000</span>
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">yarn-cluster</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>spark-submit <span class="se">\</span>
    --master yarn <span class="se">\</span>
    --driver-memory 1g <span class="se">\</span>
    --deploy-mode cluster <span class="se">\</span>
    --executor-memory 1g <span class="se">\</span>
    --executor-cores <span class="m">2</span> <span class="se">\</span>
    --class org.apache.spark.examples.SparkPi <span class="se">\</span>
    examples/jars/spark-examples_2.11-2.3.4.jar <span class="se">\</span>
    <span class="m">1000</span>
</pre></div></div>
</div>
<h4 id="sparkspark">Spark应用的生命周期(Spark外部)<a class="headerlink" href="#sparkspark" title="Permanent link">&para;</a></h4>
<p>以使用<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="n">submit</span></code>命令运行Spark应用为例，说明Spark应用的生命周期：</p>
<ol>
<li>客户端请求(Client Request)：客户端提交应用(<code class="codehilite"><span class="n">spark</span><span class="o">-</span><span class="n">submit</span></code>), 向集群管理器要求spark driver进程的资源；集群管理器接收请求后，在其中一个节点上启动driver进程。</li>
<li>运行(launch): <code class="codehilite"><span class="n">SparkSession</span></code>初始化Spark集群，要求集群管理器在集群上运行executor进程</li>
<li>执行(execution): driver和worker相互联系，执行代码，移动数据</li>
<li>完成(Completion): spark应用执行完毕，driver进程退出，集群管理器关闭对应executors</li>
</ol>
<p><img alt="Life_cycle_of_spark_application" src="../figures/Life_cycle_of_spark_application.png" /></p>
<h4 id="sparkspark_1">Spark应用的生命周期(Spark内部)<a class="headerlink" href="#sparkspark_1" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../figures/the_spark_application_tree.jpg" /></p>
<h5 id="the-sparksession">The SparkSession<a class="headerlink" href="#the-sparksession" title="Permanent link">&para;</a></h5>
<p>Spark应用(Spark Application)的第一步是创建<code class="codehilite"><span class="n">SparkSession</span></code>。通过<code class="codehilite"><span class="n">SparkSession</span></code>，可以访问所有的低级环境和配置。Spark2.0之前的版本使用<code class="codehilite"><span class="n">SparkContext</span></code>。</p>
<div class="codehilite"><pre><span></span><span class="c1">// Creating a SparkSession in Scala</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.SparkSession</span>
<span class="k">val</span> <span class="n">spark</span> <span class="k">=</span> <span class="nc">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">().</span><span class="n">appName</span><span class="o">(</span><span class="s">&quot;Spark Example&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">config</span><span class="o">(</span><span class="s">&quot;spark.sql.warehouse.dir&quot;</span><span class="o">,</span> <span class="s">&quot;/user/hive/warehouse&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="n">getOrCreate</span><span class="o">()</span>
</pre></div>

<div class="admonition note">
<p class="admonition-title">SparkSession v.s. SparkContext</p>
<p><code class="codehilite"><span class="n">SparkSession</span></code>中的<code class="codehilite"><span class="n">SparkContext</span></code>代表 <em>与Spark集群的连接</em> 。<code class="codehilite"><span class="n">SparkContext</span></code>可以访问低级API，例如RDD，累加器(accumulators)，广播变量(broadcast variables)。可以直接通过<code class="codehilite"><span class="n">SparkSession</span><span class="p">.</span><span class="n">SparkContext</span></code>访问<code class="codehilite"><span class="n">SparkContext</span></code>，也可以用<code class="codehilite"><span class="n">SparkContext</span><span class="p">.</span><span class="n">getOrCreate</span><span class="p">()</span></code>得到<code class="codehilite"><span class="n">SparkContext</span></code>。</p>
<div class="codehilite"><pre><span></span><span class="n">scala</span><span class="o">&gt;</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">org.apache.spark.SparkContext</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="nc">SparkContext</span><span class="k">@</span><span class="mi">75</span><span class="n">c30a4f</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">sc</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">org.apache.spark.SparkContext</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="nc">SparkContext</span><span class="k">@</span><span class="mi">75</span><span class="n">c30a4f</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">SparkContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="o">()</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.spark.SparkContext</span>
<span class="k">import</span> <span class="nn">org.apache.spark.SparkContext</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">SparkContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="o">()</span>
<span class="n">res3</span><span class="k">:</span> <span class="kt">org.apache.spark.SparkContext</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="nc">SparkContext</span><span class="k">@</span><span class="mi">75</span><span class="n">c30a4f</span>
</pre></div>

</div>
<h5 id="the-dag">The DAG<a class="headerlink" href="#the-dag" title="Permanent link">&para;</a></h5>
<p>Spark使用RDD依赖为每个Spark作业构建一个<strong>有向无环图</strong>(Directed Acyclic Graph, DAG)，决定运行每个任务的地址，并传递该信息给<code class="codehilite"><span class="n">TaskScheduler</span></code>。<code class="codehilite"><span class="n">TaskScheduler</span></code>负责在集群上运行任务。</p>
<h5 id="a-spark-job">A Spark Job<a class="headerlink" href="#a-spark-job" title="Permanent link">&para;</a></h5>
<p>一般来说，一个动作(action)对应一个Spark作业(job)。动作总是返回结果。每个作业(job)分解为多个阶段(stages)，阶段的数量取决于shuffle操作的次数。</p>
<h5 id="stages">Stages<a class="headerlink" href="#stages" title="Permanent link">&para;</a></h5>
<p>阶段(stages)代表了一组在多个机器上可以一起执行相同操作的任务(tasks)。一般来说，Spark会尽力地把多个任务(tasks)组合成一个stage，但是在shuffle之后，计算引擎会开始新的阶段。一个shuffle代表了一次数据的重新分区(a physical repartitioning of the data)。</p>
<div class="admonition example">
<p class="admonition-title">作业示例</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">df1</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">10000000</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">df2</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">10000000</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">step1</span> <span class="k">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">repartition</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">step12</span> <span class="k">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">repartition</span><span class="o">(</span><span class="mi">6</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">step2</span> <span class="k">=</span> <span class="n">step1</span><span class="o">.</span><span class="n">selectExpr</span><span class="o">(</span><span class="s">&quot;id * 5 as id&quot;</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">step3</span> <span class="k">=</span> <span class="n">step2</span><span class="o">.</span><span class="n">join</span><span class="o">(</span><span class="n">step12</span><span class="o">,</span> <span class="s">&quot;id&quot;</span><span class="o">)</span> 
<span class="k">val</span> <span class="n">step4</span> <span class="k">=</span> <span class="n">step3</span><span class="o">.</span><span class="n">selectExpr</span><span class="o">(</span><span class="s">&quot;sum(id)&quot;</span><span class="o">)</span>
<span class="n">step4</span><span class="o">.</span><span class="n">collect</span><span class="o">()</span>
</pre></div>

<p><code class="codehilite"><span class="n">step4</span><span class="p">.</span><span class="k">explain</span><span class="p">()</span></code>的执行结果如下</p>
<p><div class="codehilite"><pre><span></span>== Physical Plan ==
*(7) HashAggregate(keys=[], functions=[sum(id#6L)])
+- Exchange SinglePartition
   +- *(6) HashAggregate(keys=[], functions=[partial_sum(id#6L)])
      +- *(6) Project [id#6L]
         +- *(6) SortMergeJoin [id#6L], [id#2L], Inner
            :- *(3) Sort [id#6L ASC NULLS FIRST], false, 0
            :  +- Exchange hashpartitioning(id#6L, 200)
            :     +- *(2) Project [(id#0L * 5) AS id#6L]
            :        +- Exchange RoundRobinPartitioning(5)
            :           +- *(1) Range (2, 10000000, step=2, splits=16)
            +- *(5) Sort [id#2L ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning(id#2L, 200)
                  +- Exchange RoundRobinPartitioning(6)
                     +- *(4) Range (2, 10000000, step=4, splits=16)
</pre></div>
通过Spark WebUI查看Stages如下：</p>
<p><img alt="example_of_stages" src="../figures/example_of_stages.png" /></p>
<p>可以看到这个job一共分为6个stage，每个stage分别有16、16、5、6、200、1个任务。stage 0和stage 1对应<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="n">range</span></code>，有16个分区。stage 3和stage 4对应<code class="codehilite"><span class="n">repartition</span></code>转换，改变分区数为5和6。stage 4对应<code class="codehilite"><span class="k">join</span></code>，200个任务是<code class="codehilite"><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">shuffle</span><span class="p">.</span><span class="n">partitions</span></code>的默认值。</p>
<p>Dag图如下：</p>
<p><img alt="dag_example" src="../figures/dag_example.png" /></p>
</div>
<h5 id="tasks">Tasks<a class="headerlink" href="#tasks" title="Permanent link">&para;</a></h5>
<p>每一个任务(task)对应在一个executor上的数据块(blocks of data)和转换(transformations)的组合。所以任务是应用到一个数据分区上的计算单元。</p>
<h4 id="_18">执行细节<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h4>
<p>Spark会自动把可以一起执行的stages和tasks流水线化(pipeline)，例如两个连续的map操作。对于所有的shuffle操作，Spark会把数据写入到存储(例如硬盘)，可以在多个作业(jobs)中重复使用。</p>
<h5 id="pipelining">Pipelining<a class="headerlink" href="#pipelining" title="Permanent link">&para;</a></h5>
<p>With pipelining, any sequence of operations that feed data directly into each other, without needing to move it across nodes, is collapsed into a single stage of tasks that do all the operations together</p>
<h5 id="shuffle-persistence">Shuffle Persistence<a class="headerlink" href="#shuffle-persistence" title="Permanent link">&para;</a></h5>
<p>Spark执行shuffle：</p>
<ol>
<li>一个stage把数据写入到本地硬盘中</li>
<li>下一个stage从对应shuffle文件中抓取记录、执行计算</li>
</ol>
<p>当运行一个数据已经shuffled的作业时，不会再重复计算，而是从shuffle文件中直接抓取。例如重新运行上例中的<code class="codehilite"><span class="n">step4</span><span class="p">.</span><span class="n">collect</span><span class="p">()</span></code>，只有一个task，一个stage。</p>
<h4 id="_19">内存管理<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<p><small>
参考：</p>
<ul>
<li><a href="https://www.slideshare.net/databricks/deep-dive-memory-management-in-apache-spark?from_action=save">Deep Dive: Memory Management in Apache Spark</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/analytics/library/ba-cn-apache-spark-memory-management/index.html">Apache Spark 内存管理详解</a></li>
<li><a href="https://www.slideshare.net/databricks/spark-performance-whats-next?qid=d56739dd-dfc8-48d2-add4-02aea082cdba&amp;v=&amp;b=&amp;from_search=2">Project Tungsten - Bringing Spark Closer to Bare Metal</a></li>
</ul>
<p></small></p>
<p>在Spark中有两类内存：</p>
<ul>
<li>Execution：用作shuffle, joins, sorts, aggregations</li>
<li>Storage: 用作缓存RDD，存放广播变量</li>
</ul>
<p>Spark最初采用静态内存分配(static assignment)：按比例分配内存给Execution和Storage，当Execution不够时，使用LRU算法溢出到磁盘。但是这种方法Execution只会利用一部分内存，即使Storage为零时。</p>
<p><img alt="" src="../figures/static_memory_assignment.png" /></p>
<p>自从Spark1.6开始，Spark采用了<strong>统一内存管理</strong>(unified memory management): Storage和Execution共享内存空间，可以动态占用对方的空闲区域。</p>
<p><img alt="" src="../figures/unified_memory_management.png" /></p>
<p>执行内存的空间被对方占用后，可让对方将占用的部分转存到硬盘，然后"归还"借用的空间。存储内存的空间被对方占用后，无法让对方"归还"。</p>
<p><img alt="" src="../figures/unified_memory_management_evict.png" /></p>
<h5 id="tungsten">Tungsten<a class="headerlink" href="#tungsten" title="Permanent link">&para;</a></h5>
<p>Java对象有很大的开销，例如字符串“abcd”</p>
<ul>
<li>Native: 4 bytes with UTF-8 encoding</li>
<li>Java: 48 bytes<ul>
<li>12 byte header</li>
<li>2 bytes per character (UTF-16 internal representation)</li>
<li>20 bytes of additional overhead</li>
<li>8 byte hash code</li>
</ul>
</li>
</ul>
<p>Tungsten通过优化了Spark的CPU和内存使用:</p>
<ul>
<li>二进制存储格式(binary storage format)</li>
<li>运行时代码产生(runtime code generation): Reduce virtual function calls and interpretation overhead</li>
</ul>
<p>Tungsten的二进制编码：</p>
<p><img alt="tungsten_binary_encoding" src="../figures/tungsten_binary_encoding.png" /></p>
<p>Whole-stage Codegen Fusing operators together so the generated code looks like hand optimized code:</p>
<ul>
<li>Identity chains of operators (“stages”)</li>
<li>Compile each stage into a single function</li>
<li>Functionality of a general purpose execution engine; performance as if hand built system just to run your query</li>
</ul>
<p>Columnar in memory format:</p>
<p><img alt="columnar_in_memory_format" src="../figures/columnar_in_memory_format.png" /></p>
<ol>
<li>More efficient: denser storage, regular data access, easier to index into. Enables vectorized processing.</li>
<li>More compatible: Most high-performance external systems are already columnar (numpy, TensorFlow, Parquet); zero serialization/ copy to work with them</li>
<li>Easier to extend: process encoded data, integrate with columnar cache, delay materialization in parquet, offload to GPU</li>
</ol>
<h3 id="5-spark-streaming">5 Spark Streaming<a class="headerlink" href="#5-spark-streaming" title="Permanent link">&para;</a></h3>
<h4 id="fundamentals">fundamentals<a class="headerlink" href="#fundamentals" title="Permanent link">&para;</a></h4>
<p>类似于RDD和Datasets，Spark对流的的API也分为DStreams、Structrued Streams</p>
<p>What is stream processing?</p>
<blockquote>
<p><strong>Stream processing</strong> is the act of continuously incorporating new data to compute a result. Batch processing is the computation runs on a fixed-input dataset. </p>
</blockquote>
<p>Although streaming and batch processing sound different, in practice, they often need to work together. For example, streaming applications often need to join input data against a dataset written periodically by a batch job, and the output of streaming jobs is often files or tables that are queried in batch jobs.</p>
<p>Advantages of Stream Processing</p>
<ol>
<li>Stream processing enables lower latency.</li>
<li>Stream processing can also be more efficient in updating a result than repeated batch jobs, because it automatically incrementalizes the computation.</li>
</ol>
<h5 id="stream-processing-design-points">Stream Processing Design Points<a class="headerlink" href="#stream-processing-design-points" title="Permanent link">&para;</a></h5>
<p>Record-at-a-Time Versus Declarative APIs</p>
<ul>
<li><strong>Record-at-a-Time</strong>: pass each event to the application and let it react using custom code<ul>
<li>disadvantage: maintaining state, are solely governed by the application. </li>
<li>e.g. Flink, Storm</li>
</ul>
</li>
<li><strong>declarative APIs</strong>: application specifies what to compute but not how to compute it in response to each new event and how to recover from failure (which is called processing time).<ul>
<li>e.g. Spark</li>
</ul>
</li>
</ul>
<p>Event Time Versus Processing Time</p>
<ul>
<li><strong>Event time</strong> is the idea of processing data based on timestamps inserted into each record at the source, as opposed to the <strong>Processing time</strong> when the record is received at the streaming application</li>
</ul>
<p>Continuous Versus Micro-Batch Execution</p>
<ul>
<li>In <strong>continuous processing-based systems</strong>, each node in the system is continually listening to messages from other nodes and outputting new updates to its child nodes.<ul>
<li>advantage: offering the lowest possible <em>latency</em></li>
<li>disadvantage: lower maximum <em>throughput</em> </li>
</ul>
</li>
<li><strong>Micro-batch systems</strong> wait to accumulate small batches of input data (say, 500 ms’ worth), then process each batch in parallel using a distributed collection of tasks,<ul>
<li>advantage: high throughput per node </li>
<li>disadvantage: a higher base latency due to waiting to accumulate a micro-batch.</li>
</ul>
</li>
</ul>
<p><img alt="one-record-at-time-minibatch" src="../figures/one-record-at-time-minibatch.png" /></p>
<h5 id="sparks-streaming-api">Spark's Streaming API<a class="headerlink" href="#sparks-streaming-api" title="Permanent link">&para;</a></h5>
<p>Spark includes two streaming APIs:</p>
<ul>
<li>DStream API<ul>
<li>purely micro-batch oriented</li>
<li>has a declarative (functional-based) API but not support for event time</li>
</ul>
</li>
<li>Structured Streaming API<ul>
<li>supports continuous processing</li>
<li>adds higher-level optimizations, event time</li>
</ul>
</li>
</ul>
<p>Structured Streaming is a higher-level streaming API built from the ground up on Spark’s Structured APIs.</p>
<h4 id="dstream">DStream<a class="headerlink" href="#dstream" title="Permanent link">&para;</a></h4>
<p><a href="https://spark.apache.org/docs/latest/streaming-programming-guide.html">官方文档</a></p>
<p>离散化流(discretized stream, <strong>DStream</strong>)是随时间推移而收到的数据序列。在内部，每个时间区间收到的数据都作为RDD存在，而DStream是由这些RDD所组成的序列(因此得名为离散化)。</p>
<p><img alt="" src="../figures/DStream_demo.jpg" /></p>
<div class="admonition example">
<p class="admonition-title">DStream例子</p>
<p>创建一个流读取本地7777端口的数据。可以使用<code class="codehilite"><span class="n">nc</span> <span class="o">-</span><span class="n">lk</span> <span class="mi">7777</span></code>发送给。</p>
<div class="codehilite"><pre><span></span><span class="c1">// 从SparkConf创建StreamingContext并指定1秒钟的批处理大小 </span>
<span class="k">val</span> <span class="n">ssc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StreamingContext</span><span class="o">(</span><span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">,</span> <span class="nc">Seconds</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
<span class="c1">// 连接到本地机器7777端口上后，使用收到的数据创建</span>
<span class="nc">DStream</span> <span class="k">val</span> <span class="n">lines</span> <span class="k">=</span> <span class="n">ssc</span><span class="o">.</span><span class="n">socketTextStream</span><span class="o">(</span><span class="s">&quot;localhost&quot;</span><span class="o">,</span> <span class="mi">7777</span><span class="o">)</span>
<span class="c1">// 从DStream中筛选出包含字符串&quot;error&quot;的行</span>
<span class="k">val</span> <span class="n">errorLines</span> <span class="k">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;error&quot;</span><span class="o">))</span> 
<span class="c1">// 打印出有&quot;error&quot;的行 errorLines.print()</span>
<span class="n">errorLines</span><span class="o">.</span><span class="n">print</span><span class="o">()</span>
<span class="c1">// 启动流计算环境StreamingContext并等待它&quot;完成&quot; </span>
<span class="n">ssc</span><span class="o">.</span><span class="n">start</span><span class="o">()</span> <span class="c1">// 等待作业完成 </span>
<span class="n">ssc</span><span class="o">.</span><span class="n">awaitTermination</span><span class="o">()</span>
</pre></div>

</div>
<p>Spark Streaming为每个输入源启动对应的接收器(recevier)。接收器以任务的形式运行在应用的执行器进程中，从输入源收集数据并保存为 RDD。 它们收集到输入数据后会把数据复制到另一个执行器(executor)进程来保障容错性(默认行为)。数据保存在执行器进程的内存中，和缓存RDD的方式一样。驱动器程序中的StreamingContext会周期性地运行Spark作业来处理这些数据，把数据与之前时间区间中的RDD进行整合。</p>
<p><img alt="StreamingContext" src="../figures/StreamingContext.png" /></p>
<p>Spark Streaming 也提供了 检查点 机制，可以把状态阶段 性地存储到可靠文件系统中(例如HDFS或者S3)。一般来说，你需要每处理5-10个批次的数据就保存一次。在恢复数据时, Spark Streaming只需要回溯到上一个检查点即可。</p>
<p>DStream的转化操作可以分为<strong>无状态</strong>(stateless)和<strong>有状态</strong>(stateful)两种。</p>
<ul>
<li>在<strong>无状态转化操作</strong>中，每个批次的处理不依赖于之前批次的数据。例如<code class="codehilite"><span class="n">filter</span><span class="p">()</span></code>和<code class="codehilite"><span class="n">reducedByKey</span><span class="p">()</span></code></li>
<li>在<strong>有状态转化操作</strong>中，需要使用之前批次的数据或者是中间结果来计算当前批次的数据。有状态转化操作包括基于滑动窗口的转化操作和追踪状态变化的转化操作。</li>
</ul>
<p>下面是常见的无状态转化操作：</p>
<p><img alt="DStream_stateless" src="../figures/DStream_stateless.png" /></p>
<p>除此之外，DStream还提供了一个叫做<code class="codehilite"><span class="k">transform</span><span class="p">()</span></code>的高级操作符，允许对DStream提供任意一个RDD到RDD的函数。这个函数会在数据流中的每个批次中被调用，生成一个新的流。</p>
<p>有状态转化操作需要在<code class="codehilite"><span class="n">StreamingContext</span></code>中打开检查点机制来确保容错性。主要的两种类型是滑动窗口和<code class="codehilite"><span class="n">updateStateByKey</span><span class="p">()</span></code>。所有基于窗口的操作都需要两个参数，分别为窗口时长(window duration)以及滑动步长，两者都必须是StreamContext的批次间隔(batch duration)的整数倍。</p>
<div class="admonition example">
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">accessLogsWindow</span> <span class="k">=</span> <span class="n">accessLogsDStream</span><span class="o">.</span><span class="n">window</span><span class="o">(</span><span class="nc">Seconds</span><span class="o">(</span><span class="mi">30</span><span class="o">),</span> <span class="nc">Seconds</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span> 
<span class="k">val</span> <span class="n">windowCounts</span> <span class="k">=</span> <span class="n">accessLogsWindow</span><span class="o">.</span><span class="n">count</span><span class="o">()</span>
</pre></div>

</div>
<p><img alt="" src="../figures/dstream_window.jpg" /></p>
<h5 id="_20">输出操作<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h5>
<p>通用的输出操作<code class="codehilite"><span class="n">foreachRDD</span><span class="p">()</span></code>， 它用来对DStream中的RDD运行任意计算。 这和<code class="codehilite"><span class="k">transform</span><span class="p">()</span></code>有些类似， 都可以让我们访问任意RDD。 在<code class="codehilite"><span class="n">foreachRDD</span><span class="p">()</span></code>中， 可以重用我们在Spark中实现的所有行动操作。 比如， 常见的用例之一是把数据写到诸如MySQL的外部数据库中。用 RDD的<code class="codehilite"><span class="n">eachPartition</span><span class="p">()</span></code>方法来把它写出去。</p>
<div class="superfences-tabs">
<input name="__tabs_4" type="radio" id="__tab_4_0" checked="checked" />
<label for="__tab_4_0">Task not serializable</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">dstream</span><span class="o">.</span><span class="n">foreachRDD</span> <span class="o">{</span> <span class="n">rdd</span> <span class="k">=&gt;</span>
  <span class="k">val</span> <span class="n">connection</span> <span class="k">=</span> <span class="n">createNewConnection</span><span class="o">()</span>  <span class="c1">// executed at the driver</span>
  <span class="n">rdd</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span> <span class="n">record</span> <span class="k">=&gt;</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="o">(</span><span class="n">record</span><span class="o">)</span> <span class="c1">// executed at the worker</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></div>
<input name="__tabs_4" type="radio" id="__tab_4_1" />
<label for="__tab_4_1">正确</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">dstream</span><span class="o">.</span><span class="n">foreachRDD</span> <span class="o">{</span> <span class="n">rdd</span> <span class="k">=&gt;</span>
  <span class="n">rdd</span><span class="o">.</span><span class="n">foreachPartition</span> <span class="o">{</span> <span class="n">partitionOfRecords</span> <span class="k">=&gt;</span>
    <span class="k">val</span> <span class="n">connection</span> <span class="k">=</span> <span class="n">createNewConnection</span><span class="o">()</span>
    <span class="n">partitionOfRecords</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">record</span> <span class="k">=&gt;</span> <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="o">(</span><span class="n">record</span><span class="o">))</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div></div>
</div>
<p>请参考官方文档<a href="https://spark.apache.org/docs/latest/streaming-kafka-0-8-integration.html">Spark Streaming + Kafka Integration Guide</a></p>
<h4 id="structured-streaming">Structured Streaming<a class="headerlink" href="#structured-streaming" title="Permanent link">&para;</a></h4>
<p>The main idea behind Structured Streaming is to treat a <em>stream</em> of data as a <em>table</em> to which data is continuously appended. The job then periodically checks for new input data, process it, updates some internal state located in a state store if needed, and updates its result.
<img alt="" src="../figures/structured_streaming_input.jpg" /></p>
<p>Structured Streaming enables users to build <a href="https://databricks.com/blog/2016/07/28/continuous-applications-evolving-streaming-in-apache-spark-2-0.html"><strong>continuous applications</strong></a>: an end-to-end application that reacts to data in real time by combining a variety of tools: streaming jobs, batch jobs, joins between streaming and offline data, and interactive ad-hoc queries.</p>
<p><img alt="" src="../figures/continuous_application.png" /></p>
<p>Core Concepts:</p>
<ul>
<li>Transformations and Actions</li>
<li>Input Sources: Kafka, Files on a distributed file system</li>
<li>Sinks: Kafka, any file format, console sink for testing, memory sink for debugging</li>
<li>Output Modes: append, update, complete</li>
</ul>
<h4 id="event-time-and-stateful-processing">Event-Time and Stateful Processing<a class="headerlink" href="#event-time-and-stateful-processing" title="Permanent link">&para;</a></h4>
<p>Stateful processing is only necessary when you need to use or update intermediate information (state) over longer periods of time (in either a microbatch or a record-at-a-time approach). When performing a stateful operation, Spark stores the intermediate information in a <em>state store</em>. Spark’s current state store implementation is an in-memory state store that is made fault tolerant by storing intermediate state to the checkpoint directory.</p>
<h3 id="6-mllib">6 MLlib<a class="headerlink" href="#6-mllib" title="Permanent link">&para;</a></h3>
<p>Spark有两个机器学习库Spark MLlib和Spark ML。它们的API差异很大，但是算法类似。</p>
<ul>
<li>MLlib支持RDDs，仅提供算法，目前已经进入维护模式。</li>
<li>ML支持DataFrames和Datasets，提供预处理、清洗、特征工程、算法等功能。</li>
</ul>
<p><img alt="" src="../figures/the_machine_learning_workflow.jpg" /></p>
<p>MLlib is a package, built on and included in Spark, that provides interfaces for gathering and cleaning data, feature engineering and feature selection, training and tuning large-scale supervised and unsupervised machine learning models, and using those models in production.</p>
<p>When and why should you use MLlib (versus scikit-learn, TensorFlow, or foo package). This means single-machine tools are usually complementary to MLlib. When you hit those scalability issues, take advantage of Spark’s abilities.</p>
<p>There are two key use cases where you want to leverage Spark’s ability to scale. First, you want to leverage Spark for preprocessing and feature generation to reduce the amount of time it might take to produce training and test sets from a large amount of data. Then you might leverage single-machine learning libraries to train on those given data sets. Second, when your input data or model size become too difficult or inconvenient to put on one machine, use Spark to do the heavy lifting. Spark makes distributed machine learning very simple.</p>
<ul>
<li>Transformers are functions that convert raw data in some way. This might be to create a new interaction variable (from two other variables), normalize a column, or simply change an Integer into a Double type to be input into a model.</li>
</ul>
<p><img alt="" src="../figures/mllib_transformers.jpg" /></p>
<h4 id="low-level-data-types">Low-level data types<a class="headerlink" href="#low-level-data-types" title="Permanent link">&para;</a></h4>
<h2 id="7">7 调优<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>参考<a href="https://spark.apache.org/docs/latest/tuning.html">官方文档</a></p>
<h4 id="_21">算子的合理选择<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<h5 id="groupbykeyreducebykey">groupByKey/reduceByKey<a class="headerlink" href="#groupbykeyreducebykey" title="Permanent link">&para;</a></h5>
<p>尽量不使用<code class="codehilite"><span class="n">groupByKey</span></code>，可以用<code class="codehilite"><span class="n">reduceByKey</span></code>代替。以WordCount为例，下面是分别用<code class="codehilite"><span class="n">groupByKey</span></code>和<code class="codehilite"><span class="n">reduceByKey</span></code>求解的代码和图示。使用GroupByKey会增加数据传输。</p>
<p><img alt="reduce_by_key_reduce_by_key" src="../figures/reduce_by_key_reduce_by_key.png" /></p>
<div class="codehilite"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="s">&quot;hdfs://centos2:9000/test/hive_exercise.json&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">&quot;[\t:{}\&quot;$,]&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">word</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
  <span class="o">.</span><span class="n">reduceByKey</span><span class="o">((</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">)</span>
  <span class="o">.</span><span class="n">collect</span><span class="o">()</span>
  <span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>

<span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="s">&quot;hdfs://centos2:9000/test/hive_exercise.json&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">&quot;[\t:{}\&quot;$,]&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">word</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
  <span class="o">.</span><span class="n">groupByKey</span><span class="o">()</span>
  <span class="o">.</span><span class="n">mapValues</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="o">)</span>
  <span class="o">.</span><span class="n">collect</span><span class="o">()</span>
  <span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
</pre></div>

<h4 id="_22">序列化格式<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<p>当Spark需要通过网络传输数据，或是将数据溢写到磁盘上时，Spark需要序列化。默认情况下， Spark会使用Java内建的序列化库(<code class="codehilite"><span class="n">ObjectOutputStream</span></code>)。为了获取更好的性能，建议使用Kryo序列化，它比Java序列化更快，更紧凑(10x)。但是并不支持所有<code class="codehilite"><span class="k">Serializable</span></code>类型，并且需要该向Kryo注册你想要序列化的类。</p>
<div class="codehilite"><pre><span></span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="o">(</span><span class="s">&quot;spark.serializer&quot;</span><span class="o">,</span> <span class="s">&quot;org.apache.spark.serializer.KryoSerializer&quot;</span><span class="o">)</span>
<span class="n">conf</span><span class="o">.</span><span class="n">registerKryoClasses</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">MyClass1</span><span class="o">],</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">MyClass2</span><span class="o">]))</span>
</pre></div>

<h4 id="_23">优化配置参数<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<p>Spark core优化配置参数</p>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.driver.cores</td>
<td>在集群模式下管理资源时，用于driver程序的CPU内核数量。默认为1。在生产环境的硬件上，这个值可能最少要上调到8或16。</td>
</tr>
<tr>
<td>spark.driver.maxResultSize</td>
<td>如果应用频繁用此driver程序，建议对这个值的设置高于其默认值“1g”。0表示没有限制。这个值反映了Spark action的全部分区中最大的结果集的大小。</td>
</tr>
<tr>
<td>spark.driver.memony</td>
<td>driver进程使用的总内存数。和内核数一样，建议根据你的应用及硬件情况，把这个值设置为“16g”或“32g”。默认”1g”。</td>
</tr>
<tr>
<td>spark.executor.memory</td>
<td>每个executor进程所使用的内存数。默认值为“1g”。根据集群的硬件情况，应该把这个值设置为“4g”、“8g”、“16g”或者更高。</td>
</tr>
<tr>
<td>spark.local.dir</td>
<td>这是Spark原生写本地文件，包括在磁盘上存储RDD的地方。默认是/tmp。强烈推荐把它设置在快速存储（首选SSD）上，分配大量的空间。在序列化对象到磁盘时，就会落入这个位置，如果这个路径下没有空间，将会出现不确定的行为</td>
</tr>
</tbody>
</table>
<p>运行时环境参数</p>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.executor.logs.rolling.*</td>
<td>有四个属性用于设定及维护spark日志的滚动。当spark应用长周期运行时（超过24小时），应该设置这个属性</td>
</tr>
<tr>
<td>spark.python.worker.memory</td>
<td>如果使用python开发spark应用，这个属性将为每个python worker进程分配总内存数。默认值512m</td>
</tr>
<tr>
<td>shuffle行为参数</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>应用参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.shuffle.manager</td>
<td>这是Spark里shuffle数据的实现方法，默认为“sort”。这里提到它是因为，如果应用使用Tungsten，应该把这个属性值设置为“Tungsten-sort”。</td>
</tr>
<tr>
<td>spark.shuffle.memoryFraction</td>
<td>这个是shuffle操作溢写到磁盘时java堆占总内存的比例。默认值为0.2。如果该应用经常溢出，或者多个shuffle操作同时发生，应该把这个值设置的更高。通常。可以从0.2升到0.4，然后再到0.6，确保一切保持稳定。这个值建议不要超过0.6，否则它可能会碍事，与其他对象竞争堆空间</td>
</tr>
<tr>
<td>spark.shuffle.service.enabled</td>
<td>在Spark内开启外部的shuffle服务。如果需要调度动态分配，就必须设置这个属性。默认为false</td>
</tr>
</tbody>
</table>
<p>压缩及序列化参数</p>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.kryo.classToRegister</td>
<td>当使用Kryo做对象序列化时，需要注册这些类。对于Kryo将序列化的应用所用的所有自定义对象，必须设置这些属性</td>
</tr>
<tr>
<td>spark.kryo.register</td>
<td>当自定义类需要扩展“KryoRegister”类接口时，用它代替上面的属性。</td>
</tr>
<tr>
<td>spark.rdd.compress</td>
<td>设置是否应当压缩序列化的RDD，默认false。但是和前面说过的一样，如果硬件充足，应该启用这个功能，因为这时的CPU性能损失可以忽略不计</td>
</tr>
<tr>
<td>spark.serializer</td>
<td>如果设置这个值，将使用Kryo序列化，而不是使用java的默认序列化方法。强烈推荐配置成Kryo序列化，因为这样可以获得最佳的性能，并改善程序的稳定性</td>
</tr>
</tbody>
</table>
<p>执行行为参数</p>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.cleaner.ttl Spark</td>
<td>记录任何对象的元数据的持续时间（按照秒来计算）。默认值设为“infinite”（无限），对长时间运行的job来说，可能会造成内存泄漏。适当地进行调整，最好先设置为3600，然后监控性能。</td>
</tr>
<tr>
<td>spark.executor.cores</td>
<td>每个executor的CPU核数。这个默认值基于选择的资源调度器。如果使用YARN或者Standalone集群模式，应该调整这个值</td>
</tr>
</tbody>
</table>
<p>网络参数</p>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.akka.frameSize</td>
<td>Spark集群通信中最大消息的大小。当程序在带有上千个map及reduce任务的大数据集上运行时，应该把这个值从128调为512，或者更高。</td>
</tr>
<tr>
<td>spark.akka.threads</td>
<td>用于通信的Akka的线程数。对于运行多核的driver应用，推荐将这个属性值从4提高为16、32或更高调度参数</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>应用属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark.cores.max</td>
<td>设置应用程序从集群所有节点请求的最大CPU内核数。如果程序在资源有限的环境下运行，应该把这个属性设置最大为集群中spark可用的CPU核数</td>
</tr>
</tbody>
</table>
<h4 id="_24">数据倾斜<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<p>对于大数据来说，数据量大并不可怕，可怕的是数据倾斜。由于数据分布不均匀，造成数据大量的几种在某个点上，造成数据热点问题。</p>
<p>https://segmentfault.com/a/1190000021814886?utm_source=tag-newest#item-1
http://www.jasongj.com/spark/skew/</p>
<h3 id="_25">附录<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<h4 id="spark_2">安装Spark集群<a class="headerlink" href="#spark_2" title="Permanent link">&para;</a></h4>
<p>在<a href="http://spark.apache.org/downloads.html">官网</a>下载对应版本Spark源码以后，进行编译</p>
<div class="codehilite"><pre><span></span>./dev/make-distribution.sh --name <span class="s2">&quot;hadoop2-without-hive&quot;</span> --tgz <span class="s2">&quot;-Pyarn,hadoop-provided,hadoop-2.7,parquet-provided,orc-provided&quot;</span>
</pre></div>

<p>在<code class="codehilite"><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span></code>中添加<code class="codehilite"><span class="n">export</span> <span class="n">LD_LIBRARY_PATH</span><span class="o">=</span><span class="err">$</span><span class="n">HADOOP_HOME</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">native</span></code>使用Hadoop native。</p>
<p>接下来编辑配置文件<code class="codehilite"><span class="n">conf</span><span class="o">/</span><span class="n">spark</span><span class="o">-</span><span class="n">env</span><span class="p">.</span><span class="n">sh</span></code>和<code class="codehilite"><span class="n">conf</span><span class="o">/</span><span class="n">slaves</span></code>。</p>
<div class="superfences-tabs">
<input name="__tabs_5" type="radio" id="__tab_5_0" checked="checked" />
<label for="__tab_5_0">spark-env.sh</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>export JAVA_HOME=/opt/jdk1.8.0_201
export HADOOP_HOME=/opt/hadoop-2.7.7
export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop
SAPRK_MASTER_IP=centos1
SPARK_DRIVER_MEMORY=1G
export SPARK_DIST_CLASSPATH=$(/opt/hadoop-2.7.7/bin/hadoop classpath)
</pre></div></div>
<input name="__tabs_5" type="radio" id="__tab_5_1" />
<label for="__tab_5_1">slaves</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span>centos1
centos2
centos3
centos4
</pre></div></div>
</div>
<p>将配置好的spark发送给其他slaves之后，就可以用命令<code class="codehilite"><span class="n">sbin</span><span class="o">/</span><span class="k">start</span><span class="o">-</span><span class="k">all</span><span class="p">.</span><span class="n">sh</span></code>启动spark集群。 如果要查看spark管理界面，在浏览器中输入<a href="http://centos1:8080">http://centos1:8080</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Kafka/" title="Kafka" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                Kafka
              </span>
            </div>
          </a>
        
        
          <a href="../Sqoop/" title="Sqoop" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Sqoop
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.a8b5e56f.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
          
            
              
              
            
          
          
            <script src="../../../assets/javascripts/lunr/lunr.multi.js"></script>
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>