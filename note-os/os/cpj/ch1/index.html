<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note/os/cpj/ch1/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Ch1 - Zhenhua's Notes</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../../extra_css/custom.css" rel="stylesheet">
        <link href="../../../extra_css/custom.js" rel="stylesheet">
        <link href="../../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../../extra_css/theme.css" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Zhenhua's Notes</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Algorithm <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../algorithm/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmPrinceton</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/unionfind/">Topic 1: UnionFind</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/stackqueue/">Topic 2: StackQueue</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/sort/">Topic 3: Sort</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/priorityqueue/">Topic 4: PriorityQueues</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/symboltable/">Topic 5: Symbol Tables</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/bst/">Topic 6: Balanced Search Trees</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/hashtable/">Topic 7: Hash Table</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/graph/">Topic 8: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/mst_shortestpath/">Topic 9: Minimum Spanning Tree and Shortest Path</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmStanford</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmStanford/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/dynamicprogramming/">Topic: Dynammic Programming</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/heap/">Topic: Heap</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/graph/">Topic: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/greedy/">Topic: Greedy Algorithm</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/hashtable/">Topic: Hash Table</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CS61B</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../calgorithm/s61b/index.md">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab1/">Lab1: javac, java, git</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab2/">Lab2: Unit Testing with JUnit and IntLists</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab3/">Lab3: Unit Testing with JUnit, Debugging</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">OS <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">OSC</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../osc/">Contents</a>
</li>
            
<li >
    <a href="../../osc/ch1/">Chapter 1: Introduction </a>
</li>
            
<li >
    <a href="../../osc/ch2/">Chapter 2: Operating System structures</a>
</li>
            
<li >
    <a href="../../osc/ch3/">Chapter 3: Processes</a>
</li>
            
<li >
    <a href="../../osc/ch4/">Chapter 4: Threads and Concurrency</a>
</li>
            
<li >
    <a href="../../osc/ch5/">Chapter 5: CPU Scheduling</a>
</li>
            
<li >
    <a href="../../osc/ch6/">Chapter 6: Synchronization Tools</a>
</li>
            
<li >
    <a href="../../osc/ch7/">Chapter 7: Synchronization Examples</a>
</li>
            
<li >
    <a href="../../osc/ch8/">Chapter 8: Deadlocks</a>
</li>
            
<li >
    <a href="../../osc/ch9/">Chapter 9: Main Memory</a>
</li>
            
<li >
    <a href="../../osc/ch10/">Chapter 10: Virtual Memory</a>
</li>
            
<li >
    <a href="../../osc/ch11/">Chapter 11: Mass-Storage Structure</a>
</li>
            
<li >
    <a href="../../osc/ch13/">Chapter 13: File-System Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CSAPP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../csapp/">Contents</a>
</li>
            
<li >
    <a href="../../csapp/ch1/">Chapter 1: 计算机系统漫游</a>
</li>
            
<li >
    <a href="../../csapp/ch2/">Chapter 2: 信息的表示和处理</a>
</li>
            
<li >
    <a href="../../csapp/ch3/">Chapter 3: 程序的机器级表示</a>
</li>
            
<li >
    <a href="../../csapp/ch4/">Chapter 4: 处理器体系结构</a>
</li>
            
<li >
    <a href="../../csapp/ch5/">Chapter 5: 优化程序性能</a>
</li>
            
<li >
    <a href="../../csapp/ch6/">Chapter 6: 存储器层次结构</a>
</li>
            
<li >
    <a href="../../csapp/ch7/">Chapter 7: 链接</a>
</li>
            
<li >
    <a href="../../csapp/ch8/">Chapter 8: 异常控制流</a>
</li>
            
<li >
    <a href="../../csapp/ch9/">Chapter 9: 虚拟内存</a>
</li>
            
<li >
    <a href="../../csapp/ch10/">Chapter 10: 系统级I/O</a>
</li>
            
<li >
    <a href="../../../csapp/ch11.md">Chapter 11: 网络编程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">DataBase <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../database/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MySql</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../database/mysql/">Contents</a>
</li>
            
<li >
    <a href="../../../database/mysql/LearningMySQLandMariaDB/">Chapter Learning MySQL and MariaDB</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Java <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../java/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfj/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch1/">Chapter 1: Dive in A Quick Dip</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch2/">Chapter 2: Classes and Objects</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch3/">Chapter 3: Primitives and References</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch4/">Chapter 4: Methods use Instance Variables</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch5/">Chapter 5: Writing a Program</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch6/">Chapter 6: Get to Know the Java API</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch7/">Chapter 7: Inheritance and Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch8/">Chapter 8: Interfaces and Abstract Classes</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch9/">Chapter 9: Constructors and Garbage Collection</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch10/">Chapter 10: Numbers and Statics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch11/">Chapter 11: Exception Handling</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch12/">Chapter 12: Getting GUI</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch13/">Chapter 13: Using Swing</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch14/">Chapter 14: Serialization and File I/O</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch15/">Chapter 15: Networking and Threads</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch16/">Chapter 16: Collections and Generics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch17/">Chapter 17: Packages, Jars and Deployment</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch18/">Chapter 18: Remote deploy with RMI</a>
</li>
            
<li >
    <a href="../../../java/hfj/Appendix/">Appendix: The Top Ten Topics</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFDP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfdp/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch1/">Chapter 1: Strategy Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch2/">Chapter 2: Observer Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch3/">Chapter 3: Decorator Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch4/">Chapter 4: Factory Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch5/">Chapter 5: Singleton Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch6/">Chapter 6: Command Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch7/">Chapter 7: Adapter and Facade Patterns</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch8/">Chapter 8: Template Method Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch9/">Chapter 9: Iterator and Composite Patterns</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TIJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/tij/">Contents</a>
</li>
            
<li >
    <a href="../../../java/tij/ch1/">Chapter 1: Introduction</a>
</li>
            
<li >
    <a href="../../../java/tij/ch2/">Chapter 2: Introduction to Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch3/">Chapter 3: Everything is an Object</a>
</li>
            
<li >
    <a href="../../../java/tij/ch4/">Chapter 4: Opertors</a>
</li>
            
<li >
    <a href="../../../java/tij/ch5/">Chapter 5: Controlling Execution</a>
</li>
            
<li >
    <a href="../../../java/tij/ch6/">Chapter 6: Initialization & Cleanup</a>
</li>
            
<li >
    <a href="../../../java/tij/ch7/">Chapter 7: Access Control</a>
</li>
            
<li >
    <a href="../../../java/tij/ch8/">Chapter 8: Reusing Clases</a>
</li>
            
<li >
    <a href="../../../java/tij/ch9/">Chapter 9: Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/tij/ch10/">Chapter 10: Interfaces</a>
</li>
            
<li >
    <a href="../../../java/tij/ch11/">Chapter 11: Inner Classes</a>
</li>
            
<li >
    <a href="../../../java/tij/ch12/">Chapter 12: Holding Your Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch13/">Chapter 13: Error Handling with Exceptions</a>
</li>
            
<li >
    <a href="../../../java/tij/ch14/">Chapter 14: Strings</a>
</li>
            
<li >
    <a href="../../../java/tij/ch15/">Chapter 15: Type Information</a>
</li>
            
<li >
    <a href="../../../java/tij/ch16/">Chapter 16: Generics</a>
</li>
            
<li >
    <a href="../../../java/tij/ch17/">Chapter 17: Arrays</a>
</li>
            
<li >
    <a href="../../../java/tij/ch18/">Chapter 18: Containers in Depth</a>
</li>
            
<li >
    <a href="../../../java/tij/ch19/">Chapter 19: I/O</a>
</li>
            
<li >
    <a href="../../../java/tij/ch20/">Chapter 20: Enumerated Types</a>
</li>
            
<li >
    <a href="../../../java/tij/ch21/">Chapter 21: Annotations</a>
</li>
            
<li >
    <a href="../../../java/tij/ch22/">Chapter 22: Concurrency</a>
</li>
            
<li >
    <a href="../../../java/tij/ch23/">Chapter 23: Graphical User Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">UJVM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/ujvm/">Contents</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch1/">Chapter 1 : 走进Java</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch2/">Chapter 2 : Java内存区域与内存溢出正常</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch3/">Chapter 3 : 垃圾收集器与内存分配策略</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch4/">Chapter 4 : 虚拟机性能监控与故障处理工具</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch5/">Chapter 5 : 调优案例分析与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch6/">Chapter 6 : 类文件结构</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch7/">Chapter 7 : 虚拟机类加载机制</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch8/">Chapter 8 : 虚拟机字节码执行引擎</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch9/">Chapter 9 : 类加载及执行子系统的案例与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch10/">Chapter 10 : 早期(编译期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch11/">Chapter 11 : 晚期(运行期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch12/">Chapter 12 : Java内存模型与线程</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch13/">Chapter 13 : 线程安全与锁优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/AppendixC/">Appendix HotSpot虚拟机主要参数列表</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">BigData <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../bigdata/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HADOOP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/hadoop/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch1/">Chapter 1: Meet Hadoop</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch2/">Chapter 2: MapReduce</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch3/">Chapter 3: The Hadoop Distributed FileSystem</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch4/">Chapter 4: YARN</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch5/">Chapter 5: Hadoop I/O</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch6/">Chapter 6: Developing a MapReduce Application</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch7/">Chapter 7: How MapReduce Works</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch8/">Chapter 8: MapReduce Types and Formats</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch9/">Chapter 9: MapReduce Features</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch10/">Chapter 10: Setting Up a Hadoop Cluster</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch11/">Chapter 11: Adminstering Hadoop</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch12/">Chapter 12: Avro</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch13/">Chapter 13: Parquet</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch14/">Chapter 14: Flume</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch15/">Chapter 15: Sqoop</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch16/">Chapter 16: Pig</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch17/">Chapter 17: Hive</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch18/">Chapter 18: Crunch</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch19/">Chapter 19: Spark</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch20/">Chapter 20: HBase</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch21/">Chapter 21: ZooKeeper</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch22/">Chapter 22: Composable Data at Center</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch23/">Chapter 23: Biological Data Science: Saving Lives with Software</a>
</li>
            
<li >
    <a href="../../../bigdata/hadoop/ch24/">Chapter 24: Cascading</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Spark</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/spark/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch1/">Chapter 1: Introduction to Data Analysis with Spark</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch2/">Chapter 2: Downloading Spark and Getting Started</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch3/">Chapter 3: Programming with RDDs</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch4/">Chapter 4: Working with Key/Value Pairs</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch5/">Chapter 5: Loading and Saving Your Data</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch6/">Chapter 6: Advanced Spark Programming</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch7/">Chapter 7: Running on a Cluster</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch8/">Chapter 8: Tuning and Debugging Spark</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch9/">Chapter 9: Spark SQL</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch10/">Chapter 10: Spark Streaming</a>
</li>
            
<li >
    <a href="../../../bigdata/spark/ch11/">Chapter 11: Machine Learning with MLlib</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">GDM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/gdm/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch1/">Chapter 1: 推荐系统入门</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch2/">Chapter 2: 隐式评价和基于物品的过滤算法</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch3/">Chapter 3: 分类</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch4/">Chapter 4: 进一步探索分类</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch5/">Chapter 5: 概率和朴素贝叶斯</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch6/">Chapter 6: 朴素贝叶斯和文本数据</a>
</li>
            
<li >
    <a href="../../../bigdata/gdm/ch7/">Chapter 7: 聚类</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MLIA</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/mlia/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch1/">Chapter 1: 机器学习基础</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch2/">Chapter 2: k-近邻算法</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch3/">Chapter 3: 决策树</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch4/">Chapter 4: 基于概率论的分类方法：朴素贝叶斯</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch5/">Chapter 5: Logistic回归</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch6/">Chapter 6: 支持向量机</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch7/">Chapter 7: 利用AdaBoost元算法提高分类性能</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch8/">Chapter 8: 预测数值型数据：回归</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch9/">Chapter 9: 树回归</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch10/">Chapter 10: 利用Ｋ-均值聚类算法对未标注数据分组</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch11/">Chapter 11: 使用Apriori算法进行关联分析</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch11/">Chapter 12: 使用FP-growth算法来高效发现频繁项集</a>
</li>
            
<li >
    <a href="../../../bigdata/mlia/ch13/">Chapter 13: 利用PCA来简化数据</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Crawler</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/crawler/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch1/">Chapter 1: 开发环境配置</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch2/">Chapter 2: 爬虫基础</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch3/">Chapter 3: 基本库的使用</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch4/">Chapter 4: 解析库的使用</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch5/">Chapter 5: 数据存储</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch7/">Chapter 7: 动态渲染页面爬取</a>
</li>
            
<li >
    <a href="../../../bigdata/crawler/ch13/">Chapter 13: Scrapy框架的使用</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Projects</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../bigdata/projects/">Contents</a>
</li>
            
<li >
    <a href="../../../bigdata/projects/SparkStreaming实时流处理项目/">SparkStreaming实时流处理</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../books/">Books</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>

                     <!--
                    -->
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#concurrent-programming-in-java-1-threads-and-locks">Concurrent Programming in Java 1: Threads and Locks</a></li>
        <li class="main "><a href="#threads">Threads</a></li>
            <li><a href="#thread-creation">Thread creation</a></li>
            <li><a href="#synchronized-methods">Synchronized Methods</a></li>
        <li class="main "><a href="#structured-locks">Structured Locks</a></li>
            <li><a href="#guarded-blocks">Guarded Blocks</a></li>
            <li><a href="#intrinsic-locks-and-synchronization">Intrinsic Locks and Synchronization</a></li>
        <li class="main "><a href="#unstructured-locks">Unstructured Locks</a></li>
            <li><a href="#reentrantlock">ReentrantLock</a></li>
            <li><a href="#interface-lock">Interface Lock</a></li>
            <li><a href="#trylock">tryLock</a></li>
        <li class="main "><a href="#liveness">Liveness</a></li>
        <li class="main "><a href="#dining-philosophers">Dining Philosophers</a></li>
            <li><a href="#implementation">Implementation</a></li>
        <li class="main "><a href="#example-list">Example: List</a></li>
        <li class="main "><a href="#java-volatile">Java Volatile</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="concurrent-programming-in-java-1-threads-and-locks">Concurrent Programming in Java 1: Threads and Locks<a class="headerlink" href="#concurrent-programming-in-java-1-threads-and-locks" title="Permanent link">&para;</a></h3>
<h3 id="threads">Threads<a class="headerlink" href="#threads" title="Permanent link">&para;</a></h3>
<p>A unique aspect of Java compared to prior mainstream programming languages is that Java included the notions of threads (as instances of the <span><span class="MathJax_Preview">\mathtt {java.lang.Thread}</span><script type="math/tex">\mathtt {java.lang.Thread}</script></span> class) in its language definition right from the start.</p>
<p>When an instance of <span><span class="MathJax_Preview">\mathtt {Thread}</span><script type="math/tex">\mathtt {Thread}</script></span> is created (via a <span><span class="MathJax_Preview">\mathtt {new}</span><script type="math/tex">\mathtt {new}</script></span> operation), it does not start executing right away; instead, it can only start executing when its <span><span class="MathJax_Preview">\mathtt {start}()</span><script type="math/tex">\mathtt {start}()</script></span> method is invoked. The statement or computation to be executed by the thread is specified as a parameter to the constructor.</p>
<p>The <span><span class="MathJax_Preview">\mathtt {Thread}</span><script type="math/tex">\mathtt {Thread}</script></span> class also includes a wait operation in the form of a <span><span class="MathJax_Preview">\mathtt {join}()</span><script type="math/tex">\mathtt {join}()</script></span> method. If thread <span><span class="MathJax_Preview">\mathtt {t0}</span><script type="math/tex">\mathtt {t0}</script></span> performs a <span><span class="MathJax_Preview">\mathtt {t1.join}()</span><script type="math/tex">\mathtt {t1.join}()</script></span> call, thread <span><span class="MathJax_Preview">\mathtt {t0}</span><script type="math/tex">\mathtt {t0}</script></span> will be forced to wait until thread <span><span class="MathJax_Preview">\mathtt {t1}</span><script type="math/tex">\mathtt {t1}</script></span> completes, after which point it can safely access any values computed by thread <span><span class="MathJax_Preview">\mathtt {t1}</span><script type="math/tex">\mathtt {t1}</script></span>. Since there is no restriction on which thread can perform a <span><span class="MathJax_Preview">\mathtt {join}</span><script type="math/tex">\mathtt {join}</script></span> on which other thread, it is possible for a programmer to erroneously create a deadlock cycle with <span><span class="MathJax_Preview">\mathtt {join}</span><script type="math/tex">\mathtt {join}</script></span> operations. (A deadlock occurs when two threads wait for each other indefinitely, so that neither can make any progress.)</p>
<h4 id="thread-creation">Thread creation<a class="headerlink" href="#thread-creation" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/tutorial/essential/concurrency/runthread.html">Java Tutorials - Defining and Starting a Thread</a></p>
<p>An application that creates an instance of <span><span class="MathJax_Preview">\mathtt {Thread}</span><script type="math/tex">\mathtt {Thread}</script></span> must provide the code that will run in that thread. There are two ways to do this:</p>
<ul>
<li><em>Provide a Runnable object</em>. The <C>Runnable</C> interface defines a single method, <C>run</C>, meant to contain the code executed in the thread. The Runnable object is passed to the <C>Thread</C> constructor, as in the HelloRunnable example:</li>
</ul>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloRunnable</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&quot;Hello from a thread!&quot;</span><span class=o>);</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span> <span class=n>args</span><span class=o>[])</span> <span class=o>{</span>
        <span class=o>(</span><span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>HelloRunnable</span><span class=o>())).</span><span class=na>start</span><span class=o>();</span>
    <span class=o>}</span>

<span class=o>}</span>
</pre></div></p>
<ul>
<li><i>Subclass <C>Thread</C></i>. The <C>Thread</C> class itself implements <C>Runnable</C>, though its <C>run</C> method does nothing. An application can subclass <C>Thread</C>, providing its own implementation of <C>run</C>, as in the HelloThread example:</li>
</ul>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloThread</span> <span class=kd>extends</span> <span class=n>Thread</span> <span class=o>{</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&quot;Hello from a thread!&quot;</span><span class=o>);</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span> <span class=n>args</span><span class=o>[])</span> <span class=o>{</span>
        <span class=o>(</span><span class=k>new</span> <span class=n>HelloThread</span><span class=o>()).</span><span class=na>start</span><span class=o>();</span>
    <span class=o>}</span>

<span class=o>}</span>
</pre></div></p>
<p>Which of these idioms should you use? The first idiom, which employs a <C>Runnable</C> object, is more general, because the <C>Runnable</C> object can subclass a class other than <C>Thread</C>. </p>
<h4 id="synchronized-methods">Synchronized Methods<a class="headerlink" href="#synchronized-methods" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html">Java tutorials - Synchronized Methods</a></p>
<p>Making methods synchronized has two effects:</p>
<ul>
<li>First, it is NOT possible for two invocations of synchronized methods on the same object to interleave. When one thread is executing a synchronized method for an object, all other threads that invoke synchronized methods for the same object block (suspend execution) until the first thread is done with the object.</li>
<li>Second, when a synchronized method exits, it automatically establishes a happens-before relationship with any subsequent invocation of a synchronized method for the same object. This guarantees that changes to the state of the object are visible to all threads.</li>
</ul>
<h3 id="structured-locks">Structured Locks<a class="headerlink" href="#structured-locks" title="Permanent link">&para;</a></h3>
<p>Structured locks can be used to enforce mutual exclusion and avoid data races.</p>
<p>A major benefit of structured locks is that their acquire and release operations are <strong>implicit</strong>, since these operations are automatically performed by the Java runtime environment when entering and exiting the scope of a <C>synchronized</C> statement or method, even if an exception is thrown in the middle.</p>
<p><C>wait()</C> and <C>notify()</C> operations can be used to block and resume threads that need to wait for specific conditions.</p>
<h4 id="guarded-blocks">Guarded Blocks<a class="headerlink" href="#guarded-blocks" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html">Java Tutorials - Guarded Blocks</a></p>
<p><strong>Guarded block</strong> is the most common coordination idiom. It begins by polling a condition that before the block can proceed.</p>
<p>Suppose, for example <C>guardedJoy</C> is a method that must not proceed until a shared variable <C>joy</C> has been set by another thread. An efficient guard invokes <C>Object.wait</C> to suspend the current thread. The invocation of <C>wait</C> does not return until another thread has issued a notification that some special event may have occurred.</p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kt>void</span> <span class=nf>guardedJoy</span><span class=o>()</span> <span class=o>{</span>
    <span class=c1>// Simple loop guard. Wastes</span>
    <span class=c1>// processor time. Don&#39;t do this!</span>
    <span class=k>while</span><span class=o>(!</span><span class=n>joy</span><span class=o>)</span> <span class=o>{}</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&quot;Joy has been achieved!&quot;</span><span class=o>);</span>
<span class=o>}</span>
</pre></div></p>
<p>A more efficient guard invokes <C>Object.wait</C> to suspend the current thread. The invocation of wait does not return until another thread has issued a notification that some special event may have occurred — though not necessarily the event this thread is waiting for:</p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>guardedJoy</span><span class=o>()</span> <span class=o>{</span>
    <span class=c1>// This guard only loops once for each special event, which may not</span>
    <span class=c1>// be the event we&#39;re waiting for.</span>
    <span class=k>while</span><span class=o>(!</span><span class=n>joy</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>try</span> <span class=o>{</span>
            <span class=n>wait</span><span class=o>();</span>
        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{}</span>
    <span class=o>}</span>
    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&quot;Joy and efficiency have been achieved!&quot;</span><span class=o>);</span>
<span class=o>}</span>
</pre></div></p>
<p>When <C>wait</C> is invoked, the thread releases the lock and suspends execution. At some future time, another thread will acquire the same lock and invoke <C>Object.notifyAll</C>, informing all threads waiting on that lock that something important has happened:</p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>synchronized</span> <span class=nf>notifyJoy</span><span class=o>()</span> <span class=o>{</span>
    <span class=n>joy</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
    <span class=n>notifyAll</span><span class=o>();</span>
<span class=o>}</span>
</pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><C>notifyAll()</C> wakes up all threads that are waiting on the object's monitor.</p>
<p><C>notify</C> wakes up a single thread that is waiting on this object's monitor. </p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What's the <strong>useful</strong> difference between <C>notify()</C> and <C>notifyAll()</C>? [<a href="https://stackoverflow.com/questions/37026/java-notify-vs-notifyall-all-over-again">ref</a>]</p>
<p>Simply put, choosing one of them depends on why your threads are waiting to be notified.</p>
<p>In some cases, all waiting threads can take useful action once the wait finishes. Suppose a set of threads waiting for a certain task to finish; once the task has finished, all waiting threads can continue with their business. In such a case you would use <C>notifyAll()</C> to wake up all waiting threads at the same time.</p>
<p>Another case, for example mutually exclusive locking, only one of the waiting threads can do something useful after being notified (in this case acquire the lock). In such a case, you would rather use <C>notify()</C>. Properly implemented, you could use <C>notifyAll()</C> in this situation as well, but you would unnecessarily wake threads that can't do anything anyway.</p>
</div>
<p>Let's use guarded blocks to create a Producer-Consumer application. This kind of application shares data between two threads: the producer, that creates the data, and the consumer, that does something with it. The two threads communicate using a shared object. Coordination is essential: the consumer thread must not attempt to retrieve the data before the producer thread has delivered it, and the producer thread must not attempt to deliver new data if the consumer hasn't retrieved the old data.</p>
<p>The data is a series of text messages, which are shared through an object of type Drop.</p>
<div class=md-fenced-code-tabs id=tab-tab-group-5><input name=tab-group-5 type=radio id=tab-group-5-0_Java checked=checked class=code-tab data-lang=Java aria-controls=tab-group-5-0_Java-panel role=tab><label for=tab-group-5-0_Java class=code-tab-label data-lang=Java id=tab-group-5-0_Java-label>Drop</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-5-0_Java-panel aria-labelledby=tab-group-5-0_Java-label><div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Drop</span> <span class=o>{</span>
    <span class=c1>// Message sent from producer</span>
    <span class=c1>// to consumer.</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>message</span><span class=o>;</span>
    <span class=c1>// True if consumer should wait</span>
    <span class=c1>// for producer to send message,</span>
    <span class=c1>// false if producer should wait for</span>
    <span class=c1>// consumer to retrieve message.</span>
    <span class=kd>private</span> <span class=kt>boolean</span> <span class=n>empty</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>

    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=n>String</span> <span class=nf>take</span><span class=o>()</span> <span class=o>{</span>
        <span class=c1>// Wait until message is</span>
        <span class=c1>// available.</span>
        <span class=k>while</span> <span class=o>(</span><span class=n>empty</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>wait</span><span class=o>();</span>
            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{}</span>
        <span class=o>}</span>
        <span class=c1>// Toggle status.</span>
        <span class=n>empty</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
        <span class=c1>// Notify producer that</span>
        <span class=c1>// status has changed.</span>
        <span class=n>notifyAll</span><span class=o>();</span>
        <span class=k>return</span> <span class=n>message</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>put</span><span class=o>(</span><span class=n>String</span> <span class=n>message</span><span class=o>)</span> <span class=o>{</span>
        <span class=c1>// Wait until message has</span>
        <span class=c1>// been retrieved.</span>
        <span class=k>while</span> <span class=o>(!</span><span class=n>empty</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>try</span> <span class=o>{</span> 
                <span class=n>wait</span><span class=o>();</span>
            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{}</span>
        <span class=o>}</span>
        <span class=c1>// Toggle status.</span>
        <span class=n>empty</span> <span class=o>=</span> <span class=kc>false</span><span class=o>;</span>
        <span class=c1>// Store message.</span>
        <span class=k>this</span><span class=o>.</span><span class=na>message</span> <span class=o>=</span> <span class=n>message</span><span class=o>;</span>
        <span class=c1>// Notify consumer that status</span>
        <span class=c1>// has changed.</span>
        <span class=n>notifyAll</span><span class=o>();</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-5 type=radio id=tab-group-5-1_Java class=code-tab data-lang=Java aria-controls=tab-group-5-1_Java-panel role=tab><label for=tab-group-5-1_Java class=code-tab-label data-lang=Java id=tab-group-5-1_Java-label>Producer</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-5-1_Java-panel aria-labelledby=tab-group-5-1_Java-label><div class=codehilite><pre><span class=kn>import</span> <span class=nn>java.util.Random</span><span class=o>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Producer</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
    <span class=kd>private</span> <span class=n>Drop</span> <span class=n>drop</span><span class=o>;</span>

    <span class=kd>public</span> <span class=nf>Producer</span><span class=o>(</span><span class=n>Drop</span> <span class=n>drop</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>this</span><span class=o>.</span><span class=na>drop</span> <span class=o>=</span> <span class=n>drop</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>String</span> <span class=n>importantInfo</span><span class=o>[]</span> <span class=o>=</span> <span class=o>{</span>
            <span class=s>&quot;Mares eat oats&quot;</span><span class=o>,</span>
            <span class=s>&quot;Does eat oats&quot;</span><span class=o>,</span>
            <span class=s>&quot;Little lambs eat ivy&quot;</span><span class=o>,</span>
            <span class=s>&quot;A kid will eat ivy too&quot;</span>
        <span class=o>};</span>
        <span class=n>Random</span> <span class=n>random</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>();</span>

        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>importantInfo</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
            <span class=n>drop</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>importantInfo</span><span class=o>[</span><span class=n>i</span><span class=o>]);</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=n>random</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>5000</span><span class=o>));</span>
            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{}</span>
        <span class=o>}</span>
        <span class=n>drop</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&quot;DONE&quot;</span><span class=o>);</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-5 type=radio id=tab-group-5-2_Java class=code-tab data-lang=Java aria-controls=tab-group-5-2_Java-panel role=tab><label for=tab-group-5-2_Java class=code-tab-label data-lang=Java id=tab-group-5-2_Java-label>Consumer</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-5-2_Java-panel aria-labelledby=tab-group-5-2_Java-label><div class=codehilite><pre><span class=kn>import</span> <span class=nn>java.util.Random</span><span class=o>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Consumer</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>
    <span class=kd>private</span> <span class=n>Drop</span> <span class=n>drop</span><span class=o>;</span>

    <span class=kd>public</span> <span class=nf>Consumer</span><span class=o>(</span><span class=n>Drop</span> <span class=n>drop</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>this</span><span class=o>.</span><span class=na>drop</span> <span class=o>=</span> <span class=n>drop</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>Random</span> <span class=n>random</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>();</span>
        <span class=k>for</span> <span class=o>(</span><span class=n>String</span> <span class=n>message</span> <span class=o>=</span> <span class=n>drop</span><span class=o>.</span><span class=na>take</span><span class=o>();</span> <span class=o>!</span> <span class=n>message</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&quot;DONE&quot;</span><span class=o>);</span> <span class=n>message</span> <span class=o>=</span> <span class=n>drop</span><span class=o>.</span><span class=na>take</span><span class=o>())</span> <span class=o>{</span>
            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=s>&quot;MESSAGE RECEIVED: %s%n&quot;</span><span class=o>,</span> <span class=n>message</span><span class=o>);</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=n>random</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>5000</span><span class=o>));</span>
            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-5 type=radio id=tab-group-5-3_Java class=code-tab data-lang=Java aria-controls=tab-group-5-3_Java-panel role=tab><label for=tab-group-5-3_Java class=code-tab-label data-lang=Java id=tab-group-5-3_Java-label>Example</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-5-3_Java-panel aria-labelledby=tab-group-5-3_Java-label><div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ProducerConsumerExample</span> <span class=o>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Drop</span> <span class=n>drop</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Drop</span><span class=o>();</span>
        <span class=o>(</span><span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>Producer</span><span class=o>(</span><span class=n>drop</span><span class=o>))).</span><span class=na>start</span><span class=o>();</span>
        <span class=o>(</span><span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=k>new</span> <span class=n>Consumer</span><span class=o>(</span><span class=n>drop</span><span class=o>))).</span><span class=na>start</span><span class=o>();</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div></div>

<h4 id="intrinsic-locks-and-synchronization">Intrinsic Locks and Synchronization<a class="headerlink" href="#intrinsic-locks-and-synchronization" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html">Tutorial on Intrinsic Locks and Synchronization in Java</a></p>
<p>Every object has an <strong>intrinsic lock</strong>(also, <strong>monitor lock </strong>or <strong>monitor</strong>) associated with it.</p>
<p>By convention, a thread that needs exclusive and consistent access to an object's fields has to acquire the object's intrinsic lock before accessing them, and then release the intrinsic lock when it's done with them.</p>
<p><strong>Locks In Synchronized Methods</strong> </p>
<p>When a thread invokes a synchronized method, it automatically acquires the intrinsic lock for that method's object and releases it when the method returns. The lock release occurs even if the return was caused by an uncaught exception.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When a static synchronized method is invoked, since a static method is associated with a class, not an object, the thread acquires the intrinsic lock for the Class object associated with the class. Thus access to class's static fields is controlled by a lock that's distinct from the lock for any instance of the class.</p>
</div>
<p><strong>Synchronized Statements</strong></p>
<p>Synchronized statements must specify the object that provides the intrinsic lock:</p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kt>void</span> <span class=nf>addName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
    <span class=kd>synchronized</span><span class=o>(</span><span class=k>this</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>lastName</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
        <span class=n>nameCount</span><span class=o>++;</span>
    <span class=o>}</span>
    <span class=n>nameList</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
<span class=o>}</span>
</pre></div></p>
<p><strong>Reentrant Synchronization</strong></p>
<p>A thread can acquire a lock that it already owns. Allowing a thread to acquire the same lock more than once enables <strong>reentrant synchronization</strong>(重入同步).</p>
<h3 id="unstructured-locks">Unstructured Locks<a class="headerlink" href="#unstructured-locks" title="Permanent link">&para;</a></h3>
<h4 id="reentrantlock">ReentrantLock<a class="headerlink" href="#reentrantlock" title="Permanent link">&para;</a></h4>
<p>A <strong>ReentrantLock</strong>(重入锁) is <em>unstructured</em>, unlike synchronized constructs -- i.e. you don't need to use a block structure for locking and can even hold a lock across methods.</p>
<p>A reentrant mutual exclusion <C>Lock</C> with the same basic behavior and semantics as the implicit monitor lock accessed using synchronized methods and statements, but with extended capabilities.[<a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html#tryLock()">Java Doc-Class ReentrantLock</a>]</p>
<blockquote>
<p>A ReentrantLock is owned by the thread last successfully locking, but not yet unlocking it. A thread invoking lock will return, successfully acquiring the lock, when the lock is not owned by another thread.</p>
</blockquote>
<p>It is recommended practice to <em>always</em> immediately follow a call to <C>lock</C> with a <C>try</C> block, most typically in a before/after construction such as:</p>
<p> <div class=codehilite><pre><span class=kd>class</span> <span class=nc>X</span> <span class=o>{</span>
   <span class=kd>private</span> <span class=kd>final</span> <span class=n>ReentrantLock</span> <span class=n>lock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ReentrantLock</span><span class=o>();</span>
   <span class=c1>// ...</span>

   <span class=kd>public</span> <span class=kt>void</span> <span class=nf>m</span><span class=o>()</span> <span class=o>{</span>
     <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>  <span class=c1>// block until condition holds</span>
     <span class=k>try</span> <span class=o>{</span>
       <span class=c1>// ... method body</span>
     <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
       <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>()</span>
     <span class=o>}</span>
   <span class=o>}</span>
 <span class=o>}</span>
</pre></div></p>
<h4 id="interface-lock">Interface Lock<a class="headerlink" href="#interface-lock" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html">Java Doc-Interface Lock</a></p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Lock</span>
</pre></div></p>
<p><C>Lock</C> implementations provide more extensive locking operations than can be obtained using <C>synchronized</C> methods and statements. They allow more <em>flexible</em> structuring, may have quite different properties, and may support multiple associated <C>Condition</C> objects.</p>
<p><strong>Comparison with<C>synchronized</C> methods and statements</strong></p>
<p>The use of synchronized methods or statements provides access to the implicit monitor lock associated with every object, but forces all lock acquisition and release to occur in a <strong>block-structured way</strong>: when multiple locks are acquired they must be released in the opposite order, and all locks must be released in the same lexical scope in which they were acquired.</p>
<p>Implementations of the Lock interface enable the lock to be acquired and released in <strong>different scopes</strong>, and allowing multiple locks to be acquired and released in <strong>any order</strong>.</p>
<p>In most cases, the following idiom should be used:</p>
<p> <div class=codehilite><pre><span class=n>Lock</span> <span class=n>l</span> <span class=o>=</span> <span class=o>...;</span>
     <span class=n>l</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
     <span class=k>try</span> <span class=o>{</span>
         <span class=c1>// access the resource protected by this lock</span>
     <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
         <span class=n>l</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
     <span class=o>}</span>
</pre></div></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When locking and unlocking occur in different scopes, care must be taken to ensure that all code that is executed while the lock is held is protected by <C>try-finally</C> or <C>try-catch</C> to ensure that the lock is released when necessary.</p>
</div>
<h4 id="trylock">tryLock<a class="headerlink" href="#trylock" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html#tryLock()">Java Doc - tryLock</a></p>
<p><C>tryLock</C> acquires the lock <strong><em>only if it is free</em></strong> at the time of invocation.</p>
<p>A typical usage idiom for this method would be:</p>
<p> <div class=codehilite><pre>  <span class=n>Lock</span> <span class=n>lock</span> <span class=o>=</span> <span class=o>...;</span>
  <span class=k>if</span> <span class=o>(</span><span class=n>lock</span><span class=o>.</span><span class=na>tryLock</span><span class=o>())</span> <span class=o>{</span>
      <span class=k>try</span> <span class=o>{</span>
          <span class=c1>// manipulate protected state</span>
      <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
          <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
      <span class=o>}</span>
  <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
      <span class=c1>// perform alternative actions</span>
  <span class=o>}</span>
</pre></div></p>
<h3 id="liveness">Liveness<a class="headerlink" href="#liveness" title="Permanent link">&para;</a></h3>
<blockquote>
<p>A concurrent application's ability to execute in a timely manner is known as its <strong>liveness</strong>. </p>
</blockquote>
<p>Common forms of Liveness failure:</p>
<ul>
<li>The first is <strong>deadlock</strong>, in which all threads are blocked indefinitely, thereby preventing any forward progress. </li>
<li>The second is <strong>livelock</strong>, in which all threads repeatedly perform an interaction that prevents forward progress, e.g., an infinite “loop” of repeating lock acquire/release patterns. </li>
<li>The third is <strong>starvation</strong>, in which at least one thread is prevented from making any forward progress.</li>
</ul>
<p><a href="../osc/ch6.md/#8-liveness">Liveness failures in detail on OSC</a></p>
<h3 id="dining-philosophers">Dining Philosophers<a class="headerlink" href="#dining-philosophers" title="Permanent link">&para;</a></h3>
<p><a href="../osc/ch7.md/#the-dining-philosophers-problem">Dining Philosophers described in OSC</a></p>
<p>The philosophers follow the following protocol:</p>
<p> <div class=codehilite><pre><span class=k>while</span><span class=o>(</span><span class=kc>true</span><span class=o>)</span> <span class=o>{</span> 
    <span class=c1>// Initially, thinking about life, universe, and everything</span>
    <span class=n>think</span><span class=o>();</span>

    <span class=c1>// Take a break from thinking, hungry now</span>
    <span class=n>pick_up_left_fork</span><span class=o>();</span>
    <span class=n>pick_up_right_fork</span><span class=o>();</span>
    <span class=n>eat</span><span class=o>();</span>
    <span class=n>put_down_right_fork</span><span class=o>();</span>
    <span class=n>put_down_left_fork</span><span class=o>();</span>

    <span class=c1>// Not hungry anymore. Back to thinking!</span>
<span class=o>}</span>
</pre></div></p>
<h4 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h4>
<p><a href="https://www.baeldung.com/java-dining-philoshophers">The Dining Philosophers Problem in Java</a></p>
<p>We model each of our philosophers as classes that implement the Runnable interface so that we can run them as separate threads. Each Philosopher has access to two forks on his left and right sides. </p>
<p>Consider a situation in which all philosophers grab the left fork/chopsticks at the same time, leading to the deadlock.</p>
<p>Simply, We introduce the condition that makes the last philosopher reach for his right fork first, instead of the left. This breaks the circular wait condition and we can avert the deadlock.</p>
<div class=md-fenced-code-tabs id=tab-tab-group-12><input name=tab-group-12 type=radio id=tab-group-12-0_Java checked=checked class=code-tab data-lang=Java aria-controls=tab-group-12-0_Java-panel role=tab><label for=tab-group-12-0_Java class=code-tab-label data-lang=Java id=tab-group-12-0_Java-label>Diningphilosopherstable</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-12-0_Java-panel aria-labelledby=tab-group-12-0_Java-label><div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DiningPhilosophersTable</span> <span class=o>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>numPhilosophers</span><span class=o>;</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>numForks</span><span class=o>;</span>

    <span class=kd>public</span> <span class=nf>DiningPhilosophersTable</span><span class=o>(</span><span class=kt>int</span> <span class=n>num</span><span class=o>){</span>
        <span class=k>this</span><span class=o>.</span><span class=na>numPhilosophers</span> <span class=o>=</span> <span class=n>num</span><span class=o>;</span>
        <span class=k>this</span><span class=o>.</span><span class=na>numForks</span> <span class=o>=</span> <span class=n>num</span><span class=o>;</span>

        <span class=n>Philosopher</span><span class=o>[]</span> <span class=n>philosophers</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Philosopher</span><span class=o>[</span><span class=n>numPhilosophers</span><span class=o>];</span>
        <span class=n>Fork</span><span class=o>[]</span> <span class=n>forks</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Fork</span><span class=o>[</span><span class=n>numForks</span><span class=o>];</span> <span class=c1>// Initialize array of forks</span>

        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>numForks</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
            <span class=n>forks</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Fork</span><span class=o>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=o>);</span>
        <span class=o>}</span>

        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>numPhilosophers</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
            <span class=c1>// avoid deadlock: the last philosopher picks up the right fork first</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>philosophers</span><span class=o>.</span><span class=na>length</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>philosophers</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Philosopher</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>i</span><span class=o>),</span> 
                    <span class=n>forks</span><span class=o>[(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=o>)</span> <span class=o>/</span> <span class=n>numForks</span><span class=o>],</span> <span class=n>forks</span><span class=o>[</span><span class=n>i</span><span class=o>]);</span>
            <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                <span class=n>philosophers</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Philosopher</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>i</span><span class=o>),</span> 
                    <span class=n>forks</span><span class=o>[</span><span class=n>i</span><span class=o>],</span> <span class=n>forks</span><span class=o>[(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=o>)</span> <span class=o>/</span> <span class=n>numForks</span><span class=o>]);</span>
            <span class=o>}</span>
        <span class=o>}</span>

        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>numPhilosophers</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
            <span class=n>Thread</span> <span class=n>thread</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Thread</span><span class=o>(</span><span class=n>philosophers</span><span class=o>[</span><span class=n>i</span><span class=o>],</span> <span class=s>&quot;Philosopher&quot;</span><span class=o>+</span><span class=n>Integer</span><span class=o>.</span><span class=na>toString</span><span class=o>(</span><span class=n>i</span><span class=o>));</span>
            <span class=n>thread</span><span class=o>.</span><span class=na>start</span><span class=o>();</span>
        <span class=o>}</span> <span class=c1>// end for</span>
    <span class=o>}</span> <span class=c1>// end constructor</span>


    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>DiningPhilosophersTable</span> <span class=n>dining</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DiningPhilosophersTable</span><span class=o>(</span><span class=mi>5</span><span class=o>);</span>
    <span class=o>}</span> <span class=c1>// end main</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-12 type=radio id=tab-group-12-1_Java class=code-tab data-lang=Java aria-controls=tab-group-12-1_Java-panel role=tab><label for=tab-group-12-1_Java class=code-tab-label data-lang=Java id=tab-group-12-1_Java-label>Philosopher</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-12-1_Java-panel aria-labelledby=tab-group-12-1_Java-label><div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Philosopher</span> <span class=kd>implements</span> <span class=n>Runnable</span> <span class=o>{</span>

    <span class=kd>private</span> <span class=n>Fork</span> <span class=n>_left_fork</span><span class=o>;</span>
    <span class=kd>private</span> <span class=n>Fork</span> <span class=n>_right_fork</span><span class=o>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>_name</span><span class=o>;</span>

    <span class=kd>public</span> <span class=nf>Philosopher</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>Fork</span> <span class=n>left_fork</span><span class=o>,</span> <span class=n>Fork</span> <span class=n>right_fork</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>_name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
        <span class=n>_left_fork</span> <span class=o>=</span> <span class=n>left_fork</span><span class=o>;</span>
        <span class=n>_right_fork</span> <span class=o>=</span> <span class=n>right_fork</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>doAction</span><span class=o>(</span><span class=n>String</span> <span class=n>action</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>try</span> <span class=o>{</span>
            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Thread</span><span class=o>.</span><span class=na>currentThread</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&quot; : &quot;</span> <span class=o>+</span> <span class=n>action</span><span class=o>);</span>
            <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(((</span><span class=kt>int</span><span class=o>)</span> <span class=o>(</span><span class=n>Math</span><span class=o>.</span><span class=na>random</span><span class=o>()</span> <span class=o>*</span> <span class=mi>500</span><span class=o>)));</span>
        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>InterruptedException</span> <span class=n>ex</span><span class=o>){</span>
            <span class=n>ex</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
        <span class=o>}</span>
    <span class=o>}</span>

    <span class=c1>// Philosopher eats</span>
    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>eat</span><span class=o>()</span> <span class=o>{</span>
        <span class=kd>synchronized</span> <span class=o>(</span><span class=n>_left_fork</span><span class=o>)</span> <span class=o>{</span>
            <span class=kd>synchronized</span> <span class=o>(</span><span class=n>_right_fork</span><span class=o>)</span> <span class=o>{</span>
                <span class=n>doAction</span><span class=o>(</span><span class=s>&quot;Eating, Using forks &quot;</span> <span class=o>+</span> <span class=n>_left_fork</span><span class=o>.</span><span class=na>get_id</span><span class=o>()</span> <span class=o>+</span> <span class=s>&quot;, &quot;</span><span class=o>+</span> <span class=n>_right_fork</span><span class=o>.</span><span class=na>get_id</span><span class=o>());</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>

    <span class=c1>// Philosopher thinks</span>
    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>think</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>doAction</span><span class=o>(</span><span class=s>&quot;Thinking&quot;</span><span class=o>);</span>

    <span class=o>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=o>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=mi>10</span><span class=o>;</span> <span class=n>i</span><span class=o>++){</span>
            <span class=n>eat</span><span class=o>();</span>
            <span class=n>think</span><span class=o>();</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-12 type=radio id=tab-group-12-2_Java class=code-tab data-lang=Java aria-controls=tab-group-12-2_Java-panel role=tab><label for=tab-group-12-2_Java class=code-tab-label data-lang=Java id=tab-group-12-2_Java-label>Fork</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-12-2_Java-panel aria-labelledby=tab-group-12-2_Java-label><div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Fork</span> <span class=o>{</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kt>int</span> <span class=n>_id</span><span class=o>;</span>

    <span class=kd>public</span> <span class=nf>Fork</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>this</span><span class=o>.</span><span class=na>_id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>get_id</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>_id</span><span class=o>;</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div></div>

<h3 id="example-list">Example: List<a class="headerlink" href="#example-list" title="Permanent link">&para;</a></h3>
<p>Using <C>ReentrantLock</C>, <C>ReentrantReadWriteLock</C>, <C>synchronized</C> method to synchronize list methods(add, remove, and contains).</p>
<ul>
<li>Using <C>ReentrantLock</C> for Class  <C>CoarseLists</C>.</li>
<li>Using <C>ReentrantReadWriteLock</C> for Class  <C>RWCoarseList</C>.</li>
<li>Using <C>synchronized</C> method for Class  <C>SyncList</C>.</li>
<li>Class <C>ListSet</C> is an abstract class.</li>
</ul>
<div class=md-fenced-code-tabs id=tab-tab-group-13><input name=tab-group-13 type=radio id=tab-group-13-0_Java checked=checked class=code-tab data-lang=Java aria-controls=tab-group-13-0_Java-panel role=tab><label for=tab-group-13-0_Java class=code-tab-label data-lang=Java id=tab-group-13-0_Java-label>Coarselist</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-13-0_Java-panel aria-labelledby=tab-group-13-0_Java-label><div class=codehilite><pre><span class=kn>import</span> <span class=nn>java.util.concurrent.locks.ReentrantLock</span><span class=o>;</span>
<span class=kn>import</span> <span class=nn>java.util.concurrent.locks.ReentrantReadWriteLock</span><span class=o>;</span>

<span class=cm>/**</span>
<span class=cm> * Wrapper class for two lock-based concurrent list implementations.</span>
<span class=cm> */</span>
<span class=kd>public</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>CoarseLists</span> <span class=o>{</span>
    <span class=cm>/**</span>
<span class=cm>     * An implementation of the ListSet interface that uses Java locks to</span>
<span class=cm>     * protect against concurrent accesses.</span>
<span class=cm>     *</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>CoarseList</span> <span class=kd>extends</span> <span class=n>ListSet</span> <span class=o>{</span>


        <span class=kd>private</span> <span class=kd>final</span> <span class=n>ReentrantLock</span> <span class=n>lock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ReentrantLock</span><span class=o>();</span>
        <span class=cm>/**</span>
<span class=cm>         * Default constructor.</span>
<span class=cm>         */</span>
        <span class=kd>public</span> <span class=nf>CoarseList</span><span class=o>()</span> <span class=o>{</span>
            <span class=kd>super</span><span class=o>();</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>add</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>

                <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
                    <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                    <span class=kd>final</span> <span class=n>Entry</span> <span class=n>entry</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Entry</span><span class=o>(</span><span class=n>object</span><span class=o>);</span>
                    <span class=n>entry</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>entry</span><span class=o>;</span>
                    <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
                <span class=o>}</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>remove</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>

                <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
                    <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                    <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                    <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
                <span class=o>}</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>contains</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>lock</span><span class=o>.</span><span class=na>lock</span><span class=o>();</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>
                <span class=k>return</span> <span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>);</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * An implementation of the ListSet interface that uses Java read-write</span>
<span class=cm>     * locks to protect against concurrent accesses.</span>
<span class=cm>     *</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>RWCoarseList</span> <span class=kd>extends</span> <span class=n>ListSet</span> <span class=o>{</span>

        <span class=kd>private</span> <span class=kd>final</span> <span class=n>ReentrantReadWriteLock</span> <span class=n>lock</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ReentrantReadWriteLock</span><span class=o>();</span>

        <span class=cm>/**</span>
<span class=cm>         * Default constructor.</span>
<span class=cm>         */</span>
        <span class=kd>public</span> <span class=nf>RWCoarseList</span><span class=o>()</span> <span class=o>{</span>
            <span class=kd>super</span><span class=o>();</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>add</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>writeLock</span><span class=o>().</span><span class=na>lock</span><span class=o>();</span>

                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>

                <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
                    <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                    <span class=kd>final</span> <span class=n>Entry</span> <span class=n>entry</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Entry</span><span class=o>(</span><span class=n>object</span><span class=o>);</span>
                    <span class=n>entry</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>entry</span><span class=o>;</span>
                    <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
                <span class=o>}</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>writeLock</span><span class=o>().</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>remove</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>writeLock</span><span class=o>().</span><span class=na>lock</span><span class=o>();</span>
                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>

                <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
                    <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                    <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
                <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
                    <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
                <span class=o>}</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>writeLock</span><span class=o>().</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>

        <span class=cm>/**</span>
<span class=cm>         * {@inheritDoc}</span>
<span class=cm>         *</span>
<span class=cm>         */</span>
        <span class=nd>@Override</span>
        <span class=kt>boolean</span> <span class=nf>contains</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
            <span class=k>try</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>readLock</span><span class=o>().</span><span class=na>lock</span><span class=o>();</span>
                <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
                <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

                <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
                    <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
                    <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
                <span class=o>}</span>
                <span class=k>return</span> <span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>);</span>
            <span class=o>}</span> <span class=k>finally</span> <span class=o>{</span>
                <span class=n>lock</span><span class=o>.</span><span class=na>readLock</span><span class=o>().</span><span class=na>unlock</span><span class=o>();</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-13 type=radio id=tab-group-13-1_Java class=code-tab data-lang=Java aria-controls=tab-group-13-1_Java-panel role=tab><label for=tab-group-13-1_Java class=code-tab-label data-lang=Java id=tab-group-13-1_Java-label>Synclist</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-13-1_Java-panel aria-labelledby=tab-group-13-1_Java-label><div class=codehilite><pre><span class=cm>/**</span>
<span class=cm> *  Class SyncList implements a thread-safe sorted list data structure that</span>
<span class=cm> *  supports contains(), add() and remove() methods.</span>
<span class=cm> *</span>
<span class=cm> *  Thread safety is guaranteed by declaring each of the methods to be</span>
<span class=cm> *  synchronized.</span>
<span class=cm> */</span>
<span class=kd>public</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>SyncList</span> <span class=kd>extends</span> <span class=n>ListSet</span> <span class=o>{</span>
    <span class=cm>/**</span>
<span class=cm>     * Constructor.</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=nf>SyncList</span><span class=o>()</span> <span class=o>{</span>
        <span class=kd>super</span><span class=o>();</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * {@inheritDoc}</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>boolean</span> <span class=nf>contains</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
        <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

        <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
            <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
        <span class=o>}</span>
        <span class=k>return</span> <span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>);</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * {@inheritDoc}</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>boolean</span> <span class=nf>add</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
        <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

        <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
            <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
        <span class=o>}</span>

        <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
            <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
            <span class=kd>final</span> <span class=n>Entry</span> <span class=n>entry</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Entry</span><span class=o>(</span><span class=n>object</span><span class=o>);</span>
            <span class=n>entry</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
            <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>entry</span><span class=o>;</span>
            <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
        <span class=o>}</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * {@inheritDoc}</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=kd>synchronized</span> <span class=kt>boolean</span> <span class=nf>remove</span><span class=o>(</span><span class=kd>final</span> <span class=n>Integer</span> <span class=n>object</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Entry</span> <span class=n>pred</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>;</span>
        <span class=n>Entry</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>pred</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>

        <span class=k>while</span> <span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>.</span><span class=na>compareTo</span><span class=o>(</span><span class=n>object</span><span class=o>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
            <span class=n>pred</span> <span class=o>=</span> <span class=n>curr</span><span class=o>;</span>
            <span class=n>curr</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
        <span class=o>}</span>

        <span class=k>if</span> <span class=o>(</span><span class=n>object</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=n>curr</span><span class=o>.</span><span class=na>object</span><span class=o>))</span> <span class=o>{</span>
            <span class=n>pred</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=n>curr</span><span class=o>.</span><span class=na>next</span><span class=o>;</span>
            <span class=k>return</span> <span class=kc>true</span><span class=o>;</span>
        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
            <span class=k>return</span> <span class=kc>false</span><span class=o>;</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></div><input name=tab-group-13 type=radio id=tab-group-13-2_Java class=code-tab data-lang=Java aria-controls=tab-group-13-2_Java-panel role=tab><label for=tab-group-13-2_Java class=code-tab-label data-lang=Java id=tab-group-13-2_Java-label>Listset</label><div class=code-tabpanel role=tabpanel data-lang=Java id=tab-group-13-2_Java-panel aria-labelledby=tab-group-13-2_Java-label><div class=codehilite><pre><span class=cm>/**</span>
<span class=cm> * Lists that support this interface must be able to add</span>
<span class=cm> * objects, remove objects, and test for existence of an object. These methods</span>
<span class=cm> * are required to maintain a sorted list of items internally with no</span>
<span class=cm> * duplicates.</span>
<span class=cm> */</span>
<span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>ListSet</span> <span class=o>{</span>
    <span class=cm>/**</span>
<span class=cm>     * Starting entry of this concurrent list.</span>
<span class=cm>     */</span>
    <span class=kd>protected</span> <span class=kd>final</span> <span class=n>Entry</span> <span class=n>head</span><span class=o>;</span>

    <span class=cm>/**</span>
<span class=cm>     * Default constructor.</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=nf>ListSet</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>this</span><span class=o>.</span><span class=na>head</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Entry</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>MIN_VALUE</span><span class=o>);</span>
        <span class=k>this</span><span class=o>.</span><span class=na>head</span><span class=o>.</span><span class=na>next</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Entry</span><span class=o>(</span><span class=n>Integer</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>);</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * Getter for the head of the list.</span>
<span class=cm>     *</span>
<span class=cm>     * @return The head of this list.</span>
<span class=cm>     */</span>
    <span class=kd>public</span> <span class=n>Entry</span> <span class=nf>getHead</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>head</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=cm>/**</span>
<span class=cm>     * Add an integer value to this sorted list, ensuring uniqueness. This</span>
<span class=cm>     * method must use ListSet.head as the head of the list.</span>
<span class=cm>     *</span>
<span class=cm>     * @param o The integer to add.</span>
<span class=cm>     * @return false if this value already exists in the list, true otherwise</span>
<span class=cm>     */</span>
    <span class=kd>abstract</span> <span class=kt>boolean</span> <span class=nf>add</span><span class=o>(</span><span class=n>Integer</span> <span class=n>o</span><span class=o>);</span>

    <span class=cm>/**</span>
<span class=cm>     * Remove an integer value from this list if it exists. This method must use</span>
<span class=cm>     * ListSet.head as the head of the list.</span>
<span class=cm>     *</span>
<span class=cm>     * @param o The integer to remove.</span>
<span class=cm>     * @return true if this value is found in the list and successfully removed,</span>
<span class=cm>     *         false otherwise</span>
<span class=cm>     */</span>
    <span class=kd>abstract</span> <span class=kt>boolean</span> <span class=nf>remove</span><span class=o>(</span><span class=n>Integer</span> <span class=n>o</span><span class=o>);</span>

    <span class=cm>/**</span>
<span class=cm>     * Check if this list contains the provided value. This method must use</span>
<span class=cm>     * ListSet.head as the head of the list.</span>
<span class=cm>     *</span>
<span class=cm>     * @param o The integer to check for.</span>
<span class=cm>     * @return true if this list contains the target value, false otherwise.</span>
<span class=cm>     */</span>
    <span class=kd>abstract</span> <span class=kt>boolean</span> <span class=nf>contains</span><span class=o>(</span><span class=n>Integer</span> <span class=n>o</span><span class=o>);</span>
<span class=o>}</span>
</pre></div></div></div>

<h3 id="java-volatile">Java Volatile<a class="headerlink" href="#java-volatile" title="Permanent link">&para;</a></h3>
<p>The Java <C>volatile</C> keyword is used to mark a Java variable as "being stored in main memory". More precisely that means, that every read of a volatile variable will be read from the computer's main memory, and not from the CPU cache, and that every write to a volatile variable will be written to main memory, and not just to the CPU cache.</p>
<p>http://tutorials.jenkov.com/java-concurrency/volatile.html#variable-visibility-problems</p>
<p>https://stackoverflow.com/questions/106591/do-you-ever-use-the-volatile-keyword-in-java</p>
<p>https://www.cnblogs.com/chengxiao/p/6528109.html</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../extra_javascript/tabhack.js" defer></script>
        <script src="../../../extra_javascript/baidu.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
