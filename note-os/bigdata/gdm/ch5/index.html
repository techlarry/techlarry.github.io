<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note-os/bigdata/gdm/ch5/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Chapter 5: 概率和朴素贝叶斯 - Zhenhua's Notes</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../../extra_css/custom.css" rel="stylesheet">
        <link href="../../../extra_css/custom.js" rel="stylesheet">
        <link href="../../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../../extra_css/theme.css" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Zhenhua's Notes</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Algorithm <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../algorithm/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmPrinceton</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/unionfind/">Topic 1: UnionFind</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/stackqueue/">Topic 2: StackQueue</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/sort/">Topic 3: Sort</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/priorityqueue/">Topic 4: PriorityQueues</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/symboltable/">Topic 5: Symbol Tables</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/bst/">Topic 6: Balanced Search Trees</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/hashtable/">Topic 7: Hash Table</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/graph/">Topic 8: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/mst_shortestpath/">Topic 9: Minimum Spanning Tree and Shortest Path</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/stringsort/">Topic 11: String Sort</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/tries/">Topic 12: Tries</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmStanford</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmStanford/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/dynamicprogramming/">Topic: Dynammic Programming</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/heap/">Topic: Heap</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/graph/">Topic: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/greedy/">Topic: Greedy Algorithm</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/hashtable/">Topic: Hash Table</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CS61B</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/cs61b/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab1/">Lab1: javac, java, git</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab2/">Lab2: Unit Testing with JUnit and IntLists</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab3/">Lab3: Unit Testing with JUnit, Debugging</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">SWORD</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/sword/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/sword/solution/">剑指Offer题解</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">OS <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../os/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">OSC</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../os/osc/">Contents</a>
</li>
            
<li >
    <a href="../../../os/osc/ch1/">Chapter 1: Introduction </a>
</li>
            
<li >
    <a href="../../../os/osc/ch2/">Chapter 2: Operating System structures</a>
</li>
            
<li >
    <a href="../../../os/osc/ch3/">Chapter 3: Processes</a>
</li>
            
<li >
    <a href="../../../os/osc/ch4/">Chapter 4: Threads and Concurrency</a>
</li>
            
<li >
    <a href="../../../os/osc/ch5/">Chapter 5: CPU Scheduling</a>
</li>
            
<li >
    <a href="../../../os/osc/ch6/">Chapter 6: Synchronization Tools</a>
</li>
            
<li >
    <a href="../../../os/osc/ch7/">Chapter 7: Synchronization Examples</a>
</li>
            
<li >
    <a href="../../../os/osc/ch8/">Chapter 8: Deadlocks</a>
</li>
            
<li >
    <a href="../../../os/osc/ch9/">Chapter 9: Main Memory</a>
</li>
            
<li >
    <a href="../../../os/osc/ch10/">Chapter 10: Virtual Memory</a>
</li>
            
<li >
    <a href="../../../os/osc/ch11/">Chapter 11: Mass-Storage Structure</a>
</li>
            
<li >
    <a href="../../../os/osc/ch13/">Chapter 13: File-System Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CSAPP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../os/csapp/">Contents</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch1/">Chapter 1: 计算机系统漫游</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch2/">Chapter 2: 信息的表示和处理</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch3/">Chapter 3: 程序的机器级表示</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch4/">Chapter 4: 处理器体系结构</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch5/">Chapter 5: 优化程序性能</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch6/">Chapter 6: 存储器层次结构</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch7/">Chapter 7: 链接</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch8/">Chapter 8: 异常控制流</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch9/">Chapter 9: 虚拟内存</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch10/">Chapter 10: 系统级I/O</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch11/">Chapter 11: 网络编程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">DataBase <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../database/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MySql</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../database/mysql/">Contents</a>
</li>
            
<li >
    <a href="../../../database/mysql/LearningMySQLandMariaDB/">Chapter Learning MySQL and MariaDB</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Java <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../java/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfj/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch1/">Chapter 1: Dive in A Quick Dip</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch2/">Chapter 2: Classes and Objects</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch3/">Chapter 3: Primitives and References</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch4/">Chapter 4: Methods use Instance Variables</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch5/">Chapter 5: Writing a Program</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch6/">Chapter 6: Get to Know the Java API</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch7/">Chapter 7: Inheritance and Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch8/">Chapter 8: Interfaces and Abstract Classes</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch9/">Chapter 9: Constructors and Garbage Collection</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch10/">Chapter 10: Numbers and Statics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch11/">Chapter 11: Exception Handling</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch12/">Chapter 12: Getting GUI</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch13/">Chapter 13: Using Swing</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch14/">Chapter 14: Serialization and File I/O</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch15/">Chapter 15: Networking and Threads</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch16/">Chapter 16: Collections and Generics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch17/">Chapter 17: Packages, Jars and Deployment</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch18/">Chapter 18: Remote deploy with RMI</a>
</li>
            
<li >
    <a href="../../../java/hfj/Appendix/">Appendix: The Top Ten Topics</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFDP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfdp/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch1/">Chapter 1: Strategy Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch2/">Chapter 2: Observer Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch3/">Chapter 3: Decorator Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch4/">Chapter 4: Factory Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch5/">Chapter 5: Singleton Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch6/">Chapter 6: Command Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch7/">Chapter 7: Adapter and Facade Patterns</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch8/">Chapter 8: Template Method Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch9/">Chapter 9: Iterator and Composite Patterns</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MultiThreading</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/multithreading/">Contents</a>
</li>
            
<li >
    <a href="../../../java/multithreading/pre1/">序章1 Java线程</a>
</li>
            
<li >
    <a href="../../../java/multithreading/pre2/">序章2 多线程程序的评价标准</a>
</li>
            
<li >
    <a href="../../../java/multithreading/ch1/">第1章 Single Threaded Execution模式</a>
</li>
            
<li >
    <a href="../../../java/multithreading/ch1/">第2章 Immutable模式</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TIJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/tij/">Contents</a>
</li>
            
<li >
    <a href="../../../java/tij/ch1/">Chapter 1: Introduction</a>
</li>
            
<li >
    <a href="../../../java/tij/ch2/">Chapter 2: Introduction to Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch3/">Chapter 3: Everything is an Object</a>
</li>
            
<li >
    <a href="../../../java/tij/ch4/">Chapter 4: Opertors</a>
</li>
            
<li >
    <a href="../../../java/tij/ch5/">Chapter 5: Controlling Execution</a>
</li>
            
<li >
    <a href="../../../java/tij/ch6/">Chapter 6: Initialization & Cleanup</a>
</li>
            
<li >
    <a href="../../../java/tij/ch7/">Chapter 7: Access Control</a>
</li>
            
<li >
    <a href="../../../java/tij/ch8/">Chapter 8: Reusing Clases</a>
</li>
            
<li >
    <a href="../../../java/tij/ch9/">Chapter 9: Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/tij/ch10/">Chapter 10: Interfaces</a>
</li>
            
<li >
    <a href="../../../java/tij/ch11/">Chapter 11: Inner Classes</a>
</li>
            
<li >
    <a href="../../../java/tij/ch12/">Chapter 12: Holding Your Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch13/">Chapter 13: Error Handling with Exceptions</a>
</li>
            
<li >
    <a href="../../../java/tij/ch14/">Chapter 14: Strings</a>
</li>
            
<li >
    <a href="../../../java/tij/ch15/">Chapter 15: Type Information</a>
</li>
            
<li >
    <a href="../../../java/tij/ch16/">Chapter 16: Generics</a>
</li>
            
<li >
    <a href="../../../java/tij/ch17/">Chapter 17: Arrays</a>
</li>
            
<li >
    <a href="../../../java/tij/ch18/">Chapter 18: Containers in Depth</a>
</li>
            
<li >
    <a href="../../../java/tij/ch19/">Chapter 19: I/O</a>
</li>
            
<li >
    <a href="../../../java/tij/ch20/">Chapter 20: Enumerated Types</a>
</li>
            
<li >
    <a href="../../../java/tij/ch21/">Chapter 21: Annotations</a>
</li>
            
<li >
    <a href="../../../java/tij/ch22/">Chapter 22: Concurrency</a>
</li>
            
<li >
    <a href="../../../java/tij/ch23/">Chapter 23: Graphical User Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">UJVM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/ujvm/">Contents</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch1/">Chapter 1 : 走进Java</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch2/">Chapter 2 : Java内存区域与内存溢出正常</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch3/">Chapter 3 : 垃圾收集器与内存分配策略</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch4/">Chapter 4 : 虚拟机性能监控与故障处理工具</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch5/">Chapter 5 : 调优案例分析与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch6/">Chapter 6 : 类文件结构</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch7/">Chapter 7 : 虚拟机类加载机制</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch8/">Chapter 8 : 虚拟机字节码执行引擎</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch9/">Chapter 9 : 类加载及执行子系统的案例与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch10/">Chapter 10 : 早期(编译期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch11/">Chapter 11 : 晚期(运行期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch12/">Chapter 12 : Java内存模型与线程</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch13/">Chapter 13 : 线程安全与锁优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/AppendixC/">Appendix HotSpot虚拟机主要参数列表</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">BigData <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HADOOP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../hadoop/">Contents</a>
</li>
            
<li >
    <a href="../../hadoop/ch1/">Chapter 1: Meet Hadoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch2/">Chapter 2: MapReduce</a>
</li>
            
<li >
    <a href="../../hadoop/ch3/">Chapter 3: The Hadoop Distributed FileSystem</a>
</li>
            
<li >
    <a href="../../hadoop/ch4/">Chapter 4: YARN</a>
</li>
            
<li >
    <a href="../../hadoop/ch5/">Chapter 5: Hadoop I/O</a>
</li>
            
<li >
    <a href="../../hadoop/ch6/">Chapter 6: Developing a MapReduce Application</a>
</li>
            
<li >
    <a href="../../hadoop/ch7/">Chapter 7: How MapReduce Works</a>
</li>
            
<li >
    <a href="../../hadoop/ch8/">Chapter 8: MapReduce Types and Formats</a>
</li>
            
<li >
    <a href="../../hadoop/ch9/">Chapter 9: MapReduce Features</a>
</li>
            
<li >
    <a href="../../hadoop/ch10/">Chapter 10: Setting Up a Hadoop Cluster</a>
</li>
            
<li >
    <a href="../../hadoop/ch11/">Chapter 11: Adminstering Hadoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch12/">Chapter 12: Avro</a>
</li>
            
<li >
    <a href="../../hadoop/ch13/">Chapter 13: Parquet</a>
</li>
            
<li >
    <a href="../../hadoop/ch14/">Chapter 14: Flume</a>
</li>
            
<li >
    <a href="../../hadoop/ch15/">Chapter 15: Sqoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch16/">Chapter 16: Pig</a>
</li>
            
<li >
    <a href="../../hadoop/ch17/">Chapter 17: Hive</a>
</li>
            
<li >
    <a href="../../hadoop/ch18/">Chapter 18: Crunch</a>
</li>
            
<li >
    <a href="../../hadoop/ch19/">Chapter 19: Spark</a>
</li>
            
<li >
    <a href="../../hadoop/ch20/">Chapter 20: HBase</a>
</li>
            
<li >
    <a href="../../hadoop/ch21/">Chapter 21: ZooKeeper</a>
</li>
            
<li >
    <a href="../../hadoop/ch22/">Chapter 22: Composable Data at Center</a>
</li>
            
<li >
    <a href="../../hadoop/ch23/">Chapter 23: Biological Data Science: Saving Lives with Software</a>
</li>
            
<li >
    <a href="../../hadoop/ch24/">Chapter 24: Cascading</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Spark</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../spark/">Contents</a>
</li>
            
<li >
    <a href="../../spark/ch1/">Chapter 1: Introduction to Data Analysis with Spark</a>
</li>
            
<li >
    <a href="../../spark/ch2/">Chapter 2: Downloading Spark and Getting Started</a>
</li>
            
<li >
    <a href="../../spark/ch3/">Chapter 3: Programming with RDDs</a>
</li>
            
<li >
    <a href="../../spark/ch4/">Chapter 4: Working with Key/Value Pairs</a>
</li>
            
<li >
    <a href="../../spark/ch5/">Chapter 5: Loading and Saving Your Data</a>
</li>
            
<li >
    <a href="../../spark/ch6/">Chapter 6: Advanced Spark Programming</a>
</li>
            
<li >
    <a href="../../spark/ch7/">Chapter 7: Running on a Cluster</a>
</li>
            
<li >
    <a href="../../spark/ch8/">Chapter 8: Tuning and Debugging Spark</a>
</li>
            
<li >
    <a href="../../spark/ch9/">Chapter 9: Spark SQL</a>
</li>
            
<li >
    <a href="../../spark/ch10/">Chapter 10: Spark Streaming</a>
</li>
            
<li >
    <a href="../../spark/ch11/">Chapter 11: Machine Learning with MLlib</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">GDM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../">Contents</a>
</li>
            
<li >
    <a href="../ch1/">Chapter 1: 推荐系统入门</a>
</li>
            
<li >
    <a href="../ch2/">Chapter 2: 隐式评价和基于物品的过滤算法</a>
</li>
            
<li >
    <a href="../ch3/">Chapter 3: 分类</a>
</li>
            
<li >
    <a href="../ch4/">Chapter 4: 进一步探索分类</a>
</li>
            
<li class="active">
    <a href="./">Chapter 5: 概率和朴素贝叶斯</a>
</li>
            
<li >
    <a href="../ch6/">Chapter 6: 朴素贝叶斯和文本数据</a>
</li>
            
<li >
    <a href="../ch7/">Chapter 7: 聚类</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MLIA</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../mlia/">Contents</a>
</li>
            
<li >
    <a href="../../mlia/ch1/">Chapter 1: 机器学习基础</a>
</li>
            
<li >
    <a href="../../mlia/ch2/">Chapter 2: k-近邻算法</a>
</li>
            
<li >
    <a href="../../mlia/ch3/">Chapter 3: 决策树</a>
</li>
            
<li >
    <a href="../../mlia/ch4/">Chapter 4: 基于概率论的分类方法：朴素贝叶斯</a>
</li>
            
<li >
    <a href="../../mlia/ch5/">Chapter 5: Logistic回归</a>
</li>
            
<li >
    <a href="../../mlia/ch6/">Chapter 6: 支持向量机</a>
</li>
            
<li >
    <a href="../../mlia/ch7/">Chapter 7: 利用AdaBoost元算法提高分类性能</a>
</li>
            
<li >
    <a href="../../mlia/ch8/">Chapter 8: 预测数值型数据：回归</a>
</li>
            
<li >
    <a href="../../mlia/ch9/">Chapter 9: 树回归</a>
</li>
            
<li >
    <a href="../../mlia/ch10/">Chapter 10: 利用Ｋ-均值聚类算法对未标注数据分组</a>
</li>
            
<li >
    <a href="../../mlia/ch11/">Chapter 11: 使用Apriori算法进行关联分析</a>
</li>
            
<li >
    <a href="../../mlia/ch11/">Chapter 12: 使用FP-growth算法来高效发现频繁项集</a>
</li>
            
<li >
    <a href="../../mlia/ch13/">Chapter 13: 利用PCA来简化数据</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Crawler</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../crawler/">Contents</a>
</li>
            
<li >
    <a href="../../crawler/ch1/">Chapter 1: 开发环境配置</a>
</li>
            
<li >
    <a href="../../crawler/ch2/">Chapter 2: 爬虫基础</a>
</li>
            
<li >
    <a href="../../crawler/ch3/">Chapter 3: 基本库的使用</a>
</li>
            
<li >
    <a href="../../crawler/ch4/">Chapter 4: 解析库的使用</a>
</li>
            
<li >
    <a href="../../crawler/ch5/">Chapter 5: 数据存储</a>
</li>
            
<li >
    <a href="../../crawler/ch7/">Chapter 7: 动态渲染页面爬取</a>
</li>
            
<li >
    <a href="../../crawler/ch13/">Chapter 13: Scrapy框架的使用</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Projects</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../projects/">Contents</a>
</li>
            
<li >
    <a href="../../projects/SparkStreaming实时流处理项目/">SparkStreaming实时流处理</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../books/">Books</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>

                     <!--
                            <li >
                                <a rel="next" href="../ch4/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../ch6/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    -->
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#-5">面向程序员的数据挖掘指南 - 5 朴素贝叶斯</a></li>
        <li class="main "><a href="#1">1 朴素贝叶斯</a></li>
            <li><a href="#_1">概率</a></li>
            <li><a href="#_2">贝叶斯法则</a></li>
            <li><a href="#example">Example: 手环推荐</a></li>
            <li><a href="#example_1">Example: 美国国会投票数据</a></li>
        <li class="main "><a href="#2">2 数值型数据</a></li>
            <li><a href="#_3">区分类别</a></li>
            <li><a href="#_4">高斯分布</a></li>
            <li><a href="#example_2">Example: 比马印第安人糖尿病</a></li>
            <li><a href="#_5">为什么要叫“朴素贝叶斯”呢？</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="-5"><strong>面向程序员的数据挖掘指南 - 5 朴素贝叶斯</strong><a class="headerlink" href="#-5" title="Permanent link">&para;</a></h3>
<h3 id="1">1 朴素贝叶斯<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>使用近邻算法时，我们很难对分类结果的置信度进行量化。但如果使用的是基于概率的分类算法——贝叶斯算法——那就可以给出分类结果的可能性了：这名运动员有80%的几率是篮球运动员。</p>
<p>近邻算法又称为<strong>被动学习算法</strong>。这种算法只是将训练集的数据保存起来，在收到测试数据时才会进行计算。如果我们有10万首音乐，那每进行一次分类，都需要遍历这10万条记录才行。</p>
<p>贝叶斯算法则是一种<strong>主动学习算法</strong>。它会根据训练集构建起一个模型，并用这个模型来对新的记录进行分类，因此速度会快很多。</p>
<p>贝叶斯算法的两个优点即：</p>
<ul>
<li>能够给出分类结果的置信度；</li>
<li>它是一种主动学习算法。</li>
</ul>
<h4 id="_1">概率<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>我们用<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>来表示<span><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span>条件下事件<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>发生的概率。<span><span class="MathJax_Preview">P(h)</span><script type="math/tex">P(h)</script></span>表示事件<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>发生的概率，称为h的先验概率。<span><span class="MathJax_Preview">P(h|d)</span><script type="math/tex">P(h|d)</script></span>称为后验概率，表示在观察了数据集<span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span>之后，<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>事件发生的概率是多少。后验概率又称为条件概率。</p>
<h4 id="_2">贝叶斯法则<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>贝叶斯法则描述了<span><span class="MathJax_Preview">P(h)</span><script type="math/tex">P(h)</script></span>、<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>、<span><span class="MathJax_Preview">P(D)</span><script type="math/tex">P(D)</script></span>、以及<span><span class="MathJax_Preview">P(D|h)</span><script type="math/tex">P(D|h)</script></span>这四个概率之间的关系：</p>
<div>
<div class="MathJax_Preview">P(h|D) = \frac{P(D|h)P(h)}{P(D)}</div>
<script type="math/tex; mode=display">P(h|D) = \frac{P(D|h)P(h)}{P(D)}</script>
</div>
<p>如果我们有<span><span class="MathJax_Preview">h_1, h_2,...h_n</span><script type="math/tex">h_1, h_2,...h_n</script></span>等事件。计算不同事件发生的概率，</p>
<div>
<div class="MathJax_Preview">P(h_i|D) = \frac{P(D|h_i)P(h_i)}{P(D)}</div>
<script type="math/tex; mode=display">P(h_i|D) = \frac{P(D|h_i)P(h_i)}{P(D)}</script>
</div>
<p>选取最大的概率，就能用作分类了。这种方法叫最大后验估计，记为<span><span class="MathJax_Preview">h_{MAP}</span><script type="math/tex">h_{MAP}</script></span>：</p>
<div>
<div class="MathJax_Preview">h_{MAP} = \arg \max_{h\in H} P(h|D) =  \arg \max_{h\in H} \frac{P(D|h)P(h)}{P(D)}</div>
<script type="math/tex; mode=display">h_{MAP} = \arg \max_{h\in H} P(h|D) =  \arg \max_{h\in H} \frac{P(D|h)P(h)}{P(D)}</script>
</div>
<p><span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>表示所有的事件，所以<span><span class="MathJax_Preview">h\in H</span><script type="math/tex">h\in H</script></span>表示“对于集合中的每一个事件”。整个公式的含义就是：对于集合中的每一个事件，计算出<span><span class="MathJax_Preview">P(h|D)</span><script type="math/tex">P(h|D)</script></span>的值，并取最大的结果。</p>
<p>可以发现对于所有的事件，公式中的分母都是<span><span class="MathJax_Preview">P(D)</span><script type="math/tex">P(D)</script></span>，因此即便只计算<span><span class="MathJax_Preview">P(D|h)P(h)</span><script type="math/tex">P(D|h)P(h)</script></span>，也可以判断出最大的结果。那么这个公式就可以简化为：</p>
<div>
<div class="MathJax_Preview">h_{MAP} = \arg \max_{h\in H} P(D|h)P(h)</div>
<script type="math/tex; mode=display">h_{MAP} = \arg \max_{h\in H} P(D|h)P(h)</script>
</div>
<h4 id="example">Example: 手环推荐<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<p>现在我们要为iHealth公司发一套推荐系统。iHealth新出产了两件商品：i100和i500。为了收集数据，让购买的用户填写调查问卷，每个问题都对应一个特征：</p>
<p><img alt="" src="../figures/iHealth.jpg" /></p>
<p>已知一位客户的运动目的、当前运动水平、对健身的热情、是否适应高科技产品，请用朴素贝叶斯来推荐手环型号。</p>
<p>朴素贝叶斯分类器包含两个部分：训练和分类。</p>
<p><hh>训练</hh></p>
<p>训练的输出结果应该是：</p>
<ul>
<li>先验概率，如<span><span class="MathJax_Preview">P(i100) = 0.4</span><script type="math/tex">P(i100) = 0.4</script></span></li>
<li>条件概率，如<span><span class="MathJax_Preview">P(健康|i100) = 0.167</span><script type="math/tex">P(健康|i100) = 0.167</script></span></li>
</ul>
<p>我们使用如下代码表示先验概率：</p>
<p> <div class=codehilite><pre><span class=bp>self</span><span class=o>.</span><span class=n>prior</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;i500&#39;</span><span class=p>:</span> <span class=mf>0.6</span><span class=p>,</span> <span class=s1>&#39;i100&#39;</span><span class=p>:</span> <span class=mf>0.4</span><span class=p>}</span>
</pre></div></p>
<p>条件概率的表示有些复杂，用嵌套的字典来实现：</p>
<p> <div class=codehilite><pre><span class=p>{</span><span class=s1>&#39;i500&#39;</span><span class=p>:</span> <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;appearance&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>,</span> <span class=s1>&#39;health&#39;</span><span class=p>:</span> <span class=mf>0.4444444444444444</span><span class=p>,</span>
                <span class=s1>&#39;both&#39;</span><span class=p>:</span> <span class=mf>0.2222222222222222</span><span class=p>},</span>
        <span class=mi>2</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;active&#39;</span><span class=p>:</span> <span class=mf>0.4444444444444444</span><span class=p>,</span> <span class=s1>&#39;sedentary&#39;</span><span class=p>:</span> <span class=mf>0.2222222222222222</span><span class=p>,</span>
                <span class=s1>&#39;moderate&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>},</span>
        <span class=mi>3</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;aggressive&#39;</span><span class=p>:</span> <span class=mf>0.6666666666666666</span><span class=p>,</span> <span class=s1>&#39;moderate&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>},</span>
        <span class=mi>4</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;yes&#39;</span><span class=p>:</span> <span class=mf>0.6666666666666666</span><span class=p>,</span> <span class=s1>&#39;no&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>}},</span>
<span class=s1>&#39;i100&#39;</span><span class=p>:</span> <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;both&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>,</span> <span class=s1>&#39;health&#39;</span><span class=p>:</span> <span class=mf>0.16666666666666666</span><span class=p>,</span>
                <span class=s1>&#39;appearance&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>},</span>
        <span class=mi>2</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;active&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>,</span> <span class=s1>&#39;sedentary&#39;</span><span class=p>:</span> <span class=mf>0.5</span><span class=p>,</span>
                <span class=s1>&#39;moderate&#39;</span><span class=p>:</span> <span class=mf>0.16666666666666666</span><span class=p>},</span>
        <span class=mi>3</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;aggressive&#39;</span><span class=p>:</span> <span class=mf>0.16666666666666666</span><span class=p>,</span> <span class=s1>&#39;moderate&#39;</span><span class=p>:</span> <span class=mf>0.8333333333333334</span><span class=p>},</span>
        <span class=mi>4</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;yes&#39;</span><span class=p>:</span> <span class=mf>0.3333333333333333</span><span class=p>,</span> <span class=s1>&#39;no&#39;</span><span class=p>:</span> <span class=mf>0.6666666666666666</span><span class=p>}}}</span>
</pre></div></p>
<p>1、2、3、4表示第几列，所以第一行可以解释为购买i500的顾客中运动目的是外表的概率是 0.333。</p>
<p>为了计算概率，要进行计数，可以用字典来统计每个型号的次数。</p>
<p>以下是训练用的Python代码：</p>
<p> <div class=codehilite><pre><span class=k>class</span> <span class=nc>NavieBayes</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Classification Using naive bayes</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=nf>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>testBucketNumber</span><span class=p>,</span> <span class=n>dataFormat</span><span class=p>,</span> <span class=n>separator</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        initialize data</span>
<span class=sd>        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class=sd>        :param testBucketNumber: 测试桶的编号</span>
<span class=sd>        :param dataFormat: 数据格式，形如attr attr attr attr class</span>
<span class=sd>        :param separator: 文件分隔符</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># 总条数</span>
        <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=c1># 先验概率计数</span>
        <span class=n>classes</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=c1># 后验概率计数</span>
        <span class=n>counts</span> <span class=o>=</span> <span class=p>{}</span>

        <span class=c1># 从文件中读取数据</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>format</span> <span class=o>=</span> <span class=n>dataFormat</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>separator</span><span class=p>)</span>
        <span class=c1># 先验概率</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>prior</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=c1># 条件概率</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span> <span class=o>=</span> <span class=p>{}</span>

        <span class=c1># 遍历十个桶， 十折交叉验证</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>):</span>
            <span class=c1># 跳过测试桶</span>
            <span class=k>if</span> <span class=n>i</span> <span class=o>!=</span> <span class=n>testBucketNumber</span><span class=p>:</span>
                <span class=n>filename</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>-</span><span class=si>%02i</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
                <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
                <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
                <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
                    <span class=n>fields</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
                    <span class=n>ignore</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=n>vector</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)):</span>
                        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;num&#39;</span><span class=p>:</span>
                            <span class=n>vector</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;attr&#39;</span><span class=p>:</span>
                            <span class=n>vector</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;comment&#39;</span><span class=p>:</span>
                            <span class=n>ignore</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;class&#39;</span><span class=p>:</span>
                            <span class=n>category</span> <span class=o>=</span> <span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
                    <span class=c1># 处理该条记录</span>
                    <span class=n>total</span> <span class=o>+=</span> <span class=mi>1</span>
                    <span class=n>classes</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                    <span class=n>counts</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
                    <span class=n>classes</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
                    <span class=c1># 处理各个属性</span>
                    <span class=n>col</span> <span class=o>=</span> <span class=mi>0</span>
                    <span class=k>for</span> <span class=n>columnValue</span> <span class=ow>in</span> <span class=n>vector</span><span class=p>:</span>
                        <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=p>{})</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>columnValue</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>][</span><span class=n>columnValue</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>

        <span class=c1># 计数结束，开始计算概率</span>

        <span class=c1># 计算先验概率P(h)</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span> <span class=ow>in</span> <span class=n>classes</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>prior</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>=</span> <span class=n>count</span> <span class=o>/</span> <span class=n>total</span>

        <span class=c1># 计算条件概率P(h|D)</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>columns</span><span class=p>)</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
            <span class=k>for</span> <span class=p>(</span><span class=n>col_id</span><span class=p>,</span> <span class=n>valueCounts</span><span class=p>)</span> <span class=ow>in</span> <span class=n>columns</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col_id</span><span class=p>,</span> <span class=p>{})</span>
                <span class=k>for</span> <span class=p>(</span><span class=n>attrValue</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span> <span class=ow>in</span> <span class=n>valueCounts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col_id</span><span class=p>][</span><span class=n>attrValue</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                            <span class=n>count</span> <span class=o>/</span> <span class=n>classes</span><span class=p>[</span><span class=n>category</span><span class=p>])</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>tmp</span> <span class=o>=</span> <span class=n>counts</span>

    <span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>itemVector</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        返回itemVector所属类别</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>prior</span><span class=p>)</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>prior</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>prob</span> <span class=o>=</span> <span class=n>prior</span>
            <span class=n>col</span> <span class=o>=</span> <span class=mi>1</span>
            <span class=k>for</span> <span class=n>attrValue</span> <span class=ow>in</span> <span class=n>itemVector</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>attrValue</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]:</span>
                    <span class=c1># 属性不存在，返回0概率</span>
                    <span class=n>prob</span> <span class=o>=</span> <span class=mi>0</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>prob</span> <span class=o>=</span> <span class=n>prob</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>][</span><span class=n>attrValue</span><span class=p>]</span>
                <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>prob</span><span class=p>,</span> <span class=n>category</span><span class=p>))</span>
        <span class=c1># 返回概率最高的结果</span>
        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=n>results</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>

<span class=k>if</span> <span class=n>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>c</span> <span class=o>=</span> <span class=n>NavieBayes</span><span class=p>(</span><span class=s1>&#39;iHealth/i&#39;</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;attr</span><span class=se>\t</span><span class=s1>attr</span><span class=se>\t</span><span class=s1>attr</span><span class=se>\t</span><span class=s1>attr</span><span class=se>\t</span><span class=s1>class&#39;</span><span class=p>)</span>
    <span class=k>print</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>classify</span><span class=p>([</span><span class=s1>&#39;health&#39;</span> <span class=s1>&#39;moderate&#39;</span><span class=p>,</span> <span class=s1>&#39;moderate&#39;</span><span class=p>,</span> <span class=s1>&#39;yes&#39;</span><span class=p>]))</span>
</pre></div></p>
<h4 id="example_1">Example: 美国国会投票数据<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h4>
<p><a href="https://archive.ics.uci.edu/ml/datasets/congressional+voting+records">美国国会投票数据</a>，其中每条记录代表一个选民，第一列是分类名称（democrat, republican），之后是16条法案，用y和n表示该人是否支持。</p>
<p>文件格式如下：</p>
<p> <div class=codehilite><pre>democrat
y n y n n y y y y y n n y n n y
democrat
y y y n n y y y y n n n n n y y
republican
y y n y y y n n n y n y y y n n
</pre></div></p>
<p>在调用上一节编写的朴素贝叶斯分类器时使用以下dataFormat参数就可以了：</p>
<p> <div class=codehilite><pre>&quot;class\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\tattr\t
attr\tattr\tattr&quot;
</pre></div></p>
<p><hh>概率值为0</hh></p>
<p>但是，上面的代码在一些特殊情况下会有一些问题。</p>
<p>使用朴素贝叶斯计算得到的概率其实是真实概率的一种估计，而真实概率是对全量数据做统计得到的。比如说，我们需要对所有人都做血液测试，才能得到健康人返回阴性结果的真实概率。显然，对全量数据做统计是不现实的，所以我们会选取一个样本，如1000人，对他们进行测试并计算概率。大部分情况下，这种估计都是接近于真实概率的。但当真实概率非常小时，这种抽样统计的做法就会有问题了。比如说，民主党对网络非法传播法案的否决率是0.03，即<span><span class="MathJax_Preview">P(S=no|民主党) = 0.03</span><script type="math/tex">P(S=no|民主党) = 0.03</script></span>。如果我们 分别选取十个民主党和共和党人，看他们对该法案的投票情况，你觉得得到的概率会是什么？答案很可能是0。</p>
<p>在朴素贝叶斯中，概率为0的影响是很大的。如果其中⼀个概率值为0，那么最后的乘积也为0。</p>
<p>为了表示方便，我们采用以下公式：</p>
<div>
<div class="MathJax_Preview">P(x|y)=\frac{n_c}{n}</div>
<script type="math/tex; mode=display">P(x|y)=\frac{n_c}{n}</script>
</div>
<p>其中,<span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>表示训练集中y类别的记录数；<span><span class="MathJax_Preview">n_c</span><script type="math/tex">n_c</script></span>表示<span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>类别中值为<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>的记录数。我们的问题是<span><span class="MathJax_Preview">n_c</span><script type="math/tex">n_c</script></span>可能为0。解决方法是将公示变为以下形式：</p>
<div>
<div class="MathJax_Preview">P(x|y)=\frac{n_c+mp}{n+m}</div>
<script type="math/tex; mode=display">P(x|y)=\frac{n_c+mp}{n+m}</script>
</div>
<p><span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>是一个常数，表示等效样本大小。决定常数<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>的方法有很多，我们这里使用值的类别数目来作为<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>，比如投票有赞成和否决两种类别，所以<span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>就为2。<span><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>则是相应的先验概率，比如说赞成和否决的概率分别是0.5，那<span><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>就是0.5。</p>
<h3 id="2">2 数值型数据<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>在贝叶斯方法中，之前我们对事物进行了计数，这种计数则是可以度量的。对于数值型的数据要如何计数呢？通常有两种做法：区分类别和高斯分布。</p>
<h4 id="_3">区分类别<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>我们可以划定几个范围作为分类，如：</p>
<ul>
<li>年龄<ul>
<li>&lt; 18 </li>
<li>18 - 22 </li>
<li>23 - 30 </li>
<li>31 - 40 </li>
<li>40</li>
</ul>
</li>
<li>年薪<ul>
<li>$200,000</li>
<li>150,000 - 200,000 </li>
<li>100,000 - 150,000 </li>
<li>60,000 - 100,000 </li>
<li>40,000 - 60,000</li>
</ul>
</li>
</ul>
<p>划分类别后，就可以应用朴素贝叶斯方法了。</p>
<h4 id="_4">高斯分布<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>属于类别<span><span class="MathJax_Preview">y_i</span><script type="math/tex">y_i</script></span>的特征<span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span>的概率为</p>
<div>
<div class="MathJax_Preview">P(x_i|y_i) = \frac{1}{\sqrt{2\pi}\sigma_{ij}} e^{\LARGE -\frac{(x_i-u_{ij})^2}{2\sigma^2_{ij}}}</div>
<script type="math/tex; mode=display">P(x_i|y_i) = \frac{1}{\sqrt{2\pi}\sigma_{ij}} e^{\LARGE -\frac{(x_i-u_{ij})^2}{2\sigma^2_{ij}}}</script>
</div>
<p>为了举例，我们为上面讲述的手环的例子增加一列收入属性。假设我们要计算<span><span class="MathJax_Preview">P(100k|i500)</span><script type="math/tex">P(100k|i500)</script></span>的概率，即购买i500的用户中收入是100,000美元的概率。那么这里<span><span class="MathJax_Preview">u_{ij}, \sigma_{ij}</span><script type="math/tex">u_{ij}, \sigma_{ij}</script></span>分别对应的是购买i500的用户的平均收入和收入的标准差。</p>
<p>样本标准差的计算公式是：</p>
<div>
<div class="MathJax_Preview">\sigma = \sqrt{\frac{\sum_i(x_i-\bar x)^2}{\text{card}(x)-1}}</div>
<script type="math/tex; mode=display">\sigma = \sqrt{\frac{\sum_i(x_i-\bar x)^2}{\text{card}(x)-1}}</script>
</div>
<p>注意分母中的是<span><span class="MathJax_Preview">\text{card}(x)-1</span><script type="math/tex">\text{card}(x)-1</script></span>不是<span><span class="MathJax_Preview">\text{card}(x)</span><script type="math/tex">\text{card}(x)</script></span>。</p>
<p>在训练朴素贝叶斯分类器时，可以将所有属性的平均值和样本标准差计算出来，而分类阶段使用平均值和样本标准差计算概率密度分布：</p>
<p> <div class=codehilite><pre><span class=k>def</span> <span class=nf>pdf</span><span class=p>(</span><span class=n>mean</span><span class=p>,</span> <span class=n>ssd</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;概率密度函数，计算P(x|y)&quot;&quot;&quot;</span>
    <span class=n>ePart</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>pow</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>mean</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>ssd</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
    <span class=k>return</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>/</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span> <span class=o>*</span> <span class=n>ssd</span><span class=p>))</span> <span class=o>*</span> <span class=n>ePart</span>
</pre></div></p>
<h4 id="example_2">Example: 比马印第安人糖尿病<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h4>
<p>比马印第安人糖尿病数据集在<a href="../ch4">前一章</a>已经进行了详细描述。该数据集包含了数值型特征，不能直接用上一节代码。也就是说不能直接用计数的方法来计算某个具体特征的值出现的概率，而是要用高斯分布的概率密度函数计算。</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>math</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=kn>as</span> <span class=nn>np</span>


<span class=k>class</span> <span class=nc>NaiveBayes</span><span class=p>:</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Classification Using naive bayes</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span> <span class=nf>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>testBucketNumber</span><span class=p>,</span> <span class=n>dataFormat</span><span class=p>,</span> <span class=n>separator</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        initialize data</span>
<span class=sd>        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class=sd>        :param testBucketNumber: 测试桶的编号</span>
<span class=sd>        :param dataFormat: 数据格式，形如attr attr attr attr class</span>
<span class=sd>        :param separator: 文件分隔符</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># 对数值型数据进行求和</span>
        <span class=n>totals</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>numericValues</span> <span class=o>=</span> <span class=p>{}</span>

        <span class=c1># 对分类型数据进行计数</span>
        <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=c1># 先验概率计数</span>
        <span class=n>classes</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=c1># 后验概率计数</span>
        <span class=n>counts</span> <span class=o>=</span> <span class=p>{}</span>

        <span class=c1># 从文件中读取数据</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>format</span> <span class=o>=</span> <span class=n>dataFormat</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>separator</span><span class=p>)</span>
        <span class=c1># 先验概率</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>prior</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=c1># 条件概率</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span> <span class=o>=</span> <span class=p>{}</span>

        <span class=c1># 遍历十个桶， 十折交叉验证</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>):</span>
            <span class=c1># 跳过测试桶</span>
            <span class=k>if</span> <span class=n>i</span> <span class=o>!=</span> <span class=n>testBucketNumber</span><span class=p>:</span>
                <span class=n>filename</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>-</span><span class=si>%02i</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
                <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
                <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
                <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
                <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
                    <span class=n>fields</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
                    <span class=n>ignore</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=n>vector</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=n>nums</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)</span> <span class=o>&gt;</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>):</span>
                        <span class=k>print</span><span class=p>(</span><span class=n>fields</span><span class=p>,</span> <span class=n>filename</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
                        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&quot;INPUT ERROR&quot;</span><span class=p>)</span>
                    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)):</span>
                        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;num&#39;</span><span class=p>:</span>
                            <span class=n>nums</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;attr&#39;</span><span class=p>:</span>
                            <span class=n>vector</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;comment&#39;</span><span class=p>:</span>
                            <span class=n>ignore</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;class&#39;</span><span class=p>:</span>
                            <span class=n>category</span> <span class=o>=</span> <span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>

                    <span class=c1># 处理分类型数据</span>
                    <span class=c1># 处理该条记录</span>
                    <span class=n>total</span> <span class=o>+=</span> <span class=mi>1</span>
                    <span class=n>classes</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                    <span class=n>counts</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
                    <span class=n>classes</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
                    <span class=c1># 处理各个属性</span>
                    <span class=n>col</span> <span class=o>=</span> <span class=mi>0</span>
                    <span class=k>for</span> <span class=n>columnValue</span> <span class=ow>in</span> <span class=n>vector</span><span class=p>:</span>
                        <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=p>{})</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>columnValue</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                        <span class=n>counts</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>][</span><span class=n>columnValue</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>

                    <span class=c1># 处理数值型数据</span>
                    <span class=n>col</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># column number</span>
                    <span class=n>totals</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
                    <span class=n>numericValues</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
                    <span class=k>for</span> <span class=n>columnValue</span> <span class=ow>in</span> <span class=n>nums</span><span class=p>:</span>
                        <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
                        <span class=n>totals</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                        <span class=n>totals</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>+=</span> <span class=n>columnValue</span>
                        <span class=n>numericValues</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col</span><span class=p>,</span> <span class=p>[])</span>
                        <span class=n>numericValues</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>columnValue</span><span class=p>)</span>

        <span class=c1># 计数结束，开始计算概率</span>

        <span class=c1># 计算先验概率P(h)</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span> <span class=ow>in</span> <span class=n>classes</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>prior</span><span class=p>[</span><span class=n>category</span><span class=p>]</span> <span class=o>=</span> <span class=n>count</span> <span class=o>/</span> <span class=n>total</span>

        <span class=c1># 计算条件概率P(h|D)</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>columns</span><span class=p>)</span> <span class=ow>in</span> <span class=n>counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
            <span class=k>for</span> <span class=p>(</span><span class=n>col_id</span><span class=p>,</span> <span class=n>valueCounts</span><span class=p>)</span> <span class=ow>in</span> <span class=n>columns</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>col_id</span><span class=p>,</span> <span class=p>{})</span>
                <span class=k>for</span> <span class=p>(</span><span class=n>attrValue</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span> <span class=ow>in</span> <span class=n>valueCounts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col_id</span><span class=p>][</span><span class=n>attrValue</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
                            <span class=n>count</span> <span class=o>/</span> <span class=n>classes</span><span class=p>[</span><span class=n>category</span><span class=p>])</span>

        <span class=c1># 计算平均数和样本标准差</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>means</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>standard_deviation</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>category</span><span class=p>,</span> <span class=n>columns</span> <span class=ow>in</span> <span class=n>totals</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>means</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>standard_deviation</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
            <span class=k>for</span> <span class=n>col</span><span class=p>,</span> <span class=n>sums</span> <span class=ow>in</span> <span class=n>columns</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>means</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> 
                    <span class=n>sums</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>numericValues</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>])</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>standard_deviation</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>power</span><span class=p>(</span>
                    <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>numericValues</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>])</span> <span class=o>-</span>
                    <span class=bp>self</span><span class=o>.</span><span class=n>means</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]),</span> <span class=mi>2</span><span class=p>))</span><span class=o>/</span>
                    <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>numericValues</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>])</span> <span class=o>-</span> <span class=mf>1.0</span><span class=p>))</span>

    <span class=k>def</span> <span class=nf>pdf</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mean</span><span class=p>,</span> <span class=n>ssd</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;概率密度函数，计算P(x|y)&quot;&quot;&quot;</span>
        <span class=n>ePart</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>pow</span><span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>e</span><span class=p>,</span> <span class=o>-</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>mean</span><span class=p>)</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>ssd</span> <span class=o>**</span> <span class=mi>2</span><span class=p>))</span>
        <span class=k>return</span> <span class=p>(</span><span class=mf>1.0</span> <span class=o>/</span> <span class=p>(</span><span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span> <span class=o>*</span> <span class=n>ssd</span><span class=p>))</span> <span class=o>*</span> <span class=n>ePart</span>

    <span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>itemVector</span><span class=p>,</span> <span class=n>numVector</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        根据itemVector和numVector进行分类</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=k>for</span> <span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=n>prior</span><span class=p>)</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>prior</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>prob</span> <span class=o>=</span> <span class=n>prior</span>
            <span class=n>col</span> <span class=o>=</span> <span class=mi>1</span>
            <span class=k>for</span> <span class=n>attrValue</span> <span class=ow>in</span> <span class=n>itemVector</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>attrValue</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>]:</span>
                    <span class=c1># 属性不存在，返回0概率</span>
                    <span class=n>prob</span> <span class=o>=</span> <span class=mi>0</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>prob</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conditional</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>][</span><span class=n>attrValue</span><span class=p>]</span>
                <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>col</span> <span class=o>=</span> <span class=mi>1</span>
            <span class=k>for</span> <span class=n>numValue</span> <span class=ow>in</span> <span class=n>numVector</span><span class=p>:</span>
                <span class=c1>#高斯概率密度分布</span>
                <span class=n>prob</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>pdf</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>means</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>standard_deviation</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>col</span><span class=p>],</span> <span class=n>numValue</span><span class=p>)</span>
                <span class=n>col</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>prob</span><span class=p>,</span> <span class=n>category</span><span class=p>))</span>
        <span class=c1># 返回概率最高的结果</span>
        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=n>results</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>

    <span class=k>def</span> <span class=nf>testBucket</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>):</span>
        <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        测试</span>
<span class=sd>        :param bucketPrefix: 分桶数据集文件前缀</span>
<span class=sd>        :param i: 编号</span>
<span class=sd>        :return: 测试结果</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>filename</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>-</span><span class=si>%02i</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
        <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
        <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
        <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
        <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
            <span class=n>fields</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
            <span class=n>ignore</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=n>vector</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=n>nums</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)</span> <span class=o>&gt;</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>):</span>
                <span class=k>print</span><span class=p>(</span><span class=n>fields</span><span class=p>,</span> <span class=n>filename</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
                <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&quot;INPUT ERROR&quot;</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>fields</span><span class=p>)):</span>
                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;num&#39;</span><span class=p>:</span>
                    <span class=n>nums</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]))</span>
                <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;attr&#39;</span><span class=p>:</span>
                    <span class=n>vector</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;comment&#39;</span><span class=p>:</span>
                    <span class=n>ignore</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
                <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>format</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;class&#39;</span><span class=p>:</span>
                    <span class=n>category</span> <span class=o>=</span> <span class=n>fields</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
            <span class=n>test_result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>classify</span><span class=p>(</span><span class=n>vector</span><span class=p>,</span> <span class=n>nums</span><span class=p>)</span>
            <span class=n>results</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>category</span><span class=p>,</span> <span class=p>{})</span>
            <span class=n>results</span><span class=p>[</span><span class=n>category</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>test_result</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
            <span class=n>results</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>test_result</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
        <span class=k>return</span> <span class=n>results</span>





<span class=k>def</span> <span class=nf>tenfold</span><span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>dataFormat</span><span class=p>):</span>
    <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>):</span>
        <span class=n>c</span> <span class=o>=</span> <span class=n>NaiveBayes</span><span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>dataFormat</span><span class=p>)</span>
        <span class=n>t</span> <span class=o>=</span> <span class=n>c</span><span class=o>.</span><span class=n>testBucket</span><span class=p>(</span><span class=n>bucketPrefix</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
        <span class=k>for</span> <span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span> <span class=ow>in</span> <span class=n>t</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>results</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=p>{})</span>
            <span class=k>for</span> <span class=p>(</span><span class=n>ckey</span><span class=p>,</span> <span class=n>cvalue</span><span class=p>)</span> <span class=ow>in</span> <span class=n>value</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=n>results</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>ckey</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
                <span class=n>results</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=n>ckey</span><span class=p>]</span> <span class=o>+=</span> <span class=n>cvalue</span>

    <span class=c1># now print results</span>
    <span class=n>categories</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>results</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
    <span class=n>categories</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
    <span class=k>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>       Classified as: &quot;</span><span class=p>)</span>
    <span class=n>header</span> <span class=o>=</span> <span class=s2>&quot;        &quot;</span>
    <span class=n>subheader</span> <span class=o>=</span> <span class=s2>&quot;      +&quot;</span>
    <span class=k>for</span> <span class=n>category</span> <span class=ow>in</span> <span class=n>categories</span><span class=p>:</span>
        <span class=n>header</span> <span class=o>+=</span> <span class=s2>&quot;</span><span class=si>% 2s</span><span class=s2>   &quot;</span> <span class=o>%</span> <span class=n>category</span>
        <span class=n>subheader</span> <span class=o>+=</span> <span class=s2>&quot;-----+&quot;</span>
    <span class=k>print</span><span class=p>(</span><span class=n>header</span><span class=p>)</span>
    <span class=k>print</span><span class=p>(</span><span class=n>subheader</span><span class=p>)</span>
    <span class=n>total</span> <span class=o>=</span> <span class=mf>0.0</span>
    <span class=n>correct</span> <span class=o>=</span> <span class=mf>0.0</span>
    <span class=k>for</span> <span class=n>category</span> <span class=ow>in</span> <span class=n>categories</span><span class=p>:</span>
        <span class=n>row</span> <span class=o>=</span> <span class=s2>&quot; </span><span class=si>%s</span><span class=s2>    |&quot;</span> <span class=o>%</span> <span class=n>category</span>
        <span class=k>for</span> <span class=n>c2</span> <span class=ow>in</span> <span class=n>categories</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>c2</span> <span class=ow>in</span> <span class=n>results</span><span class=p>[</span><span class=n>category</span><span class=p>]:</span>
                <span class=n>count</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=n>category</span><span class=p>][</span><span class=n>c2</span><span class=p>]</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span>
            <span class=n>row</span> <span class=o>+=</span> <span class=s2>&quot; </span><span class=si>%3i</span><span class=s2> |&quot;</span> <span class=o>%</span> <span class=n>count</span>
            <span class=n>total</span> <span class=o>+=</span> <span class=n>count</span>
            <span class=k>if</span> <span class=n>c2</span> <span class=o>==</span> <span class=n>category</span><span class=p>:</span>
                <span class=n>correct</span> <span class=o>+=</span> <span class=n>count</span>
        <span class=k>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
    <span class=k>print</span><span class=p>(</span><span class=n>subheader</span><span class=p>)</span>
    <span class=k>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>%5.3f</span><span class=s2> percent correct&quot;</span> <span class=o>%</span> <span class=p>((</span><span class=n>correct</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span> <span class=o>/</span> <span class=n>total</span><span class=p>))</span>
    <span class=k>print</span><span class=p>(</span><span class=s2>&quot;total of </span><span class=si>%i</span><span class=s2> instances&quot;</span> <span class=o>%</span> <span class=n>total</span><span class=p>)</span>



<span class=k>if</span> <span class=n>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>tenfold</span><span class=p>(</span><span class=s2>&quot;pimaSmall/pimaSmall&quot;</span><span class=p>,</span>
            <span class=s2>&quot;num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>num</span><span class=se>\t</span><span class=s2>class&quot;</span><span class=p>)</span>
</pre></div></p>
<p>输出结果如下：</p>
<p> <div class=codehilite><pre>       Classified as: 
         0    1   
      +-----+-----+
 0    |  46 |  13 |
 1    |  15 |  26 |
      +-----+-----+

72.000 percent correct
total of 100 instances
</pre></div></p>
<p>与kNN相比，朴素贝叶斯准确率更好，而且计算更快。</p>
<h4 id="_5">为什么要叫“朴素贝叶斯”呢？<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>我们之所以能将多个概率进行相乘是因为这些概率都是具有独立性的。关于贝叶斯准则，可以参见<a href="http://larryim.cc/note-big-data/prob/ch1/">概率导论</a>。</p>
<blockquote>
<p>In simple terms, a naive Bayes classifier assumes that the presence (or absence) of a particular feature of a class is unrelated to the presence (or absence) of any other feature, given the class variable. For example, a fruit may be considered to be an apple if it is red, round, and about 4" in diameter. Even if these features depend on each other or upon the existence of the other features, a naive Bayes classifier considers all of these properties to independently contribute to the probability that this fruit is an apple. [<a href="https://stackoverflow.com/questions/10614754/what-is-naive-in-a-naive-bayes-classifier">ref</a>]</p>
</blockquote>
<p>但是在现实数据挖掘场景中，这种特征变量之间往往不相互独立。</p>
<ul>
<li>运动员例子中，身高和体重不是互相独立的，因为高的人体重也会较高。 </li>
<li>地区邮编、收入、年龄，这些特征也不完全独立，一些地区的房屋都很昂贵，一些地区则只有房车：加州帕罗奥图大多是20岁的年轻人，而亚利桑那州则多是退休人员。</li>
<li>在音乐基因工程中，很多特征也是不独立的，如果音乐中有很多变音吉他，那小提琴的 概率就降低了。 血液检验的结果中，T4和TSH这两个指标通常是呈反比的。</li>
</ul>
<p>所以，在使用贝叶斯方法时，我们需要互相独立的特征，但现实生活中很难找到这样的应用，因此我们只能假设他们是独立的了！我们完全忽略了这个问题，因此才称为“朴素的”（天真的）贝叶斯方法。不过事实证明朴素贝叶斯的效果还是很不错的。</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../extra_javascript/tabhack.js" defer></script>
        <script src="../../../extra_javascript/baidu.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
