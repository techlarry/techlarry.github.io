<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note/bigdata/crawler/ch3/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Chapter 3: 基本库的使用 - Zhenhua's Notes</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../../extra_css/custom.css" rel="stylesheet">
        <link href="../../../extra_css/custom.js" rel="stylesheet">
        <link href="../../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../../extra_css/theme.css" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">Zhenhua's Notes</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Algorithm <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../algorithm/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmPrinceton</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/unionfind/">Topic 1: UnionFind</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/stackqueue/">Topic 2: StackQueue</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/sort/">Topic 3: Sort</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/priorityqueue/">Topic 4: PriorityQueues</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/symboltable/">Topic 5: Symbol Tables</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/bst/">Topic 6: Balanced Search Trees</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/hashtable/">Topic 7: Hash Table</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/graph/">Topic 8: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmPrinceton/mst_shortestpath/">Topic 9: Minimum Spanning Tree and Shortest Path</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">AlgorithmStanford</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../algorithm/algorithmStanford/">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/dynamicprogramming/">Topic: Dynammic Programming</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/heap/">Topic: Heap</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/graph/">Topic: Graph</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/greedy/">Topic: Greedy Algorithm</a>
</li>
            
<li >
    <a href="../../../algorithm/algorithmStanford/hashtable/">Topic: Hash Table</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CS61B</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../calgorithm/s61b/index.md">Contents</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab1/">Lab1: javac, java, git</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab2/">Lab2: Unit Testing with JUnit and IntLists</a>
</li>
            
<li >
    <a href="../../../algorithm/cs61b/Lab3/">Lab3: Unit Testing with JUnit, Debugging</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">OS <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../os/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">OSC</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../os/osc/">Contents</a>
</li>
            
<li >
    <a href="../../../os/osc/ch1/">Chapter 1: Introduction </a>
</li>
            
<li >
    <a href="../../../os/osc/ch2/">Chapter 2: Operating System structures</a>
</li>
            
<li >
    <a href="../../../os/osc/ch3/">Chapter 3: Processes</a>
</li>
            
<li >
    <a href="../../../os/osc/ch4/">Chapter 4: Threads and Concurrency</a>
</li>
            
<li >
    <a href="../../../os/osc/ch5/">Chapter 5: CPU Scheduling</a>
</li>
            
<li >
    <a href="../../../os/osc/ch6/">Chapter 6: Synchronization Tools</a>
</li>
            
<li >
    <a href="../../../os/osc/ch7/">Chapter 7: Synchronization Examples</a>
</li>
            
<li >
    <a href="../../../os/osc/ch8/">Chapter 8: Deadlocks</a>
</li>
            
<li >
    <a href="../../../os/osc/ch9/">Chapter 9: Main Memory</a>
</li>
            
<li >
    <a href="../../../os/osc/ch10/">Chapter 10: Virtual Memory</a>
</li>
            
<li >
    <a href="../../../os/osc/ch11/">Chapter 11: Mass-Storage Structure</a>
</li>
            
<li >
    <a href="../../../os/osc/ch13/">Chapter 13: File-System Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">CSAPP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../os/csapp/">Contents</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch1/">Chapter 1: 计算机系统漫游</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch2/">Chapter 2: 信息的表示和处理</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch3/">Chapter 3: 程序的机器级表示</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch4/">Chapter 4: 处理器体系结构</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch5/">Chapter 5: 优化程序性能</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch6/">Chapter 6: 存储器层次结构</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch7/">Chapter 7: 链接</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch8/">Chapter 8: 异常控制流</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch9/">Chapter 9: 虚拟内存</a>
</li>
            
<li >
    <a href="../../../os/csapp/ch10/">Chapter 10: 系统级I/O</a>
</li>
            
<li >
    <a href="../../../csapp/ch11.md">Chapter 11: 网络编程</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">DataBase <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../database/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MySql</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../database/mysql/">Contents</a>
</li>
            
<li >
    <a href="../../../database/mysql/LearningMySQLandMariaDB/">Chapter Learning MySQL and MariaDB</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Java <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../java/">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfj/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch1/">Chapter 1: Dive in A Quick Dip</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch2/">Chapter 2: Classes and Objects</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch3/">Chapter 3: Primitives and References</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch4/">Chapter 4: Methods use Instance Variables</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch5/">Chapter 5: Writing a Program</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch6/">Chapter 6: Get to Know the Java API</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch7/">Chapter 7: Inheritance and Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch8/">Chapter 8: Interfaces and Abstract Classes</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch9/">Chapter 9: Constructors and Garbage Collection</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch10/">Chapter 10: Numbers and Statics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch11/">Chapter 11: Exception Handling</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch12/">Chapter 12: Getting GUI</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch13/">Chapter 13: Using Swing</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch14/">Chapter 14: Serialization and File I/O</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch15/">Chapter 15: Networking and Threads</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch16/">Chapter 16: Collections and Generics</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch17/">Chapter 17: Packages, Jars and Deployment</a>
</li>
            
<li >
    <a href="../../../java/hfj/ch18/">Chapter 18: Remote deploy with RMI</a>
</li>
            
<li >
    <a href="../../../java/hfj/Appendix/">Appendix: The Top Ten Topics</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HFDP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/hfdp/">Contents</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch1/">Chapter 1: Strategy Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch2/">Chapter 2: Observer Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch3/">Chapter 3: Decorator Pattern </a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch4/">Chapter 4: Factory Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch5/">Chapter 5: Singleton Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch6/">Chapter 6: Command Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch7/">Chapter 7: Adapter and Facade Patterns</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch8/">Chapter 8: Template Method Pattern</a>
</li>
            
<li >
    <a href="../../../java/hfdp/ch9/">Chapter 9: Iterator and Composite Patterns</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TIJ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/tij/">Contents</a>
</li>
            
<li >
    <a href="../../../java/tij/ch1/">Chapter 1: Introduction</a>
</li>
            
<li >
    <a href="../../../java/tij/ch2/">Chapter 2: Introduction to Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch3/">Chapter 3: Everything is an Object</a>
</li>
            
<li >
    <a href="../../../java/tij/ch4/">Chapter 4: Opertors</a>
</li>
            
<li >
    <a href="../../../java/tij/ch5/">Chapter 5: Controlling Execution</a>
</li>
            
<li >
    <a href="../../../java/tij/ch6/">Chapter 6: Initialization & Cleanup</a>
</li>
            
<li >
    <a href="../../../java/tij/ch7/">Chapter 7: Access Control</a>
</li>
            
<li >
    <a href="../../../java/tij/ch8/">Chapter 8: Reusing Clases</a>
</li>
            
<li >
    <a href="../../../java/tij/ch9/">Chapter 9: Polymorphism</a>
</li>
            
<li >
    <a href="../../../java/tij/ch10/">Chapter 10: Interfaces</a>
</li>
            
<li >
    <a href="../../../java/tij/ch11/">Chapter 11: Inner Classes</a>
</li>
            
<li >
    <a href="../../../java/tij/ch12/">Chapter 12: Holding Your Objects</a>
</li>
            
<li >
    <a href="../../../java/tij/ch13/">Chapter 13: Error Handling with Exceptions</a>
</li>
            
<li >
    <a href="../../../java/tij/ch14/">Chapter 14: Strings</a>
</li>
            
<li >
    <a href="../../../java/tij/ch15/">Chapter 15: Type Information</a>
</li>
            
<li >
    <a href="../../../java/tij/ch16/">Chapter 16: Generics</a>
</li>
            
<li >
    <a href="../../../java/tij/ch17/">Chapter 17: Arrays</a>
</li>
            
<li >
    <a href="../../../java/tij/ch18/">Chapter 18: Containers in Depth</a>
</li>
            
<li >
    <a href="../../../java/tij/ch19/">Chapter 19: I/O</a>
</li>
            
<li >
    <a href="../../../java/tij/ch20/">Chapter 20: Enumerated Types</a>
</li>
            
<li >
    <a href="../../../java/tij/ch21/">Chapter 21: Annotations</a>
</li>
            
<li >
    <a href="../../../java/tij/ch22/">Chapter 22: Concurrency</a>
</li>
            
<li >
    <a href="../../../java/tij/ch23/">Chapter 23: Graphical User Interfaces</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">UJVM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../java/ujvm/">Contents</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch1/">Chapter 1 : 走进Java</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch2/">Chapter 2 : Java内存区域与内存溢出正常</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch3/">Chapter 3 : 垃圾收集器与内存分配策略</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch4/">Chapter 4 : 虚拟机性能监控与故障处理工具</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch5/">Chapter 5 : 调优案例分析与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch6/">Chapter 6 : 类文件结构</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch7/">Chapter 7 : 虚拟机类加载机制</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch8/">Chapter 8 : 虚拟机字节码执行引擎</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch9/">Chapter 9 : 类加载及执行子系统的案例与实战</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch10/">Chapter 10 : 早期(编译期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch11/">Chapter 11 : 晚期(运行期)优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch12/">Chapter 12 : Java内存模型与线程</a>
</li>
            
<li >
    <a href="../../../java/ujvm/ch13/">Chapter 13 : 线程安全与锁优化</a>
</li>
            
<li >
    <a href="../../../java/ujvm/AppendixC/">Appendix HotSpot虚拟机主要参数列表</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">BigData <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../">Contents</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HADOOP</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../hadoop/">Contents</a>
</li>
            
<li >
    <a href="../../hadoop/ch1/">Chapter 1: Meet Hadoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch2/">Chapter 2: MapReduce</a>
</li>
            
<li >
    <a href="../../hadoop/ch3/">Chapter 3: The Hadoop Distributed FileSystem</a>
</li>
            
<li >
    <a href="../../hadoop/ch4/">Chapter 4: YARN</a>
</li>
            
<li >
    <a href="../../hadoop/ch5/">Chapter 5: Hadoop I/O</a>
</li>
            
<li >
    <a href="../../hadoop/ch6/">Chapter 6: Developing a MapReduce Application</a>
</li>
            
<li >
    <a href="../../hadoop/ch7/">Chapter 7: How MapReduce Works</a>
</li>
            
<li >
    <a href="../../hadoop/ch8/">Chapter 8: MapReduce Types and Formats</a>
</li>
            
<li >
    <a href="../../hadoop/ch9/">Chapter 9: MapReduce Features</a>
</li>
            
<li >
    <a href="../../hadoop/ch10/">Chapter 10: Setting Up a Hadoop Cluster</a>
</li>
            
<li >
    <a href="../../hadoop/ch11/">Chapter 11: Adminstering Hadoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch12/">Chapter 12: Avro</a>
</li>
            
<li >
    <a href="../../hadoop/ch13/">Chapter 13: Parquet</a>
</li>
            
<li >
    <a href="../../hadoop/ch14/">Chapter 14: Flume</a>
</li>
            
<li >
    <a href="../../hadoop/ch15/">Chapter 15: Sqoop</a>
</li>
            
<li >
    <a href="../../hadoop/ch16/">Chapter 16: Pig</a>
</li>
            
<li >
    <a href="../../hadoop/ch17/">Chapter 17: Hive</a>
</li>
            
<li >
    <a href="../../hadoop/ch18/">Chapter 18: Crunch</a>
</li>
            
<li >
    <a href="../../hadoop/ch19/">Chapter 19: Spark</a>
</li>
            
<li >
    <a href="../../hadoop/ch20/">Chapter 20: HBase</a>
</li>
            
<li >
    <a href="../../hadoop/ch21/">Chapter 21: ZooKeeper</a>
</li>
            
<li >
    <a href="../../hadoop/ch22/">Chapter 22: Composable Data at Center</a>
</li>
            
<li >
    <a href="../../hadoop/ch23/">Chapter 23: Biological Data Science: Saving Lives with Software</a>
</li>
            
<li >
    <a href="../../hadoop/ch24/">Chapter 24: Cascading</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Spark</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../spark/">Contents</a>
</li>
            
<li >
    <a href="../../spark/ch1/">Chapter 1: Introduction to Data Analysis with Spark</a>
</li>
            
<li >
    <a href="../../spark/ch2/">Chapter 2: Downloading Spark and Getting Started</a>
</li>
            
<li >
    <a href="../../spark/ch3/">Chapter 3: Programming with RDDs</a>
</li>
            
<li >
    <a href="../../spark/ch4/">Chapter 4: Working with Key/Value Pairs</a>
</li>
            
<li >
    <a href="../../spark/ch5/">Chapter 5: Loading and Saving Your Data</a>
</li>
            
<li >
    <a href="../../spark/ch6/">Chapter 6: Advanced Spark Programming</a>
</li>
            
<li >
    <a href="../../spark/ch7/">Chapter 7: Running on a Cluster</a>
</li>
            
<li >
    <a href="../../spark/ch8/">Chapter 8: Tuning and Debugging Spark</a>
</li>
            
<li >
    <a href="../../spark/ch9/">Chapter 9: Spark SQL</a>
</li>
            
<li >
    <a href="../../spark/ch10/">Chapter 10: Spark Streaming</a>
</li>
            
<li >
    <a href="../../spark/ch11/">Chapter 11: Machine Learning with MLlib</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">GDM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../gdm/">Contents</a>
</li>
            
<li >
    <a href="../../gdm/ch1/">Chapter 1: 推荐系统入门</a>
</li>
            
<li >
    <a href="../../gdm/ch2/">Chapter 2: 隐式评价和基于物品的过滤算法</a>
</li>
            
<li >
    <a href="../../gdm/ch3/">Chapter 3: 分类</a>
</li>
            
<li >
    <a href="../../gdm/ch4/">Chapter 4: 进一步探索分类</a>
</li>
            
<li >
    <a href="../../gdm/ch5/">Chapter 5: 概率和朴素贝叶斯</a>
</li>
            
<li >
    <a href="../../gdm/ch6/">Chapter 6: 朴素贝叶斯和文本数据</a>
</li>
            
<li >
    <a href="../../gdm/ch7/">Chapter 7: 聚类</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MLIA</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../mlia/">Contents</a>
</li>
            
<li >
    <a href="../../mlia/ch1/">Chapter 1: 机器学习基础</a>
</li>
            
<li >
    <a href="../../mlia/ch2/">Chapter 2: k-近邻算法</a>
</li>
            
<li >
    <a href="../../mlia/ch3/">Chapter 3: 决策树</a>
</li>
            
<li >
    <a href="../../mlia/ch4/">Chapter 4: 基于概率论的分类方法：朴素贝叶斯</a>
</li>
            
<li >
    <a href="../../mlia/ch5/">Chapter 5: Logistic回归</a>
</li>
            
<li >
    <a href="../../mlia/ch6/">Chapter 6: 支持向量机</a>
</li>
            
<li >
    <a href="../../mlia/ch7/">Chapter 7: 利用AdaBoost元算法提高分类性能</a>
</li>
            
<li >
    <a href="../../mlia/ch8/">Chapter 8: 预测数值型数据：回归</a>
</li>
            
<li >
    <a href="../../mlia/ch9/">Chapter 9: 树回归</a>
</li>
            
<li >
    <a href="../../mlia/ch10/">Chapter 10: 利用Ｋ-均值聚类算法对未标注数据分组</a>
</li>
            
<li >
    <a href="../../mlia/ch11/">Chapter 11: 使用Apriori算法进行关联分析</a>
</li>
            
<li >
    <a href="../../mlia/ch11/">Chapter 12: 使用FP-growth算法来高效发现频繁项集</a>
</li>
            
<li >
    <a href="../../mlia/ch13/">Chapter 13: 利用PCA来简化数据</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Crawler</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../">Contents</a>
</li>
            
<li >
    <a href="../ch1/">Chapter 1: 开发环境配置</a>
</li>
            
<li >
    <a href="../ch2/">Chapter 2: 爬虫基础</a>
</li>
            
<li class="active">
    <a href="./">Chapter 3: 基本库的使用</a>
</li>
            
<li >
    <a href="../ch4/">Chapter 4: 解析库的使用</a>
</li>
            
<li >
    <a href="../ch5/">Chapter 5: 数据存储</a>
</li>
            
<li >
    <a href="../ch7/">Chapter 7: 动态渲染页面爬取</a>
</li>
            
<li >
    <a href="../ch13/">Chapter 13: Scrapy框架的使用</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Projects</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../projects/">Contents</a>
</li>
            
<li >
    <a href="../../projects/SparkStreaming实时流处理项目/">SparkStreaming实时流处理</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../books/">Books</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>

                     <!--
                            <li >
                                <a rel="next" href="../ch2/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../ch4/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    -->
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#python3-3">Python3网络爬虫开发实战 - 3 基本库的使用</a></li>
        <li class="main "><a href="#1-urllib">1 使用Urllib</a></li>
            <li><a href="#11">1.1 发送请求</a></li>
            <li><a href="#12">1.2 处理异常</a></li>
            <li><a href="#13">1.3 解析链接</a></li>
            <li><a href="#14-robots">1.4 分析Robots协议</a></li>
        <li class="main "><a href="#2-requests">2 使用Requests</a></li>
            <li><a href="#get">GET请求</a></li>
            <li><a href="#post">POST请求</a></li>
            <li><a href="#_1">文件上传</a></li>
            <li><a href="#cookie">Cookie</a></li>
            <li><a href="#_2">会话维持</a></li>
            <li><a href="#_3">代理设置</a></li>
        <li class="main "><a href="#3">3 正则表达式</a></li>
        <li class="main "><a href="#4-example">4 Example: 抓取猫眼电影排行</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="python3-3"><strong>Python3网络爬虫开发实战 - 3 基本库的使用</strong><a class="headerlink" href="#python3-3" title="Permanent link">&para;</a></h3>
<h3 id="1-urllib">1 使用Urllib<a class="headerlink" href="#1-urllib" title="Permanent link">&para;</a></h3>
<p>Urllib库是Python内置的HTTP请求库(<a href="https://docs.python.org/3/library/urllib.html">官方文档链接</a>)， 它包含四个模块：</p>
<ul>
<li><C>request</C>模块，最基本的HTTP请求模块，可以用来模拟发送请求，就像在浏览器里输入网址然后敲击回车一样，只需要给库方法传入URL还有额外的参数，就可以模拟实现这个过程了。</li>
<li><C>error</C>模块即异常处理模块，如果出现请求错误，我们可以捕获这些异常，然后进行重试或其他操作保证程序不会意外终止。</li>
<li><C>parse</C>模块，用来解析URL。</li>
<li><C>robotparser</C>模块，用来解析robots.txt文件。</li>
</ul>
<h4 id="11">1.1 发送请求<a class="headerlink" href="#11" title="Permanent link">&para;</a></h4>
<p>使用Urllib的<a href="https://docs.python.org/3/library/urllib.request.html">request模块</a>可以方便地实现Request的发送并得到Response。</p>
<p><hh>urlopen()</hh></p>
<p><C>urllib.request</C>模块提供了最基本的构造HTTP请求的方法，利用它可以模拟浏览器的一个请求发起过程，同时它还带有处理authenticaton(授权验证)，redirections(重定向)，cookies(浏览器Cookies)以及其它内容。</p>
<p>我们来感受一下它的强大之处，以Python官网为例，我们来把这个网页抓下来:</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>urllib.request</span>
<span class=c1># 打开网页</span>
<span class=n>response</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s1>&#39;https://www.python.org&#39;</span><span class=p>)</span>
<span class=c1># 得到返回的网页内容</span>
<span class=k>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
<span class=c1># 查看返回类型： &lt;class &#39;http.client.HTTPResponse&#39;&gt;</span>
<span class=k>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>response</span><span class=p>))</span>
</pre></div></p>
<p><C>urlopen</C>返回一个<C>HTTPResponse</C>对象，调用对象的<C>read()</C>方法可以得到返回的网页内容，调用<C>status</C>属性就可以得到返回结果的状态码，如200代表请求成功，404代表网页未找到等，调用<C>getheaders()</C>返回响应的头信息。</p>
<p> <div class=codehilite><pre><span class=o>&gt;&gt;&gt;</span> <span class=n>response</span><span class=o>.</span><span class=n>status</span>
<span class=mi>200</span>
<span class=o>&gt;&gt;&gt;</span> <span class=n>response</span><span class=o>.</span><span class=n>getheaders</span><span class=p>()</span>
<span class=p>[(</span><span class=s1>&#39;Server&#39;</span><span class=p>,</span> <span class=s1>&#39;nginx&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span> <span class=s1>&#39;text/html; charset=utf-8&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Frame-Options&#39;</span><span class=p>,</span> <span class=s1>&#39;SAMEORIGIN&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;x-xss-protection&#39;</span><span class=p>,</span> <span class=s1>&#39;1; mode=block&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Clacks-Overhead&#39;</span><span class=p>,</span> <span class=s1>&#39;GNU Terry Pratchett&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Via&#39;</span><span class=p>,</span> <span class=s1>&#39;1.1 varnish&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Content-Length&#39;</span><span class=p>,</span> <span class=s1>&#39;49419&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Accept-Ranges&#39;</span><span class=p>,</span> <span class=s1>&#39;bytes&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Date&#39;</span><span class=p>,</span> <span class=s1>&#39;Fri, 19 Oct 2018 01:31:34 GMT&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Via&#39;</span><span class=p>,</span> <span class=s1>&#39;1.1 varnish&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Age&#39;</span><span class=p>,</span> <span class=s1>&#39;1228&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Connection&#39;</span><span class=p>,</span> <span class=s1>&#39;close&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Served-By&#39;</span><span class=p>,</span> <span class=s1>&#39;cache-iad2144-IAD, cache-bur17551-BUR&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Cache&#39;</span><span class=p>,</span> <span class=s1>&#39;HIT, HIT&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Cache-Hits&#39;</span><span class=p>,</span> <span class=s1>&#39;1, 1&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;X-Timer&#39;</span><span class=p>,</span> <span class=s1>&#39;S1539912694.426186,VS0,VE1&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Vary&#39;</span><span class=p>,</span> <span class=s1>&#39;Cookie&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Strict-Transport-Security&#39;</span><span class=p>,</span> <span class=s1>&#39;max-age=63072000; includeSubDomains&#39;</span><span class=p>)]</span>
</pre></div></p>
<p>如果我们想给链接传递一些参数该怎么实现呢？我们首先看一下<C>urlopen()</C>函数的API：</p>
<p> <div class=codehilite><pre><span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=p>[</span><span class=n>timeout</span><span class=p>,</span> <span class=p>]</span><span class=o>*</span><span class=p>,</span> 
    <span class=n>cafile</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=n>capath</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=n>cadefault</span><span class=o>=</span><span class=bp>False</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span>
</pre></div></p>
<p>下面我们详细说明下这几个参数的用法。</p>
<p><strong>data参数</strong></p>
<p><C>data</C>参数是可选的，如果要添加<C>data</C>，它要是字节流编码格式的内容，即<C>bytes</C>类型，可以通过<C>bytes()</C>方法进行转化，另外如果传递了这个 <C>data</C>参数，它的请求方式就不再是GET方式请求，而是POST。</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>urllib.parse</span>
<span class=kn>import</span> <span class=nn>urllib.request</span>
<span class=c1># 转码成bytes(字节流)类型</span>
<span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>urlencode</span><span class=p>({</span><span class=s1>&#39;word&#39;</span><span class=p>:</span> <span class=s1>&#39;hello&#39;</span><span class=p>}),</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
<span class=c1># 请求站点</span>
<span class=n>response</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/post&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
<span class=c1># 返回网页内容</span>
<span class=k>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</pre></div></p>
<p><strong>timeout参数</strong></p>
<p><C>timeout</C>参数可以设置超时时间，单位为秒。如果请求超出了设置的这个时间还没有得到响应，就会抛出异常<C>urllib.error.URLError</C>。如果不指定，就会使用全局默认时间。可以通过设置超时时间C&gt;timeout</C>来控制一个网页如果长时间未响应就跳过它的抓取，利用try-except语句就可以实现这样的操作:</p>
<p> <div class=codehilite><pre><span class=k>try</span><span class=p>:</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/get&#39;</span><span class=p>,</span> 
        <span class=n>timeout</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
<span class=k>except</span> <span class=n>urllib</span><span class=o>.</span><span class=n>error</span><span class=o>.</span><span class=n>URLError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>reason</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>timeout</span><span class=p>):</span>
        <span class=k>print</span><span class=p>(</span><span class=s1>&#39;TIME OUT&#39;</span><span class=p>)</span>
</pre></div></p>
<p><hh>Request</hh></p>
<p><C>urlopen()</C>方法也可以接收<C>Request</C>对象。<C>urlopen(url,...)</C>可以实现最基本请求的发起，但这几个简单的参数并不足以构建一个完整的请求，如果请求中需要加入Headers等信息，我们就可以利用更强大的<C>Request</C>类来构建一个请求。</p>
<p><C>Request</C>类的构造方法：</p>
<p> <div class=codehilite><pre><span class=k>class</span> <span class=nc>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>Request</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=p>{},</span> 
    <span class=n>origin_req_host</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=n>unverifiable</span><span class=o>=</span><span class=bp>False</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span>
</pre></div></p>
<ul>
<li><C>url</C>参数是URL。</li>
<li><C>data</C>参数如果要传必须传bytes(字节流)类型的，如果是一个字典，可以先用 <C>urllib.parse</C>模块里的<C>urlencode()</C>编码。</li>
<li><C>headers</C>参数是Request Headers，字典格式，你可以在构造Request时通过<C>headers</C>参数直接构造，也可以通过调用Request实例的<C>add_header()</C>方法来添加。</li>
<li><C>origin_req_host</C>参数指的是请求方的 host 名称或者 IP 地址.</li>
<li><C>unverifiable</C>参数指的是这个请求是否是无法验证的，默认是False</li>
<li><C>method</C>参数它用来指示请求使用的方法，比如GET，POST，PUT等等</li>
</ul>
<p>下面看一个具体的例子</p>
<p> <div class=codehilite><pre><span class=kn>from</span> <span class=nn>urllib</span> <span class=kn>import</span> <span class=n>request</span><span class=p>,</span> <span class=n>parse</span>

<span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://httpbin.org/post&#39;</span>
<span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span> <span class=s1>&#39;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Host&#39;</span><span class=p>:</span> <span class=s1>&#39;httpbin.org&#39;</span>
<span class=p>}</span>
<span class=nb>dict</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Germey&#39;</span>
<span class=p>}</span>
<span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>parse</span><span class=o>.</span><span class=n>urlencode</span><span class=p>(</span><span class=nb>dict</span><span class=p>),</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf8&#39;</span><span class=p>)</span>
<span class=n>req</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>Request</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;POST&#39;</span><span class=p>)</span>
<span class=n>response</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</pre></div></p>
<p><hh>高级用法</hh></p>
<p>有没有发现，在上面的过程中，我们虽然可以构造 Request，但是一些更高级的操作，比如 Cookies处理，代理设置等操作我们该怎么办？这时我们可以使用Handler。</p>
<p><C>urllib.request</C>模块里的<C>BaseHandler</C>类，它是所有其他<C>Handler</C>的父类，它提供了最基本的<C>Handler</C>的方法，例如 <C>default_open()</C>、<C>protocol_request()</C>方法等。接下来就有各种 <C>Handler</C>子类继承这个<C>BaseHandler</C>类，举例几个如下：</p>
<ul>
<li><C>HTTPDefaultErrorHandler</C>用于处理 HTTP 响应错误，错误都会抛出 HTTPError 类型的异常。</li>
<li><C>HTTPRedirectHandler</C>用于处理重定向。</li>
<li><C>HTTPCookieProcessor</C>用于处理 Cookies。</li>
<li><C>ProxyHandler</C>用于设置代理，默认代理为空。</li>
<li><C>HTTPPasswordMgr</C>用于管理密码，它维护了用户名密码的表。</li>
<li><C>HTTPBasicAuthHandler</C>用于管理认证，如果一个链接打开时需要认证，那么可以用它来解决认证问题。</li>
</ul>
<h4 id="12">1.2 处理异常<a class="headerlink" href="#12" title="Permanent link">&para;</a></h4>
<p>Urllib的error模块定义了由request模块产生的异常。如果出现了问题，request模块便会抛出error模块中定义的异常。</p>
<p><hh>URLError</hh>
URLError类来自Urllib库的error模块，它继承自OSError类，是error异常模块的基类，由request模块生的异常都可以通过捕获这个类来处理。它具有一个属性reason，即返回错误的原因。</p>
<p> <div class=codehilite><pre><span class=kn>from</span> <span class=nn>urllib</span> <span class=kn>import</span> <span class=n>request</span><span class=p>,</span> <span class=n>error</span>
<span class=k>try</span><span class=p>:</span>
    <span class=c1># 打开不存在的网站</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s1>&#39;http://www.pythonfs.org&#39;</span><span class=p>)</span>
<span class=k>except</span> <span class=n>error</span><span class=o>.</span><span class=n>URLError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=k>print</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>reason</span><span class=p>)</span>
</pre></div></p>
<p><hh>HTTPError</hh></p>
<p>HTTPError是URLError的子类，专门用来处理HTTP请求错误，比如认证请求失败等等。</p>
<p>它有三个属性:</p>
<ul>
<li>code，返回 HTTP Status Code，即状态码，比如 404 网页不存在，500 服务器内部错误等等。</li>
<li>reason，同父类一样，返回错误的原因。</li>
<li>headers，返回 Request Headers。</li>
</ul>
<p> <div class=codehilite><pre><span class=kn>from</span> <span class=nn>urllib</span> <span class=kn>import</span> <span class=n>request</span><span class=p>,</span> <span class=n>error</span>
<span class=k>try</span><span class=p>:</span>
    <span class=c1># 打开不存在的网站</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=s1>&#39;http://www.pythonfs.org&#39;</span><span class=p>)</span>
<span class=k>except</span> <span class=n>error</span><span class=o>.</span><span class=n>HTTPError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=k>print</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>reason</span><span class=p>,</span> <span class=n>e</span><span class=o>.</span><span class=n>code</span><span class=p>,</span> <span class=n>e</span><span class=o>.</span><span class=n>headers</span><span class=p>)</span>
</pre></div></p>
<h4 id="13">1.3 解析链接<a class="headerlink" href="#13" title="Permanent link">&para;</a></h4>
<h4 id="14-robots">1.4 分析Robots协议<a class="headerlink" href="#14-robots" title="Permanent link">&para;</a></h4>
<p><hh>Robots协议</hh></p>
<p>Robots协议也被称作爬虫协议、机器人协议，它的全名叫做网络爬虫排除标准(Robots Exclusion Protocol)，用来告诉爬虫和搜索引擎哪些页面可以抓取，哪些不可以抓取。它通常是一个叫做 robots.txt 的文本文件，放在网站的根目录下，例如<a href="https://www.jd.com/robots.txt">https://www.jd.com/robots.txt</a> 。</p>
<p>当爬虫访问一个站点时，它首先会检查下这个站点根目录下是否存在robots.txt文件，如果存在，搜索爬虫会根据其中定义的爬取范围来爬取。如果没有找到这个文件，那么搜索爬虫便会访问所有可直接访问的页面。</p>
<p>下面我们看一下京东的robots.txt的样例</p>
<p> <div class=codehilite><pre>User-agent: * 
Disallow: /?* 
Disallow: /pop/*.html 
Disallow: /pinpai/*.html?* 
User-agent: EtaoSpider 
Disallow: / 
User-agent: HuihuiSpider 
Disallow: / 
User-agent: GwdangSpider 
Disallow: / 
User-agent: WochachaSpider 
Disallow: /
</pre></div></p>
<p>最简单的robots.txt只有两条规则：</p>
<ul>
<li>User-agent：指定对哪些爬虫生效</li>
<li>Disallow：指定要屏蔽的网址。以正斜线(/)开头，可以列出特定的网址或模式。要屏蔽整个网站，使用正斜线即可;要屏蔽某一目录以及其中的所有内容，在目录名后添加正斜线;要屏蔽某个具体的网页，就指出这个网页。</li>
</ul>
<p><hh>robotparser</hh></p>
<p>robotparser模块提供了一个类，叫做RobotFileParser。它可以根据某网站的 robots.txt文件来判断一个爬取爬虫是否有权限来爬取这个网页。</p>
<p>使用非常简单，首先看一下它的声明</p>
<p> <div class=codehilite><pre>urllib.robotparser.RobotFileParser(url=&#39;&#39;)
</pre></div></p>
<p>使用这个类的时候非常简单，只需要在构造方法里传入robots.txt的链接即可。当然也可以声明时不传入，默认为空，再使用<C>set_url()</C>方法设置一下也可以。</p>
<p>有常用的几个方法分别介绍一下：</p>
<ul>
<li><C>set_url()</C>，用来设置 robots.txt 文件的链接。如果已经在创建 RobotFileParser 对象时传入了链接，那就不需要再使用这个方法设置了。</li>
<li><C>read()</C>，读取 robots.txt 文件并进行分析，注意这个函数是执行一个读取和分析操作，如果不调用这个方法，接下来的判断都会为 False，所以一定记得调用这个方法，这个方法不会返回任何内容，但是执行了读取操作。</li>
<li><C>parse()</C>，用来解析 robots.txt 文件，传入的参数是 robots.txt 某些行的内容，它会按照 robots.txt 的语法规则来分析这些内容。</li>
<li><C>can_fetch()</C>，方法传入两个参数，第一个是 User-agent，第二个是要抓取的 URL，返回的内容是该搜索引擎是否可以抓取这个 URL，返回结果是 True 或 False。</li>
<li><C>mtime()</C>，返回的是上次抓取和分析 robots.txt 的时间，这个对于长时间分析和抓取的搜索爬虫是很有必要的，你可能需要定期检查来抓取最新的 robots.txt。</li>
<li><C>modified()</C>，同样的对于长时间分析和抓取的搜索爬虫很有帮助，将当前时间设置为上次抓取和分析 robots.txt 的时间。</li>
</ul>
<p>以上是这个类提供的所有方法，下面我们用实例来感受一下：</p>
<p> <div class=codehilite><pre><span class=kn>from</span> <span class=nn>urllib.robotparser</span> <span class=kn>import</span> <span class=n>RobotFileParser</span>
<span class=n>rp</span> <span class=o>=</span> <span class=n>RobotFileParser</span><span class=p>()</span>
<span class=n>rp</span><span class=o>.</span><span class=n>set_url</span><span class=p>(</span><span class=s1>&#39;https://www.jd.com/robots.txt&#39;</span><span class=p>)</span>
<span class=n>rp</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<span class=k>print</span><span class=p>(</span><span class=n>rp</span><span class=o>.</span><span class=n>can_fetch</span><span class=p>(</span><span class=s1>&#39;*&#39;</span><span class=p>,</span> <span class=s1>&#39;https://miaosha.jd.com&#39;</span><span class=p>))</span> <span class=o>//</span> <span class=bp>True</span>
<span class=k>print</span><span class=p>(</span><span class=n>rp</span><span class=o>.</span><span class=n>can_fetch</span><span class=p>(</span><span class=s1>&#39;GwdangSpider&#39;</span><span class=p>,</span> <span class=s2>&quot;https://miaosha.jd.com&quot;</span><span class=p>))</span> <span class=o>//</span> <span class=bp>False</span>
</pre></div></p>
<h3 id="2-requests">2 使用Requests<a class="headerlink" href="#2-requests" title="Permanent link">&para;</a></h3>
<p>在前面一节我们了解了Urllib的基本用法，但是其中确实有不方便的地方。比如处理网页验证、处理Cookies等等，需要写Opener、Handler来进行处理。为了更加方便地实现这些操作，在这里就有了更为强大的库Requests，有了它，Cookies、登录验证、代理设置等操作都不是事儿。</p>
<p><a href="http://docs.python-requests.org/">Requests官方文档</a></p>
<h4 id="get">GET请求<a class="headerlink" href="#get" title="Permanent link">&para;</a></h4>
<p>首先让我们来构建一个最简单的 GET 请求，请求的链接为：http://httpbin.org/get，它会判断如果如果是 GET 请求的话，会返回响应的 Request 信息。</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>requests</span>
<span class=kn>import</span> <span class=nn>re</span>
<span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span> <span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36&#39;</span>
<span class=p>}</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://www.zhihu.com/explore&quot;</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
<span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;explore-feed.*?question_link.*?&gt;(.*?)&lt;/a&gt;&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>S</span><span class=p>)</span>
<span class=n>titles</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>titles</span><span class=p>)</span>
</pre></div></p>
<h4 id="post">POST请求<a class="headerlink" href="#post" title="Permanent link">&para;</a></h4>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>requests</span>

<span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;germey&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=s1>&#39;22&#39;</span><span class=p>}</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;http://httpbin.org/post&quot;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</pre></div></p>
<h4 id="_1">文件上传<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>我们知道 Reqeuests 可以模拟提交一些数据，假如有的网站需要我们上传文件，我们同样可以利用它来上传，实现非常简单，实例如下：</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>requests</span>

<span class=n>files</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;favicon.ico&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)}</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;http://httpbin.org/post&#39;</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=n>files</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</pre></div></p>
<h4 id="cookie">Cookie<a class="headerlink" href="#cookie" title="Permanent link">&para;</a></h4>
<p>可以直接用 Cookies 来维持登录状态。登录知乎，将 Headers 中的 Cookies 复制下来，将其设置到 Headers 里面，发送Request。</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>requests</span>

<span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;Cookie&#39;</span><span class=p>:</span> <span class=s1>&#39;知乎的Cookie&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Host&#39;</span><span class=p>:</span> <span class=s1>&#39;www.zhihu.com&#39;</span><span class=p>,</span>
    <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span> <span class=s1>&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36&#39;</span><span class=p>,</span>
<span class=p>}</span>
<span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.zhihu.com&#39;</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</pre></div></p>
<h4 id="_2">会话维持<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>在Requests中，如果直接利用<C>get()</C>或<C>post()</C>等方法的确可以做到模拟网页的请求。但是这实际上是相当于不同的会话，即不同的Session，也就是说相当于你用了两个浏览器打开了不同的页面。</p>
<p>设想这样一个场景，我们第一个请求利用了<C>post()</C>方法登录了某个网站，第二次想获取成功登录后的自己的个人信息，你又用了一次<C>get()</C> 方法去请求个人信息页面。实际上，这相当于打开了两个浏览器，是两个完全不相关的会话，能成功获取个人信息吗？那当然不能。</p>
<p>其实解决这个问题的主要方法就是维持同一个会话，也就是相当于打开一个新的浏览器选项卡而不是新开一个浏览器。但是我又不想每次设置Cookies，那该怎么办？这时候就有了新的利器Session对象。</p>
<h4 id="_3">代理设置<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>对于某些网站，在测试的时候请求几次，能正常获取内容。但是一旦开始大规模爬取，对于大规模且频繁的请求，网站可能会直接登录验证，验证码，甚至直接把IP给封禁掉。那么为了防止这种情况的发生，我们就需要设置代理来解决这个问题，在 Requests 中需要用到 proxies 这个参数。</p>
<p> <div class=codehilite><pre><span class=kn>import</span> <span class=nn>requests</span>
<span class=n>proxies</span> <span class=o>=</span> <span class=p>{</span>
  <span class=s1>&#39;http&#39;</span><span class=p>:</span> <span class=s1>&#39;http://10.10.1.10:3128&#39;</span><span class=p>,</span>
  <span class=s1>&#39;https&#39;</span><span class=p>:</span> <span class=s1>&#39;http://10.10.1.10:1080&#39;</span><span class=p>,</span>
<span class=p>}</span>
<span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://www.taobao.com&#39;</span><span class=p>,</span> <span class=n>proxies</span><span class=o>=</span><span class=n>proxies</span><span class=p>)</span>
</pre></div></p>
<h3 id="3">3 正则表达式<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<h3 id="4-example">4 Example: 抓取猫眼电影排行<a class="headerlink" href="#4-example" title="Permanent link">&para;</a></h3></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../extra_javascript/tabhack.js" defer></script>
        <script src="../../../extra_javascript/baidu.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
