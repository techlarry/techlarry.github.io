<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhenhua Wang">
        <link rel="canonical" href="http://larryim.cc/note/algorithmPrinceton/topic4/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Topic 4: PriorityQueues - Zhenhua's Notes - Algorithm</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/docco.min.css">
        <link href="../../extra_css/custom.css" rel="stylesheet">
        <link href="../../extra_css/custom.js" rel="stylesheet">
        <link href="../../extra_css/friendly.css" rel="stylesheet">
        <link href="../../extra_css/theme.css" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/lunr-0.5.7.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/mustache.min.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/require.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/search.js" rel="stylesheet">
        <link href="../../extra_css/mkdocs/js/text.js" rel="stylesheet">
        <link href="../../extra_css/code-tab.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Zhenhua's Notes - Algorithm</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">AlgorithmPrinceton <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../">Contents</a>
</li>
                                    
<li >
    <a href="../topic1/">Topic 1: UnionFind </a>
</li>
                                    
<li >
    <a href="../topic2/">Topic 2: StackQueue</a>
</li>
                                    
<li >
    <a href="../topic3/">Topic 3: Sort </a>
</li>
                                    
<li class="active">
    <a href="./">Topic 4: PriorityQueues</a>
</li>
                                    
<li >
    <a href="../topic5/">Topic 5: Symbol Tables</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">AlgorithmStanford <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../algorithmStanford/">Contents</a>
</li>
                                    
<li >
    <a href="../../algorithmStanford/dynamicprogramming/">Topic: Dynammic Programming </a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">CS61B <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../cs61b/">Contents</a>
</li>
                                    
<li >
    <a href="../../cs61b/Lab1/">Lab1: javac, java, git</a>
</li>
                                    
<li >
    <a href="../../cs61b/Lab2/">Lab2: Unit Testing with JUnit and IntLists</a>
</li>
                                    
<li >
    <a href="../../cs61b/Lab3/">Lab3: Unit Testing with JUnit, Debugging</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../books/">Books</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../topic3/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../topic5/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#topic-4-priority-queues">Topic 4: Priority Queues</a></li>
        <li class="main "><a href="#1-priority-queue">1 Priority Queue</a></li>
            <li><a href="#elementary-implementations">Elementary implementations</a></li>
            <li><a href="#analysis">Analysis</a></li>
        <li class="main "><a href="#2-binary-heap">2 Binary Heap</a></li>
            <li><a href="#promotion-in-a-heap">Promotion in a heap</a></li>
            <li><a href="#insertion-in-a-heap">Insertion in a heap</a></li>
            <li><a href="#demotion-in-a-heap">Demotion in a heap</a></li>
            <li><a href="#delete-the-maximum-in-a-heap">Delete the maximum in a heap</a></li>
        <li class="main "><a href="#3-heap-sort">3 Heap Sort</a></li>
            <li><a href="#heap-construction">Heap construction</a></li>
            <li><a href="#sortdown">Sortdown</a></li>
            <li><a href="#analysis_1">Analysis</a></li>
        <li class="main "><a href="#4-quick-sort">4 Quick Sort</a></li>
            <li><a href="#5-quick-select">5 Quick Select</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="topic-4-priority-queues"><strong>Topic 4: Priority Queues</strong><a class="headerlink" href="#topic-4-priority-queues" title="Permanent link">&para;</a></h3>
<h3 id="1-priority-queue">1 Priority Queue<a class="headerlink" href="#1-priority-queue" title="Permanent link">&para;</a></h3>
<blockquote>
<p>A <strong>priority queue</strong> is an abstract data type which is like a regular queue or stack data structure, but where additionally each element has a "priority" associated with it.  It basically supports two operations: <em>remove the maximum</em> and <em>insert</em>.</p>
</blockquote>
<p><img alt="PriorityQueueAPI" src="../figures/PriorityQueueAPI.png" /></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Q: The purpose of Binary Heap: Why exactly don’t we just sort and then consider the items in increasing order in the sorted array?</p>
<ul>
<li>In some data-processing examples such as TopM and Multiway, the total amount of data is far too large to consider sorting (or even storing in memory).</li>
<li>In other examples, all the data does not even exist together at any point in time.</li>
</ul>
</div>
<h4 id="elementary-implementations">Elementary implementations<a class="headerlink" href="#elementary-implementations" title="Permanent link">&para;</a></h4>
<p><hh> Array representation (unordered)</hh></p>
<p>Perhaps the simplest priority-queue implementation is based on pushdown stacks. The code for <C>insert</C> in the priority queue is the same as for <C>push</C> in the stack. To implement <C>remove the maximum</C>, we can add code like the inner loop of selection sort to exchange the maximum item with the item at the end and then delete that one, the same as <C>pop()</C> for stacks. As with stacks, we can add resizing-array code to ensure that the data structure is always at least one-quarter full and never overflows.</p>
<p><details><summary>click here</summary></p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UnorderedMaxPQ</span><span class=o>&lt;</span><span class=n>Key</span> <span class=kd>extends</span> <span class=n>Comparable</span><span class=o>&lt;</span><span class=n>Key</span><span class=o>&gt;&gt;</span> <span class=o>{</span>

    <span class=kd>private</span> <span class=n>Key</span><span class=o>[]</span> <span class=n>pq</span><span class=o>;</span> <span class=c1>// pq[i] = ith element on pq</span>
    <span class=kd>private</span> <span class=kt>int</span> <span class=n>N</span><span class=o>;</span> <span class=c1>// number of elements on pq</span>

    <span class=nd>@SuppressWarnings</span><span class=o>(</span><span class=s>&quot;unchecked&quot;</span><span class=o>)</span>
    <span class=kd>public</span> <span class=nf>UnorderedMaxPQ</span><span class=o>(</span><span class=kt>int</span> <span class=n>capacity</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>pq</span> <span class=o>=</span> <span class=o>(</span><span class=n>Key</span><span class=o>[])</span> <span class=k>new</span> <span class=n>Comparable</span><span class=o>[</span><span class=n>capacity</span><span class=o>];</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>isEmpty</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>N</span> <span class=o>==</span> <span class=mi>0</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>insert</span><span class=o>(</span><span class=n>Key</span> <span class=n>x</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>N</span><span class=o>++]</span> <span class=o>=</span> <span class=n>x</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=n>Key</span> <span class=nf>delMax</span><span class=o>()</span> <span class=o>{</span>
        <span class=kt>int</span> <span class=n>max</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span>
        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>less</span><span class=o>(</span><span class=n>max</span><span class=o>,</span> <span class=n>i</span><span class=o>))</span>
                <span class=n>max</span> <span class=o>=</span> <span class=n>i</span><span class=o>;</span>
        <span class=n>exch</span><span class=o>(</span><span class=n>max</span><span class=o>,</span> <span class=n>N</span> <span class=o>-</span> <span class=mi>1</span><span class=o>);</span>
        <span class=n>Key</span> <span class=n>max_element</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[--</span><span class=n>N</span><span class=o>];</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>N</span><span class=o>]</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span> <span class=c1>//null out entry, to prevent loitering</span>
        <span class=k>return</span> <span class=n>max_element</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>exch</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>int</span> <span class=n>j</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Key</span> <span class=n>swap</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>];</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>];</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>swap</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>private</span> <span class=kt>boolean</span> <span class=nf>less</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>int</span> <span class=n>j</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>compareTo</span><span class=o>(</span><span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>;</span>
    <span class=o>}</span>

<span class=o>}</span>
</pre></div></p>
<p></details></p>
<p><hh>Array representation (ordered).</hh></p>
<p>Another approach for <C>insert</C>  is to move larger entries one position to the right, thus keeping the keys in the array in order (as in insertion sort). Thus, the largest element is always at the end, and the code for remove the maximum in the priority queue is the same as for <C>pop</C> in the stack.</p>
<h4 id="analysis">Analysis<a class="headerlink" href="#analysis" title="Permanent link">&para;</a></h4>
<p>Order of growth of worst-case running time for priority-queue implementations：</p>
<p><img alt="Order of growth of worst-case running time for priority-queue implementations" src="../figures/priorityQueueComplexity.png" /></p>
<h3 id="2-binary-heap">2 Binary Heap<a class="headerlink" href="#2-binary-heap" title="Permanent link">&para;</a></h3>
<blockquote>
<p>A <strong>binary tree</strong> is heap-ordered if the key in each node is larger than or equal to the keys in that node’s two children (if any).</p>
<p>A <strong>binary heap</strong> is a collection of keys arranged in a <mark class="critic">complete</mark> heap-ordered binary tree, represented in level order in an array (not using the first entry).</p>
</blockquote>
<p><img alt="HeapRepresentations" src="../figures/HeapRepresentations.png" /></p>
<ul>
<li>In a heap, the parent of the node in position <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> is in position ⎣<span><span class="MathJax_Preview">k/2</span><script type="math/tex">k/2</script></span>⎦ and, conversely, the two children of the node in position <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> are in positions <span><span class="MathJax_Preview">2k</span><script type="math/tex">2k</script></span> and <span><span class="MathJax_Preview">2k + 1</span><script type="math/tex">2k + 1</script></span>.</li>
<li>we can travel up and down by doing simple arithmetic on array indices: to move up the tree from <span><span class="MathJax_Preview">a[k]</span><script type="math/tex">a[k]</script></span> we set <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> to <span><span class="MathJax_Preview">k/2</span><script type="math/tex">k/2</script></span>; to move down the tree we set k to <span><span class="MathJax_Preview">2k</span><script type="math/tex">2k</script></span> or <span><span class="MathJax_Preview">2k+1</span><script type="math/tex">2k+1</script></span>.</li>
<li>The height of a complete binary tree of size <span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span> is ⎣ <span><span class="MathJax_Preview">\lg N</span><script type="math/tex">\lg N</script></span> ⎦ .</li>
</ul>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Q. Why not use <span><span class="MathJax_Preview">a[0]</span><script type="math/tex">a[0]</script></span> in the heap representation?</p>
<p>A. Doing so simplifies the arithmetic a bit.</p>
</div>
<h4 id="promotion-in-a-heap">Promotion in a heap<a class="headerlink" href="#promotion-in-a-heap" title="Permanent link">&para;</a></h4>
<p>Scenario: Child's key becomes larger key than its parent's key.</p>
<p><img alt="PromotionInAHeap" src="../figures/PromotionInAHeap.png" /></p>
<p>To eliminate the violation:</p>
<ul>
<li>Exchange key in child with key in parent. </li>
<li>Repeat until heap order restored.</li>
</ul>
<p> <div class=codehilite><pre><span class=kd>private</span> <span class=kt>void</span> <span class=nf>swim</span><span class=o>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>)</span> <span class=o>{</span>
    <span class=k>while</span> <span class=o>(</span><span class=n>k</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>less</span><span class=o>(</span><span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>,</span> <span class=n>k</span><span class=o>))</span> <span class=o>{</span>
        <span class=n>exch</span><span class=o>(</span><span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>,</span> <span class=n>k</span><span class=o>);</span>
        <span class=n>k</span> <span class=o>=</span> <span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>;</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></p>
<h4 id="insertion-in-a-heap">Insertion in a heap<a class="headerlink" href="#insertion-in-a-heap" title="Permanent link">&para;</a></h4>
<ul>
<li>Insert: Add node at end, then swim it up. </li>
<li>Cost: At most <span><span class="MathJax_Preview">1 + \lg N</span><script type="math/tex">1 + \lg N</script></span> compares.</li>
</ul>
<p><img alt="InsertInAHeap" src="../figures/InsertInAHeap.png" /></p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kt>void</span> <span class=nf>insert</span><span class=o>(</span><span class=n>Key</span> <span class=n>v</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>pq</span><span class=o>[++</span><span class=n>N</span><span class=o>]</span> <span class=o>=</span> <span class=n>v</span><span class=o>;</span>
    <span class=n>swim</span><span class=o>(</span><span class=n>N</span><span class=o>);</span>
<span class=o>}</span>
</pre></div></p>
<h4 id="demotion-in-a-heap">Demotion in a heap<a class="headerlink" href="#demotion-in-a-heap" title="Permanent link">&para;</a></h4>
<p>Scenario: Parent's key becomes smaller than one (or both) of its children's.</p>
<p>To eliminate the violation:</p>
<ul>
<li>Exchange key in parent with key in <strong>larger</strong> child. </li>
<li>Repeat until heap order restored.</li>
</ul>
<p><img alt="DemotionInAHeap" src="../figures/DemotionInAHeap.png" /></p>
<p> <div class=codehilite><pre><span class=kd>private</span> <span class=kt>void</span> <span class=nf>sink</span><span class=o>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>)</span> <span class=o>{</span>
    <span class=k>while</span> <span class=o>(</span><span class=mi>2</span><span class=o>*</span><span class=n>k</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=o>)</span> <span class=o>{</span>
        <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>k</span><span class=o>;</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>N</span> <span class=o>&amp;&amp;</span> <span class=n>less</span><span class=o>(</span><span class=n>j</span><span class=o>,</span> <span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=o>))</span> <span class=n>j</span><span class=o>++;</span>
        <span class=k>if</span> <span class=o>(!</span><span class=n>less</span><span class=o>(</span><span class=n>k</span><span class=o>,</span> <span class=n>j</span><span class=o>))</span> <span class=k>break</span><span class=o>;</span>
        <span class=n>exch</span><span class=o>(</span><span class=n>k</span><span class=o>,</span> <span class=n>j</span><span class=o>);</span>
        <span class=n>k</span> <span class=o>=</span> <span class=n>j</span><span class=o>;</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div></p>
<h4 id="delete-the-maximum-in-a-heap">Delete the maximum in a heap<a class="headerlink" href="#delete-the-maximum-in-a-heap" title="Permanent link">&para;</a></h4>
<ul>
<li>Delete max. Exchange root with node at end, then sink it down. </li>
<li>Cost. At most <span><span class="MathJax_Preview">2 \lg N</span><script type="math/tex">2 \lg N</script></span> compares.</li>
</ul>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=n>Key</span> <span class=nf>delMax</span><span class=o>()</span> <span class=o>{</span>
    <span class=n>Key</span> <span class=n>max</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=mi>1</span><span class=o>];</span>
    <span class=n>exch</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>N</span><span class=o>--);</span>
    <span class=n>sink</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
    <span class=n>pq</span><span class=o>[</span><span class=n>N</span> <span class=o>+</span> <span class=mi>1</span><span class=o>]</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
    <span class=k>return</span> <span class=n>max</span><span class=o>;</span>
<span class=o>}</span>
</pre></div></p>
<p><img alt="RemoveTheMaximum" src="../figures/RemoveTheMaximum.png" /></p>
<p><hh>Complete Java Code</hh></p>
<p><details><summary>Click Here</summary></p>
<p> <div class=codehilite><pre><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MaxPQ</span><span class=o>&lt;</span><span class=n>Key</span> <span class=kd>extends</span> <span class=n>Comparable</span><span class=o>&lt;</span><span class=n>Key</span><span class=o>&gt;&gt;</span> <span class=o>{</span>

    <span class=kd>private</span> <span class=n>Key</span><span class=o>[]</span> <span class=n>pq</span><span class=o>;</span> <span class=c1>// pq[i] = ith element on pq</span>
    <span class=kd>private</span> <span class=kt>int</span> <span class=n>N</span><span class=o>;</span> <span class=c1>// number of elements on pq</span>

    <span class=nd>@SuppressWarnings</span><span class=o>(</span><span class=s>&quot;unchecked&quot;</span><span class=o>)</span>
    <span class=kd>public</span> <span class=nf>MaxPQ</span><span class=o>(</span><span class=kt>int</span> <span class=n>capacity</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>pq</span> <span class=o>=</span> <span class=o>(</span><span class=n>Key</span><span class=o>[])</span> <span class=k>new</span> <span class=n>Comparable</span><span class=o>[</span><span class=n>capacity</span> <span class=o>+</span> <span class=mi>1</span><span class=o>];</span>
    <span class=o>}</span>


    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>insert</span><span class=o>(</span><span class=n>Key</span> <span class=n>v</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>pq</span><span class=o>[++</span><span class=n>N</span><span class=o>]</span> <span class=o>=</span> <span class=n>v</span><span class=o>;</span>
        <span class=n>swim</span><span class=o>(</span><span class=n>N</span><span class=o>);</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=n>Key</span> <span class=nf>delMax</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>Key</span> <span class=n>max</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=mi>1</span><span class=o>];</span>
        <span class=n>exch</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>N</span><span class=o>--);</span>
        <span class=n>sink</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>N</span> <span class=o>+</span> <span class=mi>1</span><span class=o>]</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
        <span class=k>return</span> <span class=n>max</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>isEmpty</span><span class=o>()</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>N</span> <span class=o>==</span> <span class=mi>0</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>swim</span><span class=o>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>while</span> <span class=o>(</span><span class=n>k</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=n>less</span><span class=o>(</span><span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>,</span> <span class=n>k</span><span class=o>))</span> <span class=o>{</span>
            <span class=n>exch</span><span class=o>(</span><span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>,</span> <span class=n>k</span><span class=o>);</span>
            <span class=n>k</span> <span class=o>=</span> <span class=n>k</span> <span class=o>/</span> <span class=mi>2</span><span class=o>;</span>
        <span class=o>}</span>
    <span class=o>}</span>


    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>sink</span><span class=o>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>while</span> <span class=o>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=o>)</span> <span class=o>{</span>
            <span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>k</span><span class=o>;</span>
            <span class=k>if</span> <span class=o>(</span><span class=n>j</span> <span class=o>&lt;</span> <span class=n>N</span> <span class=o>&amp;&amp;</span> <span class=n>less</span><span class=o>(</span><span class=n>j</span><span class=o>,</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=o>))</span> <span class=n>j</span><span class=o>++;</span>
            <span class=k>if</span> <span class=o>(!</span><span class=n>less</span><span class=o>(</span><span class=n>k</span><span class=o>,</span> <span class=n>j</span><span class=o>))</span> <span class=k>break</span><span class=o>;</span>
            <span class=n>exch</span><span class=o>(</span><span class=n>k</span><span class=o>,</span> <span class=n>j</span><span class=o>);</span>
            <span class=n>k</span> <span class=o>=</span> <span class=n>j</span><span class=o>;</span>
        <span class=o>}</span>
    <span class=o>}</span>


    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>exch</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>int</span> <span class=n>j</span><span class=o>)</span> <span class=o>{</span>
        <span class=n>Key</span> <span class=n>swap</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>];</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>];</span>
        <span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>]</span> <span class=o>=</span> <span class=n>swap</span><span class=o>;</span>
    <span class=o>}</span>

    <span class=kd>private</span> <span class=kt>boolean</span> <span class=nf>less</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=kt>int</span> <span class=n>j</span><span class=o>)</span> <span class=o>{</span>
        <span class=k>return</span> <span class=n>pq</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>compareTo</span><span class=o>(</span><span class=n>pq</span><span class=o>[</span><span class=n>j</span><span class=o>])</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=o>;</span>
    <span class=o>}</span>

<span class=o>}</span>
</pre></div></p>
<p></details></p>
<h3 id="3-heap-sort">3 Heap Sort<a class="headerlink" href="#3-heap-sort" title="Permanent link">&para;</a></h3>
<p>Heapsort use any heap-based priority queue as the basis for a sorting algorithm by inserting a sequence of items, then successively removing the smallest to get them out.</p>
<p>Heapsort breaks into two phases: </p>
<ul>
<li><C>heap construction</C>: reorganize the original array into a heap.</li>
<li><C>sortdown</C>: pull the items out of the heap in decreasing order to build the sorted result.</li>
</ul>
<p><img alt="HeapSortDemo" src="../figures/HeapSortDemo.png" /></p>
<h4 id="heap-construction">Heap construction<a class="headerlink" href="#heap-construction" title="Permanent link">&para;</a></h4>
<p>Build heap using bottom-up method:</p>
<ul>
<li>proceed from bottom to top, using <C>sink()</C> to make subheaps.</li>
<li>The scan starts halfway, and ends at position 1.</li>
</ul>
<p> <div class=codehilite><pre><span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=na>length</span><span class=o>;</span>
<span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>N</span><span class=o>/</span><span class=mi>2</span><span class=o>;</span> <span class=n>k</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=o>;</span> <span class=n>k</span><span class=o>--)</span>
    <span class=n>sink</span><span class=o>(</span><span class=n>a</span><span class=o>,</span> <span class=n>k</span><span class=o>,</span> <span class=n>N</span><span class=o>);</span>
</pre></div></p>
<h4 id="sortdown">Sortdown<a class="headerlink" href="#sortdown" title="Permanent link">&para;</a></h4>
<p>Sortdown: repeatedly delete the largest remaining item.</p>
<ul>
<li>Remove the maximum, one at a time.</li>
<li>Leave in array, instead of nulling out.</li>
</ul>
<p> <div class=codehilite><pre><span class=k>while</span> <span class=o>(</span><span class=n>N</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=o>)</span> <span class=o>{</span>
    <span class=n>exch</span><span class=o>(</span><span class=n>a</span><span class=o>,</span><span class=mi>1</span><span class=o>,</span> <span class=n>N</span><span class=o>--);</span>
    <span class=n>sink</span><span class=o>(</span><span class=n>a</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=n>N</span><span class=o>);</span> 
<span class=o>}</span>
</pre></div></p>
<h4 id="analysis_1">Analysis<a class="headerlink" href="#analysis_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Heap construction uses <span><span class="MathJax_Preview">\le 2 N</span><script type="math/tex">\le 2 N</script></span> compares and exchanges. </li>
<li>Heapsort uses  <span><span class="MathJax_Preview">\le 2 N \lg N</span><script type="math/tex">\le 2 N \lg N</script></span> compares and exchanges.</li>
</ul>
<p>Heapsort is optimal for both time and space, but:</p>
<ul>
<li>Inner loop longer than quicksort’s.</li>
<li>Makes poor use of cache memory.</li>
<li>Not stable.</li>
</ul>
<h3 id="4-quick-sort">4 Quick Sort<a class="headerlink" href="#4-quick-sort" title="Permanent link">&para;</a></h3>
<h4 id="5-quick-select">5 Quick Select<a class="headerlink" href="#5-quick-select" title="Permanent link">&para;</a></h4></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../extra_javascript/tabhack.js" defer></script>
        <script src="../../extra_javascript/baidu.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
