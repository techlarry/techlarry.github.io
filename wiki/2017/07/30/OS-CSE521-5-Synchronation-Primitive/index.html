<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>Synchronization Primitives | Wiki</title>
    
    
        <meta name="keywords" content="OS" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Synchronization primitives(同步原语) are simple software mechanisms provided by a platform (e.g. operating system) to its users for the purposes of supporting thread or process synchronization. They’re us">
<meta name="keywords" content="OS">
<meta property="og:type" content="article">
<meta property="og:title" content="Synchronization Primitives">
<meta property="og:url" content="http://larryim.cc/2017/07/30/OS-CSE521-5-Synchronation-Primitive/index.html">
<meta property="og:site_name" content="Wiki">
<meta property="og:description" content="Synchronization primitives(同步原语) are simple software mechanisms provided by a platform (e.g. operating system) to its users for the purposes of supporting thread or process synchronization. They’re us">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://or9a8nskt.bkt.clouddn.com/15314088473143.jpg">
<meta property="og:image" content="http://or9a8nskt.bkt.clouddn.com/whentwothreadsrace.png">
<meta property="og:image" content="http://or9a8nskt.bkt.clouddn.com/whentospin.png">
<meta property="og:image" content="http://or9a8nskt.bkt.clouddn.com/when_to_sleep.png">
<meta property="og:image" content="http://or9a8nskt.bkt.clouddn.com/condition_variable.png">
<meta property="og:updated_time" content="2018-07-13T00:39:04.837Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Synchronization Primitives">
<meta name="twitter:description" content="Synchronization primitives(同步原语) are simple software mechanisms provided by a platform (e.g. operating system) to its users for the purposes of supporting thread or process synchronization. They’re us">
<meta name="twitter:image" content="http://or9a8nskt.bkt.clouddn.com/15314088473143.jpg">
    

    

    

    <link rel="stylesheet" href="/wiki/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/wiki/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/wiki/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/wiki/css/style.css">
    <script src="/wiki/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="/wiki/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>
    
    
        <link rel="stylesheet" href="/wiki/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/wiki/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-112743284-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    
        <script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?fdc936c9f5a3b72177541183cdeb8cb3";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>

    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/wiki/" id="logo">
                
                <span class="site-title">Wiki</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/wiki/">首页</a>
                
                    <a class="main-nav-link" href="/wiki/tags">标签</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/wiki/',
        CONTENT_URL: '/wiki/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/wiki/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/wiki/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/wiki/tags">标签</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id='categories'>
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id='allExpand' href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree" > 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Algorithm
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/10/10/Algorithm-水塘抽样/">水塘抽样</a></li>  <li class="file"><a href="/wiki/2017/10/30/Algorithm-Divide-and-Conquer/">Divide and Conquer</a></li>  <li class="file"><a href="/wiki/2017/01/30/Algorithm-Recursion/">Recursion</a></li>  <li class="file"><a href="/wiki/2017/10/30/Algorithm-Backtracking/">Exhaustive Search and Backtracking</a></li>  <li class="file"><a href="/wiki/2017/08/17/Algorithm-位操作/">位操作</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            C
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/12/30/C-static用法/">static用法</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            C++
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/07/30/C-C-Primer-12-动态内存-C-Primer-12-动态内存C-Primer-12-动态内存/">C++ Primer (12) - 动态内存</a></li>  <li class="file"><a href="/wiki/2017/07/30/C-C-Primer-6-函数C-Primer-12-动态内存/">C++ Primer (6) - 函数</a></li>  <li class="file"><a href="/wiki/2017/10/30/C-STL源码剖析/">STL源码剖析</a></li>  <li class="file"><a href="/wiki/2018/03/01/C-面试题/"></a></li>  <li class="file"><a href="/wiki/2017/08/17/C-Vector-string/">STL中的vector<string>总结</a></li>  <li class="file"><a href="/wiki/2017/08/17/C-C-面试经典100题/">C++面试经典100题</a></li>  <li class="file"><a href="/wiki/2017/08/17/C-EOF/">EOF</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            CSAPP Lab
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/12/30/CSAPP-Lab-Malloc-lab/">Lab6 Malloc Lab</a></li>  <li class="file"><a href="/wiki/2017/12/30/CSAPP-Lab-Shell-Lab/">Lab5 Shell Lab</a></li>  <li class="file"><a href="/wiki/2017/12/30/CSAPP-Lab-Cache-Lab/">Lab4 Cache Lab</a></li>  <li class="file"><a href="/wiki/2017/12/30/CSAPP-Lab-Attack-Lab/">Lab3 Attack Lab</a></li>  <li class="file"><a href="/wiki/2017/12/30/CSAPP-Lab-Data-Lab/">Lab1 Data Lab</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Java
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2018/07/12/Java-关键字native/">修饰词native</a></li>  <li class="file"><a href="/wiki/2018/07/12/Java-record/">Java record</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Leetcode
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/10/30/Leetcode-941-Valid-Mountain-Array/">941. Valid Mountain Array</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-876-Middle-of-the-Linked-List/">876. Middle of the Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-867-Transpose-Matrix/">867. Transpose Matrix</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-841-Keys-and-Rooms/">841. Keys and Rooms</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-785-Is-Graph-Bipartite/">785. Is Graph Bipartite?</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-783-Minimum-Distance-Between-BST-Nodes/">783. Minimum Distance Between BST Nodes</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-760-Find-Anagram-Mappings/">760. Find Anagram Mappings</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-746-Min-Cost-Climbing-Stairs/">746. Min Cost Climbing Stairs</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-743-Network-Delay-Time/">743. Network Delay Time</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-741-Cherry-Pickup/">741. Cherry Pickup</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-728-Self-Dividing-Numbers/">728. Self Dividing Numbers</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-703-Kth-Largest-Element-in-a-Stream/">703. Kth Largest Element in a Stream</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-687-Longest-Univalue-Path/">687. Longest Univalue Path</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-685-Redundant-Connection-II/">685. Redundant Connection II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-684-Redundant-Connection/">684. Redundant Connection</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-671-Second-Minimum-Node-In-a-Binary-Tree/">671. Second Minimum Node In a Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-637-Average-of-Levels-in-Binary-Tree/">637. Average of Levels in Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-633-Sum-of-Square-Numbers/">633. Sum of Square Numbers</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-606-Construct-String-from-Binary-Tree/">606. Construct String from Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-599-Minimum-Index-Sum-of-Two-Lists/">599. Minimum Index Sum of Two Lists</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-559-Maximum-Depth-of-N-ary-Tree/">559. Maximum Depth of N-ary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-538-Convert-BST-to-Greater-Tree/">538. Convert BST to Greater Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-507-Perfect-Number/">507. Perfect Number</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-500-Keyboard-Row/">500. Keyboard Row</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-463-Island-Perimeter/">463. Island Perimeter</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-438-Find-All-Anagrams-in-a-String/">438. Find All Anagrams in a String</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-437-Path-Sum-III/">437. Path Sum III</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-429-N-ary-Tree-Level-Order-Traversal/">429. N-ary Tree Level Order Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-415-Add-Strings/">415. Add Strings</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-409-Longest-Palindrome/">409. Longest Palindrome</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-404-Sum-of-Left-Leaves/">404. Sum of Left Leaves</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-401-Binary-Watch/">401. Binary Watch</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-399-Evaluate-Division/">399. Evaluate Division</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-384-Shuffle-an-Array/">384. Shuffle an Array</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-382-Linked-List-Random-Node/">382. Linked List Random Node</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-378-Kth-Smallest-Element-in-a-Sorted-Matrix/">378. Kth Smallest Element in a Sorted Matrix</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-373-Find-K-Pairs-with-Smallest-Sums/">373. Find K Pairs with Smallest Sums</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-372-Super-Pow/">372. Super Pow</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-370-Range-Addition/">370. Range Addition</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-367-Valid-Perfect-Square/">367. Valid Perfect Square</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-366-Find-Leaves-of-Binary-Tree/">366. Find Leaves of Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-359-Logger-Rate-Limiter/">359. Logger Rate Limiter</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-350-Intersection-of-Two-Arrays-II/">350. Intersection of Two Arrays II</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-349-Intersection-of-Two-Arrays/">349. Intersection of Two Arrays</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-345-Reverse-Vowels-of-a-String/">345. Reverse Vowels of a String</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-344-Reverse-String/">344. Reverse String</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-338-Counting-Bits/">338. Counting Bits</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-337-House-Robber-III/">337. House Robber III</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-332-Reconstruct-Itinerary/">332. Reconstruct Itinerary</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-331-Verity-Preorder-Serialization-of-a-Binary-Tree/">331. Verify Preorder Serialization of a Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-328-Odd-Even-Linked-List/">328. Odd Even Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-326-Power-of-Three/">326. Power of Three</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-310-Minimum-Height-Trees/">310. Minimum Height Trees</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-309-Best-Time-to-Buy-and-Sell-Stock-with-Cooldown/">309. Best Time to Buy and Sell Stock with Cooldown</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-304-Range-Sum-Query-2D-Immutable/">304. Range Sum Query 2D - Immutable</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-303-Range-Sum-Query-Immutable/">303. Range Sum Query - Immutable</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-300-Longest-Increasing-Subsequence/">300. Longest Increasing Subsequence</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-297-Serialize-and-Deserialize-Binary-Tree/">297. Serialize and Deserialize Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-295-Find-Median-from-Data-Stream/">295. Find Median from Data Stream</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-290-Word-Pattern/">290. Word Pattern</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-287-Find-the-Duplicate-Number/">287. Find the Duplicate Number</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-279-Perfect-Squares/">279. Perfect Squares</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-278-First-Bad-Version/">278. First Bad Version</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-276-Paint-Fence/">276. Paint Fence</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-270-Closest-Binary-Search-Tree-Value/">270. Closest Binary Search Tree Value</a></li>  <li class="file"><a href="/wiki/2017/08/17/Leetcode-268-Missing-Number/">268. Missing Number</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-265-Paint-House-II/">265. Paint House II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-264-Ugly-Number-II/">264. Ugly Number II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-263-Ugly-Number/">263. Ugly Number</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-261-Graph-Valid-Tree/">261. Graph Valid Tree</a></li>  <li class="file"><a href="/wiki/2017/08/17/Leetcode-260-Single-Number-III/">260. Single Number III</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-258-Add-Digits/">258. Add Digits</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-257-Binary-Tree-Paths/">257. Binary Tree Paths</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-256-Paint-House/">256. Paint House</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-242-Valid-Anagram/">242. Valid Anagram</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-241-Different-Ways-to-Add-Parentheses/">241. Different Ways to Add Parentheses</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-240-Search-a-2D-Matrix-II/">240. Search a 2D Matrix II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-237-Delete-Node-in-a-Linked-List/">237. Delete Node in a Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-236-Lowest-Common-Ancestor-of-a-Binary-Tree/">236. Lowest Common Ancestor of a Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-235-Lowest-Common-Ancestor-of-a-Binary-Search-Tree/">235. Lowest Common Ancestor of a Binary Search Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-234-Palindrome-Linked-List/">234. Palindrome Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-232-Implement-Queue-using-Stacks/">232. Implement Queue using Stacks</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-230-Kth-Smallest-Element-in-a-BST/">230. Kth Smallest Element in a BST</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-226-Invert-Binary-Tree/">226. Invert Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-225-mplementStackUsingQueues/">225. Implement Stack using Queues</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-224-Basic-Calculator/">224. Basic Calculator</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-222-Count-Complete-Tree-Nodes/">222. Count Complete Tree Nodes</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-221-Maximal-Square/">221. Maximal Square</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-216-Combination-Sum-III/">216. Combination Sum III</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-215-Kth-Largest-Element-in-an-Array/">215. Kth Largest Element in an Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-213-House-Robber-II/">213. House Robber II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-210-Course-Schedule-II/">210. Course Schedule II</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-209-Minimum-Size-Subarray-Sum/">209. Minimum Size Subarray Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-207-Course-Schedule/">207. Course Schedule</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-206-Reverse-Linked-List/">206. Reverse Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-205-Isomorphic-Strings/">205. Isomorphic Strings</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-204-Count-Primes/">204. Count Primes</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-203-Remove-Linked-List-Elements/">203. Remove Linked List Elements</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-202-Happy-Number/">202. Happy Number</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-200-Number-of-Islands/">200. Number of Islands</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-199-Binary-Tree-Right-Side-View/">199. Binary Tree Right Side View</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-198-House-Robber/">198. House Robber</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-191-Number-of-1-Bits/">191. Number of 1 Bits</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-190-Reverse-Bits/">190. Reverse Bits</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-187-Repeated-DNA-Sequences/">187. Repeated DNA Sequences</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-179-Largest-Number/">179. Largest Number</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-174-Dungeon-Game/">174. Dungeon Game</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-173-Binary-Search-Tree-Iterator/">173. Binary Search Tree Iterator</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-172-Factorial-Trailing-Zeroes/">172. Factorial Trailing Zeroes</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-171-Excel-Sheet-Column-Number/">171. Excel Sheet Column Number</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-170-TwoSum-III/">170. TwoSum III</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-168-Excel-Sheet-Column-Title/">168. Excel Sheet Column Title</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-167-Two-Sum-II-Input-array-is-sorted/">167. Two Sum II - Input array is sorted</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-166-Fraction-to-Recurring-Decimal/">166. Fraction to Recurring Decimal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-160-Intersection-of-Two-Linked-Lists/">160. Intersection of Two Linked Lists</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-155-Min-Stack/">155. Min Stack</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-152-Maximum-Product-Subarray/">152. Maximum Product Subarray</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-151-Reverse-Words-in-a-String/">151. Reverse Words in a String</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-150-Evaluate-Reverse-Polish-Notation/">150. Evaluate Reverse Polish Notation</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-149-Max-Points-on-a-Line/">149. Max Points on a Line</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-148-Sort-List/">148. Sort List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-147-Insertion-Sort-List/">147. Insertion Sort List</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-146-LRU-Cache/">146. LRU Cache</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-145-Binary-Tree-Postorder-Traversal/">145. Binary Tree Postorder Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-144-Binary-Tree-Preorder-Traversal/">144. Binary Tree Preorder Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-143-Reorder-List/">143. Reorder List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-142-Linked-List-Cycle-II/">142. Linked List Cycle II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-141-Linked-List-Cycle/">141. Linked List Cycle</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-139-Word-Break/">139. Word Break</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-138-Copy-List-with-Random-Pointer/">138. Copy List with Random Pointer</a></li>  <li class="file"><a href="/wiki/2017/08/17/Leetcode-136-Single-Number/">136 Single Number</a></li>  <li class="file"><a href="/wiki/2017/08/17/Leetcode-137-Single-Number-II/">137 Single Number II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-133-Clone-Graph/">133. Clone Graph</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-132-Palindrome-Partitioning-II/">132. Palindrome Partitioning II</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-131-Palindrome-Partitioning/">131. Palindrome Partitioning</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-130-Surrounded-Regions/">130. Surrounded Regions</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-129-Sum-Root-to-Leaf-Numbers/">129. Sum Root to Leaf Numbers</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-128-Longest-Consecutive-Sequence/">128. Longest Consecutive Sequence</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-127-Word-Ladder/">127. Word Ladder</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-125-Valid-Palindrome/">125. Valid Palindrome</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-124-Binary-Tree-Maximum-Path-Sum/">124. Binary Tree Maximum Path Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-121-Best-Time-to-Buy-and-Sell-Stock/">121. Best Time to Buy and Sell Stock</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-120-Triangle/">120. Triangle</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-119-Pascal-s-Triangle-II/">119. Pascal's Triangle II</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-118-Pascal-s-Triangle/">118. Pascal's Triangle</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-117-Populating-Next-Right-Pointers-in-Each-Node-II/">117. Populating Next Right Pointers in Each Node II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-116-Populating-Next-Right-Pointers-in-Each-Node/">116. Populating Next Right Pointers in Each Node</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-114-Flatten-Binary-Tree-to-Linked-List/">114. Flatten Binary Tree to Linked List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-113-Path-Sum-II/">113. Path Sum II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-112-Path-Sum/">112. Path Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-111-Minimum-Depth-of-Binary-Tree/">111. Minimum Depth of Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-110-Balanced-Binary-Tree/">110. Balanced Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-108-Convert-Sorted-Array-to-Binary-Search-Tree/">108. Convert Sorted Array to Binary Search Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-107-Binary-Tree-Level-Order-Traversal-II/">107. Binary Tree Level Order Traversal II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-105-Construct-Binary-Tree-from-Preorder-and-Inorder-Traversal/">105. Construct Binary Tree from Preorder and Inorder Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-104-Maximum-Depth-of-Binary-Tree/">104. Maximum Depth of Binary Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-103-Binary-Tree-Zigzag-Level-Order-Traversal/">103. Binary Tree Zigzag Level Order Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-102-Binary-Tree-Level-Order-Traversal/">102. Binary Tree Level Order Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-101-Symmetric-Tree/">101. Symmetric Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-100-Same-Tree/">100. Same Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-99-Recover-Binary-Search-Tree/">99. Recover Binary Search Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-98-Validate-Binary-Search-Tree/">98. Validate Binary Search Tree</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-96-Unique-Binary-Search-Trees/">96. Unique Binary Search Trees</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-95-Unique-Binary-Search-Trees-II/">95. Unique Binary Search Trees II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-94-Binary-Tree-Inorder-Traversal/">94. Binary Tree Inorder Traversal</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-93-Restore-IP-Adress/">93. Restore IP Adress</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-93-Restore-IP-Addresses/">93. Restore IP Addresses</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-92-Reverse-Linked-List-II/">92. Reverse Linked List II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-91-Decode-Ways/">91. Decode Ways</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-90-Subsets-II/">90. Subsets II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-89-Gray-Code/">89. Gray Code</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-88-Merge-Sorted-Array/">88. Merge Sorted Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-86-Partition-List/">86. Partition List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-85-Maximal-Rectangle/">85. Maximal Rectangle</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-84-Largest-Rectangle-in-Histogram/">84. Largest Rectangle in Histogram</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-83-Remove-Duplicates-from-Sorted-List/">83. Remove Duplicates from Sorted List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-82-Remove-Duplicates-from-Sorted-List-II/">82. Remove Duplicates from Sorted List II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-79-Word-Search/">79. Word Search</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-78-Subsets-md/">78. Subsets</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-77-Combinations/">77. Combinations</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-76-Minimum-Window-Substring/">76. Minimum Window Substring</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-75-Sort-Colors/">75. Sort Colors</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-74-Search-a-2D-Matrix/">74. Search a 2D Matrix</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-71-Simplify-Path/">71. Simplify Path</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-70-Climbing-Stairs/">70. Climbing Stairs</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-69-Sqrt-x/">69. Sqrt(x)</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-67-Add-Binary/">67. Add Binary</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-66-Plus-One/">66. Plus One</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-64-Minimum-Path-Sum/">64. Minimum Path Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-63-Unique-Paths-II/">63. Unique Paths II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-62-Unique-Paths/">62. Unique Paths</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-61-Rotate-List/">61. Rotate List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-60-Permutation-Sequence/">60. Permutation Sequence</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-58-Length-of-Last-Word/">58. Length of Last Word</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-56-Merge-Intervals/">56. Merge Intervals</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-53-Maximum-Subarray/">53. Maximum Subarray</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-52-N-Queens-II/">52. N-Queens II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-51-N-Queens/">51. N-Queens</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-50-Pow-x-n/">50. Pow(x, n)</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-49-Group-Anagrams/">49. Group Anagrams</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-47-Permutations-II/">47. Permutations II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-46-Permutations/">46. Permutations</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-43-Multiply-Strings/">43. Multiply Strings</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-42-Trapping-Rain-Water/">42. Trapping Rain Water</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-40-Combination-Sum-II/">40. Combination Sum II</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-39-Combination-Sum/">39. Combination Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-38-Count-and-Say/">38. Count and Say</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-37-Sudoku-Solver/">37. Sudoku Solver</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-36-Valid-Sudoku/">36. Valid Sudoku</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-35-Search-Insert-Position/">35. Search Insert Position</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-34-Search-for-a-Range/">34. Find First and Last Position of Element in Sorted Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-33-Search-in-Rotated-Sorted-Array/">33. Search in Rotated Sorted Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-33-Search-in-Rotated-Sorted-Array/">33. Search in Rotated Sorted Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-32-Longest-Valid-Parentheses/">32. Longest Valid Parentheses</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-31-Next-Permutation/">31. Next Permutation</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-30-Substring-with-Concatenation-of-All-Words/">30. Substring with Concatenation of All Words</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-29-Divide-Two-Integers/">29. Divide Two Integers</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-28-Implement-strStr/">28. Implement strStr()</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-27-Remove-Element/">27. Remove Element</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-26-Remove-Duplicates-from-Sorted-Array/">26. Remove Duplicates from Sorted Array</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-25-Reverse-Nodes-in-k-Group/">25. Reverse Nodes in k-Group</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-24-Swap-Nodes-in-Pairs/">24. Swap Nodes in Pairs</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-23-Merge-k-Sorted-Lists/">23. Merge k Sorted Lists</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-22-Generate-Parentheses/">22. Generate Parentheses</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-21-Merge-Two-Sorted-Lists/">21. Merge Two Sorted Lists</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-20-Valid-Parentheses/">20. Valid Parentheses</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-19-Remove-Nth-Node-From-End-of-List/">19. Remove Nth Node From End of List</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-18-4-Sum/">18. 4 Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-17-Letter-Combinations-of-a-Phone-Number/">17. Letter Combinations of a Phone Number.md</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-16-3-Sum-Cloest/">16. 3Sum Closest</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-15-3-Sum/">15. 3Sum</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-14-Longest-Common-Prefix/">14. Longest Common Prefix</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-12-Integer-to-Roman/">12. Integer to Roman</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-11-Container-With-Most-Water/">11. Container With Most Water</a></li>  <li class="file"><a href="/wiki/2017/10/30/Leetcode-10-Regular-Expression-Matching/">10. Regular Expression Matching</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-9-Palindrome-Number/">9. Palindrome Number</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-8-String-to-Integer-atoi/">8. String to Integer (atoi)</a></li>  <li class="file"><a href="/wiki/2017/09/01/Leetcode-7-Reverse-Integer/">7. Reverse Integer</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-6-ZigZag-Conversion/">6. ZigZag Conversion</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-5-Longest-Palindromic-Substring/">5. Longest Palindromic Substring</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-4-Median-of-Two-Sorted-Arrays/">4. Median of Two Sorted Arrays</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-3-Longest-Substring-Without-Repeating-Characters/">3. Longest Substring Without Repeating Characters</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-2-Add-Two-Numbers/">2. Add Two Numbers</a></li>  <li class="file"><a href="/wiki/2017/10/10/Leetcode-1-Two-Sum/">1. Two Sum</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            LintCode
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/10/10/LintCode-464-Sort-Integers-II/">464. Sort Integers II</a></li>  <li class="file"><a href="/wiki/2017/10/30/LintCode-77-Longest-Common-Subsequence/">77. Longest Common Subsequence</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            OS
                        </a>
                         <ul class="unstyled" id="tree" > 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            CSE521
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-10-Introduction-to-scheduling/">Introduction to scheduling</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-9-Threads-and-Thread-Implementations/">Threads and Thread Implementations</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-8-contect-switching/">context switching</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-7-Interrupt-and-Exception-Handling/">Interrupt and Exception Handling</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-6-Deaklock-and-exec/">Deadlock and exec</a></li>  <li class="file active"><a href="/wiki/2017/07/30/OS-CSE521-5-Synchronation-Primitive/">Synchronization Primitives</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-4-Introduction-to-Synchronation/">Introduction to Synchronization</a></li>  <li class="file"><a href="/wiki/2017/07/30/OS-CSE521-3-fork-and-pipe/">fork() and pipe()</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/wiki/2017/07/30/OS-实现操作系统1-配置/">实现操作系统1 - 配置</a></li>  <li class="file"><a href="/wiki/2018/07/12/OS-POSIX/">POSIX</a></li>  <li class="file"><a href="/wiki/2018/07/12/OS-超线程/">超线程</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Python
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/12/30/Python-Records/">Records</a></li>  <li class="file"><a href="/wiki/2017/10/30/Python-谈谈Python中的拷贝/">谈谈Python中的拷贝</a></li>  <li class="file"><a href="/wiki/2017/10/30/Python-python引号/">Python引号</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            TOOLS
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/03/30/TOOLS-Python配置/">Python配置</a></li>  <li class="file"><a href="/wiki/2017/10/30/TOOLS-LLDB使用/">LLDB使用</a></li>  <li class="file"><a href="/wiki/2018/01/01/TOOLS-Git/">Git</a></li>  <li class="file"><a href="/wiki/2017/12/30/TOOLS-VIM技巧/">VIM技巧</a></li>  <li class="file"><a href="/wiki/2017/10/30/TOOLS-Clion/">Clion</a></li>  <li class="file"><a href="/wiki/2017/10/30/TOOLS-Maven/">Maven</a></li>  <li class="file"><a href="/wiki/2017/10/30/TOOLS-VSCODE/">VSCode</a></li>  <li class="file"><a href="/wiki/2017/10/30/TOOLS-GCC/">GCC</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            TensorFlow
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-TF会话生命周期/">TF会话生命周期</a></li>  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-5-TF-Graph模块/">5 TF - Graph模块</a></li>  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-4-OpKernels简介/">4 TF OpKernels简介</a></li>  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-3-代码分析初步/">3 TF代码分析初步</a></li>  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-2-核心概念/">2 TF核心概念</a></li>  <li class="file"><a href="/wiki/2017/12/30/TensorFlow-1-TF系统框架/">1 TF系统框架</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            awesome Install
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2018/01/01/awesome-Install-shadowsocks/">搭建shadowsocks</a></li>  <li class="file"><a href="/wiki/2017/12/30/awesome-Install-vagrant搭建ubuntu/">vagrant搭建ubuntu</a></li>  <li class="file"><a href="/wiki/2017/12/30/awesome-Install-git/">git</a></li>  <li class="file"><a href="/wiki/2017/12/30/awesome-Install-Youtube/">Youtube</a></li>  <li class="file"><a href="/wiki/2017/12/11/awesome-Install-nasm/">Nasm</a></li>  <li class="file"><a href="/wiki/2017/12/10/awesome-Install-octave/">Octave</a></li>  <li class="file"><a href="/wiki/2017/12/03/awesome-Install-Intel-Parallel-Studio-XE/">Intel Parallel Studio XE</a></li>  <li class="file"><a href="/wiki/2017/09/30/awesome-Install-Mac环境下搭建Hadoop家族产品/">Mac环境下搭建Hadoop家族产品</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            小技巧
                        </a>
                         <ul class="unstyled" id="tree" >  <li class="file"><a href="/wiki/2018/02/02/小技巧-Mac禁止访问网站/">Mac禁止访问网站</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/wiki/2018/01/06/index/"></a></li>  </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title"><span>links</span></h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://larryim.cc">My Blog</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-OS-CSE521-5-Synchronation-Primitive" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/wiki/categories/OS/">OS</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/wiki/categories/OS/CSE521/">CSE521</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/wiki/tags/OS/">OS</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/2017/07/30/OS-CSE521-5-Synchronation-Primitive/">
            <time datetime="2017-07-29T16:00:00.000Z" itemprop="datePublished">2017-07-30</time>
        </a>
    </div>


                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            Synchronization Primitives
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Implementing-Critical-Sections"><span class="toc-number">1.</span> <span class="toc-text">Implementing Critical Sections</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Atomic-Instructions"><span class="toc-number">2.</span> <span class="toc-text">Atomic Instructions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Bank-Example-Test-and-Set"><span class="toc-number">3.</span> <span class="toc-text">The Bank Example: Test and Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Busy-Waiting"><span class="toc-number">4.</span> <span class="toc-text">Busy Waiting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Bank-Example-Test-and-Set-1"><span class="toc-number">5.</span> <span class="toc-text">The Bank Example: Test and Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Locks"><span class="toc-number">6.</span> <span class="toc-text">Locks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spinlocks"><span class="toc-number">7.</span> <span class="toc-text">Spinlocks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#More-Bank-Example"><span class="toc-number">8.</span> <span class="toc-text">More Bank Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-To-Wait"><span class="toc-number">9.</span> <span class="toc-text">How To Wait</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spinning-v-Sleeping"><span class="toc-number">10.</span> <span class="toc-text">Spinning v. Sleeping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-to-Spin"><span class="toc-number">11.</span> <span class="toc-text">When to Spin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-to-Sleep"><span class="toc-number">12.</span> <span class="toc-text">When to Sleep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-Sleep"><span class="toc-number">13.</span> <span class="toc-text">How to Sleep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thread-Communication"><span class="toc-number">14.</span> <span class="toc-text">Thread Communication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Condition-Variables"><span class="toc-number">15.</span> <span class="toc-text">Condition Variables</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reference"><span class="toc-number">16.</span> <span class="toc-text">reference</span></a></li></ol>
                </div>
            
        
        
            <p><strong>Synchronization primitives</strong>(同步原语) are simple software mechanisms provided by a platform (e.g. operating system) to its users for the purposes of supporting thread or process synchronization. They’re usually built using lower level mechanisms (e.g. atomic operations, memory barriers, spinlocks, context switches etc)[1].</p>
<p>primitive or atomic action 是由若干个机器指令构成的完成某种特定功能的一段程序，具有不可分割性·即原语的执行必须是连续的，在执行过程中不允许被中断[2]。</p>
<h2 id="Implementing-Critical-Sections"><a href="#Implementing-Critical-Sections" class="headerlink" title="Implementing Critical Sections"></a>Implementing Critical Sections</h2><ul>
<li><p>Two possible approaches. <strong>Don’t stop</strong>, or <strong>don’t enter</strong>.</p>
</li>
<li><p>On <strong>uniprocessors</strong> a single thread can prevent other threads from executing in a critical section by simply not being descheduled.</p>
<ul>
<li>In the kernel we can do this by <strong>masking</strong> interrupts. No timer, no scheduler, no stopping.</li>
<li><strong>In the multicore era this is only of historical interest</strong>. (This design pattern is usually broken.)</li>
</ul>
</li>
<li>More generally we need a way to force other threads—potentially running on other cores—<strong>not to enter</strong> the critical section while one thread is inside. <strong>How do we do this</strong>?</li>
</ul>
<h2 id="Atomic-Instructions"><a href="#Atomic-Instructions" class="headerlink" title="Atomic Instructions"></a>Atomic Instructions</h2><p>Software synchronization primitives <strong>utilize special hardware instructions</strong> guaranteed to be atomic across all cores:</p>
<ul>
<li><strong>Test-and-set</strong>: write a memory location and return its old value.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">testAndSet</span><span class="params">(<span class="keyword">int</span> * target, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  oldvalue = *target;</span><br><span class="line">  *target = value;</span><br><span class="line">  <span class="keyword">return</span> oldvalue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Compare-and-swap</strong>: compare the contents of a memory location to a given value. If they are the same, set the variable to a new given value.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compareAndSwap</span><span class="params">(<span class="keyword">int</span> * target, <span class="keyword">int</span> compare, <span class="keyword">int</span> newvalue)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (*target == compare) &#123;</span><br><span class="line">    *target = newvalue;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Load-link and store-conditional</strong>: Load-link returns the value of a memory address, while the following store-conditional succeeds <strong>only if</strong> the value has not changed since the load-link.</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">y = <span class="number">1</span>;</span><br><span class="line">__<span class="function"><span class="keyword">asm</span> <span class="title">volatile</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">".set push;"</span>     <span class="comment">/* save assembler mode */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">".set mips32;"</span>   <span class="comment">/* allow MIPS32 instructions */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">".set volatile;"</span> <span class="comment">/* avoid unwanted optimization */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">"ll %0, 0(%2);"</span>  <span class="comment">/*   x = *sd */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">"sc %1, 0(%2);"</span>  <span class="comment">/*   *sd = y; y = success? */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="string">".set pop"</span>       <span class="comment">/* restore assembler mode */</span></span></span></span><br><span class="line">    : "=r" (x), "+r" (y) : "r" (sd));</span><br><span class="line"><span class="keyword">if</span> (y == <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Many processors provide either <strong>test and set</strong> or <strong>compare and swap</strong>.</li>
<li>On others equivalents can be implemented in software using other atomic hardware instructions.</li>
</ul>
<h2 id="The-Bank-Example-Test-and-Set"><a href="#The-Bank-Example-Test-and-Set" class="headerlink" title="The Bank Example: Test and Set"></a>The Bank Example: Test and Set</h2><p>Let’s modify our earlier example to use a test and set:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+<span class="keyword">int</span> payGWA = <span class="number">0</span>; <span class="comment">// Shared variable for our test and set.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">+ testAndSet(&amp;payGWA, <span class="number">1</span>); # Set the test <span class="keyword">and</span> <span class="built_in">set</span>.</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">+ testAndSet(&amp;payGWA, <span class="number">0</span>); # Clear the test <span class="keyword">and</span> <span class="built_in">set</span>.</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Does this work?</strong> No! How do I tell if another thread has already set payGWA?</p>
<p>Let’s try again:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+<span class="keyword">int</span> payGWA = <span class="number">0</span>; <span class="comment">// Shared variable for our test and set.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">+ <span class="keyword">if</span> (testAndSet(&amp;payGWA, <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">+   <span class="comment">// But then what?</span></span><br><span class="line">+ &#125;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">+ testAndSet(&amp;payGWA, <span class="number">0</span>); # Clear the test <span class="keyword">and</span> <span class="built_in">set</span>.</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>But what should I do if the payGWA is set?</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+<span class="keyword">int</span> payGWA = <span class="number">0</span>; <span class="comment">// Shared variable for our test and set.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">+ <span class="keyword">while</span> (testAndSet(&amp;payGWA, <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">+   ; <span class="comment">// Test it again!</span></span><br><span class="line">+ &#125;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">+ testAndSet(&amp;payGWA, <span class="number">0</span>); # Clear the test <span class="keyword">and</span> <span class="built_in">set</span>.</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Busy-Waiting"><a href="#Busy-Waiting" class="headerlink" title="Busy Waiting"></a>Busy Waiting</h2><p><img src="http://or9a8nskt.bkt.clouddn.com/15314088473143.jpg" alt="busy waiting"></p>
<p><img src="http://or9a8nskt.bkt.clouddn.com/whentwothreadsrace.png" alt="whentwothreadsrace"></p>
<h2 id="The-Bank-Example-Test-and-Set-1"><a href="#The-Bank-Example-Test-and-Set-1" class="headerlink" title="The Bank Example: Test and Set"></a>The Bank Example: Test and Set</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> payGWA = <span class="number">0</span>; <span class="comment">// Shared variable for our test and set.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (testAndSet(&amp;payGWA, <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">   ; <span class="comment">// Test it again!</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">  testAndSet(&amp;payGWA, <span class="number">0</span>); # Clear the test <span class="keyword">and</span> <span class="built_in">set</span>.</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>What are the <strong>problems</strong> with this approach?</p>
<ul>
<li><strong>Busy waiting</strong>: threads wait for the critical section by “pounding on the door”, executing the TAS repeatedly.</li>
<li>Bad on a multicore system. Worse on a single core system! <strong>Busy waiting prevents the thread in the critical section from making progress!</strong></li>
</ul>
<h2 id="Locks"><a href="#Locks" class="headerlink" title="Locks"></a>Locks</h2><p><strong>Locks</strong> are a synchronization primitive used to implement critical sections.</p>
<ul>
<li>Threads <strong>acquire</strong> a lock when entering a critical section.</li>
<li>Threads <strong>release</strong> a lock when leaving a critical section.</li>
</ul>
<h2 id="Spinlocks"><a href="#Spinlocks" class="headerlink" title="Spinlocks"></a>Spinlocks</h2><p>What we have implemented today is known as a <strong>spinlock</strong>:</p>
<ul>
<li><strong>lock</strong> for the fact that it guards a critical section (we will have more to say about locks next time), and</li>
<li><strong>spin</strong> describing the process of acquiring it.</li>
</ul>
<p>Spinlocks are <strong>rarely used</strong> on their own to solve synchronization problems.</p>
<p>Spinlocks are <strong>commonly used</strong> to build more useful synchronization primitives.</p>
<h2 id="More-Bank-Example"><a href="#More-Bank-Example" class="headerlink" title="More Bank Example"></a>More Bank Example</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lock gwaWalletLock; <span class="comment">// Need to initialize somewhere</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">giveGWATheMoolah</span><span class="params">(<span class="keyword">account_t</span> account, <span class="keyword">int</span> largeAmount)</span> </span>&#123;</span><br><span class="line">+ lock_acquire(&amp;gwaWalletLock);</span><br><span class="line">  <span class="keyword">int</span> gwaHas = get_balance(account);</span><br><span class="line">  gwaHas = gwaHas + largeAmount;</span><br><span class="line">  put_balance(account, gwaHas);</span><br><span class="line">+ lock_release(&amp;gwaWalletLock);</span><br><span class="line">  notifyGWAThatHeIsRich(gwaHas);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>What happens if we call <code>lock_acquire()</code> while another thread is in the critical section?</p>
<ul>
<li><strong>The thread acquiring the lock must wait until the thread holding the lock calls lock_release()</strong>.</li>
</ul>
<h2 id="How-To-Wait"><a href="#How-To-Wait" class="headerlink" title="How To Wait"></a>How To Wait</h2><p><strong>How</strong> do we wait?</p>
<ul>
<li><strong>Active</strong> (or busy) waiting: repeat some action until the lock is released.</li>
<li><strong>Passive</strong> waiting: tell the kernel what we are waiting for, go to sleep, and rely on <code>lock_release</code> to awaken us.</li>
</ul>
<h2 id="Spinning-v-Sleeping"><a href="#Spinning-v-Sleeping" class="headerlink" title="Spinning v. Sleeping"></a>Spinning v. Sleeping</h2><p>There are cases where spinning is the right thing to do. <strong>When</strong>?</p>
<ul>
<li>Only on multicore systems. Why?<ul>
<li>On single core systems <strong>nothing can change</strong> unless we allow another thread to run!</li>
</ul>
</li>
<li>If the critical section is <strong>short</strong>.<ul>
<li>Balance the length of the <strong>critical section</strong> against the overhead of a <strong>context switch</strong>.</li>
</ul>
</li>
</ul>
<h2 id="When-to-Spin"><a href="#When-to-Spin" class="headerlink" title="When to Spin"></a>When to Spin</h2><p>If the critical section is <strong>short</strong>:<br><img src="http://or9a8nskt.bkt.clouddn.com/whentospin.png" alt="when to spin"></p>
<h2 id="When-to-Sleep"><a href="#When-to-Sleep" class="headerlink" title="When to Sleep"></a>When to Sleep</h2><p>If the critical section is <strong>long</strong>:</p>
<p><img src="http://or9a8nskt.bkt.clouddn.com/when_to_sleep.png" alt="when_to_sleep"></p>
<h2 id="How-to-Sleep"><a href="#How-to-Sleep" class="headerlink" title="How to Sleep"></a>How to Sleep</h2><p>The kernel provides functionality allowing kernel threads to sleep and wake on a <strong>key</strong>:</p>
<ul>
<li><code>thread_sleep(key)</code>: “Hey kernel, I’m going to sleep, but please wake me up when key happens.”</li>
<li><code>thread_wake(key)</code>: “Hey kernel, please wake up all (or one of) the threads who were waiting for key.”</li>
<li>Similar functionality can be implemented in user space.</li>
</ul>
<h2 id="Thread-Communication"><a href="#Thread-Communication" class="headerlink" title="Thread Communication"></a>Thread Communication</h2><ul>
<li>Locks are designed to protect <strong>critical sections</strong>.</li>
<li><code>lock_release()</code> can be considered a <strong>signal</strong> from the thread inside the critical section to other threads indicating that they can proceed.<ul>
<li>In order to receive this signal a thread must be sleeping.</li>
</ul>
</li>
<li>What about other kinds of signals that I might want to deliver?<ul>
<li>The buffer has data in it.</li>
<li>Your child has exited.</li>
</ul>
</li>
</ul>
<h2 id="Condition-Variables"><a href="#Condition-Variables" class="headerlink" title="Condition Variables"></a>Condition Variables</h2><p>A <strong>condition variable</strong>(条件变量) is a signaling mechanism allowing threads to:</p>
<ul>
<li><code>cv_wait</code> until a <strong>condition</strong> is true, and</li>
<li><code>cv_notify</code> other threads when the condition becomes true.</li>
</ul>
<p>The <strong>condition</strong> is usually represented as some change to shared state.</p>
<ul>
<li>The buffer has data in it: <strong>bufsize &gt; 0</strong>.</li>
<li><code>cv_wait</code>: notify me when the buffer has data in it.</li>
<li><p><code>cv_signal</code>: I just put data in the buffer, so notify the threads that are waiting for the buffer to have data.</p>
</li>
<li><p><strong>Condition variable</strong> can convey <strong>more information</strong> than locks about some change to the state of the world.</p>
</li>
</ul>
<p>As an example, a buffer can be <strong>full</strong>, <strong>empty</strong>, or <strong>neither</strong>.</p>
<ul>
<li>If the buffer is <strong>full</strong>, we can let threads withdraw but not add items.</li>
<li>If the buffer is <strong>empty</strong>, we can let threads add but not withdraw items.</li>
<li>If the buffer is neither full nor empty, we can let threads add and withdraw items.</li>
</ul>
<p>We have <strong>three</strong> different buffer states (full, empty, or neither) and <strong>two</strong> different threads (producer, consumer).</p>
<p>Why are condition variables a synchronization mechanism?</p>
<ul>
<li>Want to ensure that the condition <strong>does not change</strong> between checking it and deciding to wait!</li>
</ul>
<p><img src="http://or9a8nskt.bkt.clouddn.com/condition_variable.png" alt="condition_variable"></p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p>[1] <a href="https://stackoverflow.com/questions/8017507/definition-of-synchronization-primitive">https://stackoverflow.com/questions/8017507/definition-of-synchronization-primitive</a><br>[2] <a href="https://baike.baidu.com/item/原语/3794081?fr=aladdin">https://baike.baidu.com/item/原语/3794081?fr=aladdin</a></p>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/wiki/2017/07/30/OS-实现操作系统1-配置/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    实现操作系统1 - 配置
                
            </div>
        </a>
    
    
        <a href="/wiki/2017/03/30/TOOLS-Python配置/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">Python配置</div>
        </a>
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            larry &copy; 2018 
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme - <a href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
        </div>
    </div>
</footer>
        

    
        <script src="/wiki/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/wiki/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/wiki/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->
<script src="/wiki/js/main.js"></script>

    </div>
</body>
</html>